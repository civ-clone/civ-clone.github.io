"use strict";(()=>{var yY=Object.create;var Jm=Object.defineProperty;var fY=Object.getOwnPropertyDescriptor;var dY=Object.getOwnPropertyNames;var gY=Object.getPrototypeOf,hY=Object.prototype.hasOwnProperty;var t=(i,e)=>Jm(i,"name",{value:e,configurable:!0});var n=(i,e)=>()=>(i&&(e=i(i=0)),e);var C=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),Zp=(i,e)=>{for(var r in e)Jm(i,r,{get:e[r],enumerable:!0})},ex=(i,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of dY(e))!hY.call(i,a)&&a!==r&&Jm(i,a,{get:()=>e[a],enumerable:!(o=fY(e,a))||o.enumerable});return i};var T=(i,e,r)=>(r=i!=null?yY(gY(i)):{},ex(e||!i||!i.__esModule?Jm(r,"default",{value:i,enumerable:!0}):r,i)),R=i=>ex(Jm({},"__esModule",{value:!0}),i);var tx=(i,e,r)=>{if(!e.has(i))throw TypeError("Cannot "+r)};var b=(i,e,r)=>(tx(i,e,"read from private field"),r?r.call(i):e.get(i)),ye=(i,e,r)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,r)},ke=(i,e,r,o)=>(tx(i,e,"write to private field"),o?o.call(i,r):e.set(i,r),r),rx=(i,e,r,o)=>({set _(a){ke(i,e,a,r)},get _(){return b(i,e,o)}});var O,Qp,Ce=n(()=>{O=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return this.#e.some(r=>e instanceof r)}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(o=>{let a=o[e];return a instanceof Function?a.bind(o)()===r:o[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let o=this.#t.indexOf(r);o>-1&&this.#t.splice(o,1)})}};t(O,"EntityRegistry");Qp=O});var Xp,te,$t=n(()=>{Xp=class{#e;#t;#r;constructor(e,r,o){this.#e=r,this.#t=o,this.#r=e}data(...e){return this.#t(...e)}key(){return this.#e}type(){return this.#r}};t(Xp,"AdditionalData");te=Xp});var eu,re,kt=n(()=>{Ce();$t();eu=class extends O{constructor(){super(te)}getByType(e){return this.filter(r=>r.type()===e||Object.prototype.isPrototypeOf.call(r.type(),e)||Object.prototype.isPrototypeOf.call(r.type().prototype,e))}};t(eu,"AdditionalDataRegistry");re=new eu});var tu,RY,Zm,S,Fe,Z=n(()=>{kt();Ce();tu={},RY=t(i=>{let e=i.sourceClass().name,r=tu[e];return r||(tu[e]=0),r===Number.MAX_SAFE_INTEGER&&(tu[e]=BigInt(r)),e+"-"+(++tu[e]).toString(36)},"idProvider"),Zm=t((i,e,r=a=>a,o=re)=>{if(i=r(i),i instanceof Qp&&(i=i.entries()),Array.isArray(i))return i.map(a=>Zm(a,e,r,o));if(i instanceof S){let a=i.id();if(!(a in e)){let s={_:i.sourceClass().name};e[a]=s,i.keys().forEach(p=>{let u=i[p]instanceof Function?i[p]():i[p];s[p]=Zm(u,e,r,o)}),o.getByType(i.sourceClass()).forEach(p=>{s[p.key()]=Zm(p.data(i),e,r,o)})}return{"#ref":a}}return i instanceof Function?{_:i.name}:i&&i instanceof Object?Object.entries(i).reduce((a,[s,p])=>(a[s]=Zm(p,e,r,o),a),{}):i},"toPlainObject"),S=class{#e;#t=["id"];constructor(){this.#e=RY(this)}addKey(...e){this.#t.push(...e)}id(){return this.#e}keys(){return this.#t}sourceClass(){return this.constructor}toPlainObject(e=o=>o,r=re){let o={};return{hierarchy:Zm(this,o,e,r),objects:o}}};t(S,"DataObject");Fe=S});var ru,Dr,ka=n(()=>{Z();ru=class extends S{#e;#t;constructor(e,r){super(),this.#e=e,this.#t=r,this.addKey("value")}player(){return this.#e}value(){return this.#t}};t(ru,"PlayerAction");Dr=ru});var iu,ni,Ds=n(()=>{ka();iu=class extends Dr{};t(iu,"MandatoryPlayerAction");ni=iu});var Da,ix=n(()=>{Ds();Da=class extends ni{};t(Da,"ActiveUnit")});var Oa,ox=n(()=>{ka();Oa=class extends Dr{};t(Oa,"InactiveUnit")});var Jd=n(()=>{ix();ox()});var ou,v,E=n(()=>{Z();ou=class extends Fe{};t(ou,"Advance");v=ou});var De,Ki=n(()=>{De=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return typeof e=="function"&&this.#e.some(r=>Object.prototype.isPrototypeOf.call(r,e)||Object.prototype.isPrototypeOf.call(r.prototype,e))}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(o=>{let a=o[e];return a instanceof Function?a.bind(o)()===r:o[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let o=this.#t.indexOf(r);o>-1&&this.#t.splice(o,1)})}};t(De,"ConstructorRegistry")});var nu,h,A=n(()=>{E();Ki();nu=class extends De{constructor(){super(v)}};t(nu,"AdvanceRegistry");h=new nu});var Bl,l,B=n(()=>{Bl=class{#e=null;constructor(e){e&&(this.#e=e)}validate(...e){return this.#e===null?!0:this.#e(...e)}};t(Bl,"Criterion");l=Bl});var au,su,Zd=n(()=>{B();au=class extends l{#e=[];constructor(...e){super(),e.forEach(r=>{this.#e.push(r)})}criteria(){return this.#e}validate(...e){return this.#e.every(r=>r.validate(...e))}};t(au,"Criteria");su=au});var lu,Ya,Qd=n(()=>{Zd();lu=class extends su{};t(lu,"And");Ya=lu});var mu,m,I=n(()=>{mu=class{#e;constructor(e){this.#e=e}apply(...e){return this.#e(...e)}};t(mu,"Effect");m=mu});var pu,Or,Sa=n(()=>{pu=class{#e;constructor(e=2e3){this.#e=e}value(){return this.#e}};t(pu,"Priority");Or=pu});var Kn,Fa,Al=n(()=>{Sa();Kn=class extends Or{constructor(){super(1e3)}};t(Kn,"High");Fa=Kn});var Qe,nx,Xd=n(()=>{Sa();Qe=class extends Or{constructor(){super(3e3)}};t(Qe,"Low");nx=Qe});var Ul,ax=n(()=>{Sa();Ul=class extends Or{constructor(){super(2e3)}};t(Ul,"Normal")});var qn=n(()=>{Al();Xd();ax()});var uu,x,M=n(()=>{Qd();B();I();qn();uu=class{#e;#t=!0;#r;#i=new Ul;constructor(...e){let r=[];e.forEach(o=>{if(o instanceof m){if(this.#r)throw new TypeError("Rule: effect already specified, but another was provided.");this.#r=o;return}if(o instanceof l){r.push(o);return}this.#i=o}),r.length&&(this.#e=new Ya(...r))}disable(){this.#t=!1}enable(){this.#t=!0}enabled(){return this.#t}priority(){return this.#i}process(...e){if(!!this.#t&&this.#r instanceof m)return this.#r.apply(...e)}validate(...e){return this.#t?this.#e instanceof l?this.#e.validate(...e):!0:!1}};t(uu,"Rule");x=uu});var cu,d,P=n(()=>{Ce();M();cu=class extends O{#e=new Map;constructor(){super(x)}entries(){return super.entries().sort((e,r)=>e.priority().value()-r.priority().value())}get(e){return this.#e.has(e)||this.#e.set(e,this.filter(r=>r.enabled()&&r instanceof e)),this.#e.get(e)||[]}invalidateCache(e){this.#e.delete(e instanceof x?e.constructor:e)}process(e,...r){return this.get(e).filter(o=>o.validate(...r)).map(o=>o.process(...r))}register(...e){super.register(...e),e.forEach(r=>this.invalidateCache(r))}unregister(...e){super.unregister(...e),e.forEach(r=>this.invalidateCache(r))}};t(cu,"RuleRegistry");d=new cu});var yu,Na,fu=n(()=>{M();yu=class extends x{};t(yu,"Complete");Na=yu});var du,gu,eg=n(()=>{M();du=class extends x{};t(du,"Cost");gu=du});var hu,Ru,tg=n(()=>{M();hu=class extends x{};t(hu,"Requirements");Ru=hu});var za,L,$e=n(()=>{Z();za=class extends S{#e=[];#t=null;constructor(e=0,r="initial"){super(),this.addKey("value","values"),this.add(e,r)}add(e,r=""){if(e instanceof za)return this.add(e.value(),r);this.#e.push([e,r]),this.#t=null}clone(){return new this.constructor(this)}set(e,r=""){if(this.#e.splice(0),e instanceof za)return this.set(e.value(),r);this.#e.push([e,r]),this.#t=e}subtract(e,r=""){if(e instanceof za)return this.subtract(e.value(),r);this.#e.push([-e,r]),this.#t=null}value(){return this.#t===null&&(this.#t=this.#e.reduce((e,[r])=>e+r,0)),this.#t}values(){return this.#e}};t(za,"Yield");L=za});var Os,sx=n(()=>{$e();Os=class extends L{};t(Os,"Research")});var lx=n(()=>{sx()});var xu,vu,rg=n(()=>{M();xu=class extends x{};t(xu,"Started");vu=xu});var bu,Ml,Cu=n(()=>{A();Z();P();fu();eg();tg();lx();rg();bu=class extends S{#e;#t=[];#r=null;#i;#o=new Os(1/0);#a=new Os(0);#n;constructor(e,r=h,o=d){super(),this.#e=r,this.#i=e,this.#n=o,this.addKey("available","complete","cost","progress","researching")}add(e){this.#a.add(e),this.check()}addAdvance(e){if(this.#t.some(o=>o instanceof e))return;this.#r===e&&(this.#r=null);let r=new e;this.#t.push(r),this.#n.process(Na,this,r)}available(){let e=this.#n.get(Ru);return this.#e.filter(r=>e.filter(o=>o.validate(r,this.#t)).every(o=>o.process(r,this.#t)===!0)&&!this.#t.some(o=>o instanceof r))}check(){if(this.#r!==null&&this.#a.value()>=this.#o.value()){let e=new this.#r;this.#t.push(e),this.#r=null,this.#a.subtract(this.#o),this.#o.set(1/0),this.#n.process(Na,this,e)}}complete(){return this.#t}completed(e){return this.#t.some(r=>r instanceof e)}cost(){return this.#o}player(){return this.#i}progress(){return this.#a}research(e){let[r]=this.#n.process(gu,e,this);this.#o.set(r),this.#r=e,this.#n.process(vu,this,e)}researching(){return this.#r}};t(bu,"PlayerResearch");Ml=bu});var Tu,z,He=n(()=>{Ce();Cu();Tu=class extends O{constructor(){super(Ml)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of results for player.");return r[0]}};t(Tu,"PlayerResearchRegistry");z=new Tu});var El,Gl,Qm=n(()=>{El=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}goodyHut(){return this.#e}perform(){}unit(){return this.#t}};t(El,"Action");Gl=El});var La,mx=n(()=>{He();Qm();La=class extends Gl{#e;#t;constructor(e,r,o=z,a=()=>Math.random()){super(e,r),this.#e=o,this.#t=a}perform(){let e=this.#e.getByPlayer(this.unit().player()),r=e.available(),o=r[Math.floor(r.length*this.#t())];e.addAdvance(o)}};t(La,"Advance")});var Iu,yr,Ys=n(()=>{M();Iu=class extends x{};t(Iu,"Captured");yr=Iu});var wu,Xe,kl=n(()=>{M();wu=class extends x{};t(wu,"Cost");Xe=wu});var Pu,Wo,Bu=n(()=>{M();Pu=class extends x{};t(Pu,"Created");Wo=Pu});var Au,fr,Ss=n(()=>{M();Au=class extends x{};t(Au,"Destroyed");fr=Au});var Uu,Mu,ig=n(()=>{M();Uu=class extends x{};t(Uu,"Created");Mu=Uu});var Eu,bn,Dl=n(()=>{Z();P();ig();Eu=class extends S{#e;constructor(e=d){super(),this.#e=e,this.#e.process(Mu,this)}clone(){return new this.constructor(this.#e)}};t(Eu,"Terrain");bn=Eu});var W,px=n(()=>{Dl();W=class extends bn{};t(W,"Land")});var Jt,og=n(()=>{Dl();Jt=class extends bn{};t(Jt,"Water")});var Zt=n(()=>{px();og()});var Gu,ku,ng=n(()=>{M();Gu=class extends x{};t(Gu,"YieldModifier");ku=Gu});var Du,ai,ag=n(()=>{M();Du=class extends x{};t(Du,"Yield");ai=Du});var Ol,ue,qi=n(()=>{Z();Zt();P();Yu();$e();ng();ag();Ol=class extends S{#e;#t=[];#r;#i;#o;#a;#n=new Map;constructor(e,r,o,a,s=d){super(),this.#o=e,this.#a=r,this.#i=o,this.#e=a,this.#r=s,this.addKey("terrain","isCoast","isLand","isWater","x","y","yields")}clearYieldCache(e=null){this.#n.delete(e)}getAdjacent(){return this.getAdjacentDirections().map(e=>this.getNeighbour(e))}getAdjacentDirections(){return["n","e","s","w"]}getNeighbour(e){return e==="n"?this.#e.get(this.#o,this.#a-1):e==="ne"?this.#e.get(this.#o+1,this.#a-1):e==="e"?this.#e.get(this.#o+1,this.#a):e==="se"?this.#e.get(this.#o+1,this.#a+1):e==="s"?this.#e.get(this.#o,this.#a+1):e==="sw"?this.#e.get(this.#o-1,this.#a+1):e==="w"?this.#e.get(this.#o-1,this.#a):this.#e.get(this.#o-1,this.#a-1)}getNeighbouringDirections(){return["n","ne","e","se","s","sw","w","nw"]}getNeighbours(){return this.#t.length||(this.#t=this.getNeighbouringDirections().map(e=>this.getNeighbour(e))),this.#t}getSurroundingArea(e=2){return Ou.fromSurrounding(this,e)}distanceFrom(e){let r=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[o]=r.map(([a,s])=>Math.hypot(this.#o-e.x()+a*this.#e.width(),this.#a-e.y()+s*this.#e.height())).sort((a,s)=>a-s);return o}isCoast(){let e=this;return e.isWater()&&e.getNeighbours().some(r=>r.isLand())||e.isLand()&&e.getNeighbours().some(r=>r.isWater())}isLand(){return this.#i instanceof W}isNeighbourOf(e){return this.getNeighbours().includes(e)}isWater(){return this.#i instanceof Jt}map(){return this.#e}score(e=null,r=[[L,3]]){return this.yields(e).map(a=>{let[s]=r.filter(([u])=>a instanceof u),p=s?s[1]||1:0;return a.value()*p}).reduce((a,s)=>a+s,0)}terrain(){return this.#i}setTerrain(e){this.#i=e}x(){return this.#o}y(){return this.#a}yields(e=null){if(!this.#n.has(e)){let r=this.#r.process(ai,this,e).flat();this.#r.process(ku,this,e,r).flat(),this.#n.set(e,r)}return this.#n.get(e)}};t(Ol,"Tile");ue=Ol});var Yl,Ou,Yu=n(()=>{Ce();qi();Yl=class extends O{static from(...e){return new this(...e)}static fromSurrounding(e,r=2){let o=t(a=>{let s=[];for(let p=e.x()-a;p<=e.x()+a;p++)for(let u=e.y()-a;u<=e.y()+a;u++)s.push([p,u]);return s},"gen");return this.from(...o(r).map(([a,s])=>e.map().get(a,s)))}constructor(...e){super(Ol),this.register(...e)}push(...e){this.register(...e)}shift(){let[e]=this.entries();return this.unregister(e),e}score(e=null,r=[]){return this.entries().reduce((o,a)=>o+a.score(e,r),0)}yields(e=null){return this.entries().flatMap(r=>r.yields(e))}};t(Yl,"Tileset");Ou=Yl});var Sl,jo,Fl=n(()=>{M();Sl=class extends x{};t(Sl,"Yield");jo=Sl});var Su,Fs,Fu=n(()=>{M();Su=class extends x{};t(Su,"YieldModifier");Fs=Su});var Nu,et,Vn=n(()=>{Z();P();Ys();kl();Bu();Ss();Yu();$e();Fl();Fu();Nu=class extends S{#e;#t;#r;#i;#o;#a;#n=new Ou;constructor(e,r,o,a=d){super(),this.#e=o,this.#t=e,this.#r=e,this.#o=r,this.#a=this.#o.getSurroundingArea(),this.#n.push(r),this.#i=a,this.#i.process(Wo,this),this.addKey("name","originalPlayer","player","tile","tiles","tilesWorked","yields")}capture(e){let r=this.#r;this.#r=e,this.#i.process(yr,this,e,r)}destroy(e=null){this.#i.process(fr,this,e)}name(){return this.#e}setName(e){this.#e=e}originalPlayer(){return this.#t}player(){return this.#r}tile(){return this.#o}tiles(){return this.#a}tilesWorked(){return this.#n}yields(){let e=[];return[this.#i.get(jo),this.#i.get(Fs),this.#i.get(Xe)].flat().forEach(r=>{if(!r.validate(this,e))return;let o=r.process(this,e);if(!!o){if(o instanceof L){e.push(o);return}o.forEach(a=>e.push(a))}}),e}};t(Nu,"City");et=Nu});var zu,_,tt=n(()=>{Ce();Vn();zu=class extends O{constructor(){super(et)}getByPlayer(e){return this.filter(r=>r.player()===e)}getByTile(e){let[r]=this.filter(o=>o.tile()===e);return r??null}};t(zu,"CityRegistry");_=new zu});var Wa,ux=n(()=>{tt();P();Qm();Vn();Wa=class extends Gl{#e;constructor(e,r,o=_){super(e,r),this.#e=o}perform(e=d){let r=this.unit().player(),o=new et(r,this.goodyHut().tile(),r.civilization().getCityName(!0),e);this.#e.register(o)}};t(Wa,"City")});var ja,cx,Lu=n(()=>{Z();P();ja=class extends S{static build(e,r=d){throw new TypeError("createFromObject: Must be overridden in extending class")}};t(ja,"Buildable");cx=ja});var Wu,Cn,Nl=n(()=>{Ki();Lu();Wu=class extends De{constructor(){super(cx)}};t(Wu,"AvailableCityBuildItemsRegistry");Cn=new Wu});var Qt,yx,Xm=n(()=>{B();M();Qt=class extends x{process(e,r){let o=super.process(e,r);if(!(o instanceof Bl))throw new TypeError("Invalid build rule.");return o}};t(Qt,"Build");yx=Qt});var ju,_u,sg=n(()=>{Z();ju=class extends Fe{#e;constructor(e){super(),this.addKey("value"),this.#e=e}value(){return this.#e}};t(ju,"BuildCost");_u=ju});var ep,fx,zl,xY,tp=n(()=>{sg();B();I();M();ep=class extends x{};t(ep,"BuildCost");fx=ep,zl=t((i,e)=>xY([[i,e]]),"buildCost"),xY=t(i=>i.map(([e,r])=>new ep(new l(o=>o.item()===e),new m(()=>new _u(r)))),"buildCosts")});var Hu,Ku,lg=n(()=>{P();sg();tp();Z();Hu=class extends Fe{#e;#t=new _u(1/0);#r;#i;constructor(e,r=null,o=d){super(),this.#r=e,this.#e=r,this.#i=o,this.addKey("cost","item")}cost(){if(!Number.isFinite(this.#t.value())){let[e]=this.#i.process(fx,this,this.#e);e&&(this.#t=e)}return this.#t}item(){return this.#r}};t(Hu,"BuildItem");Ku=Hu});var Ns,dx=n(()=>{$e();Ns=class extends L{};t(Ns,"BuildProgress")});var gx=n(()=>{dx()});var qu,hx,Rx=n(()=>{M();qu=class extends x{};t(qu,"BuildingCancelled");hx=qu});var Vu,$n,rp=n(()=>{M();Vu=class extends x{};t(Vu,"BuildingComplete");$n=Vu});var $u,Ll,Ju=n(()=>{Nl();Z();P();Xm();lg();gx();Rx();rp();$u=class extends S{#e;#t=null;#r;#i=new Ns(1/0);#o=new Ns;#a;constructor(e,r=Cn,o=d){super(),this.#e=r,this.#r=e,this.#a=o,this.addKey("available","building","city","cost","progress","remaining")}add(e){this.#o.add(e)}available(){let e=this.#a.get(yx);return this.#e.filter(r=>e.filter(o=>o.validate(this.city(),r)).every(o=>o.process(this.city(),r).validate())).map(r=>new Ku(r,this.city(),this.#a))}build(e){let r=this.getAvailable(e);if(!r)throw new TypeError(`Cannot build ${e.name}, it's not available.`);this.#t=r,this.#i.set(this.#t.cost().value())}building(){return this.#t}check(){if(this.#o.value()>=this.#i.value()&&this.#t){let e=this.#t.item().build(this.#r,this.#a);return this.#o.set(0),this.#t=null,this.#i.set(1/0),this.#a.process($n,this,e),e}return null}city(){return this.#r}cost(){return this.#i}getAvailable(e){return this.available().filter(r=>r.item()===e)[0]}progress(){return this.#o}remaining(){return this.#i.value()-this.#o.value()}revalidate(){this.#t&&!this.getAvailable(this.#t.item())&&(this.#t=null,this.#i.set(1/0),this.#a.process(hx,this))}};t($u,"CityBuild");Ll=$u});var Zu,Xt,Jn=n(()=>{Ce();Ju();Zu=class extends O{constructor(){super(Ll)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of entities returned.");return r[0]}};t(Zu,"CityBuildRegistry");Xt=new Zu});var Qu,zs,mg=n(()=>{M();Qu=class extends x{};t(Qu,"Spend");zs=Qu});var Xu,ec,pg=n(()=>{Jn();P();mg();$e();Xu=class extends L{#e;#t;#r;constructor(e,r=Xt,o=d){super(),this.#e=e,this.#t=o,this.#r=r}buy(e){let r=this.#r.getByCity(e),o=this.cost(e);e.player()!==this.#e||this.value()<o.value()||(r.add(new L(r.remaining())),this.subtract(o.value()))}cost(e){let r=this.#r.getByCity(e),o=new L;return this.#t.process(zs,r,o).reduce((a,s)=>(a.add(s),a))}player(){return this.#e}};t(Xu,"PlayerTreasury");ec=Xu});var tc,si,Ls=n(()=>{Ce();pg();tc=class extends O{constructor(){super(ec)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTreasuries for player.");return r[0]}};t(tc,"PlayerTreasuryRegistry");si=new tc});var er,rc,Wl=n(()=>{$e();er=class extends L{};t(er,"Gold");rc=er});var _a,xx=n(()=>{Ls();Qm();Wl();_a=class extends Gl{#e;constructor(e,r,o=si){super(e,r),this.#e=o}perform(){this.#e.getByPlayer(this.unit().player()).add(new er(50))}};t(_a,"Gold")});var ic,oc,ug=n(()=>{M();ic=class extends x{};t(ic,"Unit");oc=ic});var Ha,vx=n(()=>{Qm();P();ug();Ha=class extends El{#e;#t;constructor(e,r,o=()=>Math.random(),a=d){super(e,r),this.#e=o,this.#t=a}perform(){this.#t.process(oc,this.goodyHut(),this.unit())}};t(Ha,"Unit")});var cg=n(()=>{mx();ux();xx();vx()});var Ka,bx=n(()=>{ka();Ka=class extends Dr{};t(Ka,"ChangeProduction")});var Tn,Cx=n(()=>{Ds();Tn=class extends ni{};t(Tn,"CityBuild")});var yg=n(()=>{bx();Cx()});var qa,Tx,nc=n(()=>{qa=class{#e;constructor(e){this.#e=e}player(){return this.#e}takeTurn(){return new Promise((e,r)=>r(new TypeError("Client#takeTurn must be implemented.")))}};t(qa,"Client");Tx=qa});var ac,Va,ip=n(()=>{$e();ac=class extends L{#e;constructor(e,r){super(r),this.#e=e}leader(){return this.#e}};t(ac,"Trait");Va=ac});var sc,lc,fg=n(()=>{Ce();ip();sc=class extends O{constructor(){super(Va)}getByLeader(e){return this.getBy("leader",e)}getBySubclass(e){return this.filter(r=>r instanceof e)}};t(sc,"TraitRegistry");lc=new sc});var mc,ee,st=n(()=>{fg();Z();mc=class extends S{#e=[];constructor(e=lc){super();let r=e.getByLeader(this.sourceClass());this.#e.push(...r),this.addKey("name")}static civilization(){throw new TypeError("Must be implemented in extending class")}name(){throw new TypeError("Must be implemented in extending class")}traits(){return[...this.#e]}};t(mc,"Leader");ee=mc});var pc,In,jl=n(()=>{Ki();st();pc=class extends De{constructor(){super(ee)}getByCivilization(e){return this.getBy("civilization",e)}};t(pc,"LeaderRegistry");In=new pc});var $a,Ix=n(()=>{ka();$a=class extends Dr{};t($a,"AdjustTradeRates")});var dg=n(()=>{Ix()});var uc,Te,dr=n(()=>{M();uc=class extends x{};t(uc,"Busy");Te=uc});var Ws,wx,gg=n(()=>{Ds();Ws=class extends ni{};t(Ws,"ChooseResearch");wx=Ws});var cc,yc,hg=n(()=>{M();cc=class extends x{};t(cc,"Cost");yc=cc});var wn,Rg,fc=n(()=>{$e();wn=class extends L{};t(wn,"FoodStorage");Rg=wn});var dc,np,xg=n(()=>{M();dc=class extends x{};t(dc,"FoodStorage");np=dc});var gc,Pn,hc=n(()=>{M();gc=class extends x{};t(gc,"Grow");Pn=gc});var Rc,js,vg=n(()=>{M();Rc=class extends x{};t(Rc,"Shrink");js=Rc});var xc,_s,vc=n(()=>{Z();P();hg();fc();xg();hc();vg();xc=class extends S{#e;#t=new Rg(1/0);#r=new Rg;#i;#o=1;constructor(e,r=d){super(),this.#e=e,this.#i=r,this.setCost(),this.addKey("cost","progress","size")}add(e){this.#r.add(e)}check(){this.#i.process(np,this)}city(){return this.#e}cost(){return this.#t}setCost(){let e=this.#i.process(yc,this);e.length>0&&this.#t.set(e[0],"setCost")}empty(){this.#r.subtract(this.#r.value())}grow(){this.#o++,this.#i.process(Pn,this)}progress(){return this.#r}shrink(){this.#o--,this.#i.process(js,this)}size(){return this.#o}};t(xc,"CityGrowth");_s=xc});var bc,ap,bg=n(()=>{M();bc=class extends x{};t(bc,"Created");ap=bc});var Cc,Y,Ae=n(()=>{Lu();P();bg();Cc=class extends ja{#e;#t;constructor(e,r=d){super(),this.#e=e,this.#t=r,this.#t.process(ap,this,e)}city(){return this.#e}static build(e,r=d){return new this(e,r)}};t(Cc,"CityImprovement");Y=Cc});var Tc,fe,tr=n(()=>{Z();Tc=class extends S{#e;#t;#r;constructor(e,r,o){super(),this.#e=e,this.#t=r,this.#r=o,this.addKey("name","value")}civilization(){return this.#e}name(){return this.#t}value(){return this.#r}};t(Tc,"Attribute");fe=Tc});var _l,de,rr=n(()=>{Ce();tr();_l=class extends O{constructor(){super(fe)}getByCivilization(e){return this.getBy("civilization",e)}getByName(e){return this.getBy("name",e)}};t(_l,"AttributeRegistry");de=new _l});var Ic,Q,Dt=n(()=>{Ic=class{#e;#t;#r=!1;constructor(e,r,o=!1){this.#e=e,this.#t=r,this.#r=o}name(){return this.#e}civilization(){return this.#t}capital(){return this.#r}};t(Ic,"CityName");Q=Ic});var wc,J,gt=n(()=>{Ce();Dt();wc=class extends O{#e=1;#t;constructor(e=()=>Math.random()){super(Q),this.#t=e}takeByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1);return r instanceof Q?(this.unregister(r),r.name()):this.takeUnassociated()}takeCapitalByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1).filter(o=>o.capital());return r instanceof Q?(this.unregister(r),r.name()):this.takeByCivilization(e)}takeUnassociated(){let[e]=this.getBy("civilization",null).sort(()=>Math.floor(this.#t()*3)-1);return e instanceof Q?(this.unregister(e),e.name()):`City #${this.#e++}`}};t(wc,"CityNameRegistry");J=new wc});var Pc,ae,Ot=n(()=>{rr();gt();Z();Pc=class extends S{#e=null;#t;#r=new _l;constructor(e=de,r=J){super(),this.#t=r,this.#r.register(...e.getByCivilization(this.sourceClass())),this.addKey("name","leader","attributes")}attributes(){return this.#r.entries()}name(){return this.constructor.name}leader(){return this.#e}setLeader(e){this.#e=e}getCityName(e=!1){let r=this.sourceClass();return e?this.#t.takeCapitalByCivilization(r):this.#t.takeByCivilization(r)}};t(Pc,"Civilization");ae=Pc});var Ja,Px=n(()=>{ka();Ja=class extends Dr{value(){return super.value()}};t(Ja,"CompleteProduction")});var Cg=n(()=>{Px()});var Hs,Ac,Uc=n(()=>{Ds();Hs=class extends ni{};t(Hs,"EndTurn");Ac=Hs});var Mc,ht,Zn=n(()=>{M();Mc=class extends x{};t(Mc,"Action");ht=Mc});var Ec,li,Ks=n(()=>{M();Ec=class extends x{};t(Ec,"Added");li=Ec});var Gc,Tg,Ax=n(()=>{ka();Gc=class extends Dr{};t(Gc,"HiddenPlayerAction");Tg=Gc});var kc,H,_o=n(()=>{Z();P();Zn();Ks();Ax();Ds();kc=class extends S{#e=null;#t;constructor(e=d){super(),this.#t=e,this.#t.process(li,this),this.addKey("actions","civilization","mandatoryActions")}action(){let[e]=this.actions();return e}actions(){return this.#t.process(ht,this).flat().filter(e=>!(e instanceof Tg))}civilization(){if(this.#e===null)throw new TypeError("Player#civilization is unset.");return this.#e}hasActions(){return!!this.action()}hasMandatoryActions(){return this.actions().some(e=>e instanceof ni)}hiddenActions(){return this.#t.process(ht,this).flat().filter(e=>e instanceof Tg)}mandatoryAction(){let[e]=this.mandatoryActions();return e}mandatoryActions(){return this.actions().filter(e=>e instanceof ni)}setCivilization(e){this.#e=e}};t(kc,"Player");H=kc});var Dc,Hl,Ig=n(()=>{kt();Z();qi();Dc=class extends S{#e={};#t;#r;#i;constructor(e,r,o=re){super(),this.#t=o,this.#r=r,this.#i=e,this.addKey("isCoast","isLand","isWater","terrain","x","y","yields"),this.setAdditionalData()}addKey(...e){super.addKey(...e)}isCoast(){return this.#i.isCoast()}isLand(){return this.#i.isLand()}isWater(){return this.#i.isWater()}player(){return this.#r}setAdditionalData(){this.#t.getByType(ue).forEach(e=>{this.#e[e.key()]=e.data(this.#i),Object.defineProperty(this,e.key(),{configurable:!0,value:()=>e.data(this.#i)}),this.addKey(e.key())})}terrain(){return this.#i.terrain()}tile(){return this.#i}update(){this.#i.clearYieldCache(this.#r),this.setAdditionalData()}x(){return this.#i.x()}y(){return this.#i.y()}yields(){return this.#i.yields(this.#r)}};t(Dc,"PlayerTile");Hl=Dc});var Oc,Ux,Mx=n(()=>{Dl();Oc=class extends bn{};t(Oc,"Unknown");Ux=Oc});var Yc,Ex,Gx=n(()=>{qi();Mx();Yc=class extends ue{constructor(e,r,o){super(e,r,new Ux,o)}};t(Yc,"UndiscoveredTile");Ex=Yc});var Sc,Fc,wg=n(()=>{M();Sc=class extends x{};t(Sc,"VisibilityChanged");Fc=Sc});var Nc,Kl,zc=n(()=>{Z();P();Ig();qi();Gx();wg();Nc=class extends S{#e;#t;#r=[];#i;constructor(e,r,o=d){super(),this.#e=e,this.#i=r,this.#t=o,this.addKey("height","tiles","width")}entries(){return this.#r}filter(e){return this.entries().filter(e)}forEach(e){return this.#r.forEach(e)}get(e,r){let[o]=this.entries().filter(a=>a.x()===e&&a.y()===r);return o||new Ex(e,r,this.#i)}getByTile(e){let[r]=this.filter(o=>o.tile()===e);return r??null}height(){return this.#i.height()}includes(e){return e instanceof ue?!!this.getByTile(e):this.#r.includes(e)}map(e){return this.#r.map(e)}player(){return this.#e}register(...e){e.forEach(r=>{this.includes(r)||(this.#r.push(new Hl(r,this.#e)),this.#t.process(Fc,r,this.player()))})}tiles(){return this.entries()}width(){return this.#i.width()}};t(Nc,"PlayerWorld");Kl=Nc});var Qa,Ox=n(()=>{ka();Qa=class extends Dr{};t(Qa,"Revolution")});var Pg=n(()=>{Ox()});var Vi,Yx=n(()=>{$e();Vi=class extends L{};t(Vi,"Attack")});var mi,Sx=n(()=>{$e();mi=class extends L{};t(mi,"Defence")});var $i,Fx,Bg=n(()=>{$e();$i=class extends L{};t($i,"Movement");Fx=$i});var $l,Nx=n(()=>{Bg();$l=class extends Fx{};t($l,"Moves")});var Xa,zx=n(()=>{$e();Xa=class extends L{};t(Xa,"Visibility")});var Jl=n(()=>{Yx();Sx();Bg();Nx();zx()});var Rt,Ag,pi,Bn,Zl,Ug=n(()=>{B();I();M();Rt=class extends x{};t(Rt,"Action");Ag=Rt,pi=new l(i=>i.moves().value()>=.1),Bn=new l((i,e,r=i.tile())=>r===e),Zl=new l((i,e,r=i.tile())=>e.isNeighbourOf(r))});var Hc,Ql,Mg=n(()=>{M();Hc=class extends x{};t(Hc,"Activate");Ql=Hc});var Kc,Qn,qc=n(()=>{M();Kc=class extends x{};t(Kc,"Created");Qn=Kc});var Vc,Xn,$c=n(()=>{M();Vc=class extends x{};t(Vc,"Destroyed");Xn=Vc});var Jc,Zc,Eg=n(()=>{M();Jc=class extends x{};t(Jc,"Visibility");Zc=Jc});var es,qs,cp,Lx,Xl=n(()=>{Jl();B();I();M();es=class extends x{};t(es,"BaseYield");qs=class extends x{};t(qs,"Yield");cp=qs,Lx=t((i,e=1,r=1,o=1,a=1)=>[...[[Vi,e],[mi,r],[$i,o],[Xa,a]].flatMap(([s,p])=>[new qs(new l(u=>u instanceof i),new l((u,y)=>y instanceof s),new m((u,y)=>y.set(p))),new es(new l(u=>u===i),new l((u,y)=>y instanceof s),new m((u,y)=>y.set(p)))])],"unitYield")});var Qc,we,ea=n(()=>{Jl();Lu();P();Ug();Mg();qc();$c();Eg();Xl();Qc=class extends ja{#e=!0;#t=null;#r;#i=!1;#o=new $l;#a;#n;#l=null;#s;#m=!1;constructor(e,r,o,a=d){super(),this.#r=e,this.#a=r,this.#s=o,this.#n=a,this.addKey("actions","actionsForNeighbours","active","attack","busy","city","defence","movement","moves","player","status","tile","visibility","waiting"),this.#n.process(Qn,this)}action(e,...r){return e.perform(...r)}actions(e=this.#s,r=this.#s){return typeof e=="string"&&(e=r.getNeighbour(e)),this.#n.process(Ag,this,e,r)}actionsForNeighbours(e=this.#s){return e.getNeighbouringDirections().reduce((r,o)=>({...r,[o]:this.#n.process(Ag,this,e.getNeighbour(o),e)}),{})}activate(){this.#n.process(Ql,this)}active(){return this.#e}setActive(e=!0){this.#e=e}applyVisibility(){this.#s.getSurroundingArea(this.visibility().value()).forEach(e=>{this.#n.process(Zc,e,this.#a)})}attack(){let[e]=this.yield(new Vi);return e}busy(){return this.#t}setBusy(e=null){this.#t=e}city(){return this.#r}static build(e,r=d){return new this(e,e.player(),e.tile(),r)}defence(){let[e]=this.yield(new mi);return e}destroy(e=null){this.#n.process(Xn,this,e)}destroyed(){return this.#i}setDestroyed(){this.#i=!0}movement(){let[e]=this.yield(new $i);return e}moves(){return this.#o}player(){return this.#a}status(){return this.#l}setStatus(e){this.#l=e}tile(){return this.#s}setTile(e){this.#s=e}visibility(){let[e]=this.yield(new Xa);return e}waiting(){return this.#m}setWaiting(e=!0){this.#m=e}yield(...e){let r=this.#n.get(cp);return e.forEach(o=>r.filter(a=>a.validate(this,o)).forEach(a=>a.process(this,o))),e}};t(Qc,"Unit");we=Qc});var Xc,ce,ir=n(()=>{Ce();vc();Xc=class extends O{constructor(){super(_s)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of CityGrowths returned.");return r[0]}};t(Xc,"CityGrowthRegistry");ce=new Xc});var ge,xe,Pe=n(()=>{Ae();ge=class extends Y{};t(ge,"Wonder");xe=ge});var em,ui,ts=n(()=>{Ce();_o();em=class extends O{constructor(){super(H)}};t(em,"PlayerRegistry");ui=new em});var iy,ta,bp=n(()=>{ts();iy=class extends em{};t(iy,"CurrentPlayerRegistry");ta=new iy});var oy,ny,Og=n(()=>{oy=class{#e={};on(e,r){e in this.#e||(this.#e[e]=[]),this.#e[e].push(r)}once(e,r){let o=t((...a)=>{r(...a),this.off(e,o)},"onceHandler");this.on(e,o)}off(e,r){if(!(e in this.#e))return;let o=this.#e[e].indexOf(r);o!==-1&&this.#e[e].splice(o,1)}emit(e,...r){e in this.#e&&this.#e[e].forEach(o=>o(...r))}};t(oy,"EventEmitter");ny=oy});var ay,w,V=n(()=>{Og();ay=class extends ny{#e={};#t=!1;debug(e){if(!!this.option("debug"))return e()}emit(e,...r){return this.debug(()=>console.log(`Engine#emit: ${String(e)}: ${r}`)),super.emit(e,...r)}loadPlugins(){return this.emit("plugins:load:start"),new Promise((e,r)=>{this.once("plugins:load:end",()=>e())})}option(e,r=null){return this.#e[e]||r}setOption(e,r){this.#e[e]!==r&&(this.#e[e]=r,this.emit("option:changed",e,r))}start(){this.#t||(this.#t=!0,this.emit("engine:initialise"),this.loadPlugins().then(()=>{this.emit("engine:start")}))}};t(ay,"Engine");w=new ay});var sy,ie,Ji=n(()=>{Ce();zc();sy=class extends O{constructor(){super(Kl)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError(`Wrong number of player worlds exist for player: ${e.id()}`);return r[0]}};t(sy,"PlayerWorldRegistry");ie=new sy});var ly,Ue,ci=n(()=>{Z();ly=class extends S{#e=0;constructor(){super(),this.addKey("value")}increment(){return this.#e++,this.#e}value(){return this.#e}};t(ly,"Turn");Ue=new ly});var my,N,Ke=n(()=>{Ce();ea();my=class extends O{constructor(){super(we)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.getBy("player",e)}getByTile(e){return this.getBy("tile",e)}};t(my,"UnitRegistry");N=new my});var py,rs,Yg=n(()=>{M();py=class extends x{};t(py,"Year");rs=py});var $,Ho,Vs=n(()=>{$e();$=class extends L{};t($,"Food");Ho=$});var K,ra,tm=n(()=>{$e();K=class extends L{};t(K,"Production");ra=K});var se,ia,oa=n(()=>{$e();se=class extends L{};t(se,"Trade");ia=se});var is=n(()=>{Vs();tm();oa()});var na,qe,Zi=n(()=>{na=t((i,...e)=>i.reduce((r,o)=>{let a=e.findIndex(s=>o instanceof s);return a===-1||(r[a]+=o.value()),r},e.map(()=>0)),"reduceYields"),qe=t((i,e)=>na(i,e).shift()??0,"reduceYield")});var vY,bY,Hx,Kx,os,rm=n(()=>{ir();is();Ji();Zi();vY=t((i,e=[[$,8],[K,3*(qe(i.tilesWorked().yields(i.player()),K)===0?3:1)],[se,1*(qe(i.tilesWorked().yields(i.player()),se)===0?3:1)]])=>i.tiles().entries().sort((r,o)=>o.score(i.player(),e)-r.score(i.player(),e)),"getHighestValueCityTiles"),bY=t((i,e=ie)=>vY(i).filter(r=>e.getByPlayer(i.player()).includes(r)&&!i.tilesWorked().includes(r)&&i.tile()!==r),"getHighestValueAvailableCityTiles"),Hx=t((i,e=ie,r=ce)=>{i.tilesWorked().unregister(...i.tilesWorked().entries()),i.tilesWorked().register(i.tile()),Kx(i,e,r)},"reassignWorkers"),Kx=t((i,e=ie,r=ce)=>{let o=r.getByCity(i);bY(i,e).some(a=>i.tilesWorked().length>=o.size()+1?!0:(i.tilesWorked().register(a),!1))},"assignWorkers"),os=Kx});var Un,as,ss=n(()=>{P();Z();Un=class extends S{#e;#t;#r;#i;constructor(e,r,o,a=d){super(),this.#e=e,this.#t=a,this.#r=r,this.#i=o,this.addKey("from","to")}forUnit(e){return new this.constructor(this.#e,this.#r,e,this.#t)}from(){return this.#e}perform(...e){}ruleRegistry(){return this.#t}to(){return this.#r}unit(){return this.#i}};t(Un,"Action");as=Un});var fy,Ko,Tp=n(()=>{M();fy=class extends x{};t(fy,"Defeated");Ko=fy});var ls,Jx=n(()=>{P();Ke();ss();Tp();ls=class extends as{#e;#t;constructor(e,r,o,a=d,s=N,p=()=>Math.random()){super(e,r,o,a),this.#t=s,this.#e=p}perform(){let[e]=this.#t.getByTile(this.to()).sort((o,a)=>a.defence().value()-o.defence().value()),r=Math.min(1,this.unit().moves().value());if(this.unit().attack().value()*r*this.#e()>=e.defence().value()*this.#e()){this.ruleRegistry().process(Ko,e,this.unit(),this),this.unit().moves().subtract(r,this.constructor.name);return}this.ruleRegistry().process(Ko,this.unit(),e,this)}};t(ls,"Attack")});var dy,Zx,Qx=n(()=>{dr();dy=class extends Te{};t(dy,"BuildingIrrigation");Zx=dy});var gy,q,Ut=n(()=>{M();gy=class extends x{};t(gy,"Moved");q=gy});var hy,Je,Qi=n(()=>{ss();P();ci();dr();B();I();Ut();hy=class extends Un{#e;constructor(e,r,o,a=d,s=Ue){super(e,r,o,a),this.#e=s}perform(e,r=()=>{},o=Te){let a=this.#e.value()+e;this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new o(new l(()=>this.#e.value()===a),new m((...s)=>{let p=this.unit();p.setActive(),p.setBusy(),r(...s),this.ruleRegistry().process(q,this.unit(),this)})))}};t(hy,"DelayedAction");Je=hy});var Ry,aa,xy=n(()=>{M();Ry=class extends x{};t(Ry,"Built");aa=Ry});var vy,qo,Js=n(()=>{Z();P();xy();vy=class extends S{#e;constructor(e,r=d){super(),this.#e=e,r.process(aa,e,this)}tile(){return this.#e}};t(vy,"TileImprovement");qo=vy});var Be,Xx,zg=n(()=>{Js();Be=class extends qo{};t(Be,"Irrigation");Xx=Be});var by,ve,yi=n(()=>{M();by=class extends x{};t(by,"MovementCost");ve=by});var ms,ev=n(()=>{Qx();Qi();zg();Ut();yi();ms=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Xx(this.unit().tile())},Zx),this.ruleRegistry().process(q,this.unit(),this)}};t(ms,"BuildIrrigation")});var Cy,tv,rv=n(()=>{dr();Cy=class extends Te{};t(Cy,"BuildingMine");tv=Cy});var Ze,iv,Lg=n(()=>{Js();Ze=class extends qo{};t(Ze,"Mine");iv=Ze});var ps,ov=n(()=>{rv();Qi();Lg();Ut();yi();ps=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new iv(this.unit().tile())},tv),this.ruleRegistry().process(q,this.unit(),this)}};t(ps,"BuildMine")});var Ty,nv,av=n(()=>{dr();Ty=class extends Te{};t(Ty,"BuildingRoad");nv=Ty});var Ye,sv,Wg=n(()=>{Js();Ye=class extends qo{};t(Ye,"Road");sv=Ye});var us,lv=n(()=>{av();Qi();Ut();yi();Wg();us=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new sv(this.unit().tile())},nv),this.ruleRegistry().process(q,this.unit(),this)}};t(us,"BuildRoad")});var Iy,mv,pv=n(()=>{dr();Iy=class extends Te{};t(Iy,"BuildingRailroad");mv=Iy});var or,uv,jg=n(()=>{Js();or=class extends qo{};t(or,"Railroad");uv=or});var cs,cv=n(()=>{pv();Qi();Ut();yi();jg();cs=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new uv(this.unit().tile())},mv),this.ruleRegistry().process(q,this.unit(),this)}};t(cs,"BuildRailroad")});var wy,Ip,_g=n(()=>{M();wy=class extends x{};t(wy,"ValidateMove");Ip=wy});var Yt,im,wp=n(()=>{ss();Ut();yi();_g();Yt=class extends Un{perform(){return this.validate()?(this.unit().setTile(this.to()),this.ruleRegistry().process(q,this.unit(),this),!0):!1}movementCost(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>r-o);return e}validate(){let[e]=this.ruleRegistry().process(Ip,this.unit(),this.movementCost());return e}};t(Yt,"Move");im=Yt});var om,yv=n(()=>{P();wp();om=class extends im{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.#e.capture(this.unit().player()),!0):!1}};t(om,"CaptureCity")});var Py,Ne,fi=n(()=>{Z();Py=class extends Fe{#e;constructor(e){super(),this.#e=e}clone(e=this.terrain()){return new this.constructor(e)}terrain(){return this.#e}};t(Py,"TerrainFeature");Ne=Py});var Hg,By,lt,Vo=n(()=>{Ce();fi();Hg=new Map,By=class extends O{constructor(){super(Ne)}getByTerrain(e){return Hg.has(e)||Hg.set(e,this.getBy("terrain",e)),Hg.get(e)}};t(By,"TerrainFeatureRegistry");lt=new By});var Ay,fv,dv=n(()=>{dr();Ay=class extends Te{};t(Ay,"ClearingForest");fv=Ay});var me,Uy,My=n(()=>{Zt();me=class extends W{};t(me,"Plains");Uy=me});var ys,gv=n(()=>{P();Vo();ci();dv();Qi();Ut();yi();My();ys=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Ue){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new Uy,o=this.#e.getByTerrain(this.from().terrain());this.#e.register(...o.map(a=>a.clone(r))),this.#e.unregister(...o),this.from().setTerrain(r)},fv),this.ruleRegistry().process(q,this.unit(),this)}};t(ys,"ClearForest")});var Ey,hv,Rv=n(()=>{dr();Ey=class extends Te{};t(Ey,"ClearingJungle");hv=Ey});var Pp,fs,xv,nm=n(()=>{Vo();B();I();M();Pp=class extends x{};t(Pp,"Feature");fs=Pp,xv=t((i,e,r=.2,o=lt,a=()=>Math.random())=>[new Pp(new l(s=>s===e),new l((s,p)=>p instanceof i),new l(()=>a()<=r),new m((s,p)=>o.register(new s(p))))],"feature")});var be,am,Bp=n(()=>{Zt();be=class extends W{};t(be,"Grassland");am=be});var $o,Gy,ky=n(()=>{fi();$o=class extends Ne{};t($o,"Shield");Gy=$o});var ds,vv=n(()=>{P();Vo();ci();Rv();Qi();nm();Bp();Ut();yi();ky();ds=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Ue){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new am,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(fs,Gy,r),this.#e.unregister(...o),this.from().setTerrain(r)},hv),this.ruleRegistry().process(q,this.unit(),this)}};t(ds,"ClearJungle")});var Dy,bv,Cv=n(()=>{dr();Dy=class extends Te{};t(Dy,"ClearingSwamp");bv=Dy});var gs,Tv=n(()=>{P();Vo();ci();Cv();Qi();nm();Bp();Ut();yi();ky();gs=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Ue){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new am,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(fs,Gy,r),this.#e.unregister(...o),this.from().setTerrain(r)},bv),this.ruleRegistry().process(q,this.unit(),this)}};t(gs,"ClearSwamp")});var sm,Iv=n(()=>{ss();sm=class extends as{perform(){this.unit().destroy()}};t(sm,"Disband")});var hs,wv=n(()=>{P();wp();hs=class extends im{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.unit().moves().set(0),this.#e.unload(this.unit()),!0):!1}};t(hs,"Disembark")});var lm,Pv=n(()=>{P();dr();B();wp();Ut();lm=class extends im{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.#e.stow(this.unit()),this.unit().setBusy(new Te(new l(()=>!1))),this.unit().setActive(!1),this.ruleRegistry().process(q,this.unit(),this),!0):!1}};t(lm,"Embark")});var Oy,mm,Yy=n(()=>{Z();Oy=class extends Fe{#e;constructor(e){super(),this.#e=e}unit(){return this.#e}};t(Oy,"UnitImprovement");mm=Oy});var Sy,nr,sa=n(()=>{Ce();Yy();Sy=class extends O{constructor(){super(mm)}getByUnit(e){return this.getBy("unit",e)}};t(Sy,"UnitImprovementRegistry");nr=new Sy});var Fy,Bv,Av=n(()=>{dr();Fy=class extends Te{};t(Fy,"Fortified");Bv=Fy});var di,Uv,Kg=n(()=>{Yy();di=class extends mm{};t(di,"Fortified");Uv=di});var Ny,Mv,Ev=n(()=>{dr();Ny=class extends Te{};t(Ny,"Fortifying");Mv=Ny});var Rs,Gv=n(()=>{P();ci();sa();Av();B();Qi();Kg();Ev();Ut();yi();Rs=class extends Je{#e;constructor(e,r,o,a=d,s=Ue,p=nr){super(e,r,o,a,s),this.#e=p}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{this.unit().moves().set(0),this.unit().setActive(!1),this.unit().setBusy(new Bv(new l(()=>!1))),this.#e.register(new Uv(this.unit()))},Mv),this.ruleRegistry().process(q,this.unit(),this)}};t(Rs,"Fortify")});var pm,kv=n(()=>{gt();P();ss();Vn();Ut();pm=class extends as{#e;constructor(e,r,o,a=J,s=d){super(e,r,o,s),this.#e=a}perform(){new et(this.unit().player(),this.unit().tile(),this.#e.takeCapitalByCivilization(this.unit().player().civilization().constructor),this.ruleRegistry()),this.unit().destroy(),this.ruleRegistry().process(q,this.unit(),this)}};t(pm,"FoundCity")});var Xi,Dv=n(()=>{ss();Xi=class extends Un{perform(){this.unit().moves().subtract(this.unit().moves())}};t(Xi,"NoOrders")});var zy,ze,gi=n(()=>{Ce();Js();zy=class extends O{constructor(){super(qo)}getByTile(e){return this.getBy("tile",e)}};t(zy,"TileImprovementRegistry");ze=new zy});var xs,Ov=n(()=>{P();gi();ci();Qi();Ut();yi();xs=class extends Je{#e;constructor(e,r,o,a=d,s=ze,p=Ue){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let[r]=this.#e.getByTile(this.from());this.#e.unregister(r)}),this.ruleRegistry().process(q,this.unit(),this)}};t(xs,"Pillage")});var Ve,Yv,qg=n(()=>{Zt();Ve=class extends W{};t(Ve,"Forest");Yv=Ve});var eo,Sv,Vg=n(()=>{fi();eo=class extends Ne{};t(eo,"Horse");Sv=eo});var Ly,Fv,Nv=n(()=>{dr();Ly=class extends Te{};t(Ly,"PlantingForest");Fv=Ly});var vs,zv=n(()=>{P();Vo();ci();Qi();nm();qg();Vg();Ut();yi();Nv();vs=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Ue){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new Yv,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(fs,Sv,r),this.#e.unregister(...o),this.from().setTerrain(r)},Fv),this.ruleRegistry().process(q,this.unit(),this)}};t(vs,"PlantForest")});var Wy,Lv,Wv=n(()=>{dr();Wy=class extends Te{};t(Wy,"Sleeping");Lv=Wy});var la,jv,$g=n(()=>{P();ci();Ke();B();Qi();I();Wv();la=class extends Je{#e;constructor(e,r,o,a=d,s=Ue,p=N){super(e,r,o,a,s),this.#e=p}perform(){this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new Lv(new l(()=>this.from().getSurroundingArea(this.unit().visibility().value()).some(e=>this.#e.getByTile(e).some(r=>r.player()!==this.unit().player()))),new m(()=>{this.unit().setActive(),this.unit().setBusy()})))}};t(la,"Sleep");jv=la});var um,_v=n(()=>{ss();um=class extends as{perform(){this.unit().setWaiting(),this.unit().cargo().forEach(e=>{e.moves().set(e.movement()),e.activate()})}};t(um,"Unload")});var cm=n(()=>{Jx();ev();ov();lv();cv();yv();gv();vv();Tv();Iv();wv();Pv();Gv();kv();wp();Dv();Ov();zv();$g();_v()});var St,Hv=n(()=>{Zt();St=class extends W{};t(St,"Arctic")});var Ie,Kv=n(()=>{Zt();Ie=class extends W{};t(Ie,"Desert")});var Me,qv=n(()=>{Zt();Me=class extends W{};t(Me,"Hills")});var rt,Vv=n(()=>{Zt();rt=class extends W{};t(rt,"Jungle")});var Le,$v=n(()=>{Zt();Le=class extends W{};t(Le,"Mountains")});var mt,Jv=n(()=>{og();mt=class extends Jt{};t(mt,"Ocean")});var oe,Zv,Jg=n(()=>{Zt();oe=class extends W{};t(oe,"River");Zv=oe});var it,Qv=n(()=>{Zt();it=class extends W{};t(it,"Swamp")});var xt,Xv=n(()=>{Zt();xt=class extends W{};t(xt,"Tundra")});var Jo=n(()=>{Hv();Kv();qg();Bp();qv();Vv();$v();Jv();My();Jg();Qv();Xv()});var Ft,bs,ym=n(()=>{ea();Ft=class extends we{};t(Ft,"Air");bs=Ft});var ot,jy,_y=n(()=>{ea();ot=class extends we{};t(ot,"Land");jy=ot});var F,Nt=n(()=>{_y();F=class extends jy{};t(F,"Fortifiable")});var We,Mn,Zs=n(()=>{ea();We=class extends we{};t(We,"Naval");Mn=We});var Hy,Ky,Zg=n(()=>{Hy=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}transport(){return this.#e}unit(){return this.#t}};t(Hy,"TransportManifest");Ky=Hy});var qy,En,fm=n(()=>{Ce();Zg();qy=class extends O{constructor(){super(Ky)}getByTransport(e){return this.getBy("transport",e)}getByUnit(e){let r=this.getBy("unit",e);if(r.length!==1)throw new TypeError("Wrong number of results.");return r[0]}};t(qy,"TransportRegistry");En=new qy});var Vy,$y,Qg=n(()=>{M();Vy=class extends x{};t(Vy,"Stowed");$y=Vy});var Jy,eb,tb=n(()=>{M();Jy=class extends x{};t(Jy,"Unloaded");eb=Jy});var CY,rb,ib=n(()=>{P();fm();Qg();Zg();tb();CY=t(i=>t(class extends i{#e=d;#t=En;canStow(r){return!this.cargo().includes(r)&&this.hasCapacity()}capacity(){return 0}cargo(){return this.#t.getByTransport(this).map(r=>r.unit())}hasCapacity(){return this.#t.getByTransport(this).length<this.capacity()}hasCargo(){return this.#t.getByTransport(this).length>0}setRuleRegistry(r){this.#e=r}setTransportRegistry(r){this.#t=r}stow(r){return!this.hasCapacity()||!this.canStow(r)?!1:(this.#t.register(new Ky(this,r)),this.#e.process($y,r,this),!0)}unload(r){try{let o=this.#t.getByUnit(r);return this.#t.unregister(o),this.#e.process(eb,r,this),!0}catch{return!1}}},"Transport"),"Transport"),rb=CY});var zt,Gn,Qs=n(()=>{P();fm();Zs();ib();zt=class extends rb(Mn){constructor(e,r,o,a=d,s=En){super(e,r,o,a),this.setRuleRegistry(a),this.setTransportRegistry(s)}};t(zt,"NavalTransport");Gn=zt});var gr,Xg=n(()=>{_y();gr=class extends jy{};t(gr,"Worker")});var kn=n(()=>{ym();Nt();_y();Zs();Qs();Xg()});var Zo,ob=n(()=>{fi();Zo=class extends Ne{};t(Zo,"Coal")});var Qo,nb=n(()=>{fi();Qo=class extends Ne{};t(Qo,"Fish")});var hi,ab=n(()=>{fi();hi=class extends Ne{};t(hi,"Game")});var Xo,sb=n(()=>{fi();Xo=class extends Ne{};t(Xo,"Gems")});var en,lb=n(()=>{fi();en=class extends Ne{};t(en,"Gold")});var Ri,mb=n(()=>{fi();Ri=class extends Ne{};t(Ri,"Oasis")});var tn,pb=n(()=>{fi();tn=class extends Ne{};t(tn,"Oil")});var rn,ub=n(()=>{fi();rn=class extends Ne{};t(rn,"Seal")});var Ap=n(()=>{ob();nb();ab();sb();lb();Vg();mb();pb();ub();ky()});var Zy,Xs,eh=n(()=>{M();Zy=class extends x{};t(Zy,"Action");Xs=Zy});var Qy,Xy,th=n(()=>{M();Qy=class extends x{};t(Qy,"ActionPerformed");Xy=Qy});var ef,dm,rh=n(()=>{M();ef=class extends x{};t(ef,"Discovered");dm=ef});var tf,rf,ih=n(()=>{Z();P();eh();th();rh();tf=class extends S{#e;#t;constructor(e,r=d){super(),this.#e=r,this.#t=e,this.addKey("tile")}action(e){e.perform(),this.#e.process(Xy,this,e)}actions(e){return this.#e.process(Xs,this,e)}process(e){this.#e.process(dm,this,e)}tile(){return this.#t}};t(tf,"GoodyHut");rf=tf});var of,Yr,Cs=n(()=>{ih();Ce();of=class extends O{constructor(){super(rf)}getByTile(e){let r=this.filter(o=>o.tile()===e);return r.length===0?null:r[0]}};t(of,"GoodyHutRegistry");Yr=new of});var cb=n(()=>{Js()});var Dn=n(()=>{zg();Lg();cb();Wg();jg()});var nf,yb,fb=n(()=>{nf=class{#e;#t;#r;constructor(e,r,o){this.#e=o,this.#t=r,this.#r=e}end(){return this.#e}generate(){throw new Error(`PathFinder#generate: Must be overridden in '${this.constructor.name}'.`)}start(){return this.#t}unit(){return this.#r}};t(nf,"PathFinder");yb=nf});var af,sf,oh=n(()=>{Ki();fb();af=class extends De{constructor(){super(yb)}};t(af,"PathFinderRegistry");sf=new af});var lf,Sr,Ts=n(()=>{Z();lf=class extends Fe{};t(lf,"Government");Sr=lf});var mf,gm,pf=n(()=>{Ki();Ts();mf=class extends De{constructor(){super(Sr)}};t(mf,"AvailableGovernmentRegistry");gm=new mf});var uf,Up,nh=n(()=>{M();uf=class extends x{};t(uf,"Availability");Up=uf});var cf,Mp,ah=n(()=>{M();cf=class extends x{};t(cf,"Changed");Mp=cf});var yf,ff,sh=n(()=>{pf();Z();P();nh();ah();yf=class extends S{#e;#t=null;#r;#i;constructor(e,r=gm,o=d){super(),this.#r=e,this.#e=r,this.#i=o,this.addKey("available","current")}available(){return this.#e.filter(e=>this.#i.get(Up).some(r=>r.validate(e,this.#r)))}current(){return this.#t}is(...e){return e.some(r=>this.#t instanceof r)}player(){return this.#r}set(e){this.#t=e,this.#i.process(Mp,this.#r,e)}};t(yf,"PlayerGovernment");ff=yf});var df,pt,on=n(()=>{Ce();sh();df=class extends O{constructor(){super(ff)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerGovernments for player.");return r[0]}};t(df,"PlayerGovernmentRegistry");pt=new df});var gf,hf,lh=n(()=>{nc();jl();gf=class extends qa{#e;#t;constructor(e,r=In,o=()=>Math.random()){super(e),this.#e=r,this.#t=o}chooseCivilization(e){let r=e[Math.floor(e.length*this.#t())],o=this.player(),a=new r;o.setCivilization(a),this.chooseLeader(a)}chooseLeader(e){let r=this.#e.getByCivilization(e.constructor),o=r[Math.floor(this.#t()*r.length)];e.setLeader(new o)}};t(gf,"AIClient");hf=gf});var db=n(()=>{Kg()});var ma,gb=n(()=>{Yy();ma=class extends mm{};t(ma,"Veteran")});var hb=n(()=>{gb()});var Ep=n(()=>{db();hb()});var xi,Rb,mh=n(()=>{E();xi=class extends v{};t(xi,"AdvancedFlight");Rb=xi});var to,xb,ph=n(()=>{E();to=class extends v{};t(to,"Alphabet");xb=to});var vi,vb,uh=n(()=>{E();vi=class extends v{};t(vi,"Astronomy");vb=vi});var On,bb,ch=n(()=>{E();On=class extends v{};t(On,"AtomicTheory");bb=On});var ut,Cb,yh=n(()=>{E();ut=class extends v{};t(ut,"Automobile");Cb=ut});var bi,Tb,fh=n(()=>{E();bi=class extends v{};t(bi,"Banking");Tb=bi});var ro,Ib,dh=n(()=>{E();ro=class extends v{};t(ro,"BridgeBuilding");Ib=ro});var Fr,wb,gh=n(()=>{E();Fr=class extends v{};t(Fr,"BronzeWorking");wb=Fr});var Ci,Pb,hh=n(()=>{E();Ci=class extends v{};t(Ci,"CeremonialBurial");Pb=Ci});var nn,Bb,Rh=n(()=>{E();nn=class extends v{};t(nn,"Chemistry");Bb=nn});var io,Ab,xh=n(()=>{E();io=class extends v{};t(io,"Chivalry");Ab=io});var hr,Ub,vh=n(()=>{E();hr=class extends v{};t(hr,"CodeOfLaws");Ub=hr});var Nr,Mb,bh=n(()=>{E();Nr=class extends v{};t(Nr,"Combustion");Mb=Nr});var vt,Eb,Ch=n(()=>{E();vt=class extends v{};t(vt,"Communism");Eb=vt});var Ti,Gb,Th=n(()=>{E();Ti=class extends v{};t(Ti,"Computers");Gb=Ti});var zr,kb,Ih=n(()=>{E();zr=class extends v{};t(zr,"Conscription");kb=zr});var Lr,Db,wh=n(()=>{E();Lr=class extends v{};t(Lr,"Construction");Db=Lr});var oo,Ob,Ph=n(()=>{E();oo=class extends v{};t(oo,"Corporation");Ob=oo});var Ii,Yb,Bh=n(()=>{E();Ii=class extends v{};t(Ii,"Currency");Yb=Ii});var no,Sb,Ah=n(()=>{E();no=class extends v{};t(no,"Democracy");Sb=no});var Rr,Fb,Uh=n(()=>{E();Rr=class extends v{};t(Rr,"Electricity");Fb=Rr});var ct,Nb,Mh=n(()=>{E();ct=class extends v{};t(ct,"Electronics");Nb=ct});var an,zb,Eh=n(()=>{E();an=class extends v{};t(an,"Engineering");zb=an});var sn,Lb,Gh=n(()=>{E();sn=class extends v{};t(sn,"Explosives");Lb=sn});var Yn,Wb,kh=n(()=>{E();Yn=class extends v{};t(Yn,"Feudalism");Wb=Yn});var ao,jb,Dh=n(()=>{E();ao=class extends v{};t(ao,"Flight");jb=ao});var pa,_b,Oh=n(()=>{E();pa=class extends v{};t(pa,"FusionPower");_b=pa});var ln,Hb,Yh=n(()=>{E();ln=class extends v{};t(ln,"GeneticEngineering");Hb=ln});var yt,Kb,Sh=n(()=>{E();yt=class extends v{};t(yt,"Gunpowder");Kb=yt});var mn,qb,Fh=n(()=>{E();mn=class extends v{};t(mn,"HorsebackRiding");qb=mn});var bt,Vb,Nh=n(()=>{E();bt=class extends v{};t(bt,"Industrialization");Vb=bt});var xr,$b,zh=n(()=>{E();xr=class extends v{};t(xr,"Invention");$b=xr});var wi,Jb,Lh=n(()=>{E();wi=class extends v{};t(wi,"IronWorking");Jb=wi});var pn,Zb,Wh=n(()=>{E();pn=class extends v{};t(pn,"LaborUnion");Zb=pn});var vr,Qb,jh=n(()=>{E();vr=class extends v{};t(vr,"Literacy");Qb=vr});var Lt,Xb,_h=n(()=>{E();Lt=class extends v{};t(Lt,"Magnetism");Xb=Lt});var Wr,eC,Hh=n(()=>{E();Wr=class extends v{};t(Wr,"MapMaking");eC=Wr});var Wt,tC,Kh=n(()=>{E();Wt=class extends v{};t(Wt,"Masonry");tC=Wt});var jt,rC,qh=n(()=>{E();jt=class extends v{};t(jt,"MassProduction");rC=jt});var br,iC,Vh=n(()=>{E();br=class extends v{};t(br,"Mathematics");iC=br});var Pi,oC,$h=n(()=>{E();Pi=class extends v{};t(Pi,"Medicine");oC=Pi});var jr,nC,Jh=n(()=>{E();jr=class extends v{};t(jr,"Metallurgy");nC=jr});var _r,aC,Zh=n(()=>{E();_r=class extends v{};t(_r,"Monarchy");aC=_r});var _t,sC,Qh=n(()=>{E();_t=class extends v{};t(_t,"Mysticism");sC=_t});var ar,lC,Xh=n(()=>{E();ar=class extends v{};t(ar,"Navigation");lC=ar});var Hr,mC,eR=n(()=>{E();Hr=class extends v{};t(Hr,"NuclearFission");mC=Hr});var so,pC,tR=n(()=>{E();so=class extends v{};t(so,"NuclearPower");pC=so});var Kr,uC,rR=n(()=>{E();Kr=class extends v{};t(Kr,"Philosophy");uC=Kr});var Bi,cC,iR=n(()=>{E();Bi=class extends v{};t(Bi,"Physics");cC=Bi});var un,yC,oR=n(()=>{E();un=class extends v{};t(un,"Plastics");yC=un});var cn,fC,nR=n(()=>{E();cn=class extends v{};t(cn,"Pottery");fC=cn});var qr,dC,aR=n(()=>{E();qr=class extends v{};t(qr,"Railroad");dC=qr});var yn,gC,sR=n(()=>{E();yn=class extends v{};t(yn,"Recycling");gC=yn});var Ai,hC,lR=n(()=>{E();Ai=class extends v{};t(Ai,"Refining");hC=Ai});var Ct,RC,mR=n(()=>{E();Ct=class extends v{};t(Ct,"Religion");RC=Ct});var Vr,xC,pR=n(()=>{E();Vr=class extends v{};t(Vr,"Robotics");xC=Vr});var lo,vC,uR=n(()=>{E();lo=class extends v{};t(lo,"Rocketry");vC=lo});var mo,bC,cR=n(()=>{E();mo=class extends v{};t(mo,"SpaceFlight");bC=mo});var po,CC,yR=n(()=>{E();po=class extends v{};t(po,"SteamEngine");CC=po});var uo,TC,fR=n(()=>{E();uo=class extends v{};t(uo,"Steel");TC=uo});var co,IC,dR=n(()=>{E();co=class extends v{};t(co,"Superconductor");IC=co});var Ui,wC,gR=n(()=>{E();Ui=class extends v{};t(Ui,"TheRepublic");wC=Ui});var fn,PC,hR=n(()=>{E();fn=class extends v{};t(fn,"TheWheel");PC=fn});var yo,BC,RR=n(()=>{E();yo=class extends v{};t(yo,"TheoryOfGravity");BC=yo});var Mi,AC,xR=n(()=>{E();Mi=class extends v{};t(Mi,"Trade");AC=Mi});var sr,UC,vR=n(()=>{E();sr=class extends v{};t(sr,"University");UC=sr});var Cr,MC,bR=n(()=>{E();Cr=class extends v{};t(Cr,"Writing");MC=Cr});var lr=n(()=>{mh();ph();uh();ch();yh();fh();dh();gh();hh();Rh();xh();vh();bh();Ch();Th();Ih();wh();Ph();Bh();Ah();Uh();Mh();Eh();Gh();kh();Dh();Oh();Yh();Sh();Fh();Nh();zh();Lh();Wh();jh();_h();Hh();Kh();qh();Vh();$h();Jh();Zh();Qh();Xh();eR();tR();rR();iR();oR();nR();aR();sR();lR();mR();pR();uR();cR();yR();fR();dR();gR();hR();RR();xR();vR();bR()});var Ei,EC=n(()=>{Ts();Ei=class extends Sr{};t(Ei,"Anarchy")});var Tt,GC=n(()=>{Ts();Tt=class extends Sr{};t(Tt,"Communism")});var nt,kC=n(()=>{Ts();nt=class extends Sr{};t(nt,"Democracy")});var Ht,DC=n(()=>{Ts();Ht=class extends Sr{};t(Ht,"Despotism")});var at,OC=n(()=>{Ts();at=class extends Sr{};t(at,"Monarchy")});var ft,YC=n(()=>{Ts();ft=class extends Sr{};t(ft,"Republic")});var dn=n(()=>{EC();GC();kC();DC();OC();YC()});var $r,SC=n(()=>{Ae();$r=class extends Y{};t($r,"Aqueduct")});var mr,FC=n(()=>{Ae();mr=class extends Y{};t(mr,"Bank")});var Jr,NC=n(()=>{Ae();Jr=class extends Y{};t(Jr,"Barracks")});var pr,zC=n(()=>{Ae();pr=class extends Y{};t(pr,"Cathedral")});var fo,LC=n(()=>{Ae();fo=class extends Y{};t(fo,"CityWalls")});var Zr,WC=n(()=>{Ae();Zr=class extends Y{};t(Zr,"Colosseum")});var Tr,jC=n(()=>{Ae();Tr=class extends Y{};t(Tr,"Courthouse")});var Kt,_C=n(()=>{Ae();Kt=class extends Y{};t(Kt,"Factory")});var Qr,HC=n(()=>{Ae();Qr=class extends Y{};t(Qr,"Granary")});var It,KC=n(()=>{Ae();It=class extends Y{};t(It,"HydroPlant")});var Ir,qC=n(()=>{Ae();Ir=class extends Y{};t(Ir,"Library")});var wr,VC=n(()=>{Ae();wr=class extends Y{};t(wr,"ManufacturingPlant")});var ur,$C=n(()=>{Ae();ur=class extends Y{};t(ur,"Marketplace")});var go,JC=n(()=>{Ae();go=class extends Y{};t(go,"MassTransit")});var wt,ZC=n(()=>{Ae();wt=class extends Y{};t(wt,"NuclearPlant")});var dt,QC,CR=n(()=>{Ae();dt=class extends Y{};t(dt,"Palace");QC=dt});var Pt,XC=n(()=>{Ae();Pt=class extends Y{};t(Pt,"PowerPlant")});var ho,eT=n(()=>{Ae();ho=class extends Y{};t(ho,"RecyclingCenter")});var Ro,tT=n(()=>{Ae();Ro=class extends Y{};t(Ro,"SdiDefence")});var Mt,rT=n(()=>{Ae();Mt=class extends Y{};t(Mt,"Temple")});var Pr,iT=n(()=>{Ae();Pr=class extends Y{};t(Pr,"University")});var Gi=n(()=>{SC();FC();NC();zC();LC();WC();jC();_C();HC();KC();qC();VC();$C();JC();ZC();CR();XC();eT();tT();rT();iT()});var Rf,Is,oT=n(()=>{oh();Yu();Rf=class extends Yl{#e=1/0;end(){return this.entries()[this.length-1]}static for(e,r,o,a=sf){let[s]=a.entries().map(p=>new p(e,r,o)).map(p=>p.generate()).sort((p,u)=>p.movementCost()-u.movementCost());return s&&(s.shift(),s)}movementCost(){return this.#e}setMovementCost(e){this.#e=e}push(...e){e.forEach(r=>{let o=this.end();if(this.length>0&&!r.isNeighbourOf(o))throw new TypeError(`Tile#push: Invalid element passed, ${r.x()},${r.y()} is not a neighbour of ${o.x()},${o.y()}.`);super.push(r)})}start(){return this.entries()[0]}};t(Rf,"Path");Is=Rf});var xo,nT=n(()=>{Nt();xo=class extends F{};t(xo,"Artillery")});var vo,aT=n(()=>{Zs();vo=class extends Mn{};t(vo,"Battleship")});var bo,sT=n(()=>{ym();bo=class extends bs{};t(bo,"Bomber")});var ki,lT=n(()=>{Nt();ki=class extends F{};t(ki,"Cannon")});var Co,mT=n(()=>{Nt();Co=class extends F{};t(Co,"Caravan")});var To,pT=n(()=>{ym();Qs();To=class extends Gn{canStow(e){return e instanceof bs&&super.canStow(e)}capacity(){return 8}};t(To,"Carrier")});var Di,uT=n(()=>{Nt();Di=class extends F{};t(Di,"Catapult")});var Oi,cT=n(()=>{Nt();Oi=class extends F{};t(Oi,"Chariot")});var Io,yT=n(()=>{Zs();Io=class extends Mn{};t(Io,"Cruiser")});var wo,fT=n(()=>{Nt();wo=class extends F{};t(wo,"Diplomat")});var Xr,dT=n(()=>{ym();Xr=class extends bs{};t(Xr,"Fighter")});var Yi,gT=n(()=>{Qs();Yi=class extends Gn{capacity(){return 4}};t(Yi,"Frigate")});var Br,hT=n(()=>{Nt();Br=class extends F{};t(Br,"Horseman")});var Si,RT=n(()=>{Zs();Si=class extends Mn{};t(Si,"Ironclad")});var Fi,xT=n(()=>{Nt();Fi=class extends F{};t(Fi,"Knight")});var Po,vT=n(()=>{Nt();Po=class extends F{};t(Po,"MechanizedInfantry")});var Ni,bT=n(()=>{Nt();Ni=class extends F{};t(Ni,"Musketman")});var Bo,CT=n(()=>{ym();Bo=class extends bs{};t(Bo,"Nuclear")});var Ao,TT=n(()=>{Nt();Ao=class extends F{};t(Ao,"Rifleman")});var zi,IT=n(()=>{Qs();zi=class extends Gn{capacity(){return 3}};t(zi,"Sail")});var je,wT,TR=n(()=>{Xg();je=class extends gr{};t(je,"Settlers");wT=je});var Li,PT=n(()=>{Nt();Li=class extends F{};t(Li,"Spearman")});var Uo,BT=n(()=>{Zs();Uo=class extends Mn{};t(Uo,"Submarine")});var Ar,AT=n(()=>{Nt();Ar=class extends F{};t(Ar,"Swordman")});var Mo,UT=n(()=>{Nt();Mo=class extends F{};t(Mo,"Tank")});var Eo,MT=n(()=>{Qs();Eo=class extends Gn{capacity(){return 8}};t(Eo,"Transport")});var Ur,ET=n(()=>{Qs();Ur=class extends Gn{capacity(){return 2}};t(Ur,"Trireme")});var Go,GT=n(()=>{Nt();Go=class extends F{};t(Go,"Warrior")});var gn=n(()=>{nT();aT();sT();lT();mT();pT();uT();cT();yT();fT();dT();gT();hT();RT();xT();vT();bT();CT();TT();IT();TR();PT();BT();AT();UT();MT();ET();GT()});var xf,vf,Sn,hm=n(()=>{Jl();cm();Jn();ir();tt();Jo();is();kn();Ap();Cs();Dn();jl();oh();on();He();Ls();Ji();P();Vo();gi();sa();Ke();lh();Xl();Ju();Uc();Ep();lr();dn();Gi();oT();Cu();gn();qi();ea();Pe();rm();xf=t((i,e,r=_)=>{let o=r.getByTile(i);return o===null?!1:o.player()===e},"hasPlayerCity"),vf=class extends hf{#e=e=>{let r=this.#B.getByTerrain(e.terrain());return(e.terrain()instanceof be||e.terrain()instanceof oe||e.terrain()instanceof me||r.some(o=>o instanceof Ri)||r.some(o=>o instanceof hi))&&e.getSurroundingArea().score(this.player(),[[$,4],[K,2],[se,1]])>=180&&!e.getSurroundingArea(4).filter(o=>this.#u.getByTile(o)!==null).length};#t=e=>[Ie,me,be,oe].some(r=>e.terrain()instanceof r)&&!this.#R.getByTile(e).some(r=>r instanceof Be)&&e.getSurroundingArea().some(r=>xf(r,this.player(),this.#u))&&[...e.getAdjacent(),e].some(r=>r.terrain()instanceof oe||r.isCoast()||this.#R.getByTile(r).some(o=>o instanceof Be)&&this.#u.getByTile(r)===null);#r=e=>[Me,Le].some(r=>e.terrain()instanceof r)&&!this.#R.getByTile(e).some(r=>r instanceof Ze)&&e.getSurroundingArea().some(r=>xf(r,this.player(),this.#u));#i=e=>!this.#R.getByTile(e).some(r=>r instanceof Ye)&&e.getSurroundingArea().some(r=>xf(r,this.player(),this.#u));#o=new Map;#a=new Map;#n=new Map;#l=[];#s=[];#m=[];#g=[];#y=[];#f=[];#p=[];#u;#b;#x;#C;#d;#T;#I;#w;#h;#P;#B;#R;#v;#c;constructor(e,r=_,o=Xt,a=ce,s=Yr,p=In,u=sf,y=pt,c=z,f=si,g=ie,G=d,k=lt,D=ze,U=nr,j=N){super(e,p),this.#u=r,this.#b=o,this.#x=a,this.#C=s,this.#d=u,this.#T=y,this.#I=c,this.#w=f,this.#h=g,this.#P=G,this.#B=k,this.#v=U,this.#R=D,this.#c=j}scoreUnitMove(e,r){let o=e.actions(r),{attack:a,buildIrrigation:s,buildMine:p,buildRoad:u,captureCity:y,disembark:c,embark:f,fortify:g,foundCity:G,noOrders:k}=o.reduce((ne,_e)=>({...ne,[_e.constructor.name.replace(/^./,oi=>oi.toLowerCase())]:_e}),{});if(!o.length||o.length===1&&k||e instanceof F&&o.length===2&&g&&k)return-1;let D=0;this.#C.getByTile(r)!==null&&(D+=60),(G&&this.#e(r)||p&&this.#r(r)||s&&this.#t(r)||u&&this.#i(r))&&(D+=24);let j=this.#c.getByTile(r).sort((ne,_e)=>_e.defence().value()-ne.defence().value()),[Re]=j,Se=j.some(ne=>ne.player()===this.player());e instanceof zt&&e.hasCapacity()&&j.length&&Se&&(D+=10),e instanceof zt&&e.hasCargo()&&r.isCoast()&&r.isWater()&&(D+=16),f&&(D+=16),c&&(D+=16),y&&(D+=100),a&&e.attack()>Re.defence()&&(D+=24*(e.attack().value()-Re.defence().value())),a&&e.attack().value()>=Re.defence().value()&&(D+=16),a&&e.attack().value()>=Re.defence().value()*(2/3)&&(D+=8);let At=this.#h.getByPlayer(this.player()),Ga=r.getNeighbours().filter(ne=>!At.includes(ne)).length;Ga>0&&(D+=Ga*3);let Pl=this.#n.get(e);return Pl instanceof ue&&r.distanceFrom(Pl)<e.tile().distanceFrom(Pl)&&(D+=14),(this.#o.get(e)||[]).includes(r)||(D*=4),D}moveUnit(e){let r=0;for(;e.active()&&e.moves().value()>=.1;){if(r++>1e3){console.log("SimpleAIClient#moveUnit: loopCheck: aborting"),console.log(`${e.player().civilization().name()} ${e.constructor.name}`),console.log(e.actions()),console.log(e.actionsForNeighbours()),e.action(new Xi(e.tile(),e.tile(),e));return}let o=this.#a.get(e);if(o){let c=o.shift(),[f]=e.actions(c).filter(g=>g instanceof Yt);if(f){e.action(f),o.length===0&&this.#a.delete(e);return}if(o.length>0){let g=Is.for(e,e.tile(),o.end());if(g){this.#a.set(e,g);continue}}this.#a.delete(e)}let[a]=e.tile().getNeighbours().map(c=>[c,this.scoreUnitMove(e,c)]).filter(([,c])=>c>-1).sort(([,c],[,f])=>f-c||Math.floor(Math.random()*3)-1).map(([c])=>c);if(!a){e.action(new Xi(e.tile(),e.tile(),e));return}let s=e.actions(a),[p]=s,u=this.#o.get(e)||[],y=this.#n.get(e);if(!p){e.action(new Xi(e.tile(),e.tile(),e));return}y===a&&this.#n.delete(e),u.push(a),this.#o.set(e,u.slice(-50)),e.action(p)}e.moves().value()>0&&e.action(new Xi(e.tile(),e.tile(),e))}preProcessTurn(){this.#l.splice(0),this.#s.splice(0),this.#m.splice(0),this.#g.splice(0),this.#y.splice(0),this.#f.splice(0),this.#p.splice(0);let e=this.#h.getByPlayer(this.player());e.entries().forEach(r=>{let o=r.tile(),a=this.#u.getByTile(o),s=this.#c.getBy("tile",o),p=this.#p.includes(o)&&![...this.#n.values(),...[...this.#a.values()].map(u=>u.end())].includes(o);a&&a.player()===this.player()&&!s.length&&!this.#p.includes(o)&&!p?this.#p.push(o):a&&a.player()!==this.player()&&a.originalPlayer()===this.player()?this.#l.push(o):a&&a.player()!==this.player()&&!this.#s.includes(o)?this.#s.push(o):s.length&&s.some(u=>u.player()!==this.player())&&this.#m.includes(o)?this.#m.push(o):o.isLand()&&o.getNeighbours().some(u=>!e.includes(u))&&!this.#y.includes(o)&&!p?this.#y.push(o):o.isWater()&&o.getNeighbours().some(u=>!e.includes(u))&&this.#f.includes(o)&&!p&&this.#f.push(o),this.#e(o)&&this.#g.includes(o)&&!p&&this.#g.push(o)}),this.#u.getByPlayer(this.player()).forEach(r=>{let o=this.#c.getByTile(r.tile());os(r,this.#h,this.#x),!o.length&&!this.#p.includes(r.tile())&&this.#p.push(r.tile())})}takeTurn(){return new Promise((e,r)=>{try{let o=0;this.preProcessTurn();let[a]=this.#T.filter(p=>p.player()===this.player()),[s]=this.#I.filter(p=>p.player()===this.player());for(s.completed(_r)&&!a.is(at)&&a.set(new at);this.player().hasMandatoryActions();){let p=this.player().mandatoryAction(),u=p.value();if(o++>1e3){console.log(""),console.log(""),console.log(u),u instanceof we&&(console.log(u.actions()),u.tile().getNeighbours().forEach(y=>console.log(u.actions(y))),console.log(u.active()),console.log(u.busy()),console.log(u.moves().value()),console.log(this.#v.getByUnit(u))),u.action(new Xi(u.tile(),u.tile(),u)),console.error("SimpleAIClient: Couldn't pick an action to do.");break}if(u instanceof we){let y=u,c=y.tile(),f=this.#n.get(y),g=y.actions(),{buildIrrigation:G,buildMine:k,buildRoad:D,fortify:U,foundCity:j,unload:Re}=g.reduce((Ge,ne)=>({...Ge,[ne.constructor.name.replace(/^./,_e=>_e.toLowerCase())]:ne}),{}),Se=this.#c.getByTile(c);if(this.#o.get(y)||this.#o.set(y,[y.tile()]),y instanceof zt&&Re&&c.isCoast()&&y.cargo().some(Ge=>!c.getNeighbours().some(ne=>(this.#o.get(Ge)||[]).includes(ne)))){y.action(Re),y.setWaiting();continue}if(y instanceof gr){j&&this.#e(c)?y.action(j):G&&this.#t(c)?y.action(G):k&&this.#r(c)?y.action(k):D&&this.#i(c)?y.action(D):!f&&this.#g.length&&this.#n.set(y,this.#g.shift()),this.moveUnit(y);continue}let[Ga]=Se.filter(Ge=>this.#v.getByUnit(Ge).some(ne=>ne instanceof di)&&y.defence()>Ge.defence()),Pl=this.#u.getByTile(c);if(U&&Pl&&(Ga||Se.length<=Math.ceil(this.#x.getByCity(Pl).size()/5))){y.action(U),Ga&&Ga.activate();continue}if(!f){if(y instanceof F&&y.defence().value()>0&&this.#p.length>0){let[Ge]=this.#p.sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Is.for(y,y.tile(),Ge,this.#d);ne&&(this.#p.splice(this.#p.indexOf(Ge),1),this.#a.set(y,ne))}else if(y.attack().value()>0&&this.#l.length>0){let[Ge]=this.#l.filter(_e=>y instanceof ot&&_e.isLand()).sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Is.for(y,y.tile(),Ge,this.#d);ne&&(this.#l.splice(this.#l.indexOf(Ge),1),this.#a.set(y,ne))}else if(y.attack().value()>0&&this.#m.length>0){let[Ge]=this.#m.filter(_e=>y instanceof ot&&_e.isLand()||y instanceof We&&_e.isWater()).sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Is.for(y,y.tile(),Ge,this.#d);ne&&(this.#m.splice(this.#m.indexOf(Ge),1),this.#a.set(y,ne))}else if(y instanceof ot&&y.attack().value()>0&&this.#s.length>0){let[Ge]=this.#s.sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Is.for(y,y.tile(),Ge,this.#d);ne&&(this.#s.splice(this.#s.indexOf(Ge),1),this.#a.set(y,ne))}else if(y instanceof ot&&this.#y.length>0){let[Ge]=this.#y.sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Is.for(y,y.tile(),Ge,this.#d);ne&&(this.#y.splice(this.#y.indexOf(Ge),1),this.#a.set(y,ne))}else if(y instanceof We&&this.#f.length>0){let[Ge]=this.#f.sort((_e,oi)=>_e.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),ne=Is.for(y,y.tile(),Ge,this.#d);ne&&(this.#f.splice(this.#f.indexOf(Ge),1),this.#a.set(y,ne))}}this.moveUnit(y);continue}if(u instanceof Ll){this.buildItemInCity(u.city());continue}if(u instanceof Ml){let y=u.available();y.length&&u.research(y[Math.floor(y.length*Math.random())]);continue}if(p instanceof Ac)break;console.log(`Can't process: '${u.constructor.name}'`);break}e()}catch(o){if(typeof o=="string"){r(new Error(o));return}if(o instanceof Error){r(o);return}r(new Error(`An unknown error occurred: ${o}`))}})}buildItemInCity(e){let r=e.tile(),o=this.#b.getByCity(e),a=this.#c.getByTile(r),s=o.available(),p=[dt,je],u=s.filter(U=>!p.includes(U.item())&&!Object.prototype.isPrototypeOf.call(xe,U.item())),y=s.filter(U=>Object.prototype.isPrototypeOf.call(xe,U.item())),c=u.filter(U=>Object.prototype.isPrototypeOf.call(we,U.item())),f=u[Math.floor(u.length*Math.random())].item(),g=t(U=>{let[[j]]=c.map(Re=>{let Se=Re.item(),At=new U;return this.#P.process(es,Se,At),[Se,At]}).sort(([,Re],[,Se])=>Se.value()-Re.value());return j},"getUnitByYield"),G=(U=>()=>U||(U=g(mi)))(),k=(U=>()=>U||(U=g(Vi)))();if(this.#c.getByTile(r).length<2&&G()){o.build(G());return}let D=this.#x.getByCity(o.city());if(s.some(U=>U.item()===je)&&!this.#c.getByCity(o.city()).some(U=>U instanceof je)&&this.#c.getByPlayer(this.player()).filter(U=>U instanceof je).length<3&&D.size()>1){o.build(je);return}if(this.#l.length>0||this.#s.length>0||this.#m.length>4){o.build(k());return}if(a.filter(U=>this.#v.getByUnit(U).filter(j=>j instanceof di)).length<2||this.#p.length){o.build(G());return}if(o.city().yields().filter(U=>U instanceof K).some(U=>U.value()>4)){let U=y.map(j=>j.item());o.build(U[Math.floor(Math.random()*U.length)])}f&&o.build(f)}cityLost(e,r,o){if(!r)return;let a=this.#h.getByPlayer(this.player());if(o){this.#s.push(...a.entries().filter(s=>xf(s.tile(),this.player(),this.#u)).map(s=>s.tile())),this.#m.push(...a.entries().filter(s=>this.#c.getByTile(s.tile()).some(p=>p.player()===r)).map(s=>s.tile()));return}this.#l.push(e.tile())}unitDestroyed(e,r){let o=this.#u.getByTile(e.tile()),a=this.#c.getByTile(e.tile());o&&o.player()===this.player()&&a.length<2&&(this.buildItemInCity(o),this.#w.getByPlayer(this.player()).buy(o))}};t(vf,"SimpleAIClient");Sn=vf});var bf,ko,el=n(()=>{Ce();nc();bf=class extends O{constructor(){super(Tx)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of Clients for Player.");return r[0]}};t(bf,"ClientRegistry");ko=new bf});var tl,rl,Rm=n(()=>{Ot();tl=class extends ae{};t(tl,"American");rl=tl});var TY={};var kT=n(()=>{Rm();tr();rr();Object.entries({people:"American",nation:"America",colors:["#0055A4","#FFF"]}).forEach(([i,e])=>de.register(new fe(rl,i,e)))});var IY={};var DT=n(()=>{Rm();Dt();gt();["Washington","New York","Los Angeles","Chicago","Houston","Phoenix","Philadelphia","San Antonio","San Diego","Dallas","San Jose","Austin","Jacksonville","Fort Worth","Columbus","San Francisco","Charlotte","Indianapolis","Seattle","Denver","Boston","El Paso","Detroit","Nashville","Portland","Memphis","Oklahoma City","Las Vegas","Louisville","Baltimore","Milwaukee","Albuquerque","Tucson","Fresno","Mesa","Sacramento","Atlanta","Kansas City","Colorado Springs","Miami","Raleigh","Omaha","Long Beach","Virginia Beach","Oakland","Minneapolis","Tulsa","Arlington","Tampa","New Orleans","Wichita","Cleveland","Bakersfield","Aurora","Anaheim","Honolulu","Santa Ana","Riverside","Corpus Christi","Lexington","Stockton","Henderson","Saint Paul","St. Louis","Cincinnati","Pittsburgh","Greensboro","Anchorage","Plano","Lincoln","Orlando","Irvine","Newark","Toledo","Durham","Chula Vista","Fort Wayne","Jersey City","St. Petersburg","Laredo","Madison","Chandler","Buffalo","Lubbock","Scottsdale","Reno","Glendale","Gilbert","Winston\u2013Salem","North Las Vegas","Norfolk","Chesapeake","Garland","Irving","Hialeah","Fremont","Boise","Richmond","Baton Rouge","Spokane","Des Moines","Tacoma","San Bernardino","Modesto","Fontana","Santa Clarita","Birmingham","Oxnard","Fayetteville","Moreno Valley","Rochester","Glendale","Huntington Beach","Salt Lake City","Grand Rapids","Amarillo","Yonkers","Aurora","Montgomery","Akron","Little Rock","Huntsville","Augusta","Port St. Lucie","Grand Prairie","Columbus","Tallahassee","Overland Park","Tempe","McKinney","Mobile","Cape Coral","Shreveport","Frisco","Knoxville","Worcester","Brownsville","Vancouver","Fort Lauderdale","Sioux Falls","Ontario","Chattanooga","Providence","Newport News","Rancho Cucamonga","Santa Rosa","Oceanside","Salem","Elk Grove","Garden Grove","Pembroke Pines","Peoria","Eugene","Corona","Cary","Springfield","Fort Collins","Jackson","Alexandria","Hayward","Lancaster","Lakewood","Clarksville","Palmdale","Salinas","Springfield","Hollywood","Pasadena","Sunnyvale","Macon","Kansas City","Pomona","Escondido","Killeen","Naperville","Joliet","Bellevue","Rockford","Savannah","Paterson","Torrance","Bridgeport","McAllen","Mesquite","Syracuse","Midland","Pasadena","Murfreesboro","Miramar","Dayton","Fullerton","Olathe","Orange","Thornton","Roseville","Denton","Waco","Surprise","Carrollton","West Valley City","Charleston","Warren","Hampton","Gainesville","Visalia","Coral Springs","Columbia","Cedar Rapids","Sterling Heights","New Haven","Stamford","Concord","Kent","Santa Clara","Elizabeth","Round Rock","Thousand Oaks","Lafayette","Athens","Topeka","Simi Valley","Fargo","Norman","Columbia","Abilene","Wilmington","Hartford","Victorville","Pearland","Vallejo","Ann Arbor","Berkeley","Allentown","Richardson","Odessa","Arvada","Cambridge","Sugar Land","Beaumont","Lansing","Evansville","Rochester","Independence","Fairfield","Provo","Clearwater","College Station","West Jordan","Carlsbad","El Monte","Murrieta","Temecula","Springfield","Palm Bay","Costa Mesa","Westminster","North Charleston","Miami Gardens","Manchester","High Point","Downey","Clovis","Pompano Beach","Pueblo","Elgin","Lowell","Antioch","West Palm Beach","Peoria","Everett","Ventura","Centennial","Lakeland","Gresham","Richmond","Billings","Inglewood","Broken Arrow","Sandy Springs","Jurupa Valley","Hillsboro","Waterbury","Santa Maria","Boulder","Greeley","Daly City","Meridian","Lewisville","Davie","West Covina","League City","Tyler","Norwalk","San Mateo","Green Bay","Wichita Falls","Sparks","Lakewood","Burbank","Rialto","Allen","El Cajon","Las Cruces","Renton","Davenport","South Bend","Vista","Tuscaloosa","Clinton","Edison","Woodbridge","San Angelo","Kenosha","Vacaville"].forEach((i,e)=>J.register(new Q(i,rl,e===0)))});var YT=C(OT=>{"use strict";Object.defineProperty(OT,"__esModule",{value:!0});kT();DT()});var il,xm,Gp=n(()=>{Ot();il=class extends ae{};t(il,"Aztec");xm=il});var wY={};var ST=n(()=>{Gp();tr();rr();Object.entries({people:"Aztec",nation:"Aztec",colors:["#A1DAB5","#EA6B76"]}).forEach(([i,e])=>de.register(new fe(xm,i,e)))});var PY={};var FT=n(()=>{Gp();Dt();gt();["Tenochtitlan","Teotihuacan","Tlatelolco","Texcoco","Tlaxcala","Calixtlahuaca","Xochicalco","Tlacopan","Atzcapotzalco","Tzintzuntzan","Malinalco","Tula","Tamuin","Teayo","Cempoala","Chalco","Tlalmanalco","Ixtapaluca","Huexotla","Tepexpan","Tepetlaoxtoc","Chiconautla","Zitlaltepec","Coyotepec","Tequixquiac","Jilotzingo","Tlapanaloya","Tultitan","Ecatepec","Coatepec","Chalchiuites","Chiauhita","Chapultepec","Itzapalapa","Ayotzinco","Iztapam"].forEach((i,e)=>J.register(new Q(i,xm,e===0)))});var zT=C(NT=>{"use strict";Object.defineProperty(NT,"__esModule",{value:!0});ST();FT()});var ol,vm,kp=n(()=>{Ot();ol=class extends ae{};t(ol,"Babylonian");vm=ol});var BY={};var LT=n(()=>{kp();tr();rr();Object.entries({people:"Babylonian",nation:"Babylon",colors:["#D0B8A6","#2f7b00"]}).forEach(([i,e])=>de.register(new fe(vm,i,e)))});var AY={};var WT=n(()=>{kp();Dt();gt();["Babilim","Eshnunna","Diniktum","Tutub","Der","Sippar","Kutha","Jemdet Nasr","Kish","Borsippa","Mashkan-shapir","Dilbat","Nippur","Marad","Adab","Isin","Kisurra","Shuruppak","Bad-tibira","Zabalam","Umma","Girsu","Lagash","Urum","Uruk","Larsa","Ur","Kuara","Eridu","Akshak","Akkad"].forEach((i,e)=>J.register(new Q(i,vm,e===0)))});var _T=C(jT=>{"use strict";Object.defineProperty(jT,"__esModule",{value:!0});LT();WT()});var nl,bm,Dp=n(()=>{Ot();nl=class extends ae{};t(nl,"Chinese");bm=nl});var UY={};var HT=n(()=>{Dp();tr();rr();Object.entries({people:"Chinese",nation:"China",colors:["#ee1c25","#ff0"]}).forEach(([i,e])=>de.register(new fe(bm,i,e)))});var MY={};var KT=n(()=>{Dp();Dt();gt();["Beijing","Shanghai","Chongqing","Tianjin","Guangzhou","Shenzhen\u2020","Chengdu","Nanjing","Wuhan","Xi'an","Hangzhou","Dongguan","Foshan","Shenyang","Harbin","Qingdao","Dalian","Jinan","Zhengzhou","Changsha","Kunming","Changchun","\xDCr\xFCmqi","Shantou","Hefei","Shijiazhuang","Ningbo","Taiyuan","Nanning","Xiamen\u2020","Fuzhou","Changzhou","Wenzhou","Nanchang","Tangshan","Guiyang","Wuxi","Lanzhou","Zhongshan","Handan","Huai'an","Weifang","Zibo","Shaoxing","Yantai","Huizhou","Luoyang","Nantong","Baotou","Liuzhou"].forEach((i,e)=>J.register(new Q(i,bm,e===0)))});var VT=C(qT=>{"use strict";Object.defineProperty(qT,"__esModule",{value:!0});HT();KT()});var al,Cm,Op=n(()=>{Ot();al=class extends ae{};t(al,"Egyptian");Cm=al});var EY={};var $T=n(()=>{Op();tr();rr();Object.entries({people:"Egyptian",nation:"Egypt",colors:["#CE1126","#FFF"]}).forEach(([i,e])=>de.register(new fe(Cm,i,e)))});var GY={};var JT=n(()=>{Op();Dt();gt();["Cairo","Alexandria","Gizeh","Shubra El-Kheima","Port Said","Suez","Luxor","al-Mansura","El-Mahalla El-Kubra","Tanta","Asyut","Ismailia","Fayyum","Zagazig","Aswan","Damietta","Damanhur","al-Minya","Beni Suef","Qena","Sohag","Hurghada","6th of October City","Shibin El Kom","Banha","Kafr el-Sheikh","Arish","Mallawi","10th of Ramadan City","Bilbais","Marsa Matruh","Idfu","Mit Ghamr","Al-Hamidiyya","Desouk","Qalyub","Abu Kabir","Kafr el-Dawwar","Girga","Akhmim","Matarey"].forEach((i,e)=>J.register(new Q(i,Cm,e===0)))});var QT=C(ZT=>{"use strict";Object.defineProperty(ZT,"__esModule",{value:!0});$T();JT()});var sl,ll,Tm=n(()=>{Ot();sl=class extends ae{};t(sl,"English");ll=sl});var kY={};var XT=n(()=>{Tm();tr();rr();Object.entries({people:"English",nation:"England",colors:["#FFF","#C8102E"]}).forEach(([i,e])=>de.register(new fe(ll,i,e)))});var DY={};var eI=n(()=>{Tm();Dt();gt();["London","Birmingham","Liverpool","Leeds","Sheffield","Bristol","Manchester","Leicester","Coventry","Kingston upon Hull","Stoke-on-Trent","Wolverhampton","Nottingham","Plymouth","Southampton","Reading","Derby","Dudley","Newcastle upon Tyne","Northampton","Portsmouth","Luton","Preston","Sunderland","Norwich","Walsall","Bournemouth","Southend-on-Sea","Swindon","Huddersfield","Poole","Oxford","Middlesbrough","Blackpool","Oldbury","Boldon","Ipswich","York","West Bromwich","Peterborough","Stockport","Brighton","Slough","Gloucester","Rotherham","Cambridge","Exeter","Eastbourne","Sutton Coldfield","Blackburn","Colchester","Oldham","St Helens","Woking","Chesterfield","Crawley"].forEach((i,e)=>J.register(new Q(i,ll,e===0)))});var rI=C(tI=>{"use strict";Object.defineProperty(tI,"__esModule",{value:!0});XT();eI()});var ml,Im,Yp=n(()=>{Ot();ml=class extends ae{};t(ml,"French");Im=ml});var OY={};var iI=n(()=>{Yp();tr();rr();Object.entries({people:"French",nation:"France",colors:["#FFF","#0055A4"]}).forEach(([i,e])=>de.register(new fe(Im,i,e)))});var YY={};var oI=n(()=>{Yp();Dt();gt();["Paris","Marseille","Lyon","Toulouse","Nice","Nantes","Strasbourg","Montpellier","Bordeaux","Lille","Rennes","Reims","Le Havre","Saint-\xC9tienne","Toulon","Grenoble","Dijon","N\xEEmes","Angers","Villeurbanne","Le Mans","Saint-Denis","Aix-en-Provence","Clermont-Ferrand","Brest","Limoges","Tours","Amiens","Perpignan","Metz","Besan\xE7on","Boulogne-Billancourt","Orl\xE9ans","Mulhouse","Rouen","Saint-Denis","Caen","Argenteuil","Saint-Paul","Montreuil","Nancy","Roubaix","Tourcoing","Nanterre","Avignon","Vitry-sur-Seine","Cr\xE9teil","Dunkirk","Poitiers","Asni\xE8res-sur-Seine","Courbevoie","Versailles","Colombes","Fort-de-France","Aulnay-sous-Bois","Saint-Pierre","Rueil-Malmaison","Pau","Aubervilliers","Le Tampon","Champigny-sur-Marne","Antibes","B\xE9ziers","La Rochelle","Saint-Maur-des-Foss\xE9s","Cannes","Calais","Saint-Nazaire","M\xE9rignac","Drancy","Colmar","Ajaccio","Bourges","Issy-les-Moulineaux","Levallois-Perret","La Seyne-sur-Mer","Quimper","Noisy-le-Grand","Villeneuve-d'Ascq","Neuilly-sur-Seine","Valence","Antony","Cergy","V\xE9nissieux","Pessac","Troyes","Clichy","Ivry-sur-Seine","Chamb\xE9ry","Lorient","Les Abymes","Montauban","Sarcelles","Niort","Villejuif","Saint-Andr\xE9","Hy\xE8res","Saint-Quentin","Beauvais","\xC9pinay-sur-Seine","Cayenne","Maisons-Alfort","Cholet","Meaux","Chelles","Pantin","\xC9vry","Fontenay-sous-Bois","Fr\xE9jus","Vannes","Bondy","Le Blanc-Mesnil","La Roche-sur-Yon","Saint-Louis","Arles","Clamart","Narbonne","Annecy","Sartrouville","Grasse","Laval","Belfort","Bobigny","\xC9vreux","Vincennes","Montrouge","Sevran","Albi","Charleville-M\xE9zi\xE8res","Suresnes","Martigues","Corbeil-Essonnes","Saint-Ouen","Bayonne","Cagnes-sur-Mer","Brive-la-Gaillarde","Carcassonne","Massy","Blois","Aubagne","Saint-Brieuc","Ch\xE2teauroux","Chalon-sur-Sa\xF4ne","Mantes-la-Jolie","Meudon","Saint-Malo","Ch\xE2lons-en-Champagne","Alfortville","S\xE8te","Salon-de-Provence","Vaulx-en-Velin","Puteaux","Rosny-sous-Bois","Saint-Herblain","Gennevilliers","Le Cannet","Livry-Gargan","Saint-Priest","Istres","Valenciennes","Choisy-le-Roi","Caluire-et-Cuire","Boulogne-sur-Mer","Bastia","Angoul\xEAme","Garges-l\xE8s-Gonesse","Castres","Thionville","Wattrelos","Talence","Saint-Laurent-du-Maroni","Douai","Noisy-le-Sec","Tarbes","Arras","Al\xE8s","La Courneuve","Bourg-en-Bresse","Compi\xE8gne","Gap","Melun","Le Lamentin","Rez\xE9","Saint-Germain-en-Laye","Marcq-en-Bar\u0153ul","Gagny","Anglet","Draguignan","Chartres","Bron","Bagneux","Colomiers","Saint-Martin-d'H\xE8res","Pontault-Combault","Montlu\xE7on","Jou\xE9-l\xE8s-Tours","Saint-Joseph","Poissy","Savigny-sur-Orge","Cherbourg-Octeville","Mont\xE9limar","Villefranche-sur-Sa\xF4ne","Stains","Saint-Beno\xEEt","Bagnolet","Ch\xE2tillon","Le Port","Sainte-Genevi\xE8ve-des-Bois","\xC9chirolles","Roanne","Villepinte","Saint-Chamond","Conflans-Sainte-Honorine","Auxerre","Nevers","Neuilly-sur-Marne","La Ciotat","Tremblay-en-France","Thonon-les-Bains","Vitrolles","Haguenau","Six-Fours-les-Plages","Agen","Creil","Annemasse","Saint-Rapha\xEBl","Marignane","Romans-sur-Is\xE8re","Montigny-le-Bretonneux","Le Perreux-sur-Marne","Franconville","M\xE2con","Saint-Leu","Cambrai","Ch\xE2tenay-Malabry","Sainte-Marie","Villeneuve-Saint-Georges","Houilles","\xC9pinal","Lens","Li\xE9vin","Les Mureaux","Schiltigheim","La Possession","Meyzieu","Dreux","Nogent-sur-Marne","Plaisir","Mont-de-Marsan","Palaiseau","Ch\xE2tellerault","Goussainville","L'Ha\xFF-les-Roses","Viry-Ch\xE2tillon","Vigneux-sur-Seine","Chatou","Trappes","Clichy-sous-Bois","Rillieux-la-Pape","Villenave-'Ornon","Maubeuge","Charenton-le-Pont","Malakoff","Matoury","Dieppe","Athis-Mons","Savigny-le-Temple","P\xE9rigueux","Baie-Mahault","Vandoeuvre-l\xE8s-Nancy","Pontoise","Aix-les-Bains","Cachan","Vienne","Thiais","Orange","Saint-M\xE9dard-en-Jalles","Villemomble","Saint-Cloud","Saint-Laurent-du-Var","Yerres","Saint-\xC9tienne-du-Rouvray","Sotteville-l\xE8s-Rouen","Draveil","Le Chesnay","Bois-Colombes","Le Plessis-Robinson","La Garenne-Colombes","Lambersart","Soissons","Pierrefitte-sur-Seine","Carpentras","Villiers-sur-Marne","Vanves","Menton","Bergerac","Ermont","Bezons","Grigny","Guyancourt","Saumur","Herblay","Ris-Orangis","Villiers-le-Bel","Bourgoin-Jallieu","Vierzon","Le Gosier","D\xE9cines-Charpieu","H\xE9nin-Beaumont","Fresnes","Aurillac","Sannois","Vallauris","Illkirch-Graffenstaden","Alen\xE7on","\xC9lancourt","Tournefeuille","B\xE8gles","Gonesse","Oullins","Brunoy","Taverny","Armenti\xE8res","Montfermeil","Rambouillet","Villeparisis","Le Kremlin-Bic\xEAtre","Sucy-en-Brie","Kourou","Montb\xE9liard","Romainville","Cavaillon","Saint-Dizier","Br\xE9tigny-sur-Orge","Saint-S\xE9bastien-sur-Loire","Saintes","La Teste-de-Buch","Villeneuve-la-Garenne","B\xE9thune","Bussy-Saint-Georges","Vichy","La Garde","Agde","Laon","Sens","Lunel","Miramas","Biarritz","Le Grand-Quevilly","Orvault","Les Ulis","Champs-sur-Marne","Rochefort","Muret","Sainte-Anne","Eaubonne","\xC9tampes","Gradignan","Vernon","Petit-Bourg","Libourne","Abbeville","Rodez","Saint-Ouen-l'Aum\xF4ne","Torcy","Maisons-Laffitte","Montgeron","Villeneuve-sur-Lot","Cormeilles-en-Parisis","\xC9pernay","S\xE8vres","Dole","Le Robert","Le Bouscat","Blagnac","Frontignan","Cenon","Mandelieu-la-Napoule","Vertou","Les Lilas","Bruay-la-Buissi\xE8re","Les Pavillons-sous-Bois","Chaumont","Roissy-en-Brie","Le Moule","Le Petit-Quevilly","Manosque","Saint-Mand\xE9","Fontenay-aux-Roses","Orly","Le Creusot","Oyonnax","La Madeleine","Sainte-Suzanne","Millau","Combs-la-Ville","Fontaine","Deuil-la-Barre","Coudekerque-Branche","Auch","Lanester","Beaune","Montigny-l\xE8s-Metz","Hazebrouck","Longjumeau","Sainte-Foy-l\xE8s-Lyon","Forbach","Sarreguemines","Mons-en-Bar\u0153ul","La Valette-du-Var","H\xE9rouville-Saint-Clair","Morsang-sur-Orge","Grande-Synthe","La Celle-Saint-Cloud","Lisieux","Croix","Dammarie-les-Lys","V\xE9lizy-Villacoublay","Wasquehal","Saint-Gratien","Halluin","Neuilly-Plaisance","Montmorency","Dax","Lagny-sur-Marne","Le M\xE9e-sur-Seine","Saint-Genis-Laval","Fleury-les-Aubrais","Loos","Gif-sur-Yvette","Denain","Saint-Di\xE9-des-Vosges","Sainte-Rose","Saint-Michel-sur-Orge"].forEach((i,e)=>J.register(new Q(i,Im,e===0)))});var aI=C(nI=>{"use strict";Object.defineProperty(nI,"__esModule",{value:!0});iI();oI()});var pl,ul,wm=n(()=>{Ot();pl=class extends ae{};t(pl,"German");ul=pl});var SY={};var sI=n(()=>{wm();tr();rr();Object.entries({people:"German",nation:"Germany",colors:["#000","#FC0"]}).forEach(([i,e])=>de.register(new fe(ul,i,e)))});var FY={};var lI=n(()=>{wm();Dt();gt();["Berlin","Hamburg","Munich","Cologne","Frankfurt","Stuttgart","D\xFCsseldorf","Dortmund","Essen","Leipzig","Bremen","Dresden","Hanover","Nuremberg","Duisburg","Bochum","Wuppertal","Bielefeld","Bonn","M\xFCnster","Karlsruhe","Mannheim","Augsburg","Wiesbaden","Gelsenkirchen","M\xF6nchengladbach","Braunschweig","Chemnitz","Kiel","Aachen","Halle","Magdeburg","Freiburg","Krefeld","L\xFCbeck","Oberhausen","Erfurt","Mainz","Rostock","Kassel","Hagen","Hamm","Saarbr\xFCcken","M\xFClheim an der Ruhr","Potsdam","Ludwigshafen am Rhein","Oldenburg","Leverkusen","Osnabr\xFCck","Solingen"].forEach((i,e)=>J.register(new Q(i,ul,e===0)))});var pI=C(mI=>{"use strict";Object.defineProperty(mI,"__esModule",{value:!0});sI();lI()});var cl,Pm,Sp=n(()=>{Ot();cl=class extends ae{};t(cl,"Greek");Pm=cl});var NY={};var uI=n(()=>{Sp();tr();rr();Object.entries({people:"Greek",nation:"Greece",colors:["#2175D8","#FFF"]}).forEach(([i,e])=>de.register(new fe(Pm,i,e)))});var zY={};var cI=n(()=>{Sp();Dt();gt();["Athens","Thessaloniki","Patras","Piraeus","Larissa","Heraklion","Peristeri","Kallithea","Acharnes","Kalamaria","Nikaia","Glyfada","Volos","Ilio","Ilioupoli","Keratsini","Evosmos","Chalandri","Nea Smyrni","Marousi","Agios Dimitrios","Zografou","Egaleo","Nea Ionia","Ioannina","Palaio Faliro","Korydallos","Trikala","Vyronas","Agia Paraskevi","Galatsi","Agrinio","Chalcis","Petroupoli","Serres","Alexandroupoli","Xanthi","Katerini","Kalamata","Kavala","Chania","Lamia","Komotini","Irakleio","Rhodes","Kifissia","Stavroupoli","Chaidari","Drama","Veria","Alimos","Kozani","Polichni","Karditsa","Sykies","Ampelokipoi","Pylaia","Agioi Anargyroi","Argyroupoli","Ano Liosia","Nea Ionia","Rethymno","Ptolemaida","Tripoli","Cholargos","Vrilissia","Aspropyrgos","Corinth","Gerakas","Metamorfosi","Giannitsa","Voula","Kamatero","Mytilene","Neapoli","Eleftherio-Kordelio","Chios","Agia Varvara","Kaisariani","Nea Filadelfeia","Moschato","Perama","Salamina","Eleusis","Corfu","Pyrgos","Megara","Kilkis","Dafni","Thebes","Melissia","Argos","Arta","Artemida","Livadeia","Pefki","Oraiokastro","Aigio","Kos","Koropi","Preveza","Naousa","Orestiada","Peraia","Edessa","Florina","Panorama","Nea Erythraia1","Elliniko1","Amaliada","Pallini","Sparta","Agios Ioannis Rentis","Thermi","Vari","Nea Makri","Tavros","Alexandreia","Menemeni","Paiania","Kalyvia Thorikou","Nafplio","Drapetsona","Efkarpia","Papagou","Nafpaktos","Kastoria","Grevena","Pefka","Nea Alikarnassos","Missolonghi","Gazi","Ierapetra","Kalymnos","Rafina","Loutraki","Agios Nikolaos","Ermoupoli","Ialysos","Mandra","Tyrnavos","Glyka Nera","Ymittos","Neo Psychiko"].forEach((i,e)=>J.register(new Q(i,Pm,e===0)))});var fI=C(yI=>{"use strict";Object.defineProperty(yI,"__esModule",{value:!0});uI();cI()});var yl,Bm,Fp=n(()=>{Ot();yl=class extends ae{};t(yl,"Indian");Bm=yl});var LY={};var dI=n(()=>{Fp();tr();rr();Object.entries({people:"Indian",nation:"India",colors:["#138808","#FF9933"]}).forEach(([i,e])=>de.register(new fe(Bm,i,e)))});var WY={};var gI=n(()=>{Fp();Dt();gt();["Delhi","Mumbai","Bangalore","Hyderabad","Ahmedabad","Chennai","Kolkata","Surat","Pune","Jaipur","Lucknow","Kanpur","Nagpur","Indore","Thane","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara","Ghaziabad","Ludhiana","Agra","Nashik","Faridabad","Meerut","Rajkot","Kalyan-Dombivli","Vasai-Virar","Varanasi","Srinagar","Aurangabad","Dhanbad","Amritsar","Navi Mumbai","Allahabad","Howrah","Ranchi","Gwalior","Jabalpur","Coimbatore","Vijayawada","Jodhpur","Madurai","Raipur","Kota","Chandigarh","Guwahati","Solapur","Hubli\u2013Dharwad","Tiruchirappalli","Bareilly","Moradabad","Mysore","Tiruppur","Gurgaon","Aligarh","Jalandhar","Bhubaneswar","Salem","Mira-Bhayandar","Warangal","Jalgaon","Guntur","Bhiwandi","Saharanpur","Gorakhpur","Bikaner","Amravati","Noida","Jamshedpur","Bhilai","Cuttack","Firozabad","Kochi","Nellore","Bhavnagar","Dehradun","Durgapur","Asansol","Rourkela","Nanded","Kolhapur","Ajmer","Akola","Gulbarga","Jamnagar","Ujjain","Loni","Siliguri","Jhansi","Ulhasnagar","Jammu","Sangli-Miraj & Kupwad","Mangalore","Erode","Belgaum","Ambattur","Tirunelveli","Malegaon","Gaya","Thiruvananthapuram","Udaipur","Maheshtala","Davanagere","Kozhikode","Kurnool","Rajpur Sonarpur","Rajahmundry","Bokaro","South Dumdum","Bellary","Patiala","Gopalpur","Agartala","Bhagalpur","Muzaffarnagar","Bhatpara","Panihati","Latur","Dhule","Tirupati","Rohtak","Korba","Bhilwara","Berhampur","Muzaffarpur","Ahmednagar","Mathura","Kollam","Avadi","Kadapa","Kamarhati","Sambalpur","Bilaspur","Shahjahanpur","Satara","Bijapur","Kakinada","Rampur","Shimoga","Chandrapur","Junagadh","Thrissur","Alwar","Bardhaman","Kulti","Nizamabad","Parbhani","Tumkur","Khammam","Ozhukarai","Bihar Sharif","Panipat","Darbhanga","Bally","Aizawl","Dewas","Ichalkaranji","Karnal","Bathinda","Jalna","Eluru","Barasat","Kirari Suleman Nagar","Purnia","Satna","Mau","Sonipat","Farrukhabad","Sagar","Durg","Imphal","Ratlam","Hapur","Arrah","Anantapur","Karimnagar","Etawah","Ambarnath","North Dumdum","Bharatpur","Begusarai","New Delhi","Gandhidham","Baranagar","Tiruvottiyur","Pondicherry","Sikar","Thoothukudi","Rewa","Mirzapur","Raichur","Pali","Ramagundam","Haridwar","Vijayanagaram","Katihar","Nagercoil","Sri Ganganagar","Karawal Nagar","Mango","Thanjavur","Bulandshahr","Uluberia","Katni","Sambhal","Singrauli","Nadiad","Secunderabad","Naihati","Yamunanagar","Bidhannagar","Pallavaram","Bidar","Munger","Panchkula","Burhanpur","Raurkela Industrial Township","Kharagpur","Dindigul","Gandhinagar","Hospet","Nangloi Jat","Malda","Ongole","Deoghar","Chapra","Haldia","Khandwa","Nandyal","Morena","Amroha","Anand","Bhind","Bhalswa Jahangir Pur","Madhyamgram","Bhiwani","Berhampore","Ambala","Morbi","Fatehpur","Raebareli","Mahaboobnagar","Chittoor","Bhusawal","Orai","Bahraich","Vellore","Mehsana","Raiganj","Sirsa","Danapur","Serampore","Sultan Pur Majra","Guna","Jaunpur","Panvel","Shivpuri","Surendranagar Dudhrej","Unnao","Chinsurah","Alappuzha","Kottayam","Machilipatnam","Shimla","Adoni","Udupi","Tenali","Proddatur","Saharsa","Hindupur","Sasaram","Hajipur","Bhimavaram","Kumbakonam","Dehri","Madanapalle","Siwan","Bettiah","Guntakal","Srikakulam","Motihari","Dharmavaram","Gudivada","Phagwara","Narasaraopet","Suryapet","Miryalaguda","Tadipatri","Karaikudi","Kishanganj","Jamalpur","Ballia","Kavali","Tadepalligudem","Amaravati","Buxar","Jehanabad","Aurangabad","Gangtok"].forEach((i,e)=>J.register(new Q(i,Bm,e===0)))});var RI=C(hI=>{"use strict";Object.defineProperty(hI,"__esModule",{value:!0});dI();gI()});var fl,Am,Np=n(()=>{Ot();fl=class extends ae{};t(fl,"Mongol");Am=fl});var jY={};var xI=n(()=>{Np();tr();rr();Object.entries({people:"Mongol",nation:"Mongolia",colors:["#DA2032","#0066B3"]}).forEach(([i,e])=>de.register(new fe(Am,i,e)))});var _Y={};var vI=n(()=>{Np();Dt();gt();["Ulaanbaatar","Erdenet","Darkhan","Choibalsan","M\xF6r\xF6n","Nalaikh","Bayankhongor","\xD6lgii","Khovd","Arvaikheer","Ulaangom","Baganuur","Sainshand","Tsetserleg","S\xFCkhbaatar","\xD6nd\xF6rkhaan","Dalanzadgad","Z\xFC\xFCnkharaa","Uliastai","Altai","Baruun-Urt","Mandalgovi","Zuunmod","Zamyn-\xDC\xFCd","Bulgan","Kharkhorin","Choir","Bor-\xD6nd\xF6r","Sharyngo"].forEach((i,e)=>J.register(new Q(i,Am,e===0)))});var CI=C(bI=>{"use strict";Object.defineProperty(bI,"__esModule",{value:!0});xI();vI()});var dl,Um,zp=n(()=>{Ot();dl=class extends ae{};t(dl,"Roman");Um=dl});var HY={};var TI=n(()=>{zp();tr();rr();Object.entries({people:"Roman",nation:"Rome",colors:["#A20101","#D1B24F"]}).forEach(([i,e])=>de.register(new fe(Um,i,e)))});var KY={};var II=n(()=>{zp();Dt();gt();["Roma","Ariminum","Belum","Placentia","Tarraco","Italica","Mod","Salernum","Bononia","Forum Livii","Regium Lepidi","Aquileia","Ascrivium","Valentia Edetanorum","Scalabis","Villa Euracini","Palma","Colonia Narbo Martius","Massa","Pistoria","Segovia","Gerunda","Pompaelo","Naissus","Brigantium","Florentia","Vesontio","Lutetia Parisiorum","Atuatuca Tungrorum","Iulia Romula Hispalis","Augusta Raurica","Noviodunum","Lugdunum","Siscia","Marsonia","Augusta Treverorum","Castra Legionis","Augusta Taurinorum","Augusta Praetoria Salassorum","Emerita Augusta","Norba Caesarina","Lucus Augusta","Caesarea","Bracara Augusta","Novaesium","Castra Vetera","Pons Drusi","Ovilava","Iuvavum","Augusta Vindelicorum","Turicum","Asturica Augusta","Borbetomagus","Caesaraugusta","Sirmium","Sorviodurum","Mogontiacum","Argentoratum","Bonna","Noviomagus","Castellum apud Confluentes","Divodurum","Caesaromagus","Ambianum","Faventia Paterna Barcino","Abila","Lousonna","Ulpia Noviomagus Batavorum","Rigomagus","Aquae Mattiacorum","Mursa","Emona","Vindonissa","Aventicum","Praetorium Agrippinae","Lugdunum Batavorum","Aequum","Londinium","Albanianis","Lauri","Durovernum Cantiacorum","Regulbium","Rutupiae","Viminacium","Camulodunum","Traiectum","Matilo","Forum Hadriani","Nigrum Pullum","Lindum Colonia","Ratae Corieltauvorum","Durocobrivis","Colonia Agrippina","Durocornovium","Verulamium","Letocetum","Dubris","Danum","Mediolanum","Isca Dumnoniorum","Blestium","Viroconium Cornoviorum","Aquae Sulis","Durnovaria","Lindinis","Ad Flexum","Clausentum","Venta Belgarum","Calleva Atrebatum","Duroliponte","Concangis","Condate","Corinium Dobunnorum","Eboracum","Luguvalium","Arae Flaviae","Isca Augusta","Lagentium","Lopodunum","Moridunum","Venta Silurum","Deva Victrix","Mamucium","Olicana","Vinovia","Bonames","Coria","Gerulata","Vindobona","Biriciana","Cannstatt Castrum","Colonia Nervia Glevensium","Sumelocenna","Lopodunum","Traiectum ad Nicrem","Castra Batavar","Nida","Lactodurum","Bovium","Burgodunum","Lentia","Aquae Granni","Complutum","Aeminium","Traiectum ad Mosam","Coriovallum","Portus Lemanis","Andautonia","Salona","Cibalae","Aquae Helveticae","Aquincum","Apulum","Pons Aelius","Durovigutum","Aelia Capitolina","Ala","Castra Regina","Theranda","Pomaria","Partiscum","Gesoriacum","Aurelia Aquensis","Urbs Aurelianorum","Venetiae","Ragusium"].forEach((i,e)=>J.register(new Q(i,Um,e===0)))});var PI=C(wI=>{"use strict";Object.defineProperty(wI,"__esModule",{value:!0});TI();II()});var gl,hl,Mm=n(()=>{Ot();gl=class extends ae{};t(gl,"Russian");hl=gl});var qY={};var BI=n(()=>{Mm();tr();rr();Object.entries({people:"Russian",nation:"Russia",colors:["#0032A0","#DA291C"]}).forEach(([i,e])=>de.register(new fe(hl,i,e)))});var VY={};var AI=n(()=>{Mm();Dt();gt();["Moscow","Saint Petersburg","Novosibirsk","Yekaterinburg","Nizhny Novgorod","Kazan","Chelyabinsk","Omsk","Samara","Ufa","Rostov-on-Don","Krasnoyarsk","Voronezh","Perm","Volgograd","Krasnodar","Saratov","Tyumen","Makhachkala","Tolyatti","Barnaul","Ulyanovsk","Izhevsk","Vladivostok","Irkutsk","Khabarovsk","Yaroslavl","Tomsk","Orenburg","Kemerovo","Novokuznetsk","Tula","Ryazan","Kirov","Astrakhan","Naberezhnye Chelny","Sochi","Penza","Lipetsk","Cheboksary","Balashikha","Kaliningrad","Kursk","Stavropol","Ulan-Ude","Bryansk","Tver","Magnitogorsk","Ivanovo","Belgorod","Surgut","Vladimir","Arkhangelsk","Nizhny Tagil","Kaluga","Chita","Saransk","Yakutsk","Smolensk","Podolsk","Volzhsky","Vladikavkaz","Vologda","Cherepovets","Kurgan","Oryol","Grozny","Murmansk","Tambov","Petrozavodsk","Sterlitamak","Kostroma","Nizhnevartovsk","Novorossiysk","Yoshkar-Ola","Taganrog","Komsomolsk-on-Amur","Khimki","Syktyvkar","Nalchik","Nizhnekamsk","Shakhty","Dzerzhinsk","Bratsk","Orsk","Angarsk","Engels","Blagoveshchensk","Stary Oskol","Veliky Novgorod","Korolyov","Pskov","Mytishchi","Biysk","Lyubertsy","Prokopyevsk","Yuzhno-Sakhalinsk","Balakovo","Armavir","Rybinsk","Severodvinsk","Abakan","Petropavlovsk-Kamchatsky","Norilsk","Syzran","Volgodonsk","Ussuriysk","Kamensk-Uralsky","Novocherkassk","Zlatoust","Elektrostal","Almetyevsk","Krasnogorsk","Salavat","Miass","Nakhodka","Kopeysk","Pyatigorsk","Rubtsovsk","Berezniki","Kolomna","Maykop","Odintsovo","Khasavyurt","Kovrov","Kislovodsk","Neftekamsk","Nefteyugansk","Novocheboksarsk","Serpukhov","Shchyolkovo","Novomoskovsk","Bataysk","Pervouralsk","Domodedovo","Derbent","Cherkessk","Orekhovo-Zuyevo","Nevinnomyssk","Dimitrovgrad","Nazran","Kyzyl","Oktyabrsky","Obninsk","Kaspiysk","Novy Urengoy","Ramenskoye","Kamyshin","Murom","Zhukovsky"].forEach((i,e)=>J.register(new Q(i,hl,e===0)))});var MI=C(UI=>{"use strict";Object.defineProperty(UI,"__esModule",{value:!0});BI();AI()});var Rl,Em,Lp=n(()=>{Ot();Rl=class extends ae{};t(Rl,"Zulu");Em=Rl});var $Y={};var EI=n(()=>{Lp();tr();rr();Object.entries({people:"Zulu",nation:"Zulus",colors:["#FFFD1E","#000"]}).forEach(([i,e])=>de.register(new fe(Em,i,e)))});var JY={};var GI=n(()=>{Lp();Dt();gt();["uMgungundlovu","Nobamba","Bulawayo","KwaDukuza","Nongoma","oNdini","Nodwengu","Ndondakusuka","Babanango","Khangela","Kwahlomendlini","Hlobane","eThekwini","Mlambongwenya","Eziqwaqweni","Isiphezi","Masotsheni","Mtunzini","Nyakamubi","Hlatikulu","Mthonjaneni","Empangeni","Pongola","Tungela","Kwamashu","Ingwavuma","Hluhluwe","Mtubatuba","Mhlahlandlela","Mthatha","Maseru","Lobamba","Qunu"].forEach((i,e)=>J.register(new Q(i,Em,e===0)))});var DI=C(kI=>{"use strict";Object.defineProperty(kI,"__esModule",{value:!0});EI();GI()});var ZY={};var OI=n(()=>{A();mh();h.register(Rb)});var SI=C(YI=>{"use strict";Object.defineProperty(YI,"__esModule",{value:!0});OI()});var QY={};var FI=n(()=>{A();ph();h.register(xb)});var zI=C(NI=>{"use strict";Object.defineProperty(NI,"__esModule",{value:!0});FI()});var XY={};var LI=n(()=>{A();uh();h.register(vb)});var jI=C(WI=>{"use strict";Object.defineProperty(WI,"__esModule",{value:!0});LI()});var eS={};var _I=n(()=>{A();ch();h.register(bb)});var KI=C(HI=>{"use strict";Object.defineProperty(HI,"__esModule",{value:!0});_I()});var tS={};var qI=n(()=>{A();yh();h.register(Cb)});var $I=C(VI=>{"use strict";Object.defineProperty(VI,"__esModule",{value:!0});qI()});var rS={};var JI=n(()=>{A();fh();h.register(Tb)});var QI=C(ZI=>{"use strict";Object.defineProperty(ZI,"__esModule",{value:!0});JI()});var iS={};var XI=n(()=>{A();dh();h.register(Ib)});var tw=C(ew=>{"use strict";Object.defineProperty(ew,"__esModule",{value:!0});XI()});var oS={};var rw=n(()=>{A();gh();h.register(wb)});var ow=C(iw=>{"use strict";Object.defineProperty(iw,"__esModule",{value:!0});rw()});var nS={};var nw=n(()=>{A();hh();h.register(Pb)});var sw=C(aw=>{"use strict";Object.defineProperty(aw,"__esModule",{value:!0});nw()});var aS={};var lw=n(()=>{A();Rh();h.register(Bb)});var pw=C(mw=>{"use strict";Object.defineProperty(mw,"__esModule",{value:!0});lw()});var sS={};var uw=n(()=>{A();xh();h.register(Ab)});var yw=C(cw=>{"use strict";Object.defineProperty(cw,"__esModule",{value:!0});uw()});var lS={};var fw=n(()=>{A();vh();h.register(Ub)});var gw=C(dw=>{"use strict";Object.defineProperty(dw,"__esModule",{value:!0});fw()});var mS={};var hw=n(()=>{A();bh();h.register(Mb)});var xw=C(Rw=>{"use strict";Object.defineProperty(Rw,"__esModule",{value:!0});hw()});var pS={};var vw=n(()=>{A();Ch();h.register(Eb)});var Cw=C(bw=>{"use strict";Object.defineProperty(bw,"__esModule",{value:!0});vw()});var uS={};var Tw=n(()=>{A();Th();h.register(Gb)});var ww=C(Iw=>{"use strict";Object.defineProperty(Iw,"__esModule",{value:!0});Tw()});var cS={};var Pw=n(()=>{A();Ih();h.register(kb)});var Aw=C(Bw=>{"use strict";Object.defineProperty(Bw,"__esModule",{value:!0});Pw()});var yS={};var Uw=n(()=>{A();wh();h.register(Db)});var Ew=C(Mw=>{"use strict";Object.defineProperty(Mw,"__esModule",{value:!0});Uw()});var fS={};var Gw=n(()=>{A();Ph();h.register(Ob)});var Dw=C(kw=>{"use strict";Object.defineProperty(kw,"__esModule",{value:!0});Gw()});var dS={};var Ow=n(()=>{A();Bh();h.register(Yb)});var Sw=C(Yw=>{"use strict";Object.defineProperty(Yw,"__esModule",{value:!0});Ow()});var gS={};var Fw=n(()=>{A();Ah();h.register(Sb)});var zw=C(Nw=>{"use strict";Object.defineProperty(Nw,"__esModule",{value:!0});Fw()});var hS={};var Lw=n(()=>{A();Uh();h.register(Fb)});var jw=C(Ww=>{"use strict";Object.defineProperty(Ww,"__esModule",{value:!0});Lw()});var RS={};var _w=n(()=>{A();Mh();h.register(Nb)});var Kw=C(Hw=>{"use strict";Object.defineProperty(Hw,"__esModule",{value:!0});_w()});var xS={};var qw=n(()=>{A();Eh();h.register(zb)});var $w=C(Vw=>{"use strict";Object.defineProperty(Vw,"__esModule",{value:!0});qw()});var vS={};var Jw=n(()=>{A();Gh();h.register(Lb)});var Qw=C(Zw=>{"use strict";Object.defineProperty(Zw,"__esModule",{value:!0});Jw()});var bS={};var Xw=n(()=>{A();kh();h.register(Wb)});var tP=C(eP=>{"use strict";Object.defineProperty(eP,"__esModule",{value:!0});Xw()});var CS={};var rP=n(()=>{A();Dh();h.register(jb)});var oP=C(iP=>{"use strict";Object.defineProperty(iP,"__esModule",{value:!0});rP()});var TS={};var nP=n(()=>{A();Oh();h.register(_b)});var sP=C(aP=>{"use strict";Object.defineProperty(aP,"__esModule",{value:!0});nP()});var IS={};var lP=n(()=>{A();Yh();h.register(Hb)});var pP=C(mP=>{"use strict";Object.defineProperty(mP,"__esModule",{value:!0});lP()});var wS={};var uP=n(()=>{A();Sh();h.register(Kb)});var yP=C(cP=>{"use strict";Object.defineProperty(cP,"__esModule",{value:!0});uP()});var PS={};var fP=n(()=>{A();Fh();h.register(qb)});var gP=C(dP=>{"use strict";Object.defineProperty(dP,"__esModule",{value:!0});fP()});var BS={};var hP=n(()=>{A();Nh();h.register(Vb)});var xP=C(RP=>{"use strict";Object.defineProperty(RP,"__esModule",{value:!0});hP()});var AS={};var vP=n(()=>{A();zh();h.register($b)});var CP=C(bP=>{"use strict";Object.defineProperty(bP,"__esModule",{value:!0});vP()});var US={};var TP=n(()=>{A();Lh();h.register(Jb)});var wP=C(IP=>{"use strict";Object.defineProperty(IP,"__esModule",{value:!0});TP()});var MS={};var PP=n(()=>{A();Wh();h.register(Zb)});var AP=C(BP=>{"use strict";Object.defineProperty(BP,"__esModule",{value:!0});PP()});var ES={};var UP=n(()=>{A();jh();h.register(Qb)});var EP=C(MP=>{"use strict";Object.defineProperty(MP,"__esModule",{value:!0});UP()});var GS={};var GP=n(()=>{A();_h();h.register(Xb)});var DP=C(kP=>{"use strict";Object.defineProperty(kP,"__esModule",{value:!0});GP()});var kS={};var OP=n(()=>{A();Hh();h.register(eC)});var SP=C(YP=>{"use strict";Object.defineProperty(YP,"__esModule",{value:!0});OP()});var DS={};var FP=n(()=>{A();Kh();h.register(tC)});var zP=C(NP=>{"use strict";Object.defineProperty(NP,"__esModule",{value:!0});FP()});var OS={};var LP=n(()=>{A();qh();h.register(rC)});var jP=C(WP=>{"use strict";Object.defineProperty(WP,"__esModule",{value:!0});LP()});var YS={};var _P=n(()=>{A();Vh();h.register(iC)});var KP=C(HP=>{"use strict";Object.defineProperty(HP,"__esModule",{value:!0});_P()});var SS={};var qP=n(()=>{A();$h();h.register(oC)});var $P=C(VP=>{"use strict";Object.defineProperty(VP,"__esModule",{value:!0});qP()});var FS={};var JP=n(()=>{A();Jh();h.register(nC)});var QP=C(ZP=>{"use strict";Object.defineProperty(ZP,"__esModule",{value:!0});JP()});var NS={};var XP=n(()=>{A();Zh();h.register(aC)});var tB=C(eB=>{"use strict";Object.defineProperty(eB,"__esModule",{value:!0});XP()});var zS={};var rB=n(()=>{A();Qh();h.register(sC)});var oB=C(iB=>{"use strict";Object.defineProperty(iB,"__esModule",{value:!0});rB()});var LS={};var nB=n(()=>{A();Xh();h.register(lC)});var sB=C(aB=>{"use strict";Object.defineProperty(aB,"__esModule",{value:!0});nB()});var WS={};var lB=n(()=>{A();eR();h.register(mC)});var pB=C(mB=>{"use strict";Object.defineProperty(mB,"__esModule",{value:!0});lB()});var jS={};var uB=n(()=>{A();tR();h.register(pC)});var yB=C(cB=>{"use strict";Object.defineProperty(cB,"__esModule",{value:!0});uB()});var _S={};var fB=n(()=>{A();rR();h.register(uC)});var gB=C(dB=>{"use strict";Object.defineProperty(dB,"__esModule",{value:!0});fB()});var HS={};var hB=n(()=>{A();iR();h.register(cC)});var xB=C(RB=>{"use strict";Object.defineProperty(RB,"__esModule",{value:!0});hB()});var KS={};var vB=n(()=>{A();oR();h.register(yC)});var CB=C(bB=>{"use strict";Object.defineProperty(bB,"__esModule",{value:!0});vB()});var qS={};var TB=n(()=>{A();nR();h.register(fC)});var wB=C(IB=>{"use strict";Object.defineProperty(IB,"__esModule",{value:!0});TB()});var VS={};var PB=n(()=>{A();aR();h.register(dC)});var AB=C(BB=>{"use strict";Object.defineProperty(BB,"__esModule",{value:!0});PB()});var $S={};var UB=n(()=>{A();sR();h.register(gC)});var EB=C(MB=>{"use strict";Object.defineProperty(MB,"__esModule",{value:!0});UB()});var JS={};var GB=n(()=>{A();lR();h.register(hC)});var DB=C(kB=>{"use strict";Object.defineProperty(kB,"__esModule",{value:!0});GB()});var ZS={};var OB=n(()=>{A();mR();h.register(RC)});var SB=C(YB=>{"use strict";Object.defineProperty(YB,"__esModule",{value:!0});OB()});var QS={};var FB=n(()=>{A();pR();h.register(xC)});var zB=C(NB=>{"use strict";Object.defineProperty(NB,"__esModule",{value:!0});FB()});var XS={};var LB=n(()=>{A();uR();h.register(vC)});var jB=C(WB=>{"use strict";Object.defineProperty(WB,"__esModule",{value:!0});LB()});var eF={};var _B=n(()=>{A();cR();h.register(bC)});var KB=C(HB=>{"use strict";Object.defineProperty(HB,"__esModule",{value:!0});_B()});var tF={};var qB=n(()=>{A();yR();h.register(CC)});var $B=C(VB=>{"use strict";Object.defineProperty(VB,"__esModule",{value:!0});qB()});var rF={};var JB=n(()=>{A();fR();h.register(TC)});var QB=C(ZB=>{"use strict";Object.defineProperty(ZB,"__esModule",{value:!0});JB()});var iF={};var XB=n(()=>{A();dR();h.register(IC)});var tA=C(eA=>{"use strict";Object.defineProperty(eA,"__esModule",{value:!0});XB()});var oF={};var rA=n(()=>{A();RR();h.register(BC)});var oA=C(iA=>{"use strict";Object.defineProperty(iA,"__esModule",{value:!0});rA()});var nF={};var nA=n(()=>{A();gR();h.register(wC)});var sA=C(aA=>{"use strict";Object.defineProperty(aA,"__esModule",{value:!0});nA()});var aF={};var lA=n(()=>{A();hR();h.register(PC)});var pA=C(mA=>{"use strict";Object.defineProperty(mA,"__esModule",{value:!0});lA()});var sF={};var uA=n(()=>{A();xR();h.register(AC)});var yA=C(cA=>{"use strict";Object.defineProperty(cA,"__esModule",{value:!0});uA()});var lF={};var fA=n(()=>{A();vR();h.register(UC)});var gA=C(dA=>{"use strict";Object.defineProperty(dA,"__esModule",{value:!0});fA()});var mF={};var hA=n(()=>{A();bR();h.register(MC)});var xA=C(RA=>{"use strict";Object.defineProperty(RA,"__esModule",{value:!0});hA()});var pF,vA,bA=n(()=>{rp();I();V();pF=t((i=w)=>[new $n(new m((e,r)=>{i.emit("city:building-complete",e,r)}))],"getRules"),vA=pF});var uF,CA,TA=n(()=>{tt();ir();Jn();Ke();V();Ys();I();uF=t((i=_,e=N,r=ce,o=Xt,a=w)=>[new yr(new m(s=>o.getByCity(s).progress().set(0))),new yr(new m(s=>r.getByCity(s).shrink())),new yr(new m((s,p,u)=>{a.emit("city:captured",s,p,u)})),new yr(new m(s=>e.getByCity(s).forEach(p=>p.destroy())))],"getRules"),CA=uF});var IR,Cf,ei,ws=n(()=>{$e();IR=t(i=>i instanceof L?-i.value():-i,"negate"),Cf=class extends L{add(e,r=""){super.add(IR(e),r)}set(e,r=""){super.set(IR(e),r)}subtract(e,r=""){super.subtract(IR(e),r)}};t(Cf,"NegativeYield");ei=t(i=>{["add","set","subtract"].forEach(e=>Object.defineProperty(i.prototype,e,Object.getOwnPropertyDescriptor(Cf.prototype,e)||Object.create(null)))},"makeNegative")});var Gm,IA,wR=n(()=>{Vs();ws();Gm=class extends Ho{};t(Gm,"PopulationSupportFood");ei(Gm);IA=Gm});var Ps,wA,PR=n(()=>{Vs();ws();Ps=class extends Ho{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ps,"UnitSupportFood");ei(Ps);wA=Ps});var Bs,BR,AR=n(()=>{tm();ws();Bs=class extends ra{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Bs,"UnitSupportProduction");ei(Bs);BR=Bs});var cF,PA,BA=n(()=>{kn();dn();ir();on();Ke();kl();B();I();wR();gn();PR();AR();cF=t((i=ce,e=pt,r=N)=>[new Xe(new m(o=>new IA(i.getByCity(o).size()*2))),...[[je,1,Ei,Ht],[je,2,Tt,nt,at,ft]].map(([o,a,...s])=>new Xe(new l(p=>r.getByCity(p).some(u=>u instanceof o)),new l(p=>e.getByPlayer(p.player()).is(...s)),new m(p=>r.getByCity(p).filter(u=>u instanceof o).map(u=>new wA(a,u))))),new Xe(new l(o=>e.getByPlayer(o.player()).is(Ei,Ht)),new l(o=>{let a=i.getByCity(o);return r.getByCity(o).filter(s=>[Ft,F,We,gr].some(p=>s instanceof p)).length>a.size()}),new m(o=>{let a=i.getByCity(o);return r.getByCity(o).filter(s=>[Ft,F,We,gr].some(p=>s instanceof p)).slice(a.size()).map(s=>new BR(1,s))})),new Xe(new l(o=>e.getByPlayer(o.player()).is(Tt,nt,at,ft)),new m(o=>r.getByCity(o).filter(a=>[Ft,F,We,gr].some(s=>a instanceof s)).map(a=>new BR(1,a))))],"getRules"),PA=cF});var yF,AA,UA=n(()=>{Nl();Jn();ir();tt();V();Dn();Ji();P();gi();Ju();vc();Bu();I();rm();B();yF=t((i=ze,e=Xt,r=ce,o=_,a=ie,s=d,p=Cn,u=w)=>[...[Be,Ye].map(y=>new Wo(new l(c=>i.getByTile(c.tile()).every(f=>!(f instanceof y))),new m(c=>i.register(new y(c.tile()))))),new Wo(new m(y=>e.register(new Ll(y,p,s)))),new Wo(new m(y=>r.register(new _s(y,s)))),new Wo(new m(y=>o.register(y))),new Wo(new m(y=>{u.emit("city:created",y)})),new Wo(new m(y=>os(y,a,r)))],"getRules"),AA=yF});var fF,MA,EA=n(()=>{tt();V();gi();Ke();Ss();I();Dn();fF=t((i=ze,e=_,r=w,o=N)=>[new fr(new m(a=>i.getByTile(a.tile()).filter(s=>s instanceof Be).forEach(s=>i.unregister(s)))),new fr(new m(a=>e.unregister(a))),new fr(new m((a,s)=>{r.emit("city:destroyed",a,s)})),new fr(new m(a=>o.getByCity(a).forEach(s=>s.destroy())))],"getRules"),MA=fF});var Tf,If,UR=n(()=>{M();Tf=class extends x{};t(Tf,"FoodExhausted");If=Tf});var dF,GA,kA=n(()=>{I();UR();dF=t(()=>[new If(new m(i=>i.shrink()))],"getRules"),GA=dF});var gF,DA,OA=n(()=>{P();B();I();xg();UR();gF=t((i=d)=>[new np(new l(e=>e.progress().value()>=e.cost().value()),new m(e=>e.grow())),new np(new l(e=>e.progress().value()<0),new m(e=>{i.process(If,e)}))],"getRules"),DA=gF});var hF,YA,SA=n(()=>{ir();Ji();B();I();hc();rm();hF=t((i=ce,e=ie)=>[new Pn(new m(r=>r.empty())),new Pn(new m(r=>r.cost().set((r.size()+1)*10,"city-grow"))),new Pn(new l(r=>r.city().tilesWorked().length<r.size()+1),new m(r=>os(r.city(),e,i))),new Pn(new l(r=>r.city().tilesWorked().length>r.size()+1),new m(r=>r.city().tilesWorked().entries().slice(r.size()+1).forEach(o=>r.city().tilesWorked().unregister(o))))],"getRules"),YA=hF});var RF,FA,NA=n(()=>{hg();I();RF=t(()=>[new yc(new m(i=>10*(i.size()+1)))],"getRules"),FA=RF});var hn,wf=n(()=>{oa();ws();hn=class extends ia{};t(hn,"Corruption");ei(hn)});var Do,zA,Pf=n(()=>{$e();Do=class extends L{};t(Do,"Happiness");zA=Do});var Wi,LA,Wp=n(()=>{$e();Wi=class extends L{};t(Wi,"Luxuries");LA=Wi});var qt,Bf=n(()=>{$e();qt=class extends L{};t(qt,"Research")});var Ee,As,xl=n(()=>{$e();Ee=class extends L{};t(Ee,"Unhappiness");As=Ee});var Us=n(()=>{is();wf();fc();Wl();Pf();Wp();wR();Bf();oa();xl();PR();AR()});var Af,Fn,km=n(()=>{M();Af=class extends x{};t(Af,"CivilDisorder");Fn=Af});var Uf,Oo,Dm=n(()=>{M();Uf=class extends x{};t(Uf,"ProcessYield");Oo=Uf});var Mf,vl,Ef=n(()=>{M();Mf=class extends x{};t(Mf,"Unsupported");vl=Mf});var xF,WA,jA=n(()=>{Jn();ir();is();Us();P();Ke();km();B();I();Dm();Ef();xF=t((i=Xt,e=ce,r=N,o=d)=>[new Oo(new l(a=>a instanceof $),new m((a,s,p)=>{let u=e.getByCity(s),y=new wn(a);p.forEach(c=>{if(!(c instanceof Ps)||y.value()>=0)return;let f=c.unit();f!==null&&(o.process(vl,s,f,c),y.subtract(c))}),u.add(y),u.check()})),new Oo(new l(a=>a instanceof K),new m((a,s,p)=>{let u=i.getByCity(s),y=a.clone();p.filter(f=>f instanceof Bs).sort((f,g)=>(f.unit()?.tile().distanceFrom(s.tile())??0)-(g.unit()?.tile().distanceFrom(s.tile())??0)).forEach(f=>{if(y.value()>=0)return;let g=f.unit();g!==null&&(o.process(vl,s,g,f),y.subtract(f))});let c=s.yields();o.get(Fn).some(f=>f.validate(s,c))||u.add(y),u.check()}))],"getRules"),WA=xF});var vF,_A,HA=n(()=>{ir();Ji();B();I();vg();rm();vF=t((i=ce,e=ie)=>[new js(new l(r=>r.size()>0),new m(r=>r.cost().set((r.size()+1)*10,"city-shrink"))),new js(new l(r=>r.size()>0),new l(r=>r.city().tilesWorked().length>r.size()+1),new m(r=>r.city().tilesWorked().entries().slice(r.size()+1).forEach(o=>r.city().tilesWorked().unregister(o)))),new js(new l(r=>r.size()>0),new l(r=>r.city().tilesWorked().length<r.size()+1),new m(r=>os(r.city(),e,i))),new js(new l(r=>r.size()<=0),new m(r=>r.city().destroy()))],"getRules"),_A=vF});var Gf,he,cr=n(()=>{Ae();Ce();Gf=class extends O{constructor(){super(Y)}getByCity(e){return this.filter(r=>r.city()===e)}};t(Gf,"CityImprovementRegistry");he=new Gf});var bF,KA,qA=n(()=>{dn();cr();Us();on();I();qn();CR();Sa();Fl();Zi();bF=t((i=he,e=pt)=>[new jo(new Kn,new m((r,o)=>{let a=e.getByPlayer(r.player()),[s]=i.filter(c=>c instanceof QC&&r.player()===c.city().player()).map(c=>c.city()),p=qe(o,se),u=a.is(Tt)?10:a.is(nt)?0:s?s.tile().distanceFrom(r.tile()):32,[y]=[[Ei,8],[Tt,20],[nt,0],[Ht,12],[at,16],[ft,24]].filter(([c])=>a.is(c)).map(([,c])=>c);return new hn(y?Math.min(Math.floor(p*u*3/(10*y)),p):0,u.toFixed(2))})),new jo(new Or(0),new m(r=>r.tilesWorked().entries().flatMap(o=>o.yields(r.player()).flatMap(a=>new a.constructor(a.value(),o.id()+": "+a.values().map(([,s])=>s).join("-"))))))],"getRules"),KA=bF});var CF,VA,$A=n(()=>{yg();Jn();tt();Zn();B();I();CF=t((i=Xt,e=_)=>[new ht(new l(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).some(o=>!o.building())),new m(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).filter(o=>!o.building()).map(o=>new Tn(r,o)))),new ht(new l(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).some(o=>!!o.building())),new m(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).filter(o=>!!o.building()).map(o=>new Ka(r,o))))],"getRules"),VA=CF});var TF,JA,ZA=n(()=>{ir();tt();V();cm();B();Tp();I();TF=t((i=_,e=ce,r=w)=>[new Ko(new l((o,a,s)=>s instanceof ls&&s.to()===o.tile()&&i.getByTile(s.to())!==null),new m(o=>{let a=i.getByTile(o.tile());e.getByCity(a).shrink()})),new Ko(new m((o,a,s)=>r.emit("unit:defeated",o,a,s)))],"getRules"),JA=TF});var IF,QA,XA=n(()=>{I();Ef();IF=t(()=>[new vl(new m((i,e)=>e.destroy()))],"getRules"),QA=IF});var wF={};var eU=n(()=>{bA();TA();BA();UA();EA();kA();OA();SA();NA();jA();HA();qA();P();$A();ZA();XA();d.register(...vA(),...CA(),...PA(),...AA(),...MA(),...GA(),...DA(),...YA(),...FA(),...WA(),..._A(),...KA(),...VA(),...JA(),...QA())});var rU=C(tU=>{"use strict";Object.defineProperty(tU,"__esModule",{value:!0});eU()});var bl,iU=n(()=>{xl();ws();bl=class extends As{#e;constructor(e,r){super(e,r.id()),this.#e=r}cityImprovement(){return this.#e}};t(bl,"CityImprovementContent");ei(bl)});var Om,oU=n(()=>{Pf();Om=class extends zA{};t(Om,"LuxuryHappiness")});var Cl,nU=n(()=>{xl();ws();Cl=class extends As{#e;constructor(e,r){super(e,r.id()),this.#e=r}unit(){return this.#e}};t(Cl,"MartialLaw");ei(Cl)});var ua,aU=n(()=>{xl();ua=class extends As{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(ua,"MilitaryUnhappiness")});var Ym,sU=n(()=>{xl();Ym=class extends As{};t(Ym,"PopulationUnhappiness")});var kf=n(()=>{Bf()});var Sm=n(()=>{iU();Us();Pf();Wp();oU();nU();aU();sU();is();kf();xl()});var Df,Of,MR=n(()=>{M();Df=class extends x{};t(Df,"CelebrateLeader");Of=Df});var PF,lU,mU=n(()=>{ir();Sm();MR();B();Zi();PF=t((i=ce)=>[new Of(new l(e=>i.getByCity(e).size()>2),new l((e,r=e.yields())=>{let[o,a]=na(r,Do,Ee);return a===0&&Math.floor(o)>=i.getByCity(e).size()/2}))],"getRules"),lU=PF});var BF,pU,uU=n(()=>{kn();ir();dn();Sm();on();Ke();Fl();B();I();BF=t((i=ce,e=pt,r=N)=>[new jo(new m(o=>new Ym(Math.max(i.getByCity(o).size()-5,0)))),...[[ft,1],[nt,2]].map(([o,a])=>new jo(new l(s=>{try{return e.getByPlayer(s.player()).is(o)}catch{return!1}}),new l(s=>r.getByCity(s).filter(p=>[Ft,F,We].some(u=>p instanceof u)&&p.tile()!==s.tile()).length>0),new m(s=>r.getByCity(s).filter(p=>[Ft,F,We].some(u=>p instanceof u)&&p.tile()!==s.tile()).map(p=>new ua(a,p)))))],"getRules"),pU=BF});var AF,cU,yU=n(()=>{Sm();km();B();Zi();AF=t(()=>[new Fn(new l((i,e=i.yields())=>{let[r,o]=na(e,Do,Ee);return o>r}))],"getRules"),cU=AF});var Yf,Rn,ER=n(()=>{Zd();Yf=class extends su{validate(...e){return!this.criteria().length||this.criteria().some(r=>r.validate(...e))}};t(Yf,"Or");Rn=Yf});var UF,fU,dU=n(()=>{dn();Gi();ir();Sm();cr();on();He();P();Ke();kl();B();I();kn();Al();qn();lr();ER();Zi();UF=t((i=d,e=ce,r=he,o=pt,a=z,s=N)=>[new Xe(new l(p=>o.getByPlayer(p.player()).is(Ei,Tt,Ht,at)),new m((p,u)=>s.getByTile(p.tile()).filter(y=>y instanceof F).slice(0,Math.min(4,qe(u,Ee))).map(y=>new Cl(1,y)))),...[[Mt,1],[Mt,1,_t],[Zr,3],[pr,4]].map(([p,u,...y])=>new Xe(new Qe,new l(c=>r.getByCity(c).some(f=>f instanceof p)),new Rn(new l(c=>y.length===0),new l(c=>y.every(f=>a.getByPlayer(c.player()).completed(f)))),new l((c,f)=>qe(f,Ee)>0),new m((c,f)=>new bl(Math.min(u,qe(f,Ee)),r.getByCity(c).filter(g=>g instanceof p)[0])))),new Xe(new Fa,new m((p,u)=>new Om(Math.floor(qe(u,Wi)/2),Wi.name)))],"getRules"),fU=UF});var Sf,ca,jp=n(()=>{M();Sf=class extends x{};t(Sf,"TurnStart");ca=Sf});var MF,gU,hU=n(()=>{tt();V();P();MR();km();I();qn();jp();MF=t((i=_,e=d,r=w)=>[new ca(new Qe,new m(o=>i.getByPlayer(o).forEach(a=>{e.get(Fn).some(s=>s.validate(a,a.yields()))&&r.emit("city:civil-disorder",a),e.get(Of).some(s=>s.validate(a,a.yields()))&&r.emit("city:leader-celebration",a)})))],"getRules"),gU=MF});var EF={};var RU=n(()=>{P();mU();uU();yU();dU();hU();d.register(...lU(),...pU(),...cU(),...fU(),...gU())});var vU=C(xU=>{"use strict";Object.defineProperty(xU,"__esModule",{value:!0});RU()});var GF={};var bU=n(()=>{Gi();Nl();Cn.register($r,mr,Jr,pr,fo,Zr,Tr,Kt,Qr,It,Ir,wr,ur,go,wt,dt,Pt,ho,Ro,Mt,Pr)});var kF,CU,TU=n(()=>{Gi();lr();Xm();cr();He();B();I();kF=t((i=he,e=z)=>[new Qt(new m((r,o)=>new l(()=>!i.getByCity(r).some(a=>a instanceof o)))),...[[$r,Lr],[fo,Wt],[Zr,Lr],[Tr,hr],[Qr,cn],[Ir,Cr],[ur,Ii],[dt,Wt],[Mt,Ci],[mr,bi],[pr,Ct],[Kt,bt],[It,ct],[go,jt],[wr,Vr],[wt,so],[Pt,Ai],[ho,yn],[Ro,co],[Pr,sr]].map(([r,o])=>new Qt(new l((a,s)=>s===r),new m(a=>new l(()=>e.getByPlayer(a.player()).completed(o))))),...[[mr,ur],[Pr,Ir],[It,Kt],[wt,Kt],[Pt,Kt],[wr,It,wt,Pt]].map(([r,...o])=>new Qt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByCity(a).some(s=>o.some(p=>s instanceof p)))))),...[[Tr,dt],[It,wt,Pt],[wt,Pt,It],[Pt,It,wt]].map(([r,...o])=>new Qt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByCity(a).every(s=>!o.some(p=>s instanceof p))))))],"getRules"),CU=kF});var DF,IU,wU=n(()=>{Gi();tp();DF=t(()=>[...[[$r,120],[Jr,40],[fo,120],[Zr,100],[Tr,80],[Qr,60],[Ir,80],[ur,80],[dt,200],[Mt,40],[mr,120],[pr,160],[Kt,200],[It,240],[go,160],[wr,320],[wt,160],[Pt,160],[ho,200],[Ro,200],[Pr,160]].flatMap(([i,e])=>zl(i,e))],"getRules"),IU=DF});var OF,PU,BU=n(()=>{cr();Ys();I();Gi();OF=t((i=he)=>[new yr(new m(e=>{let[r]=i.getByCity(e).filter(o=>o instanceof dt);!r||i.unregister(r)}))],"getRules"),PU=OF});var pe,GR=n(()=>{Wl();ws();pe=class extends rc{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("cityImprovement")}cityImprovement(){return this.#e}};t(pe,"CityImprovementMaintenanceGold");ei(pe)});var Ff=n(()=>{Us();GR();wf();fc();Wp();kf();oa()});var YF,AU,UU=n(()=>{Gi();lr();cr();He();Ff();kl();B();I();YF=t((i=he,e=z)=>[...[[$r,pe,2],[mr,pe,3],[pr,pe,3],[fo,pe,2],[Zr,pe,2],[Tr,pe,1],[Kt,pe,4],[Qr,pe,1],[It,pe,4],[Ir,pe,1],[wr,pe,6],[ur,pe,1],[go,pe,4],[wt,pe,2],[dt,pe,0],[Pt,pe,4],[ho,pe,2],[Ro,pe,4],[Mt,pe,1],[Pr,pe,3]].map(([r,o,a])=>new Xe(new l(s=>i.getByCity(s).some(p=>p instanceof r)),new m(s=>{let[p]=i.getByCity(s).filter(u=>u instanceof r);return new o(a,p)}))),...[[Jr,pe,0,null,yt],[Jr,pe,1,yt,ut],[Jr,pe,2,ut,null]].map(([r,o,a,s,p])=>new Xe(new l(u=>i.getByCity(u).some(y=>y instanceof r)),new l(u=>s===null||e.getByPlayer(u.player()).completed(s)),new l(u=>p===null||!e.getByPlayer(u.player()).completed(p)),new m(u=>{let[y]=i.getByCity(u).filter(c=>c instanceof r);return new o(a,y)})))],"getRules"),AU=YF});var SF,MU,EU=n(()=>{cr();tt();P();Bu();B();I();Gi();SF=t((i=_,e=he,r=d)=>[new Wo(new l(o=>i.getByPlayer(o.player()).length===0),new m(o=>e.register(new dt(o,r))))],"getRules"),MU=SF});var FF,GU,kU=n(()=>{cr();B();Ss();I();FF=t((i=he)=>[new fr(new l(e=>i.getByCity(e).length>0),new m(e=>i.getByCity(e).forEach(r=>i.unregister(r))))],"getRules"),GU=FF});var NF,DU,OU=n(()=>{Gi();cr();B();I();Ff();hc();NF=t((i=he)=>[new Pn(new l(e=>!i.getByCity(e.city()).some(r=>r instanceof $r)),new l(e=>e.size()>10),new m(e=>e.shrink())),new Pn(new l(e=>i.getByCity(e.city()).some(r=>r instanceof Qr)),new m(e=>e.add(new wn(e.cost().value()/2))))],"getRules"),DU=NF});var zF,YU,SU=n(()=>{cr();V();bg();I();zF=t((i=he,e=w)=>[new ap(new m(r=>i.register(r))),new ap(new m((r,o)=>{e.emit("city-improvement:created",r,o)}))],"getRules"),YU=zF});var LF,FU,NU=n(()=>{Gi();cr();Ff();B();I();Xd();Fu();Zi();LF=t((i=he)=>[...[[ur,er,.5],[ur,Wi,.5],[mr,er,.5],[mr,Wi,.5],[Ir,qt,.5],[Pr,qt,.5],[Kt,K,.5],[Pt,K,.5],[It,K,.5],[wt,K,.5],[wr,K,.5],[Tr,hn,.5]].map(([e,r,o])=>new Fs(new nx,new l(a=>i.getByCity(a).some(s=>s instanceof e)),new m((a,s)=>new r(Math.floor(qe(s,r)*o),e.name))))],"getRules"),FU=LF});var WF,zU,LU=n(()=>{cr();sa();Gi();qc();B();I();Ep();WF=t((i=he,e=nr)=>[new Qn(new l(r=>r.city()!==null),new l(r=>i.getByCity(r.city()).some(o=>o instanceof Jr)),new m(r=>e.register(new ma(r))))],"getRules"),zU=WF});var jF={};var WU=n(()=>{P();TU();wU();BU();UU();EU();kU();OU();SU();NU();LU();d.register(...CU(),...IU(),...PU(),...AU(),...MU(),...GU(),...DU(),...YU(),...FU(),...zU())});var _U=C(jU=>{"use strict";Object.defineProperty(jU,"__esModule",{value:!0});bU();WU()});var KU={};Zp(KU,{default:()=>_F,registerCityNames:()=>HU});var HU,_F,qU=n(()=>{Dt();gt();HU=t((i=J)=>{["Bergen","Cannae","Capua","Cordoba","Cremona","Crete","Cunaxa","Damascus","Dublin","Genoa","Ghent","Issus","Lisbon","Mecca","Melbourne","Milan","Naples","Pisa","Prague","Salamis","Salzburg","Seville","Sidon","Sydney","Tarsus","Toronto","Turin","Tyre","Utica","Venice","Verona"].forEach(e=>i.register(new Q(e,null)))},"registerCityNames"),_F=HU});var VU=n(()=>{Rm();Gp();kp();Dp();Op();Tm();Yp();wm();Sp();Fp();Np();zp();Mm();Lp()});var Nf,zf,kR=n(()=>{Ki();Ot();Nf=class extends De{constructor(){super(ae)}};t(Nf,"CivilizationRegistry");zf=new Nf});var JU={};Zp(JU,{default:()=>HF,registerCivilizations:()=>$U});var $U,HF,ZU=n(()=>{VU();kR();$U=t((i=zf)=>{i.register(tl,il,ol,nl,al,sl,ml,pl,cl,yl,fl,dl,gl,Rl)},"registerCivilizations"),HF=$U});var ya,QU=n(()=>{st();Rm();ya=class extends ee{static civilization(){return rl}name(){return"Abraham Lincoln"}};t(ya,"AbrahamLincoln")});var XU=n(()=>{st();Rm()});var eM=n(()=>{QU();XU()});var fa,tM=n(()=>{st();Gp();fa=class extends ee{static civilization(){return xm}name(){return"Moctezuma II"}};t(fa,"MoctezumaII")});var rM=n(()=>{tM()});var da,iM=n(()=>{st();kp();da=class extends ee{static civilization(){return vm}name(){return"Hammurabi"}};t(da,"Hammurabi")});var oM=n(()=>{iM()});var ga,nM=n(()=>{st();Dp();ga=class extends ee{static civilization(){return bm}name(){return"Mao Zedong"}};t(ga,"MaoZedong")});var aM=n(()=>{nM()});var ha,sM=n(()=>{st();Op();ha=class extends ee{static civilization(){return Cm}name(){return"Ramesses II"}};t(ha,"RamessesII")});var lM=n(()=>{sM()});var Ra,mM=n(()=>{st();Tm();Ra=class extends ee{static civilization(){return ll}name(){return"Elizabeth I"}};t(Ra,"ElizabethI")});var pM=n(()=>{st();Tm()});var uM=n(()=>{mM();pM()});var xa,cM=n(()=>{st();Yp();xa=class extends ee{static civilization(){return Im}name(){return"Napoleon I"}};t(xa,"NapoleonI")});var yM=n(()=>{cM()});var va,fM=n(()=>{st();wm();va=class extends ee{static civilization(){return ul}name(){return"Frederick the Great"}};t(va,"FrederickTheGreat")});var dM=n(()=>{st();wm()});var gM=n(()=>{fM();dM()});var ba,hM=n(()=>{st();Sp();ba=class extends ee{static civilization(){return Pm}name(){return"Alexander the Great"}};t(ba,"AlexanderTheGreat")});var RM=n(()=>{hM()});var Ca,xM=n(()=>{st();Fp();Ca=class extends ee{static civilization(){return Bm}name(){return"Mahatma Gandhi"}};t(Ca,"MahatmaGandhi")});var vM=n(()=>{xM()});var Ta,bM=n(()=>{st();Np();Ta=class extends ee{static civilization(){return Am}name(){return"Genghis Khan"}};t(Ta,"GenghisKhan")});var CM=n(()=>{bM()});var Ia,TM=n(()=>{st();zp();Ia=class extends ee{static civilization(){return Um}name(){return"Julius Caesar"}};t(Ia,"JuliusCaesar")});var IM=n(()=>{TM()});var wM=n(()=>{st();Mm()});var wa,PM=n(()=>{st();Mm();wa=class extends ee{static civilization(){return hl}name(){return"Joseph Stalin"}};t(wa,"JosephStalin")});var BM=n(()=>{wM();PM()});var Pa,AM=n(()=>{st();Lp();Pa=class extends ee{static civilization(){return Em}name(){return"Shaka"}};t(Pa,"Shaka")});var UM=n(()=>{AM()});var DR=n(()=>{eM();rM();oM();aM();lM();uM();yM();gM();RM();vM();CM();IM();BM();UM()});var EM={};Zp(EM,{default:()=>KF,registerLeaders:()=>MM});var MM,KF,GM=n(()=>{DR();jl();MM=t((i=In)=>{i.register(ya,fa,da,ga,ha,Ra,xa,va,ba,Ca,Ta,Ia,wa,Pa)},"registerLeaders"),KF=MM});var Lf,Fm,Wf=n(()=>{ip();Lf=class extends Va{};t(Lf,"Aggression");Fm=Lf});var jf,Nm,kM=n(()=>{Wf();jf=class extends Fm{constructor(e){super(e,1)}};t(jf,"Aggressive");Nm=jf});var _f,zm,Hf=n(()=>{ip();_f=class extends Va{};t(_f,"Militarism");zm=_f});var Kf,Ba,DM=n(()=>{Hf();Kf=class extends zm{constructor(e){super(e,0)}};t(Kf,"Civilized");Ba=Kf});var qf,Lm,Vf=n(()=>{ip();qf=class extends Va{};t(qf,"Development");Lm=qf});var $f,Wm,OM=n(()=>{Vf();$f=class extends Lm{constructor(e){super(e,1)}};t($f,"Expansionist");Wm=$f});var Jf,Zf,YM=n(()=>{Wf();Jf=class extends Fm{constructor(e){super(e,0)}};t(Jf,"Friendly");Zf=Jf});var Qf,Xf,SM=n(()=>{Hf();Qf=class extends zm{constructor(e){super(e,1)}};t(Qf,"Militaristic");Xf=Qf});var ed,Tl,FM=n(()=>{Wf();ed=class extends Fm{constructor(e){super(e,.5)}};t(ed,"Normal");Tl=ed});var td,jm,NM=n(()=>{Vf();td=class extends Lm{constructor(e){super(e,.5)}};t(td,"Normal");jm=td});var rd,id,zM=n(()=>{Hf();rd=class extends zm{constructor(e){super(e,.5)}};t(rd,"Normal");id=rd});var od,_p,LM=n(()=>{Vf();od=class extends Lm{constructor(e){super(e,0)}};t(od,"Perfectionist");_p=od});var jM={};Zp(jM,{default:()=>qF,registerTraits:()=>WM});var WM,qF,_M=n(()=>{DR();fg();kM();DM();OM();YM();SM();FM();NM();zM();LM();WM=t((i=lc)=>{[[ya,Zf,jm,Ba],[fa,Tl,_p,Ba],[da,Zf,_p,Ba],[ga,Tl,jm,Ba],[ha,Tl,jm,Ba],[Ra,Tl,Wm,id],[xa,Nm,Wm,Ba],[va,Nm,_p,Ba],[ba,Tl,Wm,Xf],[Ca,Zf,_p,id],[Ta,Nm,Wm,Xf],[Ia,Tl,Wm,Ba],[wa,Nm,jm,Xf],[Pa,Nm,jm,id]].forEach(([e,...r])=>r.forEach(o=>i.register(new o(e))))},"registerTraits"),qF=WM});var KM=C(HM=>{"use strict";Object.defineProperty(HM,"__esModule",{value:!0});var VF=(qU(),R(KU)),$F=(ZU(),R(JU)),JF=(GM(),R(EM)),ZF=(_M(),R(jM));(0,VF.default)();(0,$F.default)();(0,JF.default)();(0,ZF.default)()});var nd,ad,OR=n(()=>{nd=class{#e=[];constructor(...e){this.#e.push(...e)}isBetween(...e){return e.every(r=>this.#e.includes(r))&&e.length===this.#e.length}players(){return this.#e}};t(nd,"Interaction");ad=nd});var sd,qM,VM=n(()=>{Ce();OR();sd=class extends O{constructor(){super(ad)}getByPlayer(e){return this.entries().filter(r=>r.players().includes(e))}getByPlayers(...e){return this.entries().filter(r=>r.isBetween(...e))}};t(sd,"InteractionRegistry");qM=new sd});var _m,$M=n(()=>{OR();_m=class extends ad{constructor(...e){let r=e.map(o=>o.player());super(...r)}};t(_m,"Contact")});var JM=n(()=>{$M()});var QF,ZM,QM=n(()=>{VM();Ke();JM();B();I();Ut();QF=t((i=qM,e=N)=>[new q(new l(r=>r.tile().getNeighbours().some(o=>e.getByTile(o).some(a=>a.player()!==r.player()))),new m(r=>r.tile().getNeighbours().forEach(o=>e.getByTile(o).filter(a=>a.player()!==r.player()).forEach(a=>i.register(new _m(r,a))))))],"getRules"),ZM=QF});var XF={};var XM=n(()=>{P();QM();d.register(...ZM())});var tE=C(eE=>{"use strict";Object.defineProperty(eE,"__esModule",{value:!0});XM()});var eN,rE,iE=n(()=>{B();I();Yg();eN=t(()=>[new rs(new l(i=>i<252),new m(i=>i*20-4020)),new rs(new l(i=>i>251),new l(i=>i<302),new m(i=>(i-151)*10+1e3)),new rs(new l(i=>i>301),new l(i=>i<352),new m(i=>(i-201)*5+1500)),new rs(new l(i=>i>351),new l(i=>i<402),new m(i=>(i-251)*2+1750)),new rs(new l(i=>i>401),new m(i=>i-301+1850))],"getRules"),rE=eN});var tN={};var oE=n(()=>{P();iE();d.register(...rE())});var aE=C(nE=>{"use strict";Object.defineProperty(nE,"__esModule",{value:!0});oE()});var rN,sE,lE=n(()=>{cg();tt();Jo();He();eh();B();I();Vs();tm();oa();rN=t((i=z,e=_)=>[new Xs(new l((r,o)=>i.getByPlayer(o.player()).available().length>0),new m((r,o)=>new La(r,o))),new Xs(new l(r=>[be,me,oe].some(o=>r.tile().terrain()instanceof o)),new l((r,o)=>r.tile().getSurroundingArea().score(null,[[Ho,8],[ra,3],[ia,1]])>=150),new l(r=>r.tile().getSurroundingArea(4).every(o=>e.getByTile(o)===null)),new m((r,o)=>new Wa(r,o))),new Xs(new m((r,o)=>new _a(r,o))),new Xs(new m((r,o)=>new Ha(r,o)))],"getRules"),sE=rN});var iN,mE,pE=n(()=>{V();th();I();iN=t((i=w)=>[new Xy(new m((e,r)=>{i.emit("goody-hut:action-performed",e,r)}))],"getRules"),mE=iN});var oN,uE,cE=n(()=>{V();Cs();rh();I();oN=t((i=Yr,e=w,r=()=>Math.random())=>[new dm(new m(o=>i.unregister(o))),new dm(new m((o,a)=>{let s=o.actions(a),p=s[Math.floor(s.length*r())];o.action(p)})),new dm(new m((o,a)=>{e.emit("goody-hut:discovered",o,a)}))],"getRules"),uE=oN});var ld,Hm,YR=n(()=>{M();ld=class extends x{};t(ld,"Distribution");Hm=ld});var nN,yE,fE=n(()=>{Cs();B();YR();nN=t((i=Yr,e=()=>Math.random())=>[new Hm(new l(r=>r.isLand())),new Hm(new l(r=>r.getSurroundingArea(3).every(o=>i.getByTile(o)===null))),new Hm(new l(()=>e()<.05))],"getRules"),yE=nN});var aN,dE,gE=n(()=>{Cs();gn();P();I();ug();aN=t((i=Yr,e=()=>Math.random(),r=d)=>[new oc(new m((o,a)=>{let s=[Br,Ar],p=s[Math.floor(s.length*e())];return new p(null,a.player(),a.tile(),r)}))],"getRules"),dE=aN});var sN,hE,RE=n(()=>{Cs();B();I();Ut();sN=t((i=Yr)=>[new q(new l(e=>i.getByTile(e.tile())!==null),new m(e=>{i.getByTile(e.tile()).process(e)}))],"getRules"),hE=sN});var md,Ms,pd=n(()=>{M();md=class extends x{};t(md,"Built");Ms=md});var lN,xE,vE=n(()=>{Cs();P();pd();I();ih();YR();lN=t((i=Yr,e=d)=>[new Ms(new m(r=>{let o=e.get(Hm);r.forEach(a=>{o.every(s=>s.validate(a))&&i.register(new rf(a))})}))],"getRules"),xE=lN});var mN={};var bE=n(()=>{lE();pE();cE();fE();gE();P();RE();vE();d.register(...sE(),...mE(),...uE(),...yE(),...dE(),...hE(),...xE())});var TE=C(CE=>{"use strict";Object.defineProperty(CE,"__esModule",{value:!0});bE()});var pN={};var IE=n(()=>{dn();pf();gm.register(Tt,nt,Ht,at,ft)});var uN,wE,PE=n(()=>{on();dn();B();I();Pg();Zn();uN=t((i=pt)=>[new ht(new l(e=>!i.getByPlayer(e).is(Ei)),new m(e=>[new Qa(e,i.getByPlayer(e))]))],"getRules"),wE=uN});var cN,BE,AE=n(()=>{pf();on();P();Ks();dn();I();Al();sh();cN=t((i=gm,e=pt,r=d)=>[new li(new Fa,new m(o=>{let a=new ff(o,i,r);a.set(new Ht),e.register(a)}))],"getRules"),BE=cN});var yN,UE,ME=n(()=>{lr();dn();He();nh();B();yN=t((i=z)=>[new Up(new l(e=>e===Ht)),...[[Tt,vt],[nt,no],[at,_r],[ft,Ui]].map(([e,r])=>new Up(new l(o=>o===e),new l((o,a)=>i.getByPlayer(a).completed(r))))],"getRules"),UE=yN});var fN,EE,GE=n(()=>{V();Ji();ah();B();I();fN=t((i=w,e=ie)=>[new Mp(new m((r,o)=>{i.emit("player:government:changed",r,o)})),new Mp(new l(r=>{try{return e.getByPlayer(r),!0}catch(o){if(o instanceof TypeError&&o.message.match(/Wrong number of player worlds exist/))return!1;throw o}}),new m(r=>{e.getByPlayer(r).entries().forEach(a=>a.tile().clearYieldCache(r))}))],"getRules"),EE=fN});var dN={};var kE=n(()=>{P();PE();AE();ME();GE();d.register(...wE(),...BE(),...UE(),...EE())});var OE=C(DE=>{"use strict";Object.defineProperty(DE,"__esModule",{value:!0});IE();kE()});var ud,YE,SE=n(()=>{M();ud=class extends x{};t(ud,"TurnEnd");YE=ud});var gN,FE,NE=n(()=>{bp();V();P();SE();gN=t((i=ta,e=d,r=w)=>[["player:turn-end",o=>{i.unregister(o),e.process(YE,o);let[a]=i.entries();if(!a){r.emit("turn:end");return}r.emit("player:turn-start",a)}]],"getEvents"),FE=gN});var hN,zE,LE=n(()=>{el();V();P();jp();hN=t((i=ko,e=w,r=d)=>[["player:turn-start",o=>{r.process(ca,o),i.getByPlayer(o).takeTurn().catch(s=>console.error(s)).finally(()=>{e.emit("player:turn-end",o)})}]],"getEvents"),zE=hN});var RN,WE,jE=n(()=>{bp();V();ts();RN=t((i=ui,e=ta,r=w)=>[["turn:start",()=>{e.register(...i.entries());let[o]=e.entries();r.emit("player:turn-start",o)}]],"getEvents"),WE=RN});var xN={};var _E=n(()=>{V();NE();LE();jE();[...FE(),...zE(),...WE()].forEach(([i,e])=>w.on(i,e))});var cd,Nn,Hp=n(()=>{M();cd=class extends x{};t(cd,"Defeated");Nn=cd});var vN,HE,KE=n(()=>{tt();P();Ys();B();Hp();I();vN=t((i=_,e=d)=>[new yr(new l((r,o,a)=>i.getByPlayer(a).filter(s=>s!==r).length===0),new m((r,o,a)=>{e.process(Nn,a,o)}))],"getRules"),HE=vN});var bN,qE,VE=n(()=>{tt();P();B();Hp();Ss();I();bN=t((i=_,e=d)=>[new fr(new l((r,o)=>i.getByPlayer(r.player()).filter(a=>a!==r).length===0),new m((r,o)=>e.process(Nn,r.player(),o)))],"getRules"),qE=bN});var SR,CN,$E,JE=n(()=>{Zn();B();I();Uc();Sa();SR=new ht(new Or(9001),new l(i=>{SR.disable();let e=i.mandatoryActions();return SR.enable(),e.length===0}),new m(i=>[new Ac(i,null)])),CN=t(()=>[SR],"getRules"),$E=CN});var TN,ZE,QE=n(()=>{V();Ks();I();TN=t((i=w)=>[new li(new m(e=>{i.emit("player:added",e)}))],"getRules"),ZE=TN});var IN,XE,e0=n(()=>{bp();V();ts();B();Hp();I();IN=t((i=ta,e=ui,r=w)=>[new Nn(new l(o=>i.includes(o)),new m(o=>i.unregister(o))),new Nn(new l(o=>e.includes(o)),new m(o=>e.unregister(o))),new Nn(new m((o,a)=>{r.emit("player:defeated",o,a)}))],"getRules"),XE=IN});var wN,t0,r0=n(()=>{tt();P();Ke();I();Vs();Al();Dm();tm();oa();jp();Zi();wN=t((i=d,e=_,r=N)=>[new ca(new Fa,new m(o=>{e.getByPlayer(o).forEach(a=>{let s=a.yields();na(s,Ho,ra,ia).reduce((p,u,y)=>(p[y].set(u,"Consolidated"),p),[new Ho(0,"Consolidated"),new ra(0,"Consolidated"),new ia(0,"Consolidated")]).forEach(p=>i.process(Oo,p,a,s))})})),new ca(new m(o=>r.getByPlayer(o).forEach(a=>{a.moves().set(a.movement());let s=a.busy();if(!s){a.setActive(),a.setWaiting(!1);return}!s.validate()||s.process()})))],"getRules"),t0=wN});var PN,i0,o0=n(()=>{V();I();wg();PN=t((i=w)=>[new Fc(new m((e,r)=>{i.emit("player:visibility-changed",e,r)}))],"getRules"),i0=PN});var BN,n0,a0=n(()=>{ts();Ji();xy();I();BN=t((i=ui,e=ie)=>[new aa(new m(r=>{r.clearYieldCache(null),i.forEach(o=>{e.getByPlayer(o).getByTile(r)!==null&&r.clearYieldCache(o)})}))],"getRules"),n0=BN});var AN,s0,l0=n(()=>{tt();P();B();Hp();$c();I();AN=t((i=_,e=d)=>[new Xn(new l((r,o)=>i.getByPlayer(r.player()).length===0),new m((r,o)=>e.process(Nn,r.player(),o)))],"getRules"),s0=AN});var UN,m0,p0=n(()=>{Ji();I();Eg();UN=t((i=ie)=>[new Zc(new m((e,r)=>{e.clearYieldCache(r);let o=i.getByPlayer(r);o.register(e),o.getByTile(e).update()}))],"getRules"),m0=UN});var MN,u0,c0=n(()=>{kR();el();V();ts();Ji();P();pd();I();Vs();Bp();My();zc();tm();Jg();TR();oa();MN=t((i=zf,e=ko,r=w,o=ui,a=ie,s=d,p=()=>Math.random())=>[new Ms(new m(u=>o.entries().forEach(y=>a.register(new Kl(y,u))))),new Ms(new m(u=>{let y=new Map,c=new Map,f=t((U,j=null)=>(y.has(U)||y.set(U,U.score(j,[[Ho,8],[ra,3],[ia,1]])),y.get(U)),"tileScore"),g=t((U,j=null)=>(c.has(U)||c.set(U,U.getSurroundingArea().entries().reduce((Re,Se)=>Re+f(Se,j),0)),c.get(U)),"areaScore");r.emit("world:generate-start-tiles");let G=r.option("players",5),k=[],D=u.entries().filter(U=>[am,Uy,Zv].some(j=>U.terrain()instanceof j)).map(U=>({tile:U,score:g(U)})).sort(({score:U},{score:j})=>j-U).map(({tile:U})=>U);r.emit("world:start-tiles",D),e.entries().reduce((U,j)=>U.then(async()=>{let Re=j.player();await j.chooseCivilization(i.entries()),i.unregister(Re.civilization().sourceClass()),D.filter(At=>k.some(Ga=>Ga.distanceFrom(At)<=4)).forEach(At=>D.splice(D.indexOf(At),1));let Se=D[Math.floor(D.length*p())];if(!Se)throw new TypeError("Not enough `startingSquare`s.");k.push(Se),new wT(null,Re,Se,s)}),Promise.resolve()).then(()=>r.emit("game:start"))})),new Ms(new m(u=>{r.emit("world:built",u)}))],"getRules"),u0=MN});var EN={};var y0=n(()=>{KE();VE();P();JE();QE();e0();r0();o0();a0();l0();p0();c0();d.register(...HE(),...qE(),...$E(),...ZE(),...XE(),...t0(),...i0(),...n0(),...s0(),...m0(),...u0())});var d0=C(f0=>{"use strict";Object.defineProperty(f0,"__esModule",{value:!0});_E();y0()});var GN={};var g0=n(()=>{lr();A();h.register(xi,to,vi,On,ut,bi,ro,Fr,Ci,nn,io,hr,Nr,vt,Ti,zr,Lr,oo,Ii,no,Rr,ct,an,sn,Yn,ao,pa,ln,yt,mn,bt,xr,wi,pn,vr,Lt,Wr,Wt,jt,br,Pi,jr,_r,_t,ar,Hr,so,Kr,Bi,un,cn,qr,yn,Ai,Ct,Vr,lo,mo,po,uo,co,Ui,fn,yo,Mi,sr,Cr)});var h0=n(()=>{gg()});var kN,R0,x0=n(()=>{He();Zn();h0();B();I();kN=t((i=z)=>[new ht(new l(e=>i.getByPlayer(e).researching()===null),new l(e=>i.getByPlayer(e).available().length>0),new m(e=>[new Ws(e,i.getByPlayer(e))]))],"getRules"),R0=kN});var DN,v0,b0=n(()=>{A();He();P();Ks();I();Cu();DN=t((i=h,e=z,r=d,o=()=>Math.random())=>[new li(new m(a=>e.register(new Ml(a,i,r)))),new li(new m(a=>{let s=e.getByPlayer(a);for(let p=0,u=Math.min(s.available().length,Math.floor(4*o()));p<u;p++){let y=s.available();s.addAdvance(y[Math.floor(o()*y.length)])}}))],"getRules"),v0=DN});var ON,C0,T0=n(()=>{He();Ys();I();B();ON=t((i=z,e=()=>Math.random())=>[new yr(new l((r,o,a)=>i.getByPlayer(a).complete().some(s=>!i.getByPlayer(o).completed(s.constructor))),new m((r,o,a)=>{let s=i.getByPlayer(o),p=i.getByPlayer(a).complete().filter(u=>!s.completed(u.constructor));s.addAdvance(p.map(u=>u.constructor)[Math.floor(e()*p.length)])}))],"getRules"),C0=ON});var YN,I0,w0=n(()=>{V();fu();I();YN=t((i=w)=>[new Na(new m((e,r)=>{i.emit("player:research-complete",e,r)}))],"getRules"),I0=YN});var SN,P0,B0=n(()=>{eg();I();SN=t(()=>[new gu(new m((i,e)=>(e.complete().length+1)*(6+2*0)))],"getRules"),P0=SN});var FN,A0,U0=n(()=>{km();He();P();B();I();Dm();kf();FN=t((i=z,e=d)=>[new Oo(new l(r=>r instanceof qt),new l((r,o,a)=>!e.get(Fn).some(s=>s.validate(o,a))),new m((r,o)=>i.getByPlayer(o.player()).add(r)))],"getRules"),A0=FN});var NN,M0,E0=n(()=>{lr();B();I();tg();NN=t(()=>[...[[xi,ao,Rr],[vi,br,_t],[On,yo,Bi],[ut,Nr,uo],[bi,Ui,Mi],[ro,Lr,wi],[nn,sr,Pi],[io,Yn,mn],[hr,to],[Nr,Ai,sn],[vt,Kr,bt],[Ti,ct,br],[zr,sn,Ui],[Lr,Ii,Wt],[oo,bi,bt],[Ii,Fr],[no,Kr,vr],[Rr,jr,Lt],[ct,an,Rr],[an,Lr,fn],[sn,yt,nn],[Yn,Wt,_r],[ao,Nr,Bi],[pa,so,co],[ln,oo,Pi],[yt,xr,wi],[bt,qr,bi],[xr,an,vr],[wi,Fr],[pn,jt,vt],[vr,hr,Cr],[Lt,ar,Bi],[Wr,to],[jt,oo,ut],[br,to,Wt],[Pi,Kr,Mi],[jr,yt,sr],[_r,hr,_t],[_t,Ci],[ar,vi,Wr],[Hr,jt,On],[so,Hr,ct],[Kr,_t,vr],[Bi,ar,br],[un,Ai,mo],[qr,ro,po],[yn,no,jt],[Ai,oo,nn],[Ct,Kr,Cr],[Vr,Ti,un],[lo,ct,xi],[mo,Ti,lo],[po,xr,Bi],[uo,jr,bt],[co,jt,un],[Ui,hr,vr],[yo,vi,sr],[Mi,hr,Ii],[sr,Kr,br],[Cr,to]].map(([i,...e])=>new Ru(new l(r=>r===i),new m((r,o)=>e.every(a=>o.some(s=>s instanceof a)))))],"getRules"),M0=NN});var zN,G0,k0=n(()=>{V();I();rg();zN=t((i=w)=>[new vu(new m((e,r)=>{i.emit("player:research",e,r)}))],"getRules"),G0=zN});var LN={};var D0=n(()=>{x0();b0();T0();w0();B0();P();U0();E0();k0();d.register(...R0(),...v0(),...C0(),...I0(),...P0(),...A0(),...M0(),...G0())});var Y0=C(O0=>{"use strict";Object.defineProperty(O0,"__esModule",{value:!0});g0();D0()});var yd,Es,Kp=n(()=>{$e();yd=class extends L{};t(yd,"TradeRate");Es=yd});var Aa,S0=n(()=>{Wp();Kp();Aa=class extends Es{};t(Aa,"Luxuries"),Aa.tradeYield=LA});var Ua,F0=n(()=>{Bf();Kp();Ua=class extends Es{};t(Ua,"Research"),Ua.tradeYield=qt});var Ma,N0=n(()=>{Wl();Kp();Ma=class extends Es{};t(Ma,"Tax"),Ma.tradeYield=rc});var FR=n(()=>{S0();F0();N0()});var fd,Gs,qp=n(()=>{Ki();Kp();fd=class extends De{constructor(){super(Es)}};t(fd,"AvailableTradeRateRegistry");Gs=new fd});var WN={};var z0=n(()=>{FR();qp();Gs.register(Aa,Ua,Ma)});var L0=n(()=>{wf();oa()});var dd,gd,NR=n(()=>{Z();dd=class extends Fe{#e=100;#t;#r=[];constructor(e,...r){super(),this.#t=e,this.#r=r,this.addKey("all")}all(){return[...this.#r]}balance(e){if(this.total()===1)return;let r=1-e.value(),o=this.#r.filter(s=>s!==e),a=o.reduce((s,p)=>s+p.value(),0);o.forEach(s=>s.set(s.value()/a*r)),this.total()<1&&o[Math.floor(o.length*Math.random())].add(1-this.total()),this.total()>1&&o[Math.floor(o.length*Math.random())].subtract(1-this.total())}get(e){let[r]=this.#r.filter(o=>o instanceof e);return r}player(){return this.#t}set(e,r){let o=this.get(e);o.set(r),this.balance(o)}setAll(e){if(e.reduce((r,[,o])=>r+o,0)!==1)throw new TypeError("Invalid rates provided, must sum to 1.");e.forEach(([r,o])=>this.get(r).set(o))}total(){return Math.round(this.#r.reduce((e,r)=>e+r.value(),0)*this.#e)/this.#e}};t(dd,"PlayerTradeRates");gd=dd});var hd,ks,Vp=n(()=>{Ce();NR();hd=class extends O{constructor(){super(gd)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTradeRates for player");return r[0]}};t(hd,"PlayerTradeRatesRegistry");ks=new hd});var jN,W0,j0=n(()=>{qp();L0();Vp();I();Fl();Zi();jN=t((i=Gs,e=ks)=>[new Sl(new m((r,o)=>{let a=e.getByPlayer(r.player()),s=Math.max(0,qe(o,se)),p=s;return i.entries().map(u=>{let y=u.tradeYield,c=Math.min(Math.ceil(s*a.get(u).value()),p);return p-=c,new y(c,u.name)})}))],"getRules"),W0=jN});var _N,_0,H0=n(()=>{Vp();Zn();dg();I();_N=t((i=ks)=>[new ht(new m(e=>[new $a(e,i.getByPlayer(e))]))],"getRules"),_0=_N});var HN,K0,q0=n(()=>{qp();Vp();FR();Ks();I();NR();HN=t((i=Gs,e=ks)=>[new li(new m(r=>{let o=[new Ma(.5),new Ua(.5),new Aa(0)],a=i.entries(),s=new gd(r,...a.map(p=>{let[u]=o.filter(y=>y instanceof p);return new p(u||0)}));e.register(s)}))],"getRules"),K0=HN});var Rd,KN,V0,$0=n(()=>{qp();tt();P();I();Al();Dm();jp();Zi();Rd=[],KN=t((i=d,e=_,r=Gs)=>[new ca(new Fa,new m(o=>{Rd.length===0&&r.entries().forEach(a=>Rd.push(a.tradeYield)),e.getByPlayer(o).forEach(a=>{let s=a.yields();na(s,...Rd).reduce((p,u,y)=>(p[y].set(u,"Consolidated"),p),Rd.map(p=>new p)).forEach(p=>i.process(Oo,p,a,s))})}))],"getRules"),V0=KN});var qN={};var J0=n(()=>{P();j0();H0();q0();$0();d.register(...W0(),..._0(),...K0(),...V0())});var Q0=C(Z0=>{"use strict";Object.defineProperty(Z0,"__esModule",{value:!0});z0();J0()});var VN,X0,eG=n(()=>{Ae();B();I();mg();ea();VN=t(()=>[new zs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(we,i.building().item())),new l(i=>i.progress().value()===0),new m((i,e)=>{let r=i.remaining()/10;return e.add(Math.floor((r+4)*10*r)),e})),new zs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(we,i.building().item())),new l(i=>i.progress().value()>0),new m((i,e)=>{let r=i.remaining()/10;return e.add(Math.floor(5*r**2+20*r)),e})),new zs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(Y,i.building().item())),new l(i=>i.progress().value()===0),new m((i,e)=>(e.add(i.remaining()*4),e))),new zs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(Y,i.building().item())),new l(i=>i.progress().value()>0),new m((i,e)=>(e.add(i.remaining()*2),e)))],"getRules"),X0=VN});var $N,tG,rG=n(()=>{tt();Zn();Cg();I();$N=t((i=_)=>[new ht(new m(e=>i.getByPlayer(e).map(r=>new Ja(e,r))))],"getRules"),tG=$N});var JN,iG,oG=n(()=>{Ls();Ks();I();pg();JN=t((i=si)=>[new li(new m(e=>i.register(new ec(e))))],"getRules"),iG=JN});var nG=n(()=>{GR();Wl()});var xd,vd,zR=n(()=>{M();xd=class extends x{};t(xd,"Updated");vd=xd});var ZN,aG,sG=n(()=>{nG();cr();V();Ls();P();lg();km();B();I();Dm();zR();ZN=t((i=si,e=d,r=he,o=w)=>[new Oo(new l(a=>a instanceof er),new m((a,s,p)=>{let u=i.getByPlayer(s.player());p.forEach(y=>{if(y instanceof pe){if(u.value()<y.value()){let c=y.cityImprovement(),f=new Ku(c.constructor,s,e);r.unregister(c),u.add(f.cost().value()),o.emit("city:unsupported-improvement",s,c);return}u.subtract(y.value(),s.name())}})})),new Oo(new l(a=>a instanceof er),new l((a,s,p)=>!e.get(Fn).some(u=>u.validate(s,p))),new m((a,s)=>{let p=i.getByPlayer(s.player());p.add(a,s.name()),e.process(vd,p,s)}))],"getRules"),aG=ZN});var QN,lG,mG=n(()=>{V();B();I();zR();QN=t((i=w)=>[new vd(new l(e=>e.value()<0),new m((e,r)=>{i.emit("player:treasury-exhausted",e.player(),e,r)}))],"getRules"),lG=QN});var XN={};var pG=n(()=>{P();eG();rG();oG();sG();mG();d.register(...X0(),...tG(),...iG(),...aG(),...lG())});var cG=C(uG=>{"use strict";Object.defineProperty(uG,"__esModule",{value:!0});pG()});var ez={};var yG=n(()=>{gn();Nl();Cn.register(xo,vo,bo,ki,Co,To,Di,Oi,Io,wo,Xr,Yi,Br,Si,Fi,Po,Ni,Bo,Ao,zi,je,Li,Uo,Ar,Mo,Eo,Ur,Go)});var bd,Km,LR=n(()=>{M();bd=class extends x{};t(bd,"Available");Km=bd});var Cd,fG,WR,tz,dG,gG=n(()=>{Ug();kn();cm();gt();tt();Jo();Dn();Zt();P();Vo();gi();fm();ci();Ke();sa();Qd();LR();B();I();ER();gn();Cd=new l((i,e,r=i.tile())=>i instanceof ot),fG=new l((i,e,r=i.tile())=>i instanceof We),WR=t((i,e)=>e.getByTile(i)!==null,"tileHasCity"),tz=t((i=J,e=_,r=d,o=ze,a=nr,s=N,p=lt,u=En,y=Ue)=>[new Rt(Zl,pi,new Rn(new Ya(Cd,new l((c,f,g=c.tile())=>g.isLand()),new l((c,f)=>f.isLand()),new l((c,f)=>s.getByTile(f).every(g=>g.player()===c.player()))),new Ya(fG,new Rn(new l((c,f,g=c.tile())=>g.isWater()),new l((c,f,g=c.tile())=>e.getByTile(g)?.player()===c.player())),new Rn(new l((c,f)=>f.isWater()),new l((c,f)=>e.getByTile(f)?.player()===c.player()))),new l(c=>c instanceof Ft)),new Rn(new l((c,f)=>!(c instanceof ot)),new l((c,f,g=c.tile())=>!(g.getNeighbours().some(G=>s.getByTile(G).some(k=>k instanceof ot&&k.tile().terrain()instanceof W&&k.player()!==c.player()))&&f.getNeighbours().some(G=>s.getByTile(G).some(k=>k instanceof ot&&k.tile().terrain()instanceof W&&k.player()!==c.player())))),new l((c,f)=>s.getByTile(f).filter(g=>g.player()===c.player()).length>0),new l((c,f)=>{let g=e.getByTile(f);return g===null?!1:g.player()===c.player()})),new l((c,f)=>{let g=e.getByTile(f);return g===null?!0:g.player()===c.player()}),new l((c,f)=>!s.getByTile(f).some(g=>g.player()!==c.player())),new m((c,f,g=c.tile())=>new Yt(g,f,c,r))),new Rt(Zl,pi,new Rn(new l(c=>c instanceof Ft),new Ya(Cd,new l((c,f)=>f.isLand())),new Ya(fG,new Rn(new l((c,f)=>f.isWater()),new Ya(new l((c,f)=>s.getByTile(f).some(g=>g.player()!==c.player())))))),new l((c,f)=>s.getByTile(f).some(g=>g.player()!==c.player())),new m((c,f,g=c.tile())=>new ls(g,f,c,r,s))),new Rt(Zl,pi,Cd,new l((c,f)=>WR(f,e)),new l((c,f)=>s.getByTile(f).length===0),new l((c,f)=>e.getByTile(f).player()!==c.player()),new m((c,f,g=c.tile())=>{let G=e.getByTile(f);return new om(g,f,c,G,r)})),new Rt(pi,Bn,new l(c=>c instanceof F),new l((c,f)=>o.getByTile(f).filter(g=>[Be,Ze,or,Ye].some(G=>g instanceof G)).length>0),new m((c,f,g=c.tile())=>new xs(g,f,c,r,o,y))),new Rt(pi,Bn,new l(c=>c instanceof F),new l((c,f,g=c.tile())=>g.isLand()),new m((c,f,g=c.tile())=>new Rs(g,f,c,r,y,a))),new Rt(pi,Bn,new m((c,f,g=c.tile())=>new la(g,f,c,r,y))),new Rt(pi,Bn,new m((c,f,g=c.tile())=>new sm(g,f,c,r))),new Rt(Bn,new m((c,f,g=c.tile())=>new Xi(g,f,c,r))),new Rt(pi,Bn,new l(c=>c instanceof je),new l((c,f,g=c.tile())=>g.isLand()),new l((c,f,g=c.tile())=>!WR(g,e)),new m((c,f,g=c.tile())=>new pm(g,f,c,i,r))),...[[Be,ms,new Rn(new l((c,f,g=c.tile())=>g.terrain()instanceof oe),new l((c,f,g=c.tile())=>g.getAdjacent().some(G=>G.terrain()instanceof oe||G.terrain()instanceof Jt||o.getByTile(G).some(k=>k instanceof Be)&&!WR(G,e))))],[Ze,ps],[Ye,us],[or,cs,new l((c,f)=>o.getByTile(f).some(g=>g instanceof Ye))]].map(([c,f,...g])=>new Rt(new l(G=>G instanceof gr),pi,new l((G,k,D=G.tile())=>r.get(Km).some(U=>U.validate(D,c,G.player()))),Bn,...g,new m((G,k,D=G.tile())=>new f(D,k,G,r,y)))),...[[rt,ds],[Ve,ys],[me,vs],[it,gs]].map(([c,f])=>new Rt(pi,Bn,new l(g=>g instanceof gr),new l((g,G,k=g.tile())=>k.terrain()instanceof c),new m((g,G,k=g.tile())=>new f(k,G,g,r,p,y)))),new Rt(Zl,pi,Cd,new l((c,f)=>f.terrain()instanceof Jt),new l((c,f)=>s.getByTile(f).every(g=>g.player()===c.player())),new l((c,f)=>s.getByTile(f).filter(g=>g instanceof zt).some(g=>g.hasCapacity()&&g.canStow(c))),new m((c,f,g=c.tile())=>{let[G]=s.getByTile(f).filter(k=>k instanceof zt).filter(k=>k.hasCapacity()&&k.canStow(c));return new lm(g,f,c,G,r)})),new Rt(Zl,new l(c=>{try{return u.getByUnit(c),!0}catch{return!1}}),new Rn(new l((c,f)=>!(c instanceof ot)),new l((c,f)=>f.isLand())),new l((c,f,g=c.tile())=>u.getByUnit(c).transport().tile()===g),new m((c,f,g=c.tile())=>{let G=u.getByUnit(c).transport();return new hs(g,f,c,G,r)})),new Rt(pi,Bn,new l(c=>c instanceof zt),new l(c=>c.hasCargo()),new l((c,f)=>f.getNeighbours().some(g=>g.isLand())),new m((c,f,g=c.tile())=>new um(g,f,c,r)))],"getRules"),dG=tz});var rz,hG,RG=n(()=>{sa();Mg();B();I();Ep();rz=t((i=nr)=>[new Ql(new l(e=>e.moves().value()>0),new m(e=>e.setActive())),new Ql(new l(e=>e.busy()!==null),new m(e=>e.setBusy())),...[di].map(e=>new Ql(new l(r=>i.getByUnit(r).some(o=>o instanceof e)),new m(r=>i.unregister(...i.getByUnit(r).filter(o=>o instanceof e)))))],"getRules"),hG=rz});var iz,xG,vG=n(()=>{lr();Xm();gn();He();B();I();kn();iz=t((i=z)=>[new Qt(new l((e,r)=>Object.prototype.isPrototypeOf.call(We,r)),new m(e=>new l(()=>e.tile().isCoast()))),...[[xo,Vr],[vo,uo],[bo,xi],[ki,jr],[To,xi],[Co,Mi],[Di,br],[Oi,fn],[Io,Nr],[wo,Cr],[Xr,ao],[Yi,Lt],[Br,mn],[Si,po],[Fi,io],[Po,pn],[Ni,yt],[Bo,lo],[Ao,zr],[zi,ar],[Li,Fr],[Uo,jt],[Ar,wi],[Mo,ut],[Eo,bt],[Ur,Wr]].map(([e,r])=>new Qt(new l((o,a)=>a===e),new m(o=>new l(()=>i.getByPlayer(o.player()).completed(r))))),...[[ki,Vr],[Di,jr],[Oi,io],[Yi,bt],[Br,zr],[Si,Nr],[Fi,ut],[Ni,zr],[zi,Lt],[Li,yt],[Ar,zr],[Ur,ar],[Go,yt]].map(([e,r])=>new Qt(new l((o,a)=>a===e),new m(o=>new l(()=>!i.getByPlayer(o.player()).completed(r)))))],"getRules"),xG=iz});var oz,bG,CG=n(()=>{tp();gn();oz=t(()=>[...[[xo,80],[vo,160],[bo,120],[ki,40],[Co,50],[To,160],[Di,40],[Oi,40],[Io,80],[wo,30],[Xr,60],[Yi,40],[Br,20],[Si,50],[Fi,40],[Po,50],[Ni,30],[Bo,160],[Ao,30],[zi,40],[je,40],[Li,20],[Uo,50],[Ar,20],[Mo,80],[Eo,50],[Ur,40],[Go,10]].flatMap(([i,e])=>zl(i,e))],"getRules"),bG=oz});var nz,TG,IG=n(()=>{ir();rp();B();I();gn();nz=t((i=ce)=>[new $n(new l((e,r)=>r instanceof je),new m(e=>i.getByCity(e.city()).shrink()))],"getRules"),TG=nz});var az,wG,PG=n(()=>{V();Ke();qc();I();az=t((i=N,e=w)=>[new Qn(new m(r=>i.register(r))),new Qn(new m(r=>r.applyVisibility())),new Qn(new m(r=>r.moves().set(r.movement()))),new Qn(new m(r=>{e.emit("unit:created",r)}))],"getRules"),wG=az});var sz,BG,AG=n(()=>{V();Ke();Tp();I();sz=t((i=N,e=w)=>[new Ko(new m(r=>{r.setDestroyed(),i.unregister(r)})),new Ko(new m((r,o)=>{e.emit("unit:defeated",r,o)}))],"getRules"),BG=sz});var lz,UG,MG=n(()=>{V();sa();Ke();$c();I();lz=t((i=N,e=nr,r=w)=>[new Xn(new m((o,a)=>{r.emit("unit:destroyed",o,a)})),new Xn(new m(o=>i.unregister(o))),new Xn(new m(o=>{o.setActive(!1),o.setDestroyed()})),new Xn(new m(o=>e.getByUnit(o).forEach(a=>e.unregister(a))))],"getRules"),UG=lz});var Td,qm,jR=n(()=>{M();Td=class extends x{};t(Td,"LostAtSea");qm=Td});var mz,EG,GG=n(()=>{V();I();jR();mz=t((i=w)=>[new qm(new m(e=>{i.emit("unit:lost-at-sea",e)})),new qm(new m(e=>e.destroy(null)))],"getRules"),EG=mz});var pz,kG,DG=n(()=>{cm();V();P();fm();B();I();jR();Ut();kn();gn();tt();pz=t((i=En,e=d,r=()=>Math.random(),o=w,a=_)=>[new q(new m((s,p)=>{o.emit("unit:moved",s,p)})),new q(new m(s=>s.applyVisibility())),new q(new l(s=>s.moves().value()<=.1),new m(s=>s.moves().set(0))),new q(new l(s=>s.moves().value()<.1),new m(s=>s.setActive(!1))),new q(new l(s=>s instanceof zt),new l((s,p)=>p instanceof Yt),new l(s=>s.hasCargo()),new m((s,p)=>s.cargo().forEach(u=>u.action(p.forUnit(u))))),new q(new l((s,p)=>p instanceof hs),new m(s=>{let p=i.getByUnit(s);p.transport().unload(s),i.unregister(p)})),new q(new l(s=>s instanceof Ur),new l(s=>s.moves().value()===0),new l(s=>!s.tile().isCoast()),new l(()=>r()<=.5),new m(s=>{e.process(qm,s)})),new q(new l(s=>s instanceof Xr),new l(s=>s.moves().value()===0),new l(s=>a.getByTile(s.tile())!==null),new m(s=>{e.process(qm,s)}))],"getRules"),kG=pz});var OG,uz,YG,SG=n(()=>{Jo();kn();cm();Dn();gi();fm();B();I();yi();OG=[[St,2],[Ie,1],[Ve,2],[be,1],[Me,2],[rt,2],[Le,3],[mt,1],[me,1],[oe,1],[it,2],[xt,1]],uz=t((i=ze,e=En)=>[...OG.map(([r,o])=>new ve(new l((a,s)=>s instanceof Yt),new l(a=>a instanceof ot),new l((a,s)=>s.to().terrain()instanceof r),new m(()=>o))),new ve(new l((r,o)=>o instanceof Yt),new l(r=>r instanceof Ft||r instanceof We),new m(()=>1)),new ve(new l((r,o)=>o instanceof Yt),new l(r=>r instanceof ot),new l((r,o)=>i.getByTile(o.from()).some(a=>a instanceof Ye)),new l((r,o)=>i.getByTile(o.to()).some(a=>a instanceof Ye)),new m(()=>1/3)),new ve(new l((r,o)=>o instanceof Yt),new l(r=>r instanceof ot),new l((r,o)=>i.getByTile(o.from()).some(a=>a instanceof or)),new l((r,o)=>i.getByTile(o.to()).some(a=>a instanceof or)),new m(()=>0)),new ve(new l((r,o)=>o instanceof Yt),new l(r=>r instanceof ot),new l(r=>{try{return e.getByUnit(r),!0}catch{return!1}}),new l(r=>e.getByUnit(r).transport()instanceof zt),new m(()=>0)),...[[ms,2],[ps,3],[us,1],[cs,2],[ys,2],[ds,3],[gs,3],[Rs,1],[xs,1],[vs,3],[la,0]].flatMap(([r,o])=>OG.map(([a,s])=>new ve(new l((p,u)=>u instanceof r),new l(p=>p.tile().terrain()instanceof a),new m(()=>o*s))))],"getRules"),YG=uz});var cz,FG,NG=n(()=>{Jd();Ke();Zn();B();I();cz=t((i=N)=>[new ht(new l(e=>i.getByPlayer(e).some(r=>r.active()&&r.moves().value())),new m(e=>i.getByPlayer(e).filter(r=>r.active()&&r.moves().value()>0).sort((r,o)=>(r.waiting()?1:0)-(o.waiting()?1:0)).map(r=>new Da(e,r)))),new ht(new l(e=>i.getByPlayer(e).some(r=>!r.active()||!r.moves().value())),new m(e=>i.getByPlayer(e).filter(r=>!r.active()||r.moves().value()===0).sort((r,o)=>(r.waiting()?1:0)-(o.waiting()?1:0)).map(r=>new Oa(e,r))))],"getRules"),FG=cz});var yz,zG,LG=n(()=>{I();$g();Qg();yz=t(()=>[new $y(new m(i=>i.action(new jv(i.tile(),i.tile(),i))))],"getRules"),zG=yz});var fz,WG,jG=n(()=>{Jl();gn();Ep();P();sa();Xl();Xl();B();I();fz=t((i=nr,e=d)=>[...[[xo,12,2,2],[vo,18,12,4,2],[bo,12,1,8,2],[ki,8],[Co,0],[To,1,12,5,2],[Di,6],[Oi,4,1,2],[Io,6,6,6,2],[wo,0,0,2],[Xr,4,2,10,2],[Yi,2,2,3],[Br,2,1,2],[Si,4,4,4],[Fi,4,2,2],[Po,6,6,3],[Ni,3,2],[Bo,99,0,16],[Ao,3,5],[zi,1,1,3],[je,0],[Li,1,2],[Uo,8,2,3,2],[Ar,3],[Mo,10,5,3],[Eo,0,3,4],[Ur,1,0,3],[Go]].flatMap(([r,o=1,a=1,s=1,p=1])=>Lx(r,o,a,s,p)),...[[di,1,mi],[ma,.5,Vi,mi]].flatMap(([r,o,...a])=>a.map(s=>new qs(new l((p,u)=>u instanceof s),new l(p=>i.getByUnit(p).some(u=>u instanceof r)),new m((p,u)=>{let y=new s;e.process(es,p.constructor,y),u.add(y.value()*o,r.name)}))))],"getRules"),WG=fz});var dz,_G,HG=n(()=>{V();I();Ef();dz=t((i=w)=>[new vl(new m((e,r)=>{i.emit("unit:unsupported",e,r)}))],"getRules"),_G=dz});var gz,KG,qG=n(()=>{B();I();_g();gz=t((i=()=>Math.random())=>[new Ip(new l((e,r)=>e.moves().value()>=r),new m((e,r)=>(e.moves().subtract(r),!0))),new Ip(new l((e,r)=>e.moves().value()<r),new m((e,r)=>{let o=e.moves().value();return e.moves().set(0),o>=r*.5*i()}))],"getRules"),KG=gz});var hz={};var VG=n(()=>{gG();RG();vG();CG();IG();PG();AG();MG();P();GG();DG();SG();NG();LG();jG();HG();qG();d.register(...dG(),...hG(),...xG(),...bG(),...TG(),...wG(),...BG(),...UG(),...EG(),...kG(),...YG(),...FG(),...zG(),...WG(),..._G(),...KG())});var JG=C($G=>{"use strict";Object.defineProperty($G,"__esModule",{value:!0});yG();VG()});var zn,ZG=n(()=>{Pe();zn=class extends ge{};t(zn,"ApolloProgram")});var Mr,QG=n(()=>{Pe();Mr=class extends xe{};t(Mr,"Colossus")});var ti,XG=n(()=>{Pe();ti=class extends xe{};t(ti,"CopernicusObservatory")});var Yo,ek=n(()=>{Pe();Yo=class extends ge{};t(Yo,"CureForCancer")});var Ln,tk=n(()=>{Pe();Ln=class extends ge{};t(Ln,"DarwinsVoyage")});var Er,rk=n(()=>{Pe();Er=class extends xe{};t(Er,"GreatLibrary")});var So,ik=n(()=>{Pe();So=class extends xe{};t(So,"GreatWall")});var ri,ok=n(()=>{Pe();ri=class extends xe{};t(ri,"HangingGardens")});var Wn,nk=n(()=>{Pe();Wn=class extends ge{};t(Wn,"HooverDam")});var Fo,ak=n(()=>{Pe();Fo=class extends ge{};t(Fo,"IsaacNewtonsCollege")});var ji,sk=n(()=>{Pe();ji=class extends ge{};t(ji,"JsBachsCathedral")});var ii,lk=n(()=>{Pe();ii=class extends ge{};t(ii,"Lighthouse")});var No,mk=n(()=>{Pe();No=class extends xe{};t(No,"MagellansExpedition")});var jn,pk=n(()=>{Pe();jn=class extends ge{};t(jn,"ManhattanProject")});var Gr,uk=n(()=>{Pe();Gr=class extends ge{};t(Gr,"MichelangelosChapel")});var Vt,ck=n(()=>{Pe();Vt=class extends xe{};t(Vt,"Oracle")});var zo,yk=n(()=>{Pe();zo=class extends xe{};t(zo,"Pyramids")});var Lo,fk=n(()=>{Pe();Lo=class extends ge{};t(Lo,"SetiProgram")});var kr,dk=n(()=>{Pe();kr=class extends ge{};t(kr,"ShakespearesTheatre")});var _n,gk=n(()=>{Pe();_n=class extends ge{};t(_n,"UnitedNations")});var _i,hk=n(()=>{Pe();_i=class extends ge{};t(_i,"WomensSuffrage")});var Ea=n(()=>{ZG();QG();XG();ek();tk();rk();ik();ok();nk();ak();sk();lk();mk();pk();uk();ck();yk();fk();dk();gk();hk()});var Rz={};var Rk=n(()=>{Ea();Nl();Cn.register(zn,Mr,ti,Yo,Ln,Er,So,ri,Wn,Fo,ji,ii,No,jn,Gr,Vt,zo,Lo,kr,_n,_i)});var Id,Bt,Hn=n(()=>{Ce();Pe();Id=class extends O{constructor(){super(xe)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.filter(r=>r.city().player()===e)}};t(Id,"WonderRegistry");Bt=new Id});var xz,xk,vk=n(()=>{Ea();lr();Xm();He();Hn();B();I();Pe();xz=t((i=z,e=Bt)=>[new Qt(new l((r,o)=>Object.isPrototypeOf.call(xe,o)),new m((r,o)=>new l(()=>e.filter(a=>a instanceof o).length===0))),...[[Mr,Fr],[ti,vi],[Er,vr],[So,Wt],[ri,cn],[ii,Wr],[No,ar],[Vt,Ci],[zo,Wt],[zn,mo],[Yo,ln],[Ln,qr],[Wn,ct],[Fo,yo],[ji,Ct],[jn,Hr],[Gr,Ct],[Lo,Ti],[kr,Pi],[_n,vt],[_i,bt]].map(([r,o])=>new Qt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByPlayer(a.player()).completed(o)))))],"getRules"),xk=xz});var vz,bk,Ck=n(()=>{Ea();tp();vz=t(()=>[...[[zn,600],[Mr,200],[ti,300],[Yo,600],[Ln,300],[Er,300],[So,300],[ri,300],[Wn,600],[Fo,400],[ji,400],[ii,200],[No,400],[jn,600],[Gr,300],[Vt,300],[zo,300],[Lo,600],[kr,400],[_n,600],[_i,600]].flatMap(([i,e])=>zl(i,e))],"getRules"),bk=vz});var bz,Tk,Ik=n(()=>{Jn();V();Hn();rp();B();I();Pe();bz=t((i=Xt,e=Bt,r=w)=>[new $n(new l((o,a)=>a instanceof xe),new m((o,a)=>{let s=a.constructor;e.register(a),i.filter(p=>p.building()?.item()===s).forEach(p=>p.revalidate())})),new $n(new l((o,a)=>a instanceof xe),new m((o,a)=>{r.emit("wonder:built",a,o.city())}))],"getRules"),Tk=bz});var Vm,Hi,$p=n(()=>{Hn();B();Vm=t((i,e=Bt)=>new l(r=>e.getByCity(r).some(o=>o instanceof i)),"cityHasWonder"),Hi=t((i,e=Bt)=>new l(r=>e.getByPlayer(r.player()).some(o=>o instanceof i)),"playerHasWonder")});var wk,xn,wd,Jp=n(()=>{He();B();wk=t((i,e=z)=>new l(r=>e.getByPlayer(r.player()).completed(i)),"discoveredByPlayer"),xn=t((i,e=z)=>new l(()=>i===null||!e.some(r=>r.completed(i))),"notDiscoveredByAnyPlayer"),wd=t((i,e=z)=>new l(r=>i===null||!e.getByPlayer(r.player()).completed(i)),"notDiscoveredByPlayer")});var Pd,Pk=n(()=>{cr();B();Pd=t((i,e=he)=>new l(r=>e.getByCity(r).some(o=>o instanceof i)),"hasCityImprovement")});var Cz,Bk,Ak=n(()=>{Gi();cr();lr();Ea();on();He();Ke();Hn();$p();Jp();kl();B();I();qn();Sm();Sa();Us();Pk();Zi();Cz=t((i=he,e=pt,r=z,o=N,a=Bt)=>[new Xe(new Qe,Hi(Vt,a),Pd(Mt,i),wd(_t,r),xn(Ct,r),new m((s,p)=>new Ee(-Math.min(1,qe(p,Ee)),Vt.name))),new Xe(new Qe,Hi(Vt,a),Pd(Mt,i),wk(_t,r),xn(Ct,r),new m((s,p)=>new Ee(-Math.min(2,qe(p,Ee)),Vt.name))),new Xe(new Or(4e3),Vm(kr,a),xn(ct,r),new m((s,p)=>new Ee(-qe(p,Ee),kr.name))),new Xe(new Qe,Hi(ji,a),new m((s,p)=>new Ee(-Math.min(2,qe(p,Ee)),ji.name))),new Xe(new Qe,Hi(Gr,a),Pd(pr,i),xn(vt,r),new m((s,p)=>new Ee(-Math.min(4,qe(p,Ee)),Gr.name))),new Xe(new Qe,Hi(_i,a),new l((s,p)=>p.some(u=>u instanceof ua)),new m((s,p)=>p.flatMap(u=>u instanceof ua?new Ee(-1,_i.name):[])))],"getRules"),Bk=Cz});var Tz,Uk,Mk=n(()=>{Hn();Ss();B();I();Tz=t((i=Bt)=>[new fr(new l(e=>i.getByCity(e).length>0),new m(e=>i.getByCity(e).forEach(r=>i.unregister(r))))],"getRules"),Uk=Tz});var Iz,Ek,Gk=n(()=>{Ea();lr();Us();He();Hn();$p();Fl();I();Sa();Jp();Iz=t((i=z,e=Bt)=>[new jo(new Or(500),Vm(Mr,e),xn(Rr,i),new m(r=>new se(r.tilesWorked().filter(o=>o.yields().some(a=>a instanceof se)).length,Mr.name))),...[[ri,1,xr],[Yo,1,null]].map(([r,o,a])=>new jo(Hi(r,e),xn(a,i),new m(()=>new Do(o,r.name))))],"getRules"),Ek=Iz});var wz,kk,Dk=n(()=>{Ea();He();Hn();$p();lr();I();qn();Us();Fu();Jp();Zi();wz=t((i=z,e=Bt)=>[...[[ti,qt,1,ut]].map(([r,o,a,s])=>new Fs(new Qe,Vm(r,e),xn(s,i),new m((p,u)=>new o(qe(u,o)*a,r.name)))),...[[Lo,qt,.5,null]].map(([r,o,a,s])=>new Fs(new Qe,Hi(r,e),xn(s,i),new m((p,u)=>new o(qe(u,o)*a,r.name))))],"getRules"),kk=wz});var Bd,Ad,_R=n(()=>{M();Bd=class extends x{};t(Bd,"Obsolete");Ad=Bd});var Pz,Ok,Yk=n(()=>{lr();Ea();He();P();Hn();fu();B();I();_R();Pz=t((i=z,e=d,r=Bt)=>[new Na(new l(()=>r.some(o=>o instanceof Er)),new l((o,a)=>{let[s]=r.filter(u=>u instanceof Er).map(u=>u.city().player());return!i.getByPlayer(s).completed(a.sourceClass())}),new l((o,a)=>i.filter(s=>s.completed(a.sourceClass())).length>=3),new m((o,a)=>{let[s]=r.filter(u=>u instanceof Er).map(u=>u.city().player());return i.getByPlayer(s).addAdvance(a.sourceClass())})),...[[Mr,Rr],[ti,ut],[Er,sr],[So,yt],[ri,xr],[Fo,Hr],[ii,Lt],[Gr,vt],[Vt,Ct],[zo,vt],[kr,ct]].map(([o,a])=>new Na(new l(()=>r.entries().some(s=>s instanceof o)),new l((s,p)=>p instanceof a),new m(()=>{let[s]=r.filter(p=>p instanceof o);e.process(Ad,s,s.city())})))],"getRules"),Ok=Pz});var Bz,Sk,Fk=n(()=>{Ea();He();Hn();B();I();qn();lr();Jl();kn();Xl();Jp();$p();Bz=t((i=Bt,e=z)=>[new cp(new Qe,new l((r,o)=>o instanceof $i),new l(r=>r instanceof We),Hi(ii,i),wd(Lt,e),new m((r,o)=>o.add(1))),new cp(new Qe,new l((r,o)=>o instanceof $i),new l(r=>r instanceof We),Hi(No,i),new m((r,o)=>o.add(1)))],"getRules"),Sk=Bz});var Az,Nk,zk=n(()=>{V();I();_R();Az=t((i=w)=>[new Ad(new m((e,r)=>{i.emit("wonder:obsolete",e,r)}))],"getRules"),Nk=Az});var Uz={};var Lk=n(()=>{vk();Ck();Ik();Ak();Mk();Gk();Dk();P();Yk();Fk();zk();d.register(...xk(),...bk(),...Tk(),...Bk(),...Uk(),...Ek(),...kk(),...Ok(),...Sk(),...Nk())});var jk=C(Wk=>{"use strict";Object.defineProperty(Wk,"__esModule",{value:!0});Rk();Lk()});var Mz,_k,Hk=n(()=>{Jo();Dn();He();lr();gi();LR();B();Mz=t((i=z,e=ze)=>[...[[Be,Ie,be,Me,me,oe],[Ze,Ie,Me,Le],[Ye,St,Ie,Ve,be,Me,rt,Le,me,it,xt]].map(([r,...o])=>new Km(new l((a,s)=>s===r),new l(a=>o.some(s=>a.terrain()instanceof s)),new l((a,s)=>!e.getByTile(a).some(p=>p instanceof s)))),...[[Ye,ro,oe]].map(([r,o,...a])=>new Km(new l((s,p)=>p===r),new l(s=>a.some(p=>s.terrain()instanceof p)),new l((s,p)=>!e.getByTile(s).some(u=>u instanceof p)),new l((s,p,u)=>i.getByPlayer(u).completed(o)))),...[[or,qr,Ye,St,Ie,Ve,be,Me,rt,Le,me,oe,it,xt]].map(([r,o,a,...s])=>new Km(new l((p,u)=>u===r),new l(p=>s.some(u=>p.terrain()instanceof u)),new l((p,u)=>!e.getByTile(p).some(y=>y instanceof u)),new l(p=>e.getByTile(p).some(u=>u instanceof a)),new l((p,u,y)=>i.getByPlayer(y).completed(o))))],"getRules"),_k=Mz});var Ez,Kk,qk=n(()=>{V();Dn();gi();xy();B();I();Ez=t((i=ze,e=w)=>[new aa(new l((r,o)=>i.getByTile(r).every(a=>o.constructor!==a.constructor)),new m((r,o)=>i.register(o))),new aa(new m(r=>r.clearYieldCache(null))),new aa(new m((r,o)=>{e.emit("tile-improvement:built",r,o)})),...[[Ze,Be],[Be,Ze]].map(([r,o])=>new aa(new l((a,s)=>s instanceof r),new l(a=>i.getByTile(a).some(s=>s instanceof o)),new m(a=>i.unregister(...i.getByTile(a).filter(s=>s instanceof o)))))],"getRules"),Kk=Ez});var Ud,Md,HR=n(()=>{Ki();fi();Ud=class extends De{constructor(){super(Ne)}};t(Ud,"AvailableTerrainFeatureRegistry");Md=new Ud});var Gz,Vk,$k=n(()=>{HR();P();ig();I();nm();Gz=t((i=d,e=Md)=>[new Mu(new m(r=>{let o=i.get(fs);e.entries().forEach(a=>o.filter(s=>s.validate(a,r)).forEach(s=>s.process(a,r)))}))],"getRules"),Vk=Gz});var Et,KR=n(()=>{M();Et=class extends x{};t(Et,"Distribution")});var kz,Jk,Zk=n(()=>{Jo();KR();Zt();B();I();kz=t(()=>[new Et(new l(i=>i===St),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:0,to:.01,fill:!0},{from:.01,to:.02},{from:.98,to:.99},{from:.99,to:1,fill:!0}])),new Et(new l(i=>i===Ie),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.4,to:.45},{from:.45,to:.55,coverage:.025,cluster:!0,clusterChance:.1},{from:.55,to:.6}])),new Et(new l(i=>i===Ve),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.05,to:.2},{from:.2,to:.4,cluster:!0,clusterChance:.1,coverage:.1},{from:.4,to:.6},{from:.6,to:.8,cluster:!0,clusterChance:.1,coverage:.1},{from:.8,to:.95}])),new Et(new l(i=>i===be),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{fill:!0}])),new Et(new l(i=>i===Me),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.1,to:.9,path:!0,pathChance:.1,coverage:.06}])),new Et(new l(i=>i===rt),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.3,to:.45,cluster:!0,clusterChance:.2,coverage:.08},{from:.55,to:.7,cluster:!0,clusterChance:.2,coverage:.08}])),new Et(new l(i=>i===Le),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.01,to:.1,coverage:.3,path:!0},{from:.1,to:.9,path:!0},{from:.9,to:.99,coverage:.3,path:!0}])),new Et(new l(i=>i===mt),new l((i,e)=>e.some(r=>r.constructor===Jt)),new m(()=>[{fill:!0}])),new Et(new l(i=>i===me),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.01,to:.2,coverage:.3},{from:.2,to:.4},{from:.1,to:.4,cluster:!0},{from:.4,to:.6},{from:.6,to:.8},{from:.6,to:.9,cluster:!0},{from:.8,to:.99,coverage:.3}])),new Et(new l(i=>i===oe),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.1,to:.9,coverage:.1,path:!0,pathChance:.5}])),new Et(new l(i=>i===it),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.2,to:.4,cluster:!0},{from:.6,to:.8,cluster:!0}])),new Et(new l(i=>i===xt),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.01,to:.15,cluster:!0,coverage:.15},{from:.85,to:.99,cluster:!0,coverage:.15}]))],"getRules"),Jk=kz});var Ed,Gd,qR=n(()=>{M();Ed=class extends x{};t(Ed,"DistributionGroups");Gd=Ed});var Dz,Qk,Xk=n(()=>{Jo();I();qR();Dz=t(()=>[new Gd(new m(()=>[mt,be,it,Le,rt,Me,Ve,Ie,me,xt,St,oe]))],"getRules"),Qk=Dz});var Oz,eD,tD=n(()=>{Jo();Ap();Vo();nm();Oz=t((i=lt)=>[...[[Zo,.2,Me],[Qo,.2,mt],[hi,.2,Ve,xt],[Xo,.2,rt],[en,.2,Le],[eo,.2,me],[Ri,.2,Ie],[tn,.2,it],[rn,.2,St],[$o,.5,be,oe]].flatMap(([r,o,...a])=>a.flatMap(s=>xv(s,r,o,i)))],"getRules"),eD=Oz});var kd,Dd,rD=n(()=>{M();kd=class extends x{};t(kd,"Pillaged");Dd=kd});var Yz,iD,oD=n(()=>{V();gi();rD();B();I();Yz=t((i=ze,e=w)=>[new Dd(new l((r,o)=>i.getByTile(r).includes(o)),new m((r,o)=>i.unregister(o))),new Dd(new m(r=>r.clearYieldCache(null))),new Dd(new m((r,o)=>{e.emit("tile-improvement:pillaged",r,o)}))],"getRules"),iD=Yz});var Sz,vn,VR=n(()=>{Sz=t((i,e,r,o)=>{for(;r<0;)r+=e;for(;o<0;)o+=i;return r=r%e,o=o%i,o*e+r},"coordsToIndex"),vn=Sz});var Fz,Il,Od=n(()=>{Fz=t((i,e,r)=>{let o=i*e;for(;r<0;)r+=o;return r=r%o,[r%e,Math.floor(r/e)]},"indexToCoords"),Il=Fz});var Nz,nD,aD=n(()=>{Od();Nz=t((i,e,r,o)=>{let[a,s]=Il(i,e,r),[p,u]=Il(i,e,o),y=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[c]=y.map(([f,g])=>[f*e,g*i]).map(([f,g])=>[a-p+f,s-u+g]).map(f=>Math.hypot(...f)).sort((f,g)=>f-g);return c},"distanceFrom"),nD=Nz});var zz,wl,$R=n(()=>{VR();Od();zz=t((i,e,r,o=!0)=>{let[a,s]=Il(i,e,r),p=vn(i,e,a,s-1),u=vn(i,e,a+1,s-1),y=vn(i,e,a+1,s),c=vn(i,e,a+1,s),f=vn(i,e,a,s+1),g=vn(i,e,a-1,s+1),G=vn(i,e,a-1,s),k=vn(i,e,a-1,s-1);return o?[p,y,f,G]:[p,u,y,c,f,g,G,k]},"getNeighbours"),wl=zz});var $m,sD,JR=n(()=>{VR();aD();$R();Od();$m=class{#e;#t;#r;constructor(e,r,o={}){this.#e=e,this.#t=o,this.#r=r}coordsToIndex(e,r){return vn(this.#e,this.#r,e,r)}distanceFrom(e,r){return nD(this.#e,this.#r,e,r)}generate(){throw new Error(`Generator#generate(): Must be overridden in '${this.constructor.name}'.`)}getNeighbours(e,r=!0){return wl(this.#e,this.#r,e,r)}height(){return this.#e}indexToCoords(e){return Il(this.#e,this.#r,e)}options(){return this.#t}width(){return this.#r}};t($m,"Generator");sD=$m});var Yd,Sd,ZR=n(()=>{JR();Ki();Yd=class extends De{constructor(){super(sD)}};t(Yd,"GeneratorRegistry");Sd=new Yd});var Fd,Nd,QR=n(()=>{M();Fd=class extends x{};t(Fd,"Start");Nd=Fd});var zd,lD,mD=n(()=>{Z();P();pd();Ce();qi();zd=class extends S{#e;#t;#r;#i=new Qp(ue);#o;constructor(e,r=d){super(),this.#e=e,this.#t=e.height(),this.#o=e.width(),this.#r=r,this.addKey("height","tiles","width")}build(){return new Promise(e=>{this.#e.generate().then(r=>{r.forEach((o,a)=>{let s=new ue(a%this.#o,Math.floor(a/this.#o),o,this,this.#r);this.#i.register(s)}),this.#r.process(Ms,this),e(this)})})}entries(){return this.#i.entries()}filter(e){return this.entries().filter(e)}forEach(e){return this.#i.forEach(e)}get(e,r){return this.entries()[this.#e.coordsToIndex(e,r)]}height(){return this.#t}includes(e){return this.#i.includes(e)}map(e){return this.#i.map(e)}register(...e){this.#i.register(...e)}tiles(){return this.entries()}width(){return this.#o}};t(zd,"World");lD=zd});var Lz,pD,uD=n(()=>{ZR();P();V();I();QR();mD();Lz=t((i=d,e=Sd,r=w,o=()=>Math.random())=>[new Nd(new m(()=>{let a=e.entries(),s=a[Math.floor(a.length*o())],p=new s(parseInt(r.option("height",100),10),parseInt(r.option("width",160),10),{landCoverage:parseFloat(r.option("landCoverage",.4)),landSize:parseFloat(r.option("landSize",.2)),maxIterations:parseInt(r.option("maxIterations",20),10)});new lD(p,i).build()}))],"getRules"),pD=Lz});var Wz,cD,yD=n(()=>{Ap();Jo();is();Dn();dn();on();Vo();gi();B();I();ag();Wz=t((i=ze,e=lt,r=pt)=>[...[[$,Ve,1],[$,be,2],[$,Me,1],[$,rt,1],[$,mt,1],[$,me,1],[$,oe,2],[$,it,1],[$,xt,1],[K,Ie,1],[K,Ve,2],[K,Le,1],[K,me,1]].map(([o,a,s])=>new ai(new l(p=>p.terrain()instanceof a),new m(()=>new o(s,a.name)))),...[[K,Zo,2],[$,Qo,1],[$,hi,1],[se,Xo,2],[se,en,3],[K,eo,1],[$,Ri,2],[K,tn,3],[$,rn,2],[K,$o,1]].map(([o,a,s])=>new ai(new l(p=>e.getByTerrain(p.terrain()).some(u=>u instanceof a)),new m(()=>new o(s,a.name)))),...[[K,Zo,1],[$,Qo,1],[$,hi,1],[se,Xo,2],[se,en,2],[K,eo,1],[$,Ri,1],[K,tn,1],[$,rn,1]].map(([o,a,s])=>new ai(new l((p,u)=>{if(!u)return!1;try{return r.getByPlayer(u).is(Tt,nt,at,ft)}catch{return!1}}),new l(p=>e.getByTerrain(p.terrain()).some(u=>u instanceof a)),new m(()=>new o(s,a.name)))),new ai(new l(o=>o.terrain()instanceof mt),new m(()=>new se(2,mt.name))),new ai(new l(o=>o.terrain()instanceof oe),new m(()=>new se(1))),new ai(new l((o,a)=>{if(!a)return!1;try{return r.getByPlayer(a).is(nt,ft)}catch{return!1}}),new l(o=>o.terrain()instanceof oe||o.terrain()instanceof mt),new m(()=>new se(1,mt.name))),...[[Ie,$,Be,1],[Ie,K,Ze,1],[Me,$,Be,1],[Me,K,Ze,2],[Le,K,Ze,1],[me,$,Be,1]].map(([o,a,s,p])=>new ai(new l(u=>u.terrain()instanceof o),new l(u=>i.getByTile(u).some(y=>y instanceof s)),new m(()=>new a(p,s.name)))),...[[Ie,K,Ze,1],[be,$,Be,1],[Me,K,Ze,1],[Le,K,Ze,1],[oe,$,Be,1]].map(([o,a,s,p])=>new ai(new l((u,y)=>{if(!y)return!1;try{return r.getByPlayer(y).is(Tt,nt,at,ft)}catch{return!1}}),new l(u=>u.terrain()instanceof o),new l(u=>i.getByTile(u).some(y=>y instanceof s)),new m(()=>new a(p,s.name)))),...[Ie,be,me].map(o=>new ai(new l(a=>a.terrain()instanceof o),new l(a=>i.getByTile(a).some(s=>s instanceof Ye)),new m(()=>new se(1,Ye.name)))),...[Ie,be,me].map(o=>new ai(new l((a,s)=>{if(!s)return!1;try{return r.getByPlayer(s).is(nt,ft)}catch{return!1}}),new l(a=>a.terrain()instanceof o),new l(a=>i.getByTile(a).some(s=>s instanceof Ye)),new m(()=>new se(1,Ye.name))))],"getRules"),cD=Wz});var jz,fD,dD=n(()=>{is();gi();B();I();qn();Dn();ng();jz=t((i=ze)=>[...[[$,.5],[K,.5],[se,.5]].map(([e,r])=>new ku(new Kn,new l((o,a,s)=>s.some(p=>p instanceof e)),new l(o=>i.getByTile(o).some(a=>a instanceof or)),new m((o,a,s)=>{let p=s.filter(u=>u instanceof e).reduce((u,y)=>u+y.value(),0);s.push(new e(Math.floor(p*r),or.name))})))],"getRules"),fD=jz});var _z={};var gD=n(()=>{Hk();qk();$k();Zk();Xk();tD();P();oD();uD();yD();dD();d.register(..._k(),...Kk(),...Vk(),...Jk(),...Qk(),...eD(),...iD(),...pD(),...cD(),...fD())});var Ld,Wd,XR=n(()=>{Ki();Dl();Ld=class extends De{constructor(){super(bn)}};t(Ld,"TerrainRegistry");Wd=new Ld});var Hz={};var hD=n(()=>{Jo();XR();Wd.register(St,Ie,Ve,be,Me,rt,Le,mt,me,oe,it,xt)});var Kz={};var RD=n(()=>{Ap();HR();Md.register(Zo,Qo,hi,Xo,en,eo,Ri,tn,rn,$o)});var vD=C(xD=>{"use strict";Object.defineProperty(xD,"__esModule",{value:!0});gD();hD();RD()});var qz,bD,CD=n(()=>{tt();$t();_o();qi();qz=t((i=_)=>[new te(H,"cities",e=>i.getByPlayer(e)),new te(ue,"city",e=>i.getByTile(e))],"getAdditionalData"),bD=qz});var Vz={};var TD=n(()=>{kt();CD();re.register(...bD())});var wD=C(ID=>{"use strict";Object.defineProperty(ID,"__esModule",{value:!0});TD()});var $z,PD,BD=n(()=>{Jn();$t();Vn();$z=t((i=Xt)=>[new te(et,"build",e=>i.getByCity(e))],"getAdditionalData"),PD=$z});var Jz={};var AD=n(()=>{kt();BD();re.register(...PD())});var MD=C(UD=>{"use strict";Object.defineProperty(UD,"__esModule",{value:!0});AD()});var Zz,ED,GD=n(()=>{ir();$t();Vn();Zz=t((i=ce)=>[new te(et,"growth",e=>i.getByCity(e))],"getAdditionalData"),ED=Zz});var Qz={};var kD=n(()=>{kt();GD();re.register(...ED())});var OD=C(DD=>{"use strict";Object.defineProperty(DD,"__esModule",{value:!0});kD()});var Xz,YD,SD=n(()=>{cr();$t();Vn();Xz=t((i=he)=>[new te(et,"improvements",e=>i.getByCity(e))],"getAdditionalData"),YD=Xz});var eL={};var FD=n(()=>{kt();SD();re.register(...YD())});var zD=C(ND=>{"use strict";Object.defineProperty(ND,"__esModule",{value:!0});FD()});var tL,LD,WD=n(()=>{Cs();$t();qi();tL=t((i=Yr)=>[new te(ue,"goodyHut",e=>i.getByTile(e))],"getAdditionalData"),LD=tL});var rL={};var jD=n(()=>{kt();WD();re.register(...LD())});var HD=C(_D=>{"use strict";Object.defineProperty(_D,"__esModule",{value:!0});jD()});var iL,KD,qD=n(()=>{on();$t();_o();iL=t((i=pt)=>[new te(H,"government",e=>i.getByPlayer(e))],"getAdditionalData"),KD=iL});var oL={};var VD=n(()=>{qD();kt();re.register(...KD())});var JD=C($D=>{"use strict";Object.defineProperty($D,"__esModule",{value:!0});VD()});var nL,ZD,QD=n(()=>{Ji();$t();_o();nL=t((i=ie)=>[new te(H,"world",e=>i.getByPlayer(e))],"getAdditionalData"),ZD=nL});var aL={};var XD=n(()=>{kt();QD();re.register(...ZD())});var tO=C(eO=>{"use strict";Object.defineProperty(eO,"__esModule",{value:!0});XD()});var sL,rO,iO=n(()=>{He();$t();_o();sL=t((i=z)=>[new te(H,"research",e=>i.getByPlayer(e))],"getAdditionalData"),rO=sL});var lL={};var oO=n(()=>{kt();iO();re.register(...rO())});var aO=C(nO=>{"use strict";Object.defineProperty(nO,"__esModule",{value:!0});oO()});var mL,sO,lO=n(()=>{Vo();$t();Dl();mL=t((i=lt)=>[new te(bn,"features",e=>i.getByTerrain(e))],"getAdditionalData"),sO=mL});var pL={};var mO=n(()=>{kt();lO();re.register(...sO())});var uO=C(pO=>{"use strict";Object.defineProperty(pO,"__esModule",{value:!0});mO()});var uL,cO,yO=n(()=>{gi();$t();qi();uL=t((i=ze)=>[new te(ue,"improvements",e=>i.getByTile(e))],"getAdditionalData"),cO=uL});var cL={};var fO=n(()=>{kt();yO();re.register(...cO())});var gO=C(dO=>{"use strict";Object.defineProperty(dO,"__esModule",{value:!0});fO()});var yL,hO,RO=n(()=>{Vp();$t();_o();yL=t((i=ks)=>[new te(H,"rates",e=>i.getByPlayer(e))],"getAdditionalData"),hO=yL});var fL={};var xO=n(()=>{kt();RO();re.register(...hO())});var bO=C(vO=>{"use strict";Object.defineProperty(vO,"__esModule",{value:!0});xO()});var dL,CO,TO=n(()=>{Ls();$t();_o();dL=t((i=si)=>[new te(H,"treasury",e=>i.getByPlayer(e))],"getAdditionalData"),CO=dL});var gL={};var IO=n(()=>{kt();TO();re.register(...CO())});var PO=C(wO=>{"use strict";Object.defineProperty(wO,"__esModule",{value:!0});IO()});var jd,BO,AO=n(()=>{M();jd=class extends x{};t(jd,"End");BO=jd});var _d,UO,MO=n(()=>{M();_d=class extends x{};t(_d,"Start");UO=_d});var hL,EO,GO=n(()=>{V();P();ci();AO();QR();MO();hL=t((i=d,e=w,r=Ue)=>[["engine:start",()=>{i.process(Nd)}],...["game:start","turn:end"].map(o=>[o,()=>{e.emit("turn:start",r.increment())}]),["turn:end",()=>{i.process(BO,r)}],["turn:start",()=>{i.process(UO,r)}]],"getEvents"),EO=hL});var RL={};var kO=n(()=>{V();GO();[...EO()].forEach(([i,e])=>{w.on(i,e)})});var OO=C(DO=>{"use strict";Object.defineProperty(DO,"__esModule",{value:!0});kO()});var xL,YO,SO=n(()=>{Ke();$t();Vn();_o();qi();xL=t((i=N)=>[new te(et,"units",e=>i.getByCity(e)),new te(H,"units",e=>i.getByPlayer(e)),new te(ue,"units",e=>i.getByTile(e))],"getAdditionalData"),YO=xL});var vL={};var FO=n(()=>{kt();SO();re.register(...YO())});var zO=C(NO=>{"use strict";Object.defineProperty(NO,"__esModule",{value:!0});FO()});var bL,LO,WO=n(()=>{sa();$t();ea();bL=t((i=nr)=>[new te(we,"improvements",e=>i.getByUnit(e))],"getAdditionalData"),LO=bL});var CL={};var jO=n(()=>{kt();WO();re.register(...LO())});var HO=C(_O=>{"use strict";Object.defineProperty(_O,"__esModule",{value:!0});jO()});var Hd,KO,qO=n(()=>{Ki();lh();Hd=class extends De{constructor(){super(hf)}};t(Hd,"AIClientRegistry");KO=new Hd});var TL={};var VO=n(()=>{qO();hm();KO.register(Sn)});var IL,$O,JO=n(()=>{el();Ke();Ys();B();I();hm();IL=t((i=N,e=ko)=>[new yr(new l((r,o)=>e.getByPlayer(o)instanceof Sn),new m((r,o,a)=>e.getByPlayer(o).cityLost(r,a,!1)))],"getRules"),$O=IL});var wL,ZO,QO=n(()=>{el();Ke();B();Ss();I();hm();wL=t((i=N,e=ko)=>[new fr(new l(r=>e.getByPlayer(r.player())instanceof Sn),new m((r,o)=>e.getByPlayer(r.player()).cityLost(r,o,!0)))],"getRules"),ZO=wL});var PL,XO,eY=n(()=>{el();Ke();B();Tp();I();hm();PL=t((i=N,e=ko)=>[new Ko(new l(r=>e.getByPlayer(r.player())instanceof Sn),new m((r,o)=>e.getByPlayer(r.player()).unitDestroyed(r,o&&o.player())))],"getRules"),XO=PL});var BL={};var tY=n(()=>{P();JO();QO();eY();d.register(...$O(),...XO(),...ZO())});var iY=C(rY=>{"use strict";Object.defineProperty(rY,"__esModule",{value:!0});VO();tY()});var Kd,oY,nY=n(()=>{KR();JR();Zt();P();XR();qR();$R();Kd=class extends $m{#e;#t;#r;#i;#o;#a;#n;#l;#s;#m;constructor(e=100,r=160,o={},a=d,s=Wd,p=()=>Math.random()){super(e,r);let{landCoverage:u=.4,landSize:y=.2,maxIterations:c=10,clusterChance:f=.05,coverage:g=.25,pathChance:G=.05}=o;this.#e=u,this.#t=y,this.#r=c,this.#i=f,this.#o=g,this.#a=G,this.#s=a,this.#m=s,this.#l=p,this.#n=new Array(this.height()*this.width()).fill(0).map(()=>new Jt)}async generateIslands(){let e=this.height(),r=this.width(),o=this.#t+this.#l()*.2,a=this.#e,s=this.#r,p=Math.ceil(e*r/100*o),u=new Array(e*r).fill(0);for(;u.length===0||u.filter(y=>y===1).length/u.length<a;){let y={},c=[],f=[],g=Math.floor(e*r*Math.random()),G=t(k=>{k in y||(y[k]=0),y[k]++},"flagAsSeen");for(u[g]=1,c.push(g),G(g),f.push(...wl(e,r,g));f.length;){let k=f.shift();if((y[k]||0)<=s&&(Math.random()>.3?(u[k]=1,c.push(k),wl(e,r,k).filter(D=>f.indexOf(D)===-1).forEach(D=>f.push(D))):wl(e,r,k).forEach(D=>{let U=f.indexOf(D);U>-1&&f.splice(U,1)}),G(k)),c.length>p||u.filter(D=>D===1).length/u.length>=a)break}if(u.filter(k=>k===1).length/u.length>=a)break}this.#n=u.map(y=>y===1?new W:new Jt)}generate(){return this.generateIslands().then(()=>this.populateTerrain().then(()=>this.#n))}getNeighbours(e,r=!0){return wl(this.height(),this.width(),e,r)}populateTerrain(){return new Promise(e=>{let r=this.#s.get(Et);this.#s.get(Gd).filter(o=>o.validate()).map(o=>{let a=o.process();if(!a)throw new TypeError("Unexpected data from DistributionGroups.");return a}).forEach(o=>o.forEach(a=>r.filter(s=>s.validate(a,this.#n)).map(s=>{let p=s.process(a,this.#n);if(!p)throw new TypeError("Unexpected data from Distribution.");return p}).forEach(s=>s.forEach(({cluster:p=!1,clusterChance:u=this.#i,coverage:y=this.#o,fill:c=!1,from:f=0,path:g=!1,pathChance:G=this.#a,to:k=1})=>{let D=Object.keys(this.#n).map(j=>parseInt(j,10)).filter(j=>this.#n[j]instanceof a.__proto__).filter(j=>j>=f*this.height()*this.width()&&j<=k*this.height()*this.width());if(c){D.forEach(j=>{this.#n[j]=new a});return}let U=D.length*y;for(;U>0;){let j=D[Math.floor(this.#l()*D.length)];if(this.#n[j]=new a,U--,p){let Re=this.getNeighbours(j).filter(Se=>!(this.#n[Se]instanceof a));for(;Re.length&&U>0;){let Se=Re.shift();u>=this.#l()/this.distanceFrom(j,Se)&&(this.#n[Se]=new a,U--,Re.push(...this.getNeighbours(Se).filter(At=>!(this.#n[At]instanceof a)).filter(At=>this.#n[At]instanceof a.__proto__).filter(At=>!Re.includes(At))))}}if(g){let Re=j;for(;G>=this.#l();){let Se=this.getNeighbours(Re).filter(At=>this.#n[At]instanceof a.__proto__&&!(this.#n[At]instanceof a));Re=Se[Math.floor(this.#l()*Se.length)],this.#n[Re]=new a,U--}}}})))),e()})}};t(Kd,"BaseGenerator");oY=Kd});var AL={};var aY=n(()=>{nY();ZR();Sd.register(oY)});var lY=C(sY=>{"use strict";Object.defineProperty(sY,"__esModule",{value:!0});aY()});var UL={};var tWe,rWe,iWe,oWe,nWe,aWe,sWe,lWe,mWe,pWe,uWe,cWe,yWe,fWe,dWe,gWe,hWe,RWe,xWe,vWe,bWe,CWe,TWe,IWe,wWe,PWe,BWe,AWe,UWe,MWe,EWe,GWe,kWe,DWe,OWe,YWe,SWe,FWe,NWe,zWe,LWe,WWe,jWe,_We,HWe,KWe,qWe,VWe,$We,JWe,ZWe,QWe,XWe,eje,tje,rje,ije,oje,nje,aje,sje,lje,mje,pje,uje,cje,yje,fje,dje,gje,hje,Rje,xje,vje,bje,Cje,Tje,Ije,wje,Pje,Bje,Aje,Uje,Mje,Eje,Gje,kje,Dje,Oje,Yje,Sje,Fje,Nje,zje,Lje,Wje,jje,_je,Hje,Kje,qje,Vje,$je,Jje,Zje,Qje,Xje,e_e,t_e,r_e,i_e,o_e,n_e,mY=n(()=>{"use strict";tWe=T(YT()),rWe=T(zT()),iWe=T(_T()),oWe=T(VT()),nWe=T(QT()),aWe=T(rI()),sWe=T(aI()),lWe=T(pI()),mWe=T(fI()),pWe=T(RI()),uWe=T(CI()),cWe=T(PI()),yWe=T(MI()),fWe=T(DI()),dWe=T(SI()),gWe=T(zI()),hWe=T(jI()),RWe=T(KI()),xWe=T($I()),vWe=T(QI()),bWe=T(tw()),CWe=T(ow()),TWe=T(sw()),IWe=T(pw()),wWe=T(yw()),PWe=T(gw()),BWe=T(xw()),AWe=T(Cw()),UWe=T(ww()),MWe=T(Aw()),EWe=T(Ew()),GWe=T(Dw()),kWe=T(Sw()),DWe=T(zw()),OWe=T(jw()),YWe=T(Kw()),SWe=T($w()),FWe=T(Qw()),NWe=T(tP()),zWe=T(oP()),LWe=T(sP()),WWe=T(pP()),jWe=T(yP()),_We=T(gP()),HWe=T(xP()),KWe=T(CP()),qWe=T(wP()),VWe=T(AP()),$We=T(EP()),JWe=T(DP()),ZWe=T(SP()),QWe=T(zP()),XWe=T(jP()),eje=T(KP()),tje=T($P()),rje=T(QP()),ije=T(tB()),oje=T(oB()),nje=T(sB()),aje=T(pB()),sje=T(yB()),lje=T(gB()),mje=T(xB()),pje=T(CB()),uje=T(wB()),cje=T(AB()),yje=T(EB()),fje=T(DB()),dje=T(SB()),gje=T(zB()),hje=T(jB()),Rje=T(KB()),xje=T($B()),vje=T(QB()),bje=T(tA()),Cje=T(oA()),Tje=T(sA()),Ije=T(pA()),wje=T(yA()),Pje=T(gA()),Bje=T(xA()),Aje=T(rU()),Uje=T(vU()),Mje=T(_U()),Eje=T(KM()),Gje=T(tE()),kje=T(aE()),Dje=T(TE()),Oje=T(OE()),Yje=T(d0()),Sje=T(Y0()),Fje=T(Q0()),Nje=T(cG()),zje=T(JG()),Lje=T(jk()),Wje=T(vD()),jje=T(wD()),_je=T(MD()),Hje=T(OD()),Kje=T(zD()),qje=T(HD()),Vje=T(JD()),$je=T(tO()),Jje=T(aO()),Zje=T(uO()),Qje=T(gO()),Xje=T(bO()),e_e=T(PO()),t_e=T(OO()),r_e=T(zO()),i_e=T(HO()),o_e=T(iY()),n_e=T(lY())});Jd();cg();yg();nc();jl();var op=class extends qa{#e;#t;constructor(e,r=In,o=()=>Math.random()){super(e),this.#e=r,this.#t=o}chooseCivilization(e){let r=e[Math.floor(e.length*this.#t())],o=this.player(),a=new r;o.setCivilization(a),this.chooseLeader(a)}chooseLeader(e){let r=this.#e.getByCivilization(e.constructor),o=r[Math.floor(r.length*this.#t())];e.setLeader(new o)}};t(op,"Client");dg();dr();gg();Vn();vc();Ae();Ot();Cg();Z();var Za,Bc=class{constructor(){ye(this,Za,[])}add(e,r,o=null){b(this,Za).push({[e]:{type:"add",index:o,value:r}})}clear(){b(this,Za).splice(0)}remove(e,r=null){b(this,Za).push({[e]:{type:"remove",index:r}})}transferData(){return b(this,Za).slice(0).map(e=>{let r={};return Object.entries(e).forEach(([o,{type:a,index:s,value:p}])=>{r[o]={type:a,index:s,value:typeof p=="function"?p():p}}),r})}update(e,r,o=null){b(this,Za).push({[e]:{type:"update",index:o,value:r}})}};t(Bc,"DataQueue"),Za=new WeakMap;var Bx=Bc;Uc();Ds();_o();Ig();zc();var Lc=class extends Error{constructor(r,o,a){super(r);this.handler=o;this.attempts=a}};t(Lc,"RetryFailed");var kx=Lc;var sp,lp,ql,mp,Vl,pp,up,Wc=class{constructor(e,r=5,o=100){ye(this,sp,0);ye(this,lp,void 0);ye(this,ql,void 0);ye(this,mp,void 0);ye(this,Vl,void 0);ye(this,pp,void 0);ye(this,up,void 0);ke(this,ql,e),ke(this,mp,r),ke(this,Vl,setInterval(()=>this.run(),o)),ke(this,lp,new Promise((a,s)=>{ke(this,up,a),ke(this,pp,s)}))}run(){if(++rx(this,sp)._>b(this,mp)){clearInterval(b(this,Vl)),b(this,pp).call(this,new kx("Retry failed.",b(this,ql),b(this,sp)));return}b(this,ql).call(this)&&(clearInterval(b(this,Vl)),b(this,up).call(this))}then(){return b(this,lp)}};t(Wc,"Retryable"),sp=new WeakMap,lp=new WeakMap,ql=new WeakMap,mp=new WeakMap,Vl=new WeakMap,pp=new WeakMap,up=new WeakMap;var Dx=Wc;Pg();Z();var jc=class extends Fe{constructor(e){super(),Object.assign(this,e),this.addKey(...Object.keys(e))}};t(jc,"TransferObject");var _c=jc;qi();ea();Z();ir();var yp,fp,dp,gp,Gg=class extends Fe{constructor(r,o,a,s){super();ye(this,yp,void 0);ye(this,fp,void 0);ye(this,dp,{size:0});ye(this,gp,void 0);ke(this,yp,r),ke(this,fp,a),b(this,dp).size=s,ke(this,gp,o),this.addKey("_","growth","name","player","tile")}static fromCity(r){let o=ce.getByCity(r);return new Gg(r.name(),r.tile(),r.player(),o.size())}_(){return"City"}name(){return b(this,yp)}player(){return b(this,fp)}growth(){return b(this,dp)}tile(){return b(this,gp)}},ey=Gg;t(ey,"City"),yp=new WeakMap,fp=new WeakMap,dp=new WeakMap,gp=new WeakMap;var Wx=ey;Z();var hp,kg=class extends Fe{constructor(r){super();ye(this,hp,void 0);ke(this,hp,r),this.addKey("_","civilization")}static fromPlayer(r){return new kg(r.civilization())}_(){return"Player"}civilization(){return b(this,hp)}},ty=kg;t(ty,"Player"),hp=new WeakMap;var jx=ty;Z();var Rp,xp,vp,Dg=class extends Fe{constructor(r,o,a){super();ye(this,Rp,void 0);ye(this,xp,void 0);ye(this,vp,void 0);ke(this,Rp,r),ke(this,xp,o),ke(this,vp,a),this.addKey("_","tile","player")}static fromUnit(r){return new Dg(r.constructor.name,r.tile(),r.player())}_(){return b(this,Rp)}player(){return b(this,vp)}tile(){return b(this,xp)}},ry=Dg;t(ry,"Unit"),Rp=new WeakMap,xp=new WeakMap,vp=new WeakMap;var _x=ry;Pe();A();tt();bp();V();jl();ts();He();Ls();Ji();ci();Ke();Z();P();ci();Yg();var uy=class extends S{#e=new Map;#t;#r;constructor(e=Ue,r=d){super(),this.#t=r,this.#r=e,this.addKey("value")}value(e=this.#r.value()){if(!this.#e.has(e)){let[o]=this.#t.process(rs,e);this.#e.set(e,o)}let r=this.#e.get(e);if(typeof r!="number")throw new TypeError("Invalid cache result.");return r}};t(uy,"Year");var cy=new uy;rm();Og();var Vx=t(i=>i instanceof Fe?{"#ref":i.id()}:i,"referenceObject"),Oe=t((...i)=>e=>i.some(r=>e instanceof r)?Vx(e):e,"filterToReference"),qx=t((...i)=>e=>i.some(r=>e instanceof r)?e:Vx(e),"filterToReferenceAllExcept"),Sg=new Map,Fg=new Map,Ng=new Map,le,X,$s,ns,An,Cp,yy=class extends op{constructor(r,o,a){super(r);ye(this,le,t((r=o=>o)=>o=>o instanceof H&&o!==this.player()?(Sg.has(o)||Sg.set(o,jx.fromPlayer(o)),Sg.get(o)):o instanceof we&&o.player()!==this.player()?(Fg.has(o)||Fg.set(o,_x.fromUnit(o)),Fg.get(o)):o instanceof et&&o.player()!==this.player()?(Ng.has(o)||Ng.set(o,Wx.fromCity(o)),Ng.get(o)):o instanceof ue?ie.getByPlayer(this.player()).get(o.x(),o.y()):o instanceof Te?{_:o.constructor.name}:r(o),"#dataFilter"));ye(this,X,new Bx);ye(this,$s,void 0);ye(this,ns,void 0);ye(this,An,void 0);ye(this,Cp,!1);ke(this,$s,new ny),ke(this,An,o),ke(this,ns,a),b(this,ns).call(this,"action",(...s)=>{b(this,$s).emit("action",...s)}),b(this,ns).call(this,"cheat",({name:s,value:p})=>{if(s==="RevealMap"){let u=ie.getByPlayer(this.player()),[y]=u.entries();y.tile().map().entries().forEach(c=>{if(u.includes(c))return;u.register(c);let f=u.getByTile(c);b(this,X).add(u.id(),()=>c.toPlainObject(b(this,le).call(this)),`entries[${u.entries().indexOf(f)}]`)})}if(s==="GrantAdvance"){let[u]=h.filter(c=>c.name===p),y=z.getByPlayer(this.player());if(!u||y.completed(u))return;y.addAdvance(u),b(this,X).add(y.id(),y.toPlainObject(b(this,le).call(this,Oe(H))))}if(s==="GrantGold"){let u=si.getByPlayer(this.player());u.add(p),b(this,X).add(u.id(),u.toPlainObject(b(this,le).call(this,Oe(H))))}if(s==="ModifyUnit"){let{unitId:u,properties:y}=p,[c]=N.getBy("id",u);if(!c)return;["attack","defence","moves","movement","visibility"].forEach(f=>{f in y&&c[f]().set(y[f])}),b(this,X).add(c.id(),c.toPlainObject(b(this,le).call(this,Oe(H))))}this.sendPatchData()}),w.on("engine:plugins:load:failed",(s,p)=>{console.log(s+" failed to load"),console.error(p)}),w.on("player:visibility-changed",(s,p)=>{if(p!==this.player())return;let u=ie.getByPlayer(this.player()),y=u.getByTile(s);if(y===null){new Dx(()=>{let c=u.getByTile(s);return c===null?!1:(b(this,X).add(u.id(),()=>s.toPlainObject(b(this,le).call(this,Oe(H))),`tiles[${u.entries().indexOf(c)}]`),!0)},2,20);return}b(this,X).add(u.id(),()=>y.toPlainObject(b(this,le).call(this,Oe(H))),`tiles[${u.entries().indexOf(y)}]`)}),["unit:created","unit:defeated"].forEach(s=>{w.on(s,p=>{let u=ie.getByPlayer(this.player()),y=u.getByTile(p.tile());if(!!y&&(b(this,X).update(y.id(),()=>y.toPlainObject(b(this,le).call(this,Oe(H)))),p.player()===this.player())){if(s==="unit:created"){let c=N.getByPlayer(this.player()),f=c.indexOf(p),g=N.getByCity(p.city()),G=g.indexOf(p),k=N.getByTile(p.tile()),D=k.indexOf(p);b(this,X).add(r.id(),()=>p.toPlainObject(b(this,le).call(this,Oe(ue,H,Hl,et))),`units[${f}]`),b(this,X).add(y.id(),()=>p.toPlainObject(b(this,le).call(this,Oe(we))),`units[${D}]`),p.city()!==null&&b(this,X).add(p.city().id(),()=>p.toPlainObject(b(this,le).call(this,Oe(we))),`units[${G}]`);return}b(this,X).update(this.player().id(),()=>this.player().toPlainObject(b(this,le).call(this,qx(H,we))))}})}),["unit:destroyed"].forEach(s=>{w.on(s,(p,u)=>{p.player()===this.player()&&p.city()!==null&&b(this,X).update(p.city().id(),()=>p.city().toPlainObject(b(this,le).call(this,Oe(Tn,_s,Y,H,Hl,ue,we))))})}),["unit:moved"].forEach(s=>{w.on(s,(p,u)=>{let y=ie.getByPlayer(this.player()),c=y.getByTile(u.from()),f=y.getByTile(u.to());!c&&!f||(c&&b(this,X).update(c.id(),()=>c.toPlainObject(b(this,le).call(this,Oe(H,et)))),f&&b(this,X).update(f.id(),()=>f.toPlainObject(b(this,le).call(this,Oe(H,et)))),p.player()===this.player()&&p.city()!==null&&b(this,X).update(p.city().id(),()=>p.city().toPlainObject(b(this,le).call(this,Oe(Tn,_s,Y,H,Hl,ue,we)))))})}),["tile-improvement:built","tile-improvement:pillaged"].forEach(s=>{w.on(s,p=>{let u=ie.getByPlayer(this.player()),y=u.getByTile(p);y&&b(this,X).update(y.id(),()=>y.toPlainObject(b(this,le).call(this,Oe(H,et))))})}),w.on("city:captured",(s,p,u)=>{if(u===this.player()){_.getByPlayer(this.player()).indexOf(s)!==-1&&b(this,X).update(this.player().id(),()=>this.player().toPlainObject(b(this,le).call(this,qx(H)))),this.sendNotification(`${p.civilization().name()} have captured our city ${s.name()}!`);return}if(p===this.player()){this.sendNotification(`We have captured ${s.name()} from ${u.civilization().name()}!`);return}}),["city:created","city:captured","city:destroyed","city:grow","city:shrink"].forEach(s=>{w.on(s,p=>{let u=ie.getByPlayer(this.player()),y=u.getByTile(p.tile());!y||b(this,X).update(y.id(),()=>y.toPlainObject(b(this,le).call(this,Oe(H))))})}),w.on("city:shrink",s=>{s.player()===this.player()&&this.sendNotification(`Population decrease in ${s.name()}.`)}),w.on("city:unit-unsupported",(s,p)=>{s.player()===this.player()&&this.sendNotification(`${s.name()} cannot support ${p.constructor.name}.`)}),w.on("city:unsupported-improvement",(s,p)=>{s.player()===this.player()&&this.sendNotification(`${s.name()} cannot support ${p.constructor.name}.`)}),w.on("city:food-storage-exhausted",s=>{s.player()===this.player()&&this.sendNotification(`Food storage exhausted in ${s.name()}!`)}),w.on("city:building-complete",(s,p)=>{let u=ie.getByPlayer(this.player());if(s.city().player()!==this.player()&&p instanceof xe){this.sendNotification(`${u.getByTile(s.city().tile())?s.city().name():"A faraway city"} has completed work on ${p.constructor.name}!`);return}s.city().player()!==this.player()&&!(p instanceof xe)||(b(this,X).update(s.id(),()=>s.toPlainObject(b(this,le).call(this,Oe(ue,we,H)))),this.sendNotification(`${s.city().name()} has completed work on ${p.constructor.name}!`))}),w.on("player:research-complete",(s,p)=>{s.player()===this.player()&&(b(this,X).update(s.id(),()=>s.toPlainObject(b(this,le).call(this,Oe(H)))),this.sendNotification(`You have discovered the secrets of ${p.constructor.name}!`))}),w.on("goody-hut:action-performed",(s,p)=>{let u=s.tile();if(!!N.getByTile(u).some(c=>c.player()===this.player())){if(p instanceof La){this.sendNotification("You have discovered scrolls of ancient wisdom...");return}if(p instanceof Wa){this.sendNotification("You have discovered an advanced tribe...");return}if(p instanceof _a){this.sendNotification("You have discovered valuable treasure...");return}if(p instanceof Ha){this.sendNotification("You have discovered a friendly tribe of skilled mercenaries...");return}}}),w.on("player:defeated",(s,p)=>{s===this.player()&&(this.sendNotification("You have been defeated!"),ui.unregister(...ui.entries()),ta.unregister(...ta.entries()),b(this,An).call(this,"restart",null)),this.sendNotification(`${s.civilization().name()} defeated${p?` by ${p.civilization().name()}`:""}.`)}),w.on("city:civil-disorder",s=>{s.player()===this.player()&&this.sendNotification(`Civil disorder in ${s.name()}!`)})}chooseCivilization(r){let o=t(a=>(this.player().setCivilization(new a),this.chooseLeader(this.player().civilization())),"makeChoice");return new Promise((a,s)=>{if(r.length===1){let[p]=r;o(p).then(()=>a());return}b(this,An).call(this,"chooseCivilization",new _c({choices:r}).toPlainObject()),b(this,ns).call(this,"chooseCivilization",p=>{let[u]=r.filter(y=>y.name===p);if(!u){s(`Invalid civilization ${p} (options: ${r.map(y=>y.name).join(", ")})`);return}o(u).then(()=>a())})})}chooseLeader(r){return new Promise((o,a)=>{let s=In.getByCivilization(r.constructor);if(s.length===1){let[p]=s;r.setLeader(new p),o();return}b(this,An).call(this,"chooseLeader",new _c({choices:s}).toPlainObject()),b(this,ns).call(this,"chooseLeader",p=>{let[u]=s.filter(y=>y.name===p);if(!u){a(`Invalid civilization ${p} (options: ${s.map(y=>y.name).join(", ")})`);return}r.setLeader(new u),o()})})}handleAction(...r){let[o]=r,a=this.player(),s=a.actions(),p=s.filter(f=>f instanceof ni),{name:u,id:y}=o;if(u==="ReassignWorkers"){let[f]=_.getBy("id",o.city);return f&&(Hx(f),b(this,X).update(f.id(),f.toPlainObject(b(this,le).call(this,Oe(H,ue))))),!1}if(u==="EndTurn")return p.length===1&&p.every(f=>f instanceof Hs);if(!u)return console.log("action not specified"),!1;let[c]=s.filter(f=>f.constructor.name===u&&y===(f.value()?f.value().id():void 0));if(!c)return console.log("action not specified"),!1;if(c instanceof Da){let{unitAction:f,target:g}=o,G=c.value(),D=[...G.actions(),...Object.values(G.actionsForNeighbours())].flat().filter(j=>j.constructor.name===f);for(;D.length!==1;){if(D.length===0)return console.log(`action not found: ${f}`),!1;let[j]=ie.getByPlayer(this.player()).filter(Re=>Re.id()===g);if(!j)return console.log(`tile not found: ${g}`),!1;if(D=D.filter(Re=>Re.to()===j.tile()),D.length>1&&!g)return console.log(`too many actions found: ${f} (${D.length})`),!1}let[U]=D;return U.perform(),!1}if(c instanceof Oa){let f=c.value();return f.moves().value()>0&&b(this,X).update(f.id(),f.toPlainObject(b(this,le).call(this,Oe(H,ue)))),f.activate(),!1}if(c instanceof Tn||c instanceof Ka){let f=c.value(),{chosen:g}=o;if(!g)return console.log("no build item specified"),!1;let[G]=f.available().filter(k=>k.item().name===g);return G?(f.build(G.item()),!1):(console.log(`build item not available: ${g}`),!1)}if(c instanceof wx){let f=c.value(),{chosen:g}=o;if(!g)return this.sendNotification("no build item specified"),!1;let[G]=f.available().filter(k=>k.name===g);return G?(f.research(G),!1):(console.log(`build item not available: ${g}`),!1)}if(c instanceof Ja){let f=c.value(),g=si.getByPlayer(this.player());return g.buy(f),b(this,X).update(g.id(),g.toPlainObject(b(this,le).call(this,Oe(H)))),!1}if(c instanceof Qa){let f=c.value(),{chosen:g}=o,[G]=f.available().filter(D=>D.name===g);if(!G)return console.error(`Government type: '${g}' not found.`),!1;f.set(new G);let k=ie.getByPlayer(this.player());return b(this,X).update(k.id(),k.toPlainObject(b(this,le).call(this,Oe(H)))),_.getByPlayer(this.player()).forEach(D=>b(this,X).update(D.id(),D.toPlainObject(b(this,le).call(this,Oe(H,ue,we))))),!1}if(c instanceof $a){let f=c.value(),{value:g}=o;return f.setAll(g.map(([G,k])=>{let[D]=f.all().filter(U=>U.constructor.name===G);return[D.constructor,k]})),_.getByPlayer(this.player()).forEach(G=>b(this,X).update(G.id(),G.toPlainObject(b(this,le).call(this,Oe(H,ue,we))))),!1}return console.log(`unhandled action: ${JSON.stringify(o)}`),!1}sendInitialData(){let r={player:this.player(),turn:Ue,year:cy},o=new _c(r);b(this,An).call(this,"gameData",o.toPlainObject(b(this,le).call(this))),ke(this,Cp,!0)}sendPatchData(){b(this,An).call(this,"gameDataPatch",b(this,X).transferData()),b(this,X).clear()}sendNotification(r){b(this,An).call(this,"gameNotification",{message:r})}takeTurn(){return new Promise((r,o)=>{b(this,Cp)||this.sendInitialData(),setTimeout(()=>{b(this,X).update(Ue.id(),()=>Ue.toPlainObject()),b(this,X).update(cy.id(),()=>cy.toPlainObject()),b(this,X).add(this.player().id(),()=>this.player().toPlainObject(b(this,le).call(this,Oe(ue,ae)))),this.sendPatchData()},1);let a=t((...s)=>{try{if(this.handleAction(...s)){b(this,$s).off("action",a),this.sendPatchData(),setTimeout(()=>r(),100);return}b(this,X).update(this.player().id(),()=>this.player().toPlainObject(b(this,le).call(this,Oe(Kl,ue,et)))),this.sendPatchData()}catch(p){o(p)}},"listener");b(this,$s).on("action",a)})}};t(yy,"DataTransferClient"),le=new WeakMap,X=new WeakMap,$s=new WeakMap,ns=new WeakMap,An=new WeakMap,Cp=new WeakMap;var $x=yy;_o();hm();el();V();ts();var Gt,qd=class{constructor(e){ye(this,Gt,void 0);ke(this,Gt,e),e.receive("start",()=>{this.bindEvents(),this.start()}),e.receive("setOption",({name:r,value:o})=>{b(this,Gt).send("notification",`setting ${r} to ${o}`),w.setOption(r,o)}),e.receive("getOptions",r=>e.send("getOptions",r.reduce((o,a)=>(o[a]=w.option(a),o),{}))),e.receive("setOptions",r=>{Object.entries(r).forEach(([o,a])=>w.setOption(o,a)),e.send("setOptions")})}bindEvents(){b(this,Gt).send("notification","binding events"),w.on("engine:initialise",()=>b(this,Gt).send("notification","initialising...")),w.on("engine:plugins:load:success",e=>b(this,Gt).send("notification",`loaded plugin: ${e}`)),w.on("engine:plugins-loaded",()=>b(this,Gt).send("notification","plugins loaded")),w.on("engine:start",()=>b(this,Gt).send("notification","starting...")),w.on("world:generate-start-tiles",()=>b(this,Gt).send("notification","generating start tiles...")),w.on("world:built",()=>b(this,Gt).send("notification","world built")),w.on("game:start",()=>b(this,Gt).send("notification","game start")),w.on("turn:start",e=>b(this,Gt).send("notification",`turn start ${e}`)),w.on("player:turn-start",e=>b(this,Gt).send("notification",`player turn-start: ${e.civilization().constructor.name}`))}start(){w.on("engine:start",()=>{new Array(parseInt(w.option("players"),10)).fill(0).forEach((e,r)=>{let o=new H,a=r===0?new $x(o,(s,p)=>b(this,Gt).send(s,p),(s,p)=>b(this,Gt).receive(s,p)):new Sn(o);ui.register(o),ko.register(a),b(this,Gt).send("notification","generating world...")})}),w.start(),Promise.resolve().then(()=>(mY(),UL)).then(()=>w.emit("plugins:load:end"))}};t(qd,"Game"),Gt=new WeakMap;var pY=qd;var Vd=class{async request(e){return new Promise(r=>{this.send(e.channel(),...e.args()),this.receiveOnce(e.channel(),o=>r(o))})}};t(Vd,"AbstractTransport");var uY=Vd;var $d=class extends uY{receive(e,r){addEventListener("message",({data:{channel:o,data:a}})=>{o===e&&r(a)})}receiveOnce(e,r){addEventListener("message",({data:{channel:o,data:a}})=>{o===e&&r(a)},{once:!0})}send(e,r){postMessage({channel:e,data:r})}};t($d,"ParentTransport");var cY=$d;var R_e=new pY(new cY);})();
//# sourceMappingURL=backend.js.map
