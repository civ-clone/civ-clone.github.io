"use strict";(()=>{var iS=Object.create;var tp=Object.defineProperty;var oS=Object.getOwnPropertyDescriptor;var nS=Object.getOwnPropertyNames;var aS=Object.getPrototypeOf,sS=Object.prototype.hasOwnProperty;var t=(i,e)=>tp(i,"name",{value:e,configurable:!0});var n=(i,e)=>()=>(i&&(e=i(i=0)),e);var b=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),iu=(i,e)=>{for(var r in e)tp(i,r,{get:e[r],enumerable:!0})},FR=(i,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of nS(e))!sS.call(i,a)&&a!==r&&tp(i,a,{get:()=>e[a],enumerable:!(o=oS(e,a))||o.enumerable});return i};var C=(i,e,r)=>(r=i!=null?iS(aS(i)):{},FR(e||!i||!i.__esModule?tp(r,"default",{value:i,enumerable:!0}):r,i)),R=i=>FR(tp({},"__esModule",{value:!0}),i);var kR=(i,e,r)=>{if(!e.has(i))throw TypeError("Cannot "+r)};var v=(i,e,r)=>(kR(i,e,"read from private field"),r?r.call(i):e.get(i)),de=(i,e,r)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,r)},De=(i,e,r,o)=>(kR(i,e,"write to private field"),o?o.call(i,r):e.set(i,r),r),SR=(i,e,r,o)=>({set _(a){De(i,e,a,r)},get _(){return v(i,e,o)}});var F,Al,xe=n(()=>{F=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return this.#e.some(r=>e instanceof r)}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(o=>{let a=o[e];return a instanceof Function?a.bind(o)()===r:o[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let o=this.#t.indexOf(r);o>-1&&this.#t.splice(o,1)})}};t(F,"EntityRegistry");Al=F});var ou,oe,Vt=n(()=>{ou=class{#e;#t;#r;constructor(e,r,o){this.#e=r,this.#t=o,this.#r=e}data(...e){return this.#t(...e)}key(){return this.#e}type(){return this.#r}};t(ou,"AdditionalData");oe=ou});var nu,ne,Dt=n(()=>{xe();Vt();nu=class extends F{constructor(){super(oe)}getByType(e){return this.filter(r=>r.type()===e||Object.prototype.isPrototypeOf.call(r.type(),e)||Object.prototype.isPrototypeOf.call(r.type().prototype,e))}};t(nu,"AdditionalDataRegistry");ne=new nu});var au,lS,rp,S,Ye,Z=n(()=>{Dt();xe();au={},lS=t(i=>{let e=i.sourceClass().name,r=au[e];return r||(au[e]=0),r===Number.MAX_SAFE_INTEGER&&(au[e]=BigInt(r)),e+"-"+(++au[e]).toString(36)},"idProvider"),rp=t((i,e,r=a=>a,o=ne)=>{if(i=r(i),i instanceof Al&&(i=i.entries()),Array.isArray(i))return i.map(a=>rp(a,e,r,o));if(i instanceof S){let a=i.id();if(!(a in e)){let s={_:i.sourceClass().name};e[a]=s,i.keys().forEach(p=>{let u=i[p]instanceof Function?i[p]():i[p];s[p]=rp(u,e,r,o)}),o.getByType(i.sourceClass()).forEach(p=>{s[p.key()]=rp(p.data(i),e,r,o)})}return{"#ref":a}}return i instanceof Function?{_:i.name}:i&&i instanceof Object?Object.entries(i).reduce((a,[s,p])=>(a[s]=rp(p,e,r,o),a),{}):i},"toPlainObject"),S=class{#e;#t=["id"];constructor(){this.#e=lS(this)}addKey(...e){this.#t.push(...e)}id(){return this.#e}keys(){return this.#t}sourceClass(){return this.constructor}toPlainObject(e=o=>o,r=ne){let o={};return{hierarchy:rp(this,o,e,r),objects:o}}};t(S,"DataObject");Ye=S});var su,Er,qa=n(()=>{Z();su=class extends S{#e;#t;constructor(e,r){super(),this.#e=e,this.#t=r,this.addKey("value")}player(){return this.#e}value(){return this.#t}};t(su,"PlayerAction");Er=su});var lu,ni,Vs=n(()=>{qa();lu=class extends Er{};t(lu,"MandatoryPlayerAction");ni=lu});var Va,YR=n(()=>{Vs();Va=class extends ni{};t(Va,"ActiveUnit")});var Ja,zR=n(()=>{qa();Ja=class extends Er{};t(Ja,"InactiveUnit")});var Og=n(()=>{YR();zR()});var mu,x,M=n(()=>{Z();mu=class extends Ye{};t(mu,"Advance");x=mu});var Ee,Ki=n(()=>{Ee=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return typeof e=="function"&&this.#e.some(r=>Object.prototype.isPrototypeOf.call(r,e)||Object.prototype.isPrototypeOf.call(r.prototype,e))}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(o=>{let a=o[e];return a instanceof Function?a.bind(o)()===r:o[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let o=this.#t.indexOf(r);o>-1&&this.#t.splice(o,1)})}};t(Ee,"ConstructorRegistry")});var pu,O,B=n(()=>{M();Ki();pu=class extends Ee{constructor(){super(x)}};t(pu,"AdvanceRegistry");O=new pu});var Gl,l,w=n(()=>{Gl=class{#e=null;constructor(e){e&&(this.#e=e)}validate(...e){return this.#e===null?!0:this.#e(...e)}};t(Gl,"Criterion");l=Gl});var uu,cu,Rg=n(()=>{w();uu=class extends l{#e=[];constructor(...e){super(),e.forEach(r=>{this.#e.push(r)})}criteria(){return this.#e}validate(...e){return this.#e.every(r=>r.validate(...e))}};t(uu,"Criteria");cu=uu});var yu,$a,xg=n(()=>{Rg();yu=class extends cu{};t(yu,"And");$a=yu});var fu,m,T=n(()=>{fu=class{#e;constructor(e){this.#e=e}apply(...e){return this.#e(...e)}};t(fu,"Effect");m=fu});var du,Fr,Za=n(()=>{du=class{#e;constructor(e=2e3){this.#e=e}value(){return this.#e}};t(du,"Priority");Fr=du});var Kn,Qa,Bl=n(()=>{Za();Kn=class extends Fr{constructor(){super(1e3)}};t(Kn,"High");Qa=Kn});var Xe,NR,vg=n(()=>{Za();Xe=class extends Fr{constructor(){super(3e3)}};t(Xe,"Low");NR=Xe});var Ul,LR=n(()=>{Za();Ul=class extends Fr{constructor(){super(2e3)}};t(Ul,"Normal")});var qn=n(()=>{Bl();vg();LR()});var gu,g,G=n(()=>{xg();w();T();qn();gu=class{#e;#t=!0;#r;#i=new Ul;constructor(...e){let r=[];e.forEach(o=>{if(o instanceof m){if(this.#r)throw new TypeError("Rule: effect already specified, but another was provided.");this.#r=o;return}if(o instanceof l){r.push(o);return}this.#i=o}),r.length&&(this.#e=new $a(...r))}disable(){this.#t=!1}enable(){this.#t=!0}enabled(){return this.#t}priority(){return this.#i}process(...e){if(!!this.#t&&this.#r instanceof m)return this.#r.apply(...e)}validate(...e){return this.#t?this.#e instanceof l?this.#e.validate(...e):!0:!1}};t(gu,"Rule");g=gu});var hu,d,I=n(()=>{xe();G();hu=class extends F{#e=new Map;constructor(){super(g)}entries(){return super.entries().sort((e,r)=>e.priority().value()-r.priority().value())}get(e){return this.#e.has(e)||this.#e.set(e,this.filter(r=>r.enabled()&&r instanceof e)),this.#e.get(e)||[]}invalidateCache(e){this.#e.delete(e instanceof g?e.constructor:e)}process(e,...r){return this.get(e).filter(o=>o.validate(...r)).map(o=>o.process(...r))}register(...e){super.register(...e),e.forEach(r=>this.invalidateCache(r))}unregister(...e){super.unregister(...e),e.forEach(r=>this.invalidateCache(r))}};t(hu,"RuleRegistry");d=new hu});var Ou,Xa,Ru=n(()=>{G();Ou=class extends g{};t(Ou,"Complete");Xa=Ou});var xu,vu,bg=n(()=>{G();xu=class extends g{};t(xu,"Cost");vu=xu});var bu,Cu,Cg=n(()=>{G();bu=class extends g{};t(bu,"Requirements");Cu=bu});var es,L,Ve=n(()=>{Z();es=class extends S{#e=[];#t=null;constructor(e=0,r="initial"){super(),this.addKey("value","values"),this.add(e,r)}add(e,r=""){if(e instanceof es)return this.add(e.value(),r);this.#e.push([e,r]),this.#t=null}clone(){return new this.constructor(this)}set(e,r=""){if(this.#e.splice(0),e instanceof es)return this.set(e.value(),r);this.#e.push([e,r]),this.#t=e}subtract(e,r=""){if(e instanceof es)return this.subtract(e.value(),r);this.#e.push([-e,r]),this.#t=null}value(){return this.#t===null&&(this.#t=this.#e.reduce((e,[r])=>e+r,0)),this.#t}values(){return this.#e}};t(es,"Yield");L=es});var Js,WR=n(()=>{Ve();Js=class extends L{};t(Js,"Research")});var jR=n(()=>{WR()});var Tu,Pu,Tg=n(()=>{G();Tu=class extends g{};t(Tu,"Started");Pu=Tu});var Iu,Ml,wu=n(()=>{B();Z();I();Ru();bg();Cg();jR();Tg();Iu=class extends S{#e;#t=[];#r=null;#i;#o=new Js(1/0);#a=new Js(0);#n;constructor(e,r=O,o=d){super(),this.#e=r,this.#i=e,this.#n=o,this.addKey("available","complete","cost","progress","researching")}add(e){this.#a.add(e),this.check()}addAdvance(e){if(this.#t.some(o=>o instanceof e))return;this.#r===e&&(this.#r=null);let r=new e;this.#t.push(r),this.#n.process(Xa,this,r)}available(){let e=this.#n.get(Cu);return this.#e.filter(r=>e.filter(o=>o.validate(r,this.#t)).every(o=>o.process(r,this.#t)===!0)&&!this.#t.some(o=>o instanceof r))}check(){if(this.#r!==null&&this.#a.value()>=this.#o.value()){let e=new this.#r;this.#t.push(e),this.#r=null,this.#a.subtract(this.#o),this.#o.set(1/0),this.#n.process(Xa,this,e)}}complete(){return this.#t}completed(e){return this.#t.some(r=>r instanceof e)}cost(){return this.#o}player(){return this.#i}progress(){return this.#a}research(e){let[r]=this.#n.process(vu,e,this);this.#o.set(r),this.#r=e,this.#n.process(Pu,this,e)}researching(){return this.#r}};t(Iu,"PlayerResearch");Ml=Iu});var Au,N,He=n(()=>{xe();wu();Au=class extends F{constructor(){super(Ml)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of results for player.");return r[0]}};t(Au,"PlayerResearchRegistry");N=new Au});var Dl,El,ip=n(()=>{Dl=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}goodyHut(){return this.#e}perform(){}unit(){return this.#t}};t(Dl,"Action");El=Dl});var ts,HR=n(()=>{He();ip();ts=class extends El{#e;#t;constructor(e,r,o=N,a=()=>Math.random()){super(e,r),this.#e=o,this.#t=a}perform(){let e=this.#e.getByPlayer(this.unit().player()),r=e.available(),o=r[Math.floor(r.length*this.#t())];e.addAdvance(o)}};t(ts,"Advance")});var Gu,cr,$s=n(()=>{G();Gu=class extends g{};t(Gu,"Captured");cr=Gu});var Bu,et,Fl=n(()=>{G();Bu=class extends g{};t(Bu,"Cost");et=Bu});var Uu,jo,Mu=n(()=>{G();Uu=class extends g{};t(Uu,"Created");jo=Uu});var Du,yr,Zs=n(()=>{G();Du=class extends g{};t(Du,"Destroyed");yr=Du});var Eu,Fu,Pg=n(()=>{G();Eu=class extends g{};t(Eu,"Created");Fu=Eu});var ku,vn,kl=n(()=>{Z();I();Pg();ku=class extends S{#e;constructor(e=d){super(),this.#e=e,this.#e.process(Fu,this)}clone(){return new this.constructor(this.#e)}};t(ku,"Terrain");vn=ku});var W,_R=n(()=>{kl();W=class extends vn{};t(W,"Land")});var Jt,Ig=n(()=>{kl();Jt=class extends vn{};t(Jt,"Water")});var $t=n(()=>{_R();Ig()});var Su,Yu,wg=n(()=>{G();Su=class extends g{};t(Su,"YieldModifier");Yu=Su});var zu,ai,Ag=n(()=>{G();zu=class extends g{};t(zu,"Yield");ai=zu});var Sl,ce,qi=n(()=>{Z();$t();I();Lu();Ve();wg();Ag();Sl=class extends S{#e;#t=[];#r;#i;#o;#a;#n=new Map;constructor(e,r,o,a,s=d){super(),this.#o=e,this.#a=r,this.#i=o,this.#e=a,this.#r=s,this.addKey("terrain","isCoast","isLand","isWater","x","y","yields")}clearYieldCache(e=null){this.#n.delete(e)}getAdjacent(){return this.getAdjacentDirections().map(e=>this.getNeighbour(e))}getAdjacentDirections(){return["n","e","s","w"]}getNeighbour(e){return e==="n"?this.#e.get(this.#o,this.#a-1):e==="ne"?this.#e.get(this.#o+1,this.#a-1):e==="e"?this.#e.get(this.#o+1,this.#a):e==="se"?this.#e.get(this.#o+1,this.#a+1):e==="s"?this.#e.get(this.#o,this.#a+1):e==="sw"?this.#e.get(this.#o-1,this.#a+1):e==="w"?this.#e.get(this.#o-1,this.#a):this.#e.get(this.#o-1,this.#a-1)}getNeighbouringDirections(){return["n","ne","e","se","s","sw","w","nw"]}getNeighbours(){return this.#t.length||(this.#t=this.getNeighbouringDirections().map(e=>this.getNeighbour(e))),this.#t}getSurroundingArea(e=2){return Nu.fromSurrounding(this,e)}distanceFrom(e){let r=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[o]=r.map(([a,s])=>Math.hypot(this.#o-e.x()+a*this.#e.width(),this.#a-e.y()+s*this.#e.height())).sort((a,s)=>a-s);return o}isCoast(){let e=this;return e.isWater()&&e.getNeighbours().some(r=>r.isLand())||e.isLand()&&e.getNeighbours().some(r=>r.isWater())}isLand(){return this.#i instanceof W}isNeighbourOf(e){return this.getNeighbours().includes(e)}isWater(){return this.#i instanceof Jt}map(){return this.#e}score(e=null,r=[[L,3]]){return this.yields(e).map(a=>{let[s]=r.filter(([u])=>a instanceof u),p=s?s[1]||1:0;return a.value()*p}).reduce((a,s)=>a+s,0)}terrain(){return this.#i}setTerrain(e){this.#i=e}x(){return this.#o}y(){return this.#a}yields(e=null){if(!this.#n.has(e)){let r=this.#r.process(ai,this,e).flat();this.#r.process(Yu,this,e,r).flat(),this.#n.set(e,r)}return this.#n.get(e)}};t(Sl,"Tile");ce=Sl});var Yl,Nu,Lu=n(()=>{xe();qi();Yl=class extends F{static from(...e){return new this(...e)}static fromSurrounding(e,r=2){let o=t(a=>{let s=[];for(let p=e.x()-a;p<=e.x()+a;p++)for(let u=e.y()-a;u<=e.y()+a;u++)s.push([p,u]);return s},"gen");return this.from(...o(r).map(([a,s])=>e.map().get(a,s)))}constructor(...e){super(Sl),this.register(...e)}push(...e){this.register(...e)}shift(){let[e]=this.entries();return this.unregister(e),e}score(e=null,r=[]){return this.entries().reduce((o,a)=>o+a.score(e,r),0)}yields(e=null){return this.entries().flatMap(r=>r.yields(e))}};t(Yl,"Tileset");Nu=Yl});var zl,Ho,Nl=n(()=>{G();zl=class extends g{};t(zl,"Yield");Ho=zl});var Wu,Qs,ju=n(()=>{G();Wu=class extends g{};t(Wu,"YieldModifier");Qs=Wu});var Hu,tt,Vn=n(()=>{Z();I();$s();Fl();Mu();Zs();Lu();Ve();Nl();ju();Hu=class extends S{#e;#t;#r;#i;#o;#a;#n=new Nu;constructor(e,r,o,a=d){super(),this.#e=o,this.#t=e,this.#r=e,this.#o=r,this.#a=this.#o.getSurroundingArea(),this.#n.push(r),this.#i=a,this.#i.process(jo,this),this.addKey("name","originalPlayer","player","tile","tiles","tilesWorked","yields")}capture(e){let r=this.#r;this.#r=e,this.#i.process(cr,this,e,r)}destroy(e=null){this.#i.process(yr,this,e)}name(){return this.#e}setName(e){this.#e=e}originalPlayer(){return this.#t}player(){return this.#r}tile(){return this.#o}tiles(){return this.#a}tilesWorked(){return this.#n}yields(){let e=[];return[this.#i.get(Ho),this.#i.get(Qs),this.#i.get(et)].flat().forEach(r=>{if(!r.validate(this,e))return;let o=r.process(this,e);if(!!o){if(o instanceof L){e.push(o);return}o.forEach(a=>e.push(a))}}),e}};t(Hu,"City");tt=Hu});var _u,j,rt=n(()=>{xe();Vn();_u=class extends F{constructor(){super(tt)}getByPlayer(e){return this.filter(r=>r.player()===e)}getByTile(e){let[r]=this.filter(o=>o.tile()===e);return r??null}};t(_u,"CityRegistry");j=new _u});var rs,KR=n(()=>{rt();I();ip();Vn();rs=class extends El{#e;constructor(e,r,o=j){super(e,r),this.#e=o}perform(e=d){let r=this.unit().player(),o=new tt(r,this.goodyHut().tile(),r.civilization().getCityName(!0),e);this.#e.register(o)}};t(rs,"City")});var is,qR,Ku=n(()=>{Z();I();is=class extends S{static build(e,r=d){throw new TypeError("createFromObject: Must be overridden in extending class")}};t(is,"Buildable");qR=is});var qu,bn,Ll=n(()=>{Ki();Ku();qu=class extends Ee{constructor(){super(qR)}};t(qu,"AvailableCityBuildItemsRegistry");bn=new qu});var Zt,VR,op=n(()=>{w();G();Zt=class extends g{process(e,r){let o=super.process(e,r);if(!(o instanceof Gl))throw new TypeError("Invalid build rule.");return o}};t(Zt,"Build");VR=Zt});var Vu,Ju,Gg=n(()=>{Z();Vu=class extends Ye{#e;constructor(e){super(),this.addKey("value"),this.#e=e}value(){return this.#e}};t(Vu,"BuildCost");Ju=Vu});var np,JR,Wl,mS,ap=n(()=>{Gg();w();T();G();np=class extends g{};t(np,"BuildCost");JR=np,Wl=t((i,e)=>mS([[i,e]]),"buildCost"),mS=t(i=>i.map(([e,r])=>new np(new l(o=>o.item()===e),new m(()=>new Ju(r)))),"buildCosts")});var $u,Zu,Bg=n(()=>{I();Gg();ap();Z();$u=class extends Ye{#e;#t=new Ju(1/0);#r;#i;constructor(e,r=null,o=d){super(),this.#r=e,this.#e=r,this.#i=o,this.addKey("cost","item")}cost(){if(!Number.isFinite(this.#t.value())){let[e]=this.#i.process(JR,this,this.#e);e&&(this.#t=e)}return this.#t}item(){return this.#r}};t($u,"BuildItem");Zu=$u});var Xs,$R=n(()=>{Ve();Xs=class extends L{};t(Xs,"BuildProgress")});var ZR=n(()=>{$R()});var Qu,QR,XR=n(()=>{G();Qu=class extends g{};t(Qu,"BuildingCancelled");QR=Qu});var Xu,Jn,sp=n(()=>{G();Xu=class extends g{};t(Xu,"BuildingComplete");Jn=Xu});var ec,jl,tc=n(()=>{Ll();Z();I();op();Bg();ZR();XR();sp();ec=class extends S{#e;#t=null;#r;#i=new Xs(1/0);#o=new Xs;#a;constructor(e,r=bn,o=d){super(),this.#e=r,this.#r=e,this.#a=o,this.addKey("available","building","city","cost","progress","remaining")}add(e){this.#o.add(e)}available(){let e=this.#a.get(VR);return this.#e.filter(r=>e.filter(o=>o.validate(this.city(),r)).every(o=>o.process(this.city(),r).validate())).map(r=>new Zu(r,this.city(),this.#a))}build(e){let r=this.getAvailable(e);if(!r)throw new TypeError(`Cannot build ${e.name}, it's not available.`);this.#t=r,this.#i.set(this.#t.cost().value())}building(){return this.#t}check(){if(this.#o.value()>=this.#i.value()&&this.#t){let e=this.#t.item().build(this.#r,this.#a);return this.#o.set(0),this.#t=null,this.#i.set(1/0),this.#a.process(Jn,this,e),e}return null}city(){return this.#r}cost(){return this.#i}getAvailable(e){return this.available().filter(r=>r.item()===e)[0]}progress(){return this.#o}remaining(){return this.#i.value()-this.#o.value()}revalidate(){this.#t&&!this.getAvailable(this.#t.item())&&(this.#t=null,this.#i.set(1/0),this.#a.process(QR,this))}};t(ec,"CityBuild");jl=ec});var rc,Qt,$n=n(()=>{xe();tc();rc=class extends F{constructor(){super(jl)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of entities returned.");return r[0]}};t(rc,"CityBuildRegistry");Qt=new rc});var ic,el,Ug=n(()=>{G();ic=class extends g{};t(ic,"Spend");el=ic});var oc,nc,Mg=n(()=>{$n();I();Ug();Ve();oc=class extends L{#e;#t;#r;constructor(e,r=Qt,o=d){super(),this.#e=e,this.#t=o,this.#r=r}buy(e){let r=this.#r.getByCity(e),o=this.cost(e);e.player()!==this.#e||this.value()<o.value()||(r.add(new L(r.remaining())),this.subtract(o.value()))}cost(e){let r=this.#r.getByCity(e),o=new L;return this.#t.process(el,r,o).reduce((a,s)=>(a.add(s),a))}player(){return this.#e}};t(oc,"PlayerTreasury");nc=oc});var ac,si,tl=n(()=>{xe();Mg();ac=class extends F{constructor(){super(nc)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTreasuries for player.");return r[0]}};t(ac,"PlayerTreasuryRegistry");si=new ac});var Xt,sc,Hl=n(()=>{Ve();Xt=class extends L{};t(Xt,"Gold");sc=Xt});var os,ex=n(()=>{tl();ip();Hl();os=class extends El{#e;constructor(e,r,o=si){super(e,r),this.#e=o}perform(){this.#e.getByPlayer(this.unit().player()).add(new Xt(50))}};t(os,"Gold")});var lc,mc,Dg=n(()=>{G();lc=class extends g{};t(lc,"Unit");mc=lc});var ns,tx=n(()=>{ip();I();Dg();ns=class extends Dl{#e;#t;constructor(e,r,o=()=>Math.random(),a=d){super(e,r),this.#e=o,this.#t=a}perform(){this.#t.process(mc,this.goodyHut(),this.unit())}};t(ns,"Unit")});var Eg=n(()=>{HR();KR();ex();tx()});var as,rx=n(()=>{qa();as=class extends Er{};t(as,"ChangeProduction")});var Cn,ix=n(()=>{Vs();Cn=class extends ni{};t(Cn,"CityBuild")});var Fg=n(()=>{rx();ix()});var ss,ox,pc=n(()=>{ss=class{#e;constructor(e){this.#e=e}player(){return this.#e}takeTurn(){return new Promise((e,r)=>r(new TypeError("Client#takeTurn must be implemented.")))}};t(ss,"Client");ox=ss});var uc,ls,lp=n(()=>{Ve();uc=class extends L{#e;constructor(e,r){super(r),this.#e=e}leader(){return this.#e}};t(uc,"Trait");ls=uc});var cc,yc,kg=n(()=>{xe();lp();cc=class extends F{constructor(){super(ls)}getByLeader(e){return this.getBy("leader",e)}getBySubclass(e){return this.filter(r=>r instanceof e)}};t(cc,"TraitRegistry");yc=new cc});var fc,te,st=n(()=>{kg();Z();fc=class extends S{#e=[];constructor(e=yc){super();let r=e.getByLeader(this.sourceClass());this.#e.push(...r),this.addKey("name")}static civilization(){throw new TypeError("Must be implemented in extending class")}name(){throw new TypeError("Must be implemented in extending class")}traits(){return[...this.#e]}};t(fc,"Leader");te=fc});var dc,Tn,_l=n(()=>{Ki();st();dc=class extends Ee{constructor(){super(te)}getByCivilization(e){return this.getBy("civilization",e)}};t(dc,"LeaderRegistry");Tn=new dc});var ms,nx=n(()=>{qa();ms=class extends Er{};t(ms,"AdjustTradeRates")});var Sg=n(()=>{nx()});var gc,Te,fr=n(()=>{G();gc=class extends g{};t(gc,"Busy");Te=gc});var rl,ax,Yg=n(()=>{Vs();rl=class extends ni{};t(rl,"ChooseResearch");ax=rl});var hc,Oc,zg=n(()=>{G();hc=class extends g{};t(hc,"Cost");Oc=hc});var Pn,Ng,Rc=n(()=>{Ve();Pn=class extends L{};t(Pn,"FoodStorage");Ng=Pn});var xc,pp,Lg=n(()=>{G();xc=class extends g{};t(xc,"FoodStorage");pp=xc});var vc,In,bc=n(()=>{G();vc=class extends g{};t(vc,"Grow");In=vc});var Cc,il,Wg=n(()=>{G();Cc=class extends g{};t(Cc,"Shrink");il=Cc});var Tc,ol,Pc=n(()=>{Z();I();zg();Rc();Lg();bc();Wg();Tc=class extends S{#e;#t=new Ng(1/0);#r=new Ng;#i;#o=1;constructor(e,r=d){super(),this.#e=e,this.#i=r,this.setCost(),this.addKey("cost","progress","size")}add(e){this.#r.add(e)}check(){this.#i.process(pp,this)}city(){return this.#e}cost(){return this.#t}setCost(){let e=this.#i.process(Oc,this);e.length>0&&this.#t.set(e[0],"setCost")}empty(){this.#r.subtract(this.#r.value())}grow(){this.#o++,this.#i.process(In,this)}progress(){return this.#r}shrink(){this.#o--,this.#i.process(il,this)}size(){return this.#o}};t(Tc,"CityGrowth");ol=Tc});var Ic,up,jg=n(()=>{G();Ic=class extends g{};t(Ic,"Created");up=Ic});var wc,k,Ge=n(()=>{Ku();I();jg();wc=class extends is{#e;#t;constructor(e,r=d){super(),this.#e=e,this.#t=r,this.#t.process(up,this,e)}city(){return this.#e}static build(e,r=d){return new this(e,r)}};t(wc,"CityImprovement");k=wc});var Ac,ge,er=n(()=>{Z();Ac=class extends S{#e;#t;#r;constructor(e,r,o){super(),this.#e=e,this.#t=r,this.#r=o,this.addKey("name","value")}civilization(){return this.#e}name(){return this.#t}value(){return this.#r}};t(Ac,"Attribute");ge=Ac});var Kl,he,tr=n(()=>{xe();er();Kl=class extends F{constructor(){super(ge)}getByCivilization(e){return this.getBy("civilization",e)}getByName(e){return this.getBy("name",e)}};t(Kl,"AttributeRegistry");he=new Kl});var Gc,Q,Et=n(()=>{Gc=class{#e;#t;#r=!1;constructor(e,r,o=!1){this.#e=e,this.#t=r,this.#r=o}name(){return this.#e}civilization(){return this.#t}capital(){return this.#r}};t(Gc,"CityName");Q=Gc});var Bc,$,gt=n(()=>{xe();Et();Bc=class extends F{#e=1;#t;constructor(e=()=>Math.random()){super(Q),this.#t=e}takeByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1);return r instanceof Q?(this.unregister(r),r.name()):this.takeUnassociated()}takeCapitalByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1).filter(o=>o.capital());return r instanceof Q?(this.unregister(r),r.name()):this.takeByCivilization(e)}takeUnassociated(){let[e]=this.getBy("civilization",null).sort(()=>Math.floor(this.#t()*3)-1);return e instanceof Q?(this.unregister(e),e.name()):`City #${this.#e++}`}};t(Bc,"CityNameRegistry");$=new Bc});var Uc,me,Ft=n(()=>{tr();gt();Z();Uc=class extends S{#e=null;#t;#r=new Kl;constructor(e=he,r=$){super(),this.#t=r,this.#r.register(...e.getByCivilization(this.sourceClass())),this.addKey("name","leader","attributes")}attributes(){return this.#r.entries()}name(){return this.constructor.name}leader(){return this.#e}setLeader(e){this.#e=e}getCityName(e=!1){let r=this.sourceClass();return e?this.#t.takeCapitalByCivilization(r):this.#t.takeByCivilization(r)}};t(Uc,"Civilization");me=Uc});var ps,sx=n(()=>{qa();ps=class extends Er{value(){return super.value()}};t(ps,"CompleteProduction")});var Hg=n(()=>{sx()});var nl,Dc,Ec=n(()=>{Vs();nl=class extends ni{};t(nl,"EndTurn");Dc=nl});var Fc,ht,Zn=n(()=>{G();Fc=class extends g{};t(Fc,"Action");ht=Fc});var kc,li,al=n(()=>{G();kc=class extends g{};t(kc,"Added");li=kc});var Sc,_g,mx=n(()=>{qa();Sc=class extends Er{};t(Sc,"HiddenPlayerAction");_g=Sc});var Yc,_,_o=n(()=>{Z();I();Zn();al();mx();Vs();Yc=class extends S{#e=null;#t;constructor(e=d){super(),this.#t=e,this.#t.process(li,this),this.addKey("actions","civilization","mandatoryActions")}action(){let[e]=this.actions();return e}actions(){return this.#t.process(ht,this).flat().filter(e=>!(e instanceof _g))}civilization(){if(this.#e===null)throw new TypeError("Player#civilization is unset.");return this.#e}hasActions(){return!!this.action()}hasMandatoryActions(){return this.actions().some(e=>e instanceof ni)}hiddenActions(){return this.#t.process(ht,this).flat().filter(e=>e instanceof _g)}mandatoryAction(){let[e]=this.mandatoryActions();return e}mandatoryActions(){return this.actions().filter(e=>e instanceof ni)}setCivilization(e){this.#e=e}};t(Yc,"Player");_=Yc});var zc,ql,Kg=n(()=>{Dt();Z();qi();zc=class extends S{#e={};#t;#r;#i;constructor(e,r,o=ne){super(),this.#t=o,this.#r=r,this.#i=e,this.addKey("isCoast","isLand","isWater","terrain","x","y","yields"),this.setAdditionalData()}addKey(...e){super.addKey(...e)}isCoast(){return this.#i.isCoast()}isLand(){return this.#i.isLand()}isWater(){return this.#i.isWater()}player(){return this.#r}setAdditionalData(){this.#t.getByType(ce).forEach(e=>{this.#e[e.key()]=e.data(this.#i),Object.defineProperty(this,e.key(),{configurable:!0,value:()=>e.data(this.#i)}),this.addKey(e.key())})}terrain(){return this.#i.terrain()}tile(){return this.#i}update(){this.#i.clearYieldCache(this.#r),this.setAdditionalData()}x(){return this.#i.x()}y(){return this.#i.y()}yields(){return this.#i.yields(this.#r)}};t(zc,"PlayerTile");ql=zc});var Nc,px,ux=n(()=>{kl();Nc=class extends vn{};t(Nc,"Unknown");px=Nc});var Lc,cx,yx=n(()=>{qi();ux();Lc=class extends ce{constructor(e,r,o){super(e,r,new px,o)}};t(Lc,"UndiscoveredTile");cx=Lc});var Wc,jc,qg=n(()=>{G();Wc=class extends g{};t(Wc,"VisibilityChanged");jc=Wc});var Hc,Vl,_c=n(()=>{Z();I();Kg();qi();yx();qg();Hc=class extends S{#e;#t;#r=[];#i;constructor(e,r,o=d){super(),this.#e=e,this.#i=r,this.#t=o,this.addKey("height","tiles","width")}entries(){return this.#r}filter(e){return this.entries().filter(e)}forEach(e){return this.#r.forEach(e)}get(e,r){let[o]=this.entries().filter(a=>a.x()===e&&a.y()===r);return o||new cx(e,r,this.#i)}getByTile(e){let[r]=this.filter(o=>o.tile()===e);return r??null}height(){return this.#i.height()}includes(e){return e instanceof ce?!!this.getByTile(e):this.#r.includes(e)}map(e){return this.#r.map(e)}player(){return this.#e}register(...e){e.forEach(r=>{this.includes(r)||(this.#r.push(new ql(r,this.#e)),this.#t.process(jc,r,this.player()))})}tiles(){return this.entries()}width(){return this.#i.width()}};t(Hc,"PlayerWorld");Vl=Hc});var cs,gx=n(()=>{qa();cs=class extends Er{};t(cs,"Revolution")});var Vg=n(()=>{gx()});var Vi,hx=n(()=>{Ve();Vi=class extends L{};t(Vi,"Attack")});var mi,Ox=n(()=>{Ve();mi=class extends L{};t(mi,"Defence")});var Ji,Rx,Jg=n(()=>{Ve();Ji=class extends L{};t(Ji,"Movement");Rx=Ji});var Zl,xx=n(()=>{Jg();Zl=class extends Rx{};t(Zl,"Moves")});var ys,vx=n(()=>{Ve();ys=class extends L{};t(ys,"Visibility")});var Ql=n(()=>{hx();Ox();Jg();xx();vx()});var Ot,$g,pi,wn,Xl,Zg=n(()=>{w();T();G();Ot=class extends g{};t(Ot,"Action");$g=Ot,pi=new l(i=>i.moves().value()>=.1),wn=new l((i,e,r=i.tile())=>r===e),Xl=new l((i,e,r=i.tile())=>e.isNeighbourOf(r))});var $c,em,Qg=n(()=>{G();$c=class extends g{};t($c,"Activate");em=$c});var Zc,Qn,Qc=n(()=>{G();Zc=class extends g{};t(Zc,"Created");Qn=Zc});var Xc,Xn,ey=n(()=>{G();Xc=class extends g{};t(Xc,"Destroyed");Xn=Xc});var ty,ry,Xg=n(()=>{G();ty=class extends g{};t(ty,"Visibility");ry=ty});var fs,sl,hp,bx,tm=n(()=>{Ql();w();T();G();fs=class extends g{};t(fs,"BaseYield");sl=class extends g{};t(sl,"Yield");hp=sl,bx=t((i,e=1,r=1,o=1,a=1)=>[...[[Vi,e],[mi,r],[Ji,o],[ys,a]].flatMap(([s,p])=>[new sl(new l(u=>u instanceof i),new l((u,y)=>y instanceof s),new m((u,y)=>y.set(p))),new fs(new l(u=>u===i),new l((u,y)=>y instanceof s),new m((u,y)=>y.set(p)))])],"unitYield")});var iy,Pe,ea=n(()=>{Ql();Ku();I();Zg();Qg();Qc();ey();Xg();tm();iy=class extends is{#e=!0;#t=null;#r;#i=!1;#o=new Zl;#a;#n;#l=null;#s;#m=!1;constructor(e,r,o,a=d){super(),this.#r=e,this.#a=r,this.#s=o,this.#n=a,this.addKey("actions","actionsForNeighbours","active","attack","busy","city","defence","movement","moves","player","status","tile","visibility","waiting"),this.#n.process(Qn,this)}action(e,...r){return e.perform(...r)}actions(e=this.#s,r=this.#s){return typeof e=="string"&&(e=r.getNeighbour(e)),this.#n.process($g,this,e,r)}actionsForNeighbours(e=this.#s){return e.getNeighbouringDirections().reduce((r,o)=>({...r,[o]:this.#n.process($g,this,e.getNeighbour(o),e)}),{})}activate(){this.#n.process(em,this)}active(){return this.#e}setActive(e=!0){this.#e=e}applyVisibility(){this.#s.getSurroundingArea(this.visibility().value()).forEach(e=>{this.#n.process(ry,e,this.#a)})}attack(){let[e]=this.yield(new Vi);return e}busy(){return this.#t}setBusy(e=null){this.#t=e}city(){return this.#r}static build(e,r=d){return new this(e,e.player(),e.tile(),r)}defence(){let[e]=this.yield(new mi);return e}destroy(e=null){this.#n.process(Xn,this,e)}destroyed(){return this.#i}setDestroyed(){this.#i=!0}movement(){let[e]=this.yield(new Ji);return e}moves(){return this.#o}player(){return this.#a}status(){return this.#l}setStatus(e){this.#l=e}tile(){return this.#s}setTile(e){this.#s=e}visibility(){let[e]=this.yield(new ys);return e}waiting(){return this.#m}setWaiting(e=!0){this.#m=e}yield(...e){let r=this.#n.get(hp);return e.forEach(o=>r.filter(a=>a.validate(this,o)).forEach(a=>a.process(this,o))),e}};t(iy,"Unit");Pe=iy});var oy,ye,rr=n(()=>{xe();Pc();oy=class extends F{constructor(){super(ol)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of CityGrowths returned.");return r[0]}};t(oy,"CityGrowthRegistry");ye=new oy});var Oe,ve,Ie=n(()=>{Ge();Oe=class extends k{};t(Oe,"Wonder");ve=Oe});var rm,ui,ds=n(()=>{xe();_o();rm=class extends F{constructor(){super(_)}};t(rm,"PlayerRegistry");ui=new rm});var ly,ta,Ip=n(()=>{ds();ly=class extends rm{};t(ly,"CurrentPlayerRegistry");ta=new ly});var my,py,ih=n(()=>{my=class{#e={};on(e,r){e in this.#e||(this.#e[e]=[]),this.#e[e].push(r)}once(e,r){let o=t((...a)=>{r(...a),this.off(e,o)},"onceHandler");this.on(e,o)}off(e,r){if(!(e in this.#e))return;let o=this.#e[e].indexOf(r);o!==-1&&this.#e[e].splice(o,1)}emit(e,...r){e in this.#e&&this.#e[e].forEach(o=>o(...r))}};t(my,"EventEmitter");py=my});var uy,P,K=n(()=>{ih();uy=class extends py{#e={};#t=!1;debug(e){if(!!this.option("debug"))return e()}emit(e,...r){return this.debug(()=>console.log(`Engine#emit: ${String(e)}: ${r}`)),super.emit(e,...r)}loadPlugins(){return this.emit("plugins:load:start"),new Promise((e,r)=>{this.once("plugins:load:end",()=>e())})}option(e,r=null){return this.#e[e]||r}setOption(e,r){this.#e[e]!==r&&(this.#e[e]=r,this.emit("option:changed",e,r))}start(){this.#t||(this.#t=!0,this.emit("engine:initialise"),this.loadPlugins().then(()=>{this.emit("engine:start")}))}};t(uy,"Engine");P=new uy});var cy,ae,$i=n(()=>{xe();_c();cy=class extends F{constructor(){super(Vl)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError(`Wrong number of player worlds exist for player: ${e.id()}`);return r[0]}};t(cy,"PlayerWorldRegistry");ae=new cy});var yy,Be,ci=n(()=>{Z();yy=class extends S{#e=0;constructor(){super(),this.addKey("value")}increment(){return this.#e++,this.#e}value(){return this.#e}};t(yy,"Turn");Be=new yy});var fy,z,_e=n(()=>{xe();ea();fy=class extends F{constructor(){super(Pe)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.getBy("player",e)}getByTile(e){return this.getBy("tile",e)}};t(fy,"UnitRegistry");z=new fy});var dy,gs,oh=n(()=>{G();dy=class extends g{};t(dy,"Year");gs=dy});var J,Ko,ll=n(()=>{Ve();J=class extends L{};t(J,"Food");Ko=J});var H,ra,im=n(()=>{Ve();H=class extends L{};t(H,"Production");ra=H});var re,ia,oa=n(()=>{Ve();re=class extends L{};t(re,"Trade");ia=re});var na=n(()=>{ll();im();oa()});var aa,Ke,Zi=n(()=>{aa=t((i,...e)=>i.reduce((r,o)=>{let a=e.findIndex(s=>o instanceof s);return a===-1||(r[a]+=o.value()),r},e.map(()=>0)),"reduceYields"),Ke=t((i,e)=>aa(i,e).shift()??0,"reduceYield")});var pS,uS,Ix,wx,hs,om=n(()=>{rr();na();$i();Zi();pS=t((i,e=[[J,8],[H,3*(Ke(i.tilesWorked().yields(i.player()),H)===0?3:1)],[re,1*(Ke(i.tilesWorked().yields(i.player()),re)===0?3:1)]])=>i.tiles().entries().sort((r,o)=>o.score(i.player(),e)-r.score(i.player(),e)),"getHighestValueCityTiles"),uS=t((i,e=ae)=>pS(i).filter(r=>e.getByPlayer(i.player()).includes(r)&&!i.tilesWorked().includes(r)&&i.tile()!==r),"getHighestValueAvailableCityTiles"),Ix=t((i,e=ae,r=ye)=>{i.tilesWorked().unregister(...i.tilesWorked().entries()),i.tilesWorked().register(i.tile()),wx(i,e,r)},"reassignWorkers"),wx=t((i,e=ae,r=ye)=>{let o=r.getByCity(i);uS(i,e).some(a=>i.tilesWorked().length>=o.size()+1?!0:(i.tilesWorked().register(a),!1))},"assignWorkers"),hs=wx});var Gn,Rs,xs=n(()=>{I();Z();Gn=class extends S{#e;#t;#r;#i;constructor(e,r,o,a=d){super(),this.#e=e,this.#t=a,this.#r=r,this.#i=o,this.addKey("from","to")}forUnit(e){return new this.constructor(this.#e,this.#r,e,this.#t)}from(){return this.#e}perform(...e){}ruleRegistry(){return this.#t}to(){return this.#r}unit(){return this.#i}};t(Gn,"Action");Rs=Gn});var Ry,qo,Ap=n(()=>{G();Ry=class extends g{};t(Ry,"Defeated");qo=Ry});var vs,Ux=n(()=>{I();_e();xs();Ap();vs=class extends Rs{#e;#t;constructor(e,r,o,a=d,s=z,p=()=>Math.random()){super(e,r,o,a),this.#t=s,this.#e=p}perform(){let[e]=this.#t.getByTile(this.to()).sort((o,a)=>a.defence().value()-o.defence().value()),r=Math.min(1,this.unit().moves().value());if(this.unit().attack().value()*r*this.#e()>=e.defence().value()*this.#e()){this.ruleRegistry().process(qo,e,this.unit(),this),this.unit().moves().subtract(r,this.constructor.name);return}this.ruleRegistry().process(qo,this.unit(),e,this)}};t(vs,"Attack")});var xy,Mx,Dx=n(()=>{fr();xy=class extends Te{};t(xy,"BuildingIrrigation");Mx=xy});var vy,q,At=n(()=>{G();vy=class extends g{};t(vy,"Moved");q=vy});var by,Je,Qi=n(()=>{xs();I();ci();fr();w();T();At();by=class extends Gn{#e;constructor(e,r,o,a=d,s=Be){super(e,r,o,a),this.#e=s}perform(e,r=()=>{},o=Te){let a=this.#e.value()+e;this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new o(new l(()=>this.#e.value()===a),new m((...s)=>{let p=this.unit();p.setActive(),p.setBusy(),r(...s),this.ruleRegistry().process(q,this.unit(),this)})))}};t(by,"DelayedAction");Je=by});var Cy,sa,Ty=n(()=>{G();Cy=class extends g{};t(Cy,"Built");sa=Cy});var Py,Vo,pl=n(()=>{Z();I();Ty();Py=class extends S{#e;constructor(e,r=d){super(),this.#e=e,r.process(sa,e,this)}tile(){return this.#e}};t(Py,"TileImprovement");Vo=Py});var we,Ex,lh=n(()=>{pl();we=class extends Vo{};t(we,"Irrigation");Ex=we});var Iy,be,yi=n(()=>{G();Iy=class extends g{};t(Iy,"MovementCost");be=Iy});var bs,Fx=n(()=>{Dx();Qi();lh();At();yi();bs=class extends Je{perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Ex(this.unit().tile())},Mx),this.ruleRegistry().process(q,this.unit(),this)}};t(bs,"BuildIrrigation")});var wy,kx,Sx=n(()=>{fr();wy=class extends Te{};t(wy,"BuildingMine");kx=wy});var $e,Yx,mh=n(()=>{pl();$e=class extends Vo{};t($e,"Mine");Yx=$e});var Cs,zx=n(()=>{Sx();Qi();mh();At();yi();Cs=class extends Je{perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Yx(this.unit().tile())},kx),this.ruleRegistry().process(q,this.unit(),this)}};t(Cs,"BuildMine")});var Ay,Nx,Lx=n(()=>{fr();Ay=class extends Te{};t(Ay,"BuildingRoad");Nx=Ay});var ke,Wx,ph=n(()=>{pl();ke=class extends Vo{};t(ke,"Road");Wx=ke});var Ts,jx=n(()=>{Lx();Qi();At();yi();ph();Ts=class extends Je{perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Wx(this.unit().tile())},Nx),this.ruleRegistry().process(q,this.unit(),this)}};t(Ts,"BuildRoad")});var Gy,Hx,_x=n(()=>{fr();Gy=class extends Te{};t(Gy,"BuildingRailroad");Hx=Gy});var ir,Kx,uh=n(()=>{pl();ir=class extends Vo{};t(ir,"Railroad");Kx=ir});var Ps,qx=n(()=>{_x();Qi();At();yi();uh();Ps=class extends Je{perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Kx(this.unit().tile())},Hx),this.ruleRegistry().process(q,this.unit(),this)}};t(Ps,"BuildRailroad")});var By,Gp,ch=n(()=>{G();By=class extends g{};t(By,"ValidateMove");Gp=By});var kt,nm,Bp=n(()=>{xs();At();yi();ch();kt=class extends Gn{perform(){return this.validate()?(this.unit().setTile(this.to()),this.ruleRegistry().process(q,this.unit(),this),!0):!1}movementCost(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>r-o);return e}validate(){let[e]=this.ruleRegistry().process(Gp,this.unit(),this.movementCost());return e}};t(kt,"Move");nm=kt});var am,Vx=n(()=>{I();Bp();am=class extends nm{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.#e.capture(this.unit().player()),!0):!1}};t(am,"CaptureCity")});var Uy,ze,fi=n(()=>{Z();Uy=class extends Ye{#e;constructor(e){super(),this.#e=e}clone(e=this.terrain()){return new this.constructor(e)}terrain(){return this.#e}};t(Uy,"TerrainFeature");ze=Uy});var yh,My,lt,Jo=n(()=>{xe();fi();yh=new Map,My=class extends F{constructor(){super(ze)}getByTerrain(e){return yh.has(e)||yh.set(e,this.getBy("terrain",e)),yh.get(e)}};t(My,"TerrainFeatureRegistry");lt=new My});var Dy,Jx,$x=n(()=>{fr();Dy=class extends Te{};t(Dy,"ClearingForest");Jx=Dy});var ie,sm,Up=n(()=>{$t();ie=class extends W{};t(ie,"Plains");sm=ie});var Is,Zx=n(()=>{I();Jo();ci();$x();Qi();At();yi();Up();Is=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Be){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new sm,o=this.#e.getByTerrain(this.from().terrain());this.#e.register(...o.map(a=>a.clone(r))),this.#e.unregister(...o),this.from().setTerrain(r)},Jx),this.ruleRegistry().process(q,this.unit(),this)}};t(Is,"ClearForest")});var Ey,Qx,Xx=n(()=>{fr();Ey=class extends Te{};t(Ey,"ClearingJungle");Qx=Ey});var Mp,ws,ev,lm=n(()=>{Jo();w();T();G();Mp=class extends g{};t(Mp,"Feature");ws=Mp,ev=t((i,e,r=.2,o=lt,a=()=>Math.random())=>[new Mp(new l(s=>s===e),new l((s,p)=>p instanceof i),new l(()=>a()<=r),new m((s,p)=>o.register(new s(p))))],"feature")});var fe,As,mm=n(()=>{$t();fe=class extends W{};t(fe,"Grassland");As=fe});var $o,Fy,ky=n(()=>{fi();$o=class extends ze{};t($o,"Shield");Fy=$o});var Gs,tv=n(()=>{I();Jo();ci();Xx();Qi();lm();mm();At();yi();ky();Gs=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Be){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new As,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(ws,Fy,r),this.#e.unregister(...o),this.from().setTerrain(r)},Qx),this.ruleRegistry().process(q,this.unit(),this)}};t(Gs,"ClearJungle")});var Sy,rv,iv=n(()=>{fr();Sy=class extends Te{};t(Sy,"ClearingSwamp");rv=Sy});var Bs,ov=n(()=>{I();Jo();ci();iv();Qi();lm();mm();At();yi();ky();Bs=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Be){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new As,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(ws,Fy,r),this.#e.unregister(...o),this.from().setTerrain(r)},rv),this.ruleRegistry().process(q,this.unit(),this)}};t(Bs,"ClearSwamp")});var pm,nv=n(()=>{xs();pm=class extends Rs{perform(){this.unit().destroy()}};t(pm,"Disband")});var Us,av=n(()=>{I();Bp();Us=class extends nm{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.unit().moves().set(0),this.#e.unload(this.unit()),!0):!1}};t(Us,"Disembark")});var um,sv=n(()=>{I();fr();w();Bp();At();um=class extends nm{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.#e.stow(this.unit()),this.unit().setBusy(new Te(new l(()=>!1))),this.unit().setActive(!1),this.ruleRegistry().process(q,this.unit(),this),!0):!1}};t(um,"Embark")});var Yy,cm,zy=n(()=>{Z();Yy=class extends Ye{#e;constructor(e){super(),this.#e=e}unit(){return this.#e}};t(Yy,"UnitImprovement");cm=Yy});var Ny,or,la=n(()=>{xe();zy();Ny=class extends F{constructor(){super(cm)}getByUnit(e){return this.getBy("unit",e)}};t(Ny,"UnitImprovementRegistry");or=new Ny});var Ly,lv,mv=n(()=>{fr();Ly=class extends Te{};t(Ly,"Fortified");lv=Ly});var di,pv,fh=n(()=>{zy();di=class extends cm{};t(di,"Fortified");pv=di});var Wy,uv,cv=n(()=>{fr();Wy=class extends Te{};t(Wy,"Fortifying");uv=Wy});var Ms,yv=n(()=>{I();ci();la();mv();w();Qi();fh();cv();At();yi();Ms=class extends Je{#e;constructor(e,r,o,a=d,s=Be,p=or){super(e,r,o,a,s),this.#e=p}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{this.unit().moves().set(0),this.unit().setActive(!1),this.unit().setBusy(new lv(new l(()=>!1))),this.#e.register(new pv(this.unit()))},uv),this.ruleRegistry().process(q,this.unit(),this)}};t(Ms,"Fortify")});var ym,fv=n(()=>{gt();I();xs();Vn();At();ym=class extends Rs{#e;constructor(e,r,o,a=$,s=d){super(e,r,o,s),this.#e=a}perform(){new tt(this.unit().player(),this.unit().tile(),this.#e.takeCapitalByCivilization(this.unit().player().civilization().constructor),this.ruleRegistry()),this.unit().destroy(),this.ruleRegistry().process(q,this.unit(),this)}};t(ym,"FoundCity")});var Xi,dv=n(()=>{xs();Xi=class extends Gn{perform(){this.unit().moves().subtract(this.unit().moves())}};t(Xi,"NoOrders")});var jy,Ne,gi=n(()=>{xe();pl();jy=class extends F{constructor(){super(Vo)}getByTile(e){return this.getBy("tile",e)}};t(jy,"TileImprovementRegistry");Ne=new jy});var Ds,gv=n(()=>{I();gi();ci();Qi();At();yi();Ds=class extends Je{#e;constructor(e,r,o,a=d,s=Ne,p=Be){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let[r]=this.#e.getByTile(this.from());this.#e.unregister(r)}),this.ruleRegistry().process(q,this.unit(),this)}};t(Ds,"Pillage")});var qe,Hy,_y=n(()=>{$t();qe=class extends W{};t(qe,"Forest");Hy=qe});var eo,hv,dh=n(()=>{fi();eo=class extends ze{};t(eo,"Horse");hv=eo});var Ky,Ov,Rv=n(()=>{fr();Ky=class extends Te{};t(Ky,"PlantingForest");Ov=Ky});var Es,xv=n(()=>{I();Jo();ci();Qi();lm();_y();dh();At();yi();Rv();Es=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Be){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new Hy,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(ws,hv,r),this.#e.unregister(...o),this.from().setTerrain(r)},Ov),this.ruleRegistry().process(q,this.unit(),this)}};t(Es,"PlantForest")});var qy,vv,bv=n(()=>{fr();qy=class extends Te{};t(qy,"Sleeping");vv=qy});var ma,Cv,gh=n(()=>{I();ci();_e();w();Qi();T();bv();ma=class extends Je{#e;constructor(e,r,o,a=d,s=Be,p=z){super(e,r,o,a,s),this.#e=p}perform(){this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new vv(new l(()=>this.from().getSurroundingArea(this.unit().visibility().value()).some(e=>this.#e.getByTile(e).some(r=>r.player()!==this.unit().player()))),new m(()=>{this.unit().setActive(),this.unit().setBusy()})))}};t(ma,"Sleep");Cv=ma});var fm,Tv=n(()=>{xs();fm=class extends Rs{perform(){this.unit().setWaiting(),this.unit().cargo().forEach(e=>{e.moves().set(e.movement()),e.activate()})}};t(fm,"Unload")});var dm=n(()=>{Ux();Fx();zx();jx();qx();Vx();Zx();tv();ov();nv();av();sv();yv();fv();Bp();dv();gv();xv();gh();Tv()});var Gt,Pv,hh=n(()=>{$t();Gt=class extends W{};t(Gt,"Arctic");Pv=Gt});var Ce,Iv,Oh=n(()=>{$t();Ce=class extends W{};t(Ce,"Desert");Iv=Ce});var Ae,wv,Rh=n(()=>{$t();Ae=class extends W{};t(Ae,"Hills");wv=Ae});var Ze,Av,xh=n(()=>{$t();Ze=class extends W{};t(Ze,"Jungle");Av=Ze});var Se,Gv,vh=n(()=>{$t();Se=class extends W{};t(Se,"Mountains");Gv=Se});var it,Bv,bh=n(()=>{Ig();it=class extends Jt{};t(it,"Ocean");Bv=it});var ee,Vy,Jy=n(()=>{$t();ee=class extends W{};t(ee,"River");Vy=ee});var Qe,Uv,Ch=n(()=>{$t();Qe=class extends W{};t(Qe,"Swamp");Uv=Qe});var mt,Mv,Th=n(()=>{$t();mt=class extends W{};t(mt,"Tundra");Mv=mt});var to=n(()=>{hh();Oh();_y();mm();Rh();xh();vh();bh();Up();Jy();Ch();Th()});var St,Fs,gm=n(()=>{ea();St=class extends Pe{};t(St,"Air");Fs=St});var ot,$y,Zy=n(()=>{ea();ot=class extends Pe{};t(ot,"Land");$y=ot});var Y,Yt=n(()=>{Zy();Y=class extends $y{};t(Y,"Fortifiable")});var Le,Bn,ul=n(()=>{ea();Le=class extends Pe{};t(Le,"Naval");Bn=Le});var Qy,Xy,Ph=n(()=>{Qy=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}transport(){return this.#e}unit(){return this.#t}};t(Qy,"TransportManifest");Xy=Qy});var ef,Un,hm=n(()=>{xe();Ph();ef=class extends F{constructor(){super(Xy)}getByTransport(e){return this.getBy("transport",e)}getByUnit(e){let r=this.getBy("unit",e);if(r.length!==1)throw new TypeError("Wrong number of results.");return r[0]}};t(ef,"TransportRegistry");Un=new ef});var tf,rf,Ih=n(()=>{G();tf=class extends g{};t(tf,"Stowed");rf=tf});var of,Dv,Ev=n(()=>{G();of=class extends g{};t(of,"Unloaded");Dv=of});var cS,Fv,kv=n(()=>{I();hm();Ih();Ph();Ev();cS=t(i=>t(class extends i{#e=d;#t=Un;canStow(r){return!this.cargo().includes(r)&&this.hasCapacity()}capacity(){return 0}cargo(){return this.#t.getByTransport(this).map(r=>r.unit())}hasCapacity(){return this.#t.getByTransport(this).length<this.capacity()}hasCargo(){return this.#t.getByTransport(this).length>0}setRuleRegistry(r){this.#e=r}setTransportRegistry(r){this.#t=r}stow(r){return!this.hasCapacity()||!this.canStow(r)?!1:(this.#t.register(new Xy(this,r)),this.#e.process(rf,r,this),!0)}unload(r){try{let o=this.#t.getByUnit(r);return this.#t.unregister(o),this.#e.process(Dv,r,this),!0}catch{return!1}}},"Transport"),"Transport"),Fv=cS});var zt,Mn,cl=n(()=>{I();hm();ul();kv();zt=class extends Fv(Bn){constructor(e,r,o,a=d,s=Un){super(e,r,o,a),this.setRuleRegistry(a),this.setTransportRegistry(s)}};t(zt,"NavalTransport");Mn=zt});var dr,wh=n(()=>{Zy();dr=class extends $y{};t(dr,"Worker")});var Dn=n(()=>{gm();Yt();Zy();ul();cl();wh()});var Zo,Sv=n(()=>{fi();Zo=class extends ze{};t(Zo,"Coal")});var Qo,Yv=n(()=>{fi();Qo=class extends ze{};t(Qo,"Fish")});var hi,zv=n(()=>{fi();hi=class extends ze{};t(hi,"Game")});var Xo,Nv=n(()=>{fi();Xo=class extends ze{};t(Xo,"Gems")});var en,Lv=n(()=>{fi();en=class extends ze{};t(en,"Gold")});var Oi,Wv=n(()=>{fi();Oi=class extends ze{};t(Oi,"Oasis")});var tn,jv=n(()=>{fi();tn=class extends ze{};t(tn,"Oil")});var rn,Hv=n(()=>{fi();rn=class extends ze{};t(rn,"Seal")});var Dp=n(()=>{Sv();Yv();zv();Nv();Lv();dh();Wv();jv();Hv();ky()});var nf,yl,Ah=n(()=>{G();nf=class extends g{};t(nf,"Action");yl=nf});var af,sf,Gh=n(()=>{G();af=class extends g{};t(af,"ActionPerformed");sf=af});var lf,Om,Bh=n(()=>{G();lf=class extends g{};t(lf,"Discovered");Om=lf});var mf,pf,Uh=n(()=>{Z();I();Ah();Gh();Bh();mf=class extends S{#e;#t;constructor(e,r=d){super(),this.#e=r,this.#t=e,this.addKey("tile")}action(e){e.perform(),this.#e.process(sf,this,e)}actions(e){return this.#e.process(yl,this,e)}process(e){this.#e.process(Om,this,e)}tile(){return this.#t}};t(mf,"GoodyHut");pf=mf});var uf,kr,ks=n(()=>{Uh();xe();uf=class extends F{constructor(){super(pf)}getByTile(e){let r=this.filter(o=>o.tile()===e);return r.length===0?null:r[0]}};t(uf,"GoodyHutRegistry");kr=new uf});var _v=n(()=>{pl()});var En=n(()=>{lh();mh();_v();ph();uh()});var cf,Kv,qv=n(()=>{cf=class{#e;#t;#r;constructor(e,r,o){this.#e=o,this.#t=r,this.#r=e}end(){return this.#e}generate(){throw new Error(`PathFinder#generate: Must be overridden in '${this.constructor.name}'.`)}start(){return this.#t}unit(){return this.#r}};t(cf,"PathFinder");Kv=cf});var yf,ff,Mh=n(()=>{Ki();qv();yf=class extends Ee{constructor(){super(Kv)}};t(yf,"PathFinderRegistry");ff=new yf});var df,Sr,Ss=n(()=>{Z();df=class extends Ye{};t(df,"Government");Sr=df});var gf,Rm,hf=n(()=>{Ki();Ss();gf=class extends Ee{constructor(){super(Sr)}};t(gf,"AvailableGovernmentRegistry");Rm=new gf});var Of,Ep,Dh=n(()=>{G();Of=class extends g{};t(Of,"Availability");Ep=Of});var Rf,Fp,Eh=n(()=>{G();Rf=class extends g{};t(Rf,"Changed");Fp=Rf});var xf,vf,Fh=n(()=>{hf();Z();I();Dh();Eh();xf=class extends S{#e;#t=null;#r;#i;constructor(e,r=Rm,o=d){super(),this.#r=e,this.#e=r,this.#i=o,this.addKey("available","current")}available(){return this.#e.filter(e=>this.#i.get(Ep).some(r=>r.validate(e,this.#r)))}current(){return this.#t}is(...e){return e.some(r=>this.#t instanceof r)}player(){return this.#r}set(e){this.#t=e,this.#i.process(Fp,this.#r,e)}};t(xf,"PlayerGovernment");vf=xf});var bf,pt,on=n(()=>{xe();Fh();bf=class extends F{constructor(){super(vf)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerGovernments for player.");return r[0]}};t(bf,"PlayerGovernmentRegistry");pt=new bf});var Cf,Tf,kh=n(()=>{pc();_l();Cf=class extends ss{#e;#t;constructor(e,r=Tn,o=()=>Math.random()){super(e),this.#e=r,this.#t=o}chooseCivilization(e){let r=e[Math.floor(e.length*this.#t())],o=this.player(),a=new r;o.setCivilization(a),this.chooseLeader(a)}chooseLeader(e){let r=this.#e.getByCivilization(e.constructor),o=r[Math.floor(this.#t()*r.length)];e.setLeader(new o)}};t(Cf,"AIClient");Tf=Cf});var Vv=n(()=>{fh()});var pa,Jv=n(()=>{zy();pa=class extends cm{};t(pa,"Veteran")});var $v=n(()=>{Jv()});var kp=n(()=>{Vv();$v()});var Ri,Zv,Sh=n(()=>{M();Ri=class extends x{};t(Ri,"AdvancedFlight");Zv=Ri});var ro,Qv,Yh=n(()=>{M();ro=class extends x{};t(ro,"Alphabet");Qv=ro});var xi,Xv,zh=n(()=>{M();xi=class extends x{};t(xi,"Astronomy");Xv=xi});var Fn,eb,Nh=n(()=>{M();Fn=class extends x{};t(Fn,"AtomicTheory");eb=Fn});var ut,tb,Lh=n(()=>{M();ut=class extends x{};t(ut,"Automobile");tb=ut});var vi,rb,Wh=n(()=>{M();vi=class extends x{};t(vi,"Banking");rb=vi});var io,ib,jh=n(()=>{M();io=class extends x{};t(io,"BridgeBuilding");ib=io});var Yr,ob,Hh=n(()=>{M();Yr=class extends x{};t(Yr,"BronzeWorking");ob=Yr});var bi,nb,_h=n(()=>{M();bi=class extends x{};t(bi,"CeremonialBurial");nb=bi});var nn,ab,Kh=n(()=>{M();nn=class extends x{};t(nn,"Chemistry");ab=nn});var oo,sb,qh=n(()=>{M();oo=class extends x{};t(oo,"Chivalry");sb=oo});var gr,lb,Vh=n(()=>{M();gr=class extends x{};t(gr,"CodeOfLaws");lb=gr});var zr,mb,Jh=n(()=>{M();zr=class extends x{};t(zr,"Combustion");mb=zr});var Rt,pb,$h=n(()=>{M();Rt=class extends x{};t(Rt,"Communism");pb=Rt});var Ci,ub,Zh=n(()=>{M();Ci=class extends x{};t(Ci,"Computers");ub=Ci});var Nr,cb,Qh=n(()=>{M();Nr=class extends x{};t(Nr,"Conscription");cb=Nr});var Lr,yb,Xh=n(()=>{M();Lr=class extends x{};t(Lr,"Construction");yb=Lr});var no,fb,eO=n(()=>{M();no=class extends x{};t(no,"Corporation");fb=no});var Ti,db,tO=n(()=>{M();Ti=class extends x{};t(Ti,"Currency");db=Ti});var ao,gb,rO=n(()=>{M();ao=class extends x{};t(ao,"Democracy");gb=ao});var hr,hb,iO=n(()=>{M();hr=class extends x{};t(hr,"Electricity");hb=hr});var ct,Ob,oO=n(()=>{M();ct=class extends x{};t(ct,"Electronics");Ob=ct});var an,Rb,nO=n(()=>{M();an=class extends x{};t(an,"Engineering");Rb=an});var sn,xb,aO=n(()=>{M();sn=class extends x{};t(sn,"Explosives");xb=sn});var kn,vb,sO=n(()=>{M();kn=class extends x{};t(kn,"Feudalism");vb=kn});var so,bb,lO=n(()=>{M();so=class extends x{};t(so,"Flight");bb=so});var ua,Cb,mO=n(()=>{M();ua=class extends x{};t(ua,"FusionPower");Cb=ua});var ln,Tb,pO=n(()=>{M();ln=class extends x{};t(ln,"GeneticEngineering");Tb=ln});var yt,Pb,uO=n(()=>{M();yt=class extends x{};t(yt,"Gunpowder");Pb=yt});var mn,Ib,cO=n(()=>{M();mn=class extends x{};t(mn,"HorsebackRiding");Ib=mn});var xt,wb,yO=n(()=>{M();xt=class extends x{};t(xt,"Industrialization");wb=xt});var Or,Ab,fO=n(()=>{M();Or=class extends x{};t(Or,"Invention");Ab=Or});var Pi,Gb,dO=n(()=>{M();Pi=class extends x{};t(Pi,"IronWorking");Gb=Pi});var pn,Bb,gO=n(()=>{M();pn=class extends x{};t(pn,"LaborUnion");Bb=pn});var Rr,Ub,hO=n(()=>{M();Rr=class extends x{};t(Rr,"Literacy");Ub=Rr});var Nt,Mb,OO=n(()=>{M();Nt=class extends x{};t(Nt,"Magnetism");Mb=Nt});var Wr,Db,RO=n(()=>{M();Wr=class extends x{};t(Wr,"MapMaking");Db=Wr});var Lt,Eb,xO=n(()=>{M();Lt=class extends x{};t(Lt,"Masonry");Eb=Lt});var Wt,Fb,vO=n(()=>{M();Wt=class extends x{};t(Wt,"MassProduction");Fb=Wt});var xr,kb,bO=n(()=>{M();xr=class extends x{};t(xr,"Mathematics");kb=xr});var Ii,Sb,CO=n(()=>{M();Ii=class extends x{};t(Ii,"Medicine");Sb=Ii});var jr,Yb,TO=n(()=>{M();jr=class extends x{};t(jr,"Metallurgy");Yb=jr});var Hr,zb,PO=n(()=>{M();Hr=class extends x{};t(Hr,"Monarchy");zb=Hr});var jt,Nb,IO=n(()=>{M();jt=class extends x{};t(jt,"Mysticism");Nb=jt});var nr,Lb,wO=n(()=>{M();nr=class extends x{};t(nr,"Navigation");Lb=nr});var _r,Wb,AO=n(()=>{M();_r=class extends x{};t(_r,"NuclearFission");Wb=_r});var lo,jb,GO=n(()=>{M();lo=class extends x{};t(lo,"NuclearPower");jb=lo});var Kr,Hb,BO=n(()=>{M();Kr=class extends x{};t(Kr,"Philosophy");Hb=Kr});var wi,_b,UO=n(()=>{M();wi=class extends x{};t(wi,"Physics");_b=wi});var un,Kb,MO=n(()=>{M();un=class extends x{};t(un,"Plastics");Kb=un});var cn,qb,DO=n(()=>{M();cn=class extends x{};t(cn,"Pottery");qb=cn});var qr,Vb,EO=n(()=>{M();qr=class extends x{};t(qr,"Railroad");Vb=qr});var yn,Jb,FO=n(()=>{M();yn=class extends x{};t(yn,"Recycling");Jb=yn});var Ai,$b,kO=n(()=>{M();Ai=class extends x{};t(Ai,"Refining");$b=Ai});var vt,Zb,SO=n(()=>{M();vt=class extends x{};t(vt,"Religion");Zb=vt});var Vr,Qb,YO=n(()=>{M();Vr=class extends x{};t(Vr,"Robotics");Qb=Vr});var mo,Xb,zO=n(()=>{M();mo=class extends x{};t(mo,"Rocketry");Xb=mo});var po,eC,NO=n(()=>{M();po=class extends x{};t(po,"SpaceFlight");eC=po});var uo,tC,LO=n(()=>{M();uo=class extends x{};t(uo,"SteamEngine");tC=uo});var co,rC,WO=n(()=>{M();co=class extends x{};t(co,"Steel");rC=co});var yo,iC,jO=n(()=>{M();yo=class extends x{};t(yo,"Superconductor");iC=yo});var Gi,oC,HO=n(()=>{M();Gi=class extends x{};t(Gi,"TheRepublic");oC=Gi});var fn,nC,_O=n(()=>{M();fn=class extends x{};t(fn,"TheWheel");nC=fn});var fo,aC,KO=n(()=>{M();fo=class extends x{};t(fo,"TheoryOfGravity");aC=fo});var Bi,sC,qO=n(()=>{M();Bi=class extends x{};t(Bi,"Trade");sC=Bi});var ar,lC,VO=n(()=>{M();ar=class extends x{};t(ar,"University");lC=ar});var vr,mC,JO=n(()=>{M();vr=class extends x{};t(vr,"Writing");mC=vr});var sr=n(()=>{Sh();Yh();zh();Nh();Lh();Wh();jh();Hh();_h();Kh();qh();Vh();Jh();$h();Zh();Qh();Xh();eO();tO();rO();iO();oO();nO();aO();sO();lO();mO();pO();uO();cO();yO();fO();dO();gO();hO();OO();RO();xO();vO();bO();CO();TO();PO();IO();wO();AO();GO();BO();UO();MO();DO();EO();FO();kO();SO();YO();zO();NO();LO();WO();jO();HO();_O();KO();qO();VO();JO()});var Ui,pC=n(()=>{Ss();Ui=class extends Sr{};t(Ui,"Anarchy")});var bt,uC=n(()=>{Ss();bt=class extends Sr{};t(bt,"Communism")});var nt,cC=n(()=>{Ss();nt=class extends Sr{};t(nt,"Democracy")});var Ht,yC=n(()=>{Ss();Ht=class extends Sr{};t(Ht,"Despotism")});var at,fC=n(()=>{Ss();at=class extends Sr{};t(at,"Monarchy")});var ft,dC=n(()=>{Ss();ft=class extends Sr{};t(ft,"Republic")});var dn=n(()=>{pC();uC();cC();yC();fC();dC()});var Jr,gC=n(()=>{Ge();Jr=class extends k{};t(Jr,"Aqueduct")});var lr,hC=n(()=>{Ge();lr=class extends k{};t(lr,"Bank")});var $r,OC=n(()=>{Ge();$r=class extends k{};t($r,"Barracks")});var mr,RC=n(()=>{Ge();mr=class extends k{};t(mr,"Cathedral")});var go,xC=n(()=>{Ge();go=class extends k{};t(go,"CityWalls")});var Zr,vC=n(()=>{Ge();Zr=class extends k{};t(Zr,"Colosseum")});var br,bC=n(()=>{Ge();br=class extends k{};t(br,"Courthouse")});var _t,CC=n(()=>{Ge();_t=class extends k{};t(_t,"Factory")});var Qr,TC=n(()=>{Ge();Qr=class extends k{};t(Qr,"Granary")});var Ct,PC=n(()=>{Ge();Ct=class extends k{};t(Ct,"HydroPlant")});var Cr,IC=n(()=>{Ge();Cr=class extends k{};t(Cr,"Library")});var Tr,wC=n(()=>{Ge();Tr=class extends k{};t(Tr,"ManufacturingPlant")});var pr,AC=n(()=>{Ge();pr=class extends k{};t(pr,"Marketplace")});var ho,GC=n(()=>{Ge();ho=class extends k{};t(ho,"MassTransit")});var Tt,BC=n(()=>{Ge();Tt=class extends k{};t(Tt,"NuclearPlant")});var dt,UC,$O=n(()=>{Ge();dt=class extends k{};t(dt,"Palace");UC=dt});var Pt,MC=n(()=>{Ge();Pt=class extends k{};t(Pt,"PowerPlant")});var Oo,DC=n(()=>{Ge();Oo=class extends k{};t(Oo,"RecyclingCenter")});var Ro,EC=n(()=>{Ge();Ro=class extends k{};t(Ro,"SdiDefence")});var Bt,FC=n(()=>{Ge();Bt=class extends k{};t(Bt,"Temple")});var Pr,kC=n(()=>{Ge();Pr=class extends k{};t(Pr,"University")});var Mi=n(()=>{gC();hC();OC();RC();xC();vC();bC();CC();TC();PC();IC();wC();AC();GC();BC();$O();MC();DC();EC();FC();kC()});var Pf,Ys,SC=n(()=>{Mh();Lu();Pf=class extends Yl{#e=1/0;end(){return this.entries()[this.length-1]}static for(e,r,o,a=ff){let[s]=a.entries().map(p=>new p(e,r,o)).map(p=>p.generate()).sort((p,u)=>p.movementCost()-u.movementCost());return s&&(s.shift(),s)}movementCost(){return this.#e}setMovementCost(e){this.#e=e}push(...e){e.forEach(r=>{let o=this.end();if(this.length>0&&!r.isNeighbourOf(o))throw new TypeError(`Tile#push: Invalid element passed, ${r.x()},${r.y()} is not a neighbour of ${o.x()},${o.y()}.`);super.push(r)})}start(){return this.entries()[0]}};t(Pf,"Path");Ys=Pf});var xo,YC=n(()=>{Yt();xo=class extends Y{};t(xo,"Artillery")});var vo,zC=n(()=>{ul();vo=class extends Bn{};t(vo,"Battleship")});var bo,NC=n(()=>{gm();bo=class extends Fs{};t(bo,"Bomber")});var Di,LC=n(()=>{Yt();Di=class extends Y{};t(Di,"Cannon")});var Co,WC=n(()=>{Yt();Co=class extends Y{};t(Co,"Caravan")});var To,jC=n(()=>{gm();cl();To=class extends Mn{canStow(e){return e instanceof Fs&&super.canStow(e)}capacity(){return 8}};t(To,"Carrier")});var Ei,HC=n(()=>{Yt();Ei=class extends Y{};t(Ei,"Catapult")});var Fi,_C=n(()=>{Yt();Fi=class extends Y{};t(Fi,"Chariot")});var Po,KC=n(()=>{ul();Po=class extends Bn{};t(Po,"Cruiser")});var Io,qC=n(()=>{Yt();Io=class extends Y{};t(Io,"Diplomat")});var Xr,VC=n(()=>{gm();Xr=class extends Fs{};t(Xr,"Fighter")});var ki,JC=n(()=>{cl();ki=class extends Mn{capacity(){return 4}};t(ki,"Frigate")});var Ir,$C=n(()=>{Yt();Ir=class extends Y{};t(Ir,"Horseman")});var Si,ZC=n(()=>{ul();Si=class extends Bn{};t(Si,"Ironclad")});var Yi,QC=n(()=>{Yt();Yi=class extends Y{};t(Yi,"Knight")});var wo,XC=n(()=>{Yt();wo=class extends Y{};t(wo,"MechanizedInfantry")});var zi,eT=n(()=>{Yt();zi=class extends Y{};t(zi,"Musketman")});var Ao,tT=n(()=>{gm();Ao=class extends Fs{};t(Ao,"Nuclear")});var Go,rT=n(()=>{Yt();Go=class extends Y{};t(Go,"Rifleman")});var Ni,iT=n(()=>{cl();Ni=class extends Mn{capacity(){return 3}};t(Ni,"Sail")});var We,oT,ZO=n(()=>{wh();We=class extends dr{};t(We,"Settlers");oT=We});var Li,nT=n(()=>{Yt();Li=class extends Y{};t(Li,"Spearman")});var Bo,aT=n(()=>{ul();Bo=class extends Bn{};t(Bo,"Submarine")});var wr,sT=n(()=>{Yt();wr=class extends Y{};t(wr,"Swordman")});var Uo,lT=n(()=>{Yt();Uo=class extends Y{};t(Uo,"Tank")});var Mo,mT=n(()=>{cl();Mo=class extends Mn{capacity(){return 8}};t(Mo,"Transport")});var Ar,pT=n(()=>{cl();Ar=class extends Mn{capacity(){return 2}};t(Ar,"Trireme")});var Do,uT=n(()=>{Yt();Do=class extends Y{};t(Do,"Warrior")});var gn=n(()=>{YC();zC();NC();LC();WC();jC();HC();_C();KC();qC();VC();JC();$C();ZC();QC();XC();eT();tT();rT();iT();ZO();nT();aT();sT();lT();mT();pT();uT()});var If,wf,Sn,xm=n(()=>{Ql();dm();$n();rr();rt();to();K();na();Dn();Dp();ks();En();_l();Mh();on();He();tl();$i();I();Jo();gi();la();_e();kh();tm();tc();Ec();kp();sr();dn();Mi();SC();wu();gn();qi();ea();Ie();om();If=t((i,e,r=j)=>{let o=r.getByTile(i);return o===null?!1:o.player()===e},"hasPlayerCity"),wf=class extends Tf{#e=e=>{let r=this.#A.option("earth",!1),o=this.#p.getByPlayer(this.player()).length===0;if(r&&o)return!0;let a=this.#w.getByTerrain(e.terrain());return(e.terrain()instanceof fe||e.terrain()instanceof ee||e.terrain()instanceof ie||a.some(s=>s instanceof Oi)||a.some(s=>s instanceof hi))&&e.getSurroundingArea().score(this.player(),[[J,4],[H,2],[re,1]])>=160&&!e.getSurroundingArea(4).filter(s=>this.#p.getByTile(s)!==null).length};#t=e=>[Ce,ie,fe,ee].some(r=>e.terrain()instanceof r)&&!this.#O.getByTile(e).some(r=>r instanceof we)&&e.getSurroundingArea().some(r=>If(r,this.player(),this.#p))&&[...e.getAdjacent(),e].some(r=>r.terrain()instanceof ee||r.isCoast()||this.#O.getByTile(r).some(o=>o instanceof we)&&this.#p.getByTile(r)===null);#r=e=>[Ae,Se].some(r=>e.terrain()instanceof r)&&!this.#O.getByTile(e).some(r=>r instanceof $e)&&e.getSurroundingArea().some(r=>If(r,this.player(),this.#p));#i=e=>!this.#O.getByTile(e).some(r=>r instanceof ke)&&e.getSurroundingArea().some(r=>If(r,this.player(),this.#p));#o=new Map;#a=new Map;#n=new Map;#l=[];#s=[];#m=[];#g=[];#y=[];#f=[];#u=[];#p;#v;#R;#b;#d;#C;#T;#P;#h;#I;#w;#O;#x;#c;#A;constructor(e,r=j,o=Qt,a=ye,s=kr,p=Tn,u=ff,y=pt,c=N,f=si,h=ae,U=d,D=lt,A=Ne,E=or,V=z,se=P){super(e,p),this.#p=r,this.#v=o,this.#R=a,this.#b=s,this.#d=u,this.#C=y,this.#T=c,this.#P=f,this.#h=h,this.#I=U,this.#w=D,this.#x=E,this.#O=A,this.#c=V,this.#A=se}scoreUnitMove(e,r){let o=e.actions(r),{attack:a,buildIrrigation:s,buildMine:p,buildRoad:u,captureCity:y,disembark:c,embark:f,fortify:h,foundCity:U,noOrders:D}=o.reduce((le,je)=>({...le,[je.constructor.name.replace(/^./,oi=>oi.toLowerCase())]:je}),{});if(!o.length||o.length===1&&D||e instanceof Y&&o.length===2&&h&&D)return-1;let A=0;this.#b.getByTile(r)!==null&&(A+=60),(U&&this.#e(r)||p&&this.#r(r)||s&&this.#t(r)||u&&this.#i(r))&&(A+=24);let V=this.#c.getByTile(r).sort((le,je)=>je.defence().value()-le.defence().value()),[se]=V,wt=V.some(le=>le.player()===this.player());e instanceof zt&&e.hasCapacity()&&V.length&&wt&&(A+=10),e instanceof zt&&e.hasCargo()&&r.isCoast()&&r.isWater()&&(A+=16),f&&(A+=16),c&&(A+=16),y&&(A+=100),a&&e.attack()>se.defence()&&(A+=24*(e.attack().value()-se.defence().value())),a&&e.attack().value()>=se.defence().value()&&(A+=16),a&&e.attack().value()>=se.defence().value()*(2/3)&&(A+=8);let Dr=this.#h.getByPlayer(this.player()),Il=r.getNeighbours().filter(le=>!Dr.includes(le)).length;Il>0&&(A+=Il*3);let wl=this.#n.get(e);return wl instanceof ce&&r.distanceFrom(wl)<e.tile().distanceFrom(wl)&&(A+=14),(this.#o.get(e)||[]).includes(r)||(A*=4),A}moveUnit(e){let r=0;for(;e.active()&&e.moves().value()>=.1;){if(r++>1e3){console.log("SimpleAIClient#moveUnit: loopCheck: aborting"),console.log(`${e.player().civilization().name()} ${e.constructor.name}`),console.log(e.actions()),console.log(e.actionsForNeighbours()),e.action(new Xi(e.tile(),e.tile(),e));return}let o=this.#a.get(e);if(o){let c=o.shift(),[f]=e.actions(c).filter(h=>h instanceof kt);if(f){e.action(f),o.length===0&&this.#a.delete(e);return}if(o.length>0){let h=Ys.for(e,e.tile(),o.end());if(h){this.#a.set(e,h);continue}}this.#a.delete(e)}let[a]=e.tile().getNeighbours().map(c=>[c,this.scoreUnitMove(e,c)]).filter(([,c])=>c>-1).sort(([,c],[,f])=>f-c||Math.floor(Math.random()*3)-1).map(([c])=>c);if(!a){e.action(new Xi(e.tile(),e.tile(),e));return}let s=e.actions(a),[p]=s,u=this.#o.get(e)||[],y=this.#n.get(e);if(!p){e.action(new Xi(e.tile(),e.tile(),e));return}y===a&&this.#n.delete(e),u.push(a),this.#o.set(e,u.slice(-50)),e.action(p)}e.moves().value()>0&&e.action(new Xi(e.tile(),e.tile(),e))}preProcessTurn(){this.#l.splice(0),this.#s.splice(0),this.#m.splice(0),this.#g.splice(0),this.#y.splice(0),this.#f.splice(0),this.#u.splice(0);let e=this.#h.getByPlayer(this.player());e.entries().forEach(r=>{let o=r.tile(),a=this.#p.getByTile(o),s=this.#c.getBy("tile",o),p=this.#u.includes(o)&&![...this.#n.values(),...[...this.#a.values()].map(u=>u.end())].includes(o);a&&a.player()===this.player()&&!s.length&&!this.#u.includes(o)&&!p?this.#u.push(o):a&&a.player()!==this.player()&&a.originalPlayer()===this.player()?this.#l.push(o):a&&a.player()!==this.player()&&!this.#s.includes(o)?this.#s.push(o):s.length&&s.some(u=>u.player()!==this.player())&&this.#m.includes(o)?this.#m.push(o):o.isLand()&&o.getNeighbours().some(u=>!e.includes(u))&&!this.#y.includes(o)&&!p?this.#y.push(o):o.isWater()&&o.getNeighbours().some(u=>!e.includes(u))&&this.#f.includes(o)&&!p&&this.#f.push(o),this.#e(o)&&this.#g.includes(o)&&!p&&this.#g.push(o)}),this.#p.getByPlayer(this.player()).forEach(r=>{let o=this.#c.getByTile(r.tile());hs(r,this.#h,this.#R),!o.length&&!this.#u.includes(r.tile())&&this.#u.push(r.tile())})}takeTurn(){return new Promise((e,r)=>{try{let o=0;this.preProcessTurn();let[a]=this.#C.filter(p=>p.player()===this.player()),[s]=this.#T.filter(p=>p.player()===this.player());for(s.completed(Hr)&&!a.is(at)&&a.set(new at);this.player().hasMandatoryActions();){let p=this.player().mandatoryAction(),u=p.value();if(o++>1e3){console.log(""),console.log(""),console.log(u),u instanceof Pe&&(console.log(u.actions()),u.tile().getNeighbours().forEach(y=>console.log(u.actions(y))),console.log(u.active()),console.log(u.busy()),console.log(u.moves().value()),console.log(this.#x.getByUnit(u))),u.action(new Xi(u.tile(),u.tile(),u)),console.error("SimpleAIClient: Couldn't pick an action to do.");break}if(u instanceof Pe){let y=u,c=y.tile(),f=this.#n.get(y),h=y.actions(),{buildIrrigation:U,buildMine:D,buildRoad:A,fortify:E,foundCity:V,unload:se}=h.reduce((Me,le)=>({...Me,[le.constructor.name.replace(/^./,je=>je.toLowerCase())]:le}),{}),wt=this.#c.getByTile(c);if(this.#o.get(y)||this.#o.set(y,[y.tile()]),y instanceof zt&&se&&c.isCoast()&&y.cargo().some(Me=>!c.getNeighbours().some(le=>(this.#o.get(Me)||[]).includes(le)))){y.action(se),y.setWaiting();continue}if(y instanceof dr){V&&this.#e(c)?y.action(V):U&&this.#t(c)?y.action(U):D&&this.#r(c)?y.action(D):A&&this.#i(c)?y.action(A):!f&&this.#g.length&&this.#n.set(y,this.#g.shift()),this.moveUnit(y);continue}let[Il]=wt.filter(Me=>this.#x.getByUnit(Me).some(le=>le instanceof di)&&y.defence()>Me.defence()),wl=this.#p.getByTile(c);if(E&&wl&&(Il||wt.length<=Math.ceil(this.#R.getByCity(wl).size()/5))){y.action(E),Il&&Il.activate();continue}if(!f){if(y instanceof Y&&y.defence().value()>0&&this.#u.length>0){let[Me]=this.#u.sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#u.splice(this.#u.indexOf(Me),1),this.#a.set(y,le))}else if(y.attack().value()>0&&this.#l.length>0){let[Me]=this.#l.filter(je=>y instanceof ot&&je.isLand()).sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#l.splice(this.#l.indexOf(Me),1),this.#a.set(y,le))}else if(y.attack().value()>0&&this.#m.length>0){let[Me]=this.#m.filter(je=>y instanceof ot&&je.isLand()||y instanceof Le&&je.isWater()).sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#m.splice(this.#m.indexOf(Me),1),this.#a.set(y,le))}else if(y instanceof ot&&y.attack().value()>0&&this.#s.length>0){let[Me]=this.#s.sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#s.splice(this.#s.indexOf(Me),1),this.#a.set(y,le))}else if(y instanceof ot&&this.#y.length>0){let[Me]=this.#y.sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#y.splice(this.#y.indexOf(Me),1),this.#a.set(y,le))}else if(y instanceof Le&&this.#f.length>0){let[Me]=this.#f.sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#f.splice(this.#f.indexOf(Me),1),this.#a.set(y,le))}}this.moveUnit(y);continue}if(u instanceof jl){this.buildItemInCity(u.city());continue}if(u instanceof Ml){let y=u.available();y.length&&u.research(y[Math.floor(y.length*Math.random())]);continue}if(p instanceof Dc)break;console.log(`Can't process: '${u.constructor.name}'`);break}e()}catch(o){if(typeof o=="string"){r(new Error(o));return}if(o instanceof Error){r(o);return}r(new Error(`An unknown error occurred: ${o}`))}})}buildItemInCity(e){let r=e.tile(),o=this.#v.getByCity(e),a=this.#c.getByTile(r),s=o.available(),p=[dt,We],u=s.filter(E=>!p.includes(E.item())&&!Object.prototype.isPrototypeOf.call(ve,E.item())),y=s.filter(E=>Object.prototype.isPrototypeOf.call(ve,E.item())),c=u.filter(E=>Object.prototype.isPrototypeOf.call(Pe,E.item())),f=u[Math.floor(u.length*Math.random())].item(),h=t(E=>{let[[V]]=c.map(se=>{let wt=se.item(),Dr=new E;return this.#I.process(fs,wt,Dr),[wt,Dr]}).sort(([,se],[,wt])=>wt.value()-se.value());return V},"getUnitByYield"),U=(E=>()=>E||(E=h(mi)))(),D=(E=>()=>E||(E=h(Vi)))();if(this.#c.getByTile(r).length<2&&U()){o.build(U());return}let A=this.#R.getByCity(o.city());if(s.some(E=>E.item()===We)&&!this.#c.getByCity(o.city()).some(E=>E instanceof We)&&this.#c.getByPlayer(this.player()).filter(E=>E instanceof We).length<3&&A.size()>1){o.build(We);return}if(this.#l.length>0||this.#s.length>0||this.#m.length>4){o.build(D());return}if(a.filter(E=>this.#x.getByUnit(E).filter(V=>V instanceof di)).length<2||this.#u.length){o.build(U());return}if(o.city().yields().filter(E=>E instanceof H).some(E=>E.value()>4)){let E=y.map(V=>V.item());o.build(E[Math.floor(Math.random()*E.length)])}f&&o.build(f)}cityLost(e,r,o){if(!r)return;let a=this.#h.getByPlayer(this.player());if(o){this.#s.push(...a.entries().filter(s=>If(s.tile(),this.player(),this.#p)).map(s=>s.tile())),this.#m.push(...a.entries().filter(s=>this.#c.getByTile(s.tile()).some(p=>p.player()===r)).map(s=>s.tile()));return}this.#l.push(e.tile())}unitDestroyed(e,r){let o=this.#p.getByTile(e.tile()),a=this.#c.getByTile(e.tile());o&&o.player()===this.player()&&a.length<2&&(this.buildItemInCity(o),this.#P.getByPlayer(this.player()).buy(o))}};t(wf,"SimpleAIClient");Sn=wf});var Af,Eo,fl=n(()=>{xe();pc();Af=class extends F{constructor(){super(ox)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of Clients for Player.");return r[0]}};t(Af,"ClientRegistry");Eo=new Af});var ca,dl,vm=n(()=>{Ft();ca=class extends me{};t(ca,"American");dl=ca});var yS={};var cT=n(()=>{vm();er();tr();Object.entries({people:"American",nation:"America",colors:["#0055A4","#FFF"]}).forEach(([i,e])=>he.register(new ge(dl,i,e)))});var fS={};var yT=n(()=>{vm();Et();gt();["Washington","New York","Los Angeles","Chicago","Houston","Phoenix","Philadelphia","San Antonio","San Diego","Dallas","San Jose","Austin","Jacksonville","Fort Worth","Columbus","San Francisco","Charlotte","Indianapolis","Seattle","Denver","Boston","El Paso","Detroit","Nashville","Portland","Memphis","Oklahoma City","Las Vegas","Louisville","Baltimore","Milwaukee","Albuquerque","Tucson","Fresno","Mesa","Sacramento","Atlanta","Kansas City","Colorado Springs","Miami","Raleigh","Omaha","Long Beach","Virginia Beach","Oakland","Minneapolis","Tulsa","Arlington","Tampa","New Orleans","Wichita","Cleveland","Bakersfield","Aurora","Anaheim","Honolulu","Santa Ana","Riverside","Corpus Christi","Lexington","Stockton","Henderson","Saint Paul","St. Louis","Cincinnati","Pittsburgh","Greensboro","Anchorage","Plano","Lincoln","Orlando","Irvine","Newark","Toledo","Durham","Chula Vista","Fort Wayne","Jersey City","St. Petersburg","Laredo","Madison","Chandler","Buffalo","Lubbock","Scottsdale","Reno","Glendale","Gilbert","Winston\u2013Salem","North Las Vegas","Norfolk","Chesapeake","Garland","Irving","Hialeah","Fremont","Boise","Richmond","Baton Rouge","Spokane","Des Moines","Tacoma","San Bernardino","Modesto","Fontana","Santa Clarita","Birmingham","Oxnard","Fayetteville","Moreno Valley","Rochester","Glendale","Huntington Beach","Salt Lake City","Grand Rapids","Amarillo","Yonkers","Aurora","Montgomery","Akron","Little Rock","Huntsville","Augusta","Port St. Lucie","Grand Prairie","Columbus","Tallahassee","Overland Park","Tempe","McKinney","Mobile","Cape Coral","Shreveport","Frisco","Knoxville","Worcester","Brownsville","Vancouver","Fort Lauderdale","Sioux Falls","Ontario","Chattanooga","Providence","Newport News","Rancho Cucamonga","Santa Rosa","Oceanside","Salem","Elk Grove","Garden Grove","Pembroke Pines","Peoria","Eugene","Corona","Cary","Springfield","Fort Collins","Jackson","Alexandria","Hayward","Lancaster","Lakewood","Clarksville","Palmdale","Salinas","Springfield","Hollywood","Pasadena","Sunnyvale","Macon","Kansas City","Pomona","Escondido","Killeen","Naperville","Joliet","Bellevue","Rockford","Savannah","Paterson","Torrance","Bridgeport","McAllen","Mesquite","Syracuse","Midland","Pasadena","Murfreesboro","Miramar","Dayton","Fullerton","Olathe","Orange","Thornton","Roseville","Denton","Waco","Surprise","Carrollton","West Valley City","Charleston","Warren","Hampton","Gainesville","Visalia","Coral Springs","Columbia","Cedar Rapids","Sterling Heights","New Haven","Stamford","Concord","Kent","Santa Clara","Elizabeth","Round Rock","Thousand Oaks","Lafayette","Athens","Topeka","Simi Valley","Fargo","Norman","Columbia","Abilene","Wilmington","Hartford","Victorville","Pearland","Vallejo","Ann Arbor","Berkeley","Allentown","Richardson","Odessa","Arvada","Cambridge","Sugar Land","Beaumont","Lansing","Evansville","Rochester","Independence","Fairfield","Provo","Clearwater","College Station","West Jordan","Carlsbad","El Monte","Murrieta","Temecula","Springfield","Palm Bay","Costa Mesa","Westminster","North Charleston","Miami Gardens","Manchester","High Point","Downey","Clovis","Pompano Beach","Pueblo","Elgin","Lowell","Antioch","West Palm Beach","Peoria","Everett","Ventura","Centennial","Lakeland","Gresham","Richmond","Billings","Inglewood","Broken Arrow","Sandy Springs","Jurupa Valley","Hillsboro","Waterbury","Santa Maria","Boulder","Greeley","Daly City","Meridian","Lewisville","Davie","West Covina","League City","Tyler","Norwalk","San Mateo","Green Bay","Wichita Falls","Sparks","Lakewood","Burbank","Rialto","Allen","El Cajon","Las Cruces","Renton","Davenport","South Bend","Vista","Tuscaloosa","Clinton","Edison","Woodbridge","San Angelo","Kenosha","Vacaville"].forEach((i,e)=>$.register(new Q(i,dl,e===0)))});var dT=b(fT=>{"use strict";Object.defineProperty(fT,"__esModule",{value:!0});cT();yT()});var ya,bm,Sp=n(()=>{Ft();ya=class extends me{};t(ya,"Aztec");bm=ya});var dS={};var gT=n(()=>{Sp();er();tr();Object.entries({people:"Aztec",nation:"Aztec",colors:["#A1DAB5","#EA6B76"]}).forEach(([i,e])=>he.register(new ge(bm,i,e)))});var gS={};var hT=n(()=>{Sp();Et();gt();["Tenochtitlan","Teotihuacan","Tlatelolco","Texcoco","Tlaxcala","Calixtlahuaca","Xochicalco","Tlacopan","Atzcapotzalco","Tzintzuntzan","Malinalco","Tula","Tamuin","Teayo","Cempoala","Chalco","Tlalmanalco","Ixtapaluca","Huexotla","Tepexpan","Tepetlaoxtoc","Chiconautla","Zitlaltepec","Coyotepec","Tequixquiac","Jilotzingo","Tlapanaloya","Tultitan","Ecatepec","Coatepec","Chalchiuites","Chiauhita","Chapultepec","Itzapalapa","Ayotzinco","Iztapam"].forEach((i,e)=>$.register(new Q(i,bm,e===0)))});var RT=b(OT=>{"use strict";Object.defineProperty(OT,"__esModule",{value:!0});gT();hT()});var fa,Cm,Yp=n(()=>{Ft();fa=class extends me{};t(fa,"Babylonian");Cm=fa});var hS={};var xT=n(()=>{Yp();er();tr();Object.entries({people:"Babylonian",nation:"Babylon",colors:["#D0B8A6","#2f7b00"]}).forEach(([i,e])=>he.register(new ge(Cm,i,e)))});var OS={};var vT=n(()=>{Yp();Et();gt();["Babilim","Eshnunna","Diniktum","Tutub","Der","Sippar","Kutha","Jemdet Nasr","Kish","Borsippa","Mashkan-shapir","Dilbat","Nippur","Marad","Adab","Isin","Kisurra","Shuruppak","Bad-tibira","Zabalam","Umma","Girsu","Lagash","Urum","Uruk","Larsa","Ur","Kuara","Eridu","Akshak","Akkad"].forEach((i,e)=>$.register(new Q(i,Cm,e===0)))});var CT=b(bT=>{"use strict";Object.defineProperty(bT,"__esModule",{value:!0});xT();vT()});var da,Tm,zp=n(()=>{Ft();da=class extends me{};t(da,"Chinese");Tm=da});var RS={};var TT=n(()=>{zp();er();tr();Object.entries({people:"Chinese",nation:"China",colors:["#ee1c25","#ff0"]}).forEach(([i,e])=>he.register(new ge(Tm,i,e)))});var xS={};var PT=n(()=>{zp();Et();gt();["Beijing","Shanghai","Chongqing","Tianjin","Guangzhou","Shenzhen\u2020","Chengdu","Nanjing","Wuhan","Xi'an","Hangzhou","Dongguan","Foshan","Shenyang","Harbin","Qingdao","Dalian","Jinan","Zhengzhou","Changsha","Kunming","Changchun","\xDCr\xFCmqi","Shantou","Hefei","Shijiazhuang","Ningbo","Taiyuan","Nanning","Xiamen\u2020","Fuzhou","Changzhou","Wenzhou","Nanchang","Tangshan","Guiyang","Wuxi","Lanzhou","Zhongshan","Handan","Huai'an","Weifang","Zibo","Shaoxing","Yantai","Huizhou","Luoyang","Nantong","Baotou","Liuzhou"].forEach((i,e)=>$.register(new Q(i,Tm,e===0)))});var wT=b(IT=>{"use strict";Object.defineProperty(IT,"__esModule",{value:!0});TT();PT()});var ga,Pm,Np=n(()=>{Ft();ga=class extends me{};t(ga,"Egyptian");Pm=ga});var vS={};var AT=n(()=>{Np();er();tr();Object.entries({people:"Egyptian",nation:"Egypt",colors:["#CE1126","#FFF"]}).forEach(([i,e])=>he.register(new ge(Pm,i,e)))});var bS={};var GT=n(()=>{Np();Et();gt();["Cairo","Alexandria","Gizeh","Shubra El-Kheima","Port Said","Suez","Luxor","al-Mansura","El-Mahalla El-Kubra","Tanta","Asyut","Ismailia","Fayyum","Zagazig","Aswan","Damietta","Damanhur","al-Minya","Beni Suef","Qena","Sohag","Hurghada","6th of October City","Shibin El Kom","Banha","Kafr el-Sheikh","Arish","Mallawi","10th of Ramadan City","Bilbais","Marsa Matruh","Idfu","Mit Ghamr","Al-Hamidiyya","Desouk","Qalyub","Abu Kabir","Kafr el-Dawwar","Girga","Akhmim","Matarey"].forEach((i,e)=>$.register(new Q(i,Pm,e===0)))});var UT=b(BT=>{"use strict";Object.defineProperty(BT,"__esModule",{value:!0});AT();GT()});var ha,gl,Im=n(()=>{Ft();ha=class extends me{};t(ha,"English");gl=ha});var CS={};var MT=n(()=>{Im();er();tr();Object.entries({people:"English",nation:"England",colors:["#FFF","#C8102E"]}).forEach(([i,e])=>he.register(new ge(gl,i,e)))});var TS={};var DT=n(()=>{Im();Et();gt();["London","Birmingham","Liverpool","Leeds","Sheffield","Bristol","Manchester","Leicester","Coventry","Kingston upon Hull","Stoke-on-Trent","Wolverhampton","Nottingham","Plymouth","Southampton","Reading","Derby","Dudley","Newcastle upon Tyne","Northampton","Portsmouth","Luton","Preston","Sunderland","Norwich","Walsall","Bournemouth","Southend-on-Sea","Swindon","Huddersfield","Poole","Oxford","Middlesbrough","Blackpool","Oldbury","Boldon","Ipswich","York","West Bromwich","Peterborough","Stockport","Brighton","Slough","Gloucester","Rotherham","Cambridge","Exeter","Eastbourne","Sutton Coldfield","Blackburn","Colchester","Oldham","St Helens","Woking","Chesterfield","Crawley"].forEach((i,e)=>$.register(new Q(i,gl,e===0)))});var FT=b(ET=>{"use strict";Object.defineProperty(ET,"__esModule",{value:!0});MT();DT()});var Oa,wm,Lp=n(()=>{Ft();Oa=class extends me{};t(Oa,"French");wm=Oa});var PS={};var kT=n(()=>{Lp();er();tr();Object.entries({people:"French",nation:"France",colors:["#FFF","#0055A4"]}).forEach(([i,e])=>he.register(new ge(wm,i,e)))});var IS={};var ST=n(()=>{Lp();Et();gt();["Paris","Marseille","Lyon","Toulouse","Nice","Nantes","Strasbourg","Montpellier","Bordeaux","Lille","Rennes","Reims","Le Havre","Saint-\xC9tienne","Toulon","Grenoble","Dijon","N\xEEmes","Angers","Villeurbanne","Le Mans","Saint-Denis","Aix-en-Provence","Clermont-Ferrand","Brest","Limoges","Tours","Amiens","Perpignan","Metz","Besan\xE7on","Boulogne-Billancourt","Orl\xE9ans","Mulhouse","Rouen","Saint-Denis","Caen","Argenteuil","Saint-Paul","Montreuil","Nancy","Roubaix","Tourcoing","Nanterre","Avignon","Vitry-sur-Seine","Cr\xE9teil","Dunkirk","Poitiers","Asni\xE8res-sur-Seine","Courbevoie","Versailles","Colombes","Fort-de-France","Aulnay-sous-Bois","Saint-Pierre","Rueil-Malmaison","Pau","Aubervilliers","Le Tampon","Champigny-sur-Marne","Antibes","B\xE9ziers","La Rochelle","Saint-Maur-des-Foss\xE9s","Cannes","Calais","Saint-Nazaire","M\xE9rignac","Drancy","Colmar","Ajaccio","Bourges","Issy-les-Moulineaux","Levallois-Perret","La Seyne-sur-Mer","Quimper","Noisy-le-Grand","Villeneuve-d'Ascq","Neuilly-sur-Seine","Valence","Antony","Cergy","V\xE9nissieux","Pessac","Troyes","Clichy","Ivry-sur-Seine","Chamb\xE9ry","Lorient","Les Abymes","Montauban","Sarcelles","Niort","Villejuif","Saint-Andr\xE9","Hy\xE8res","Saint-Quentin","Beauvais","\xC9pinay-sur-Seine","Cayenne","Maisons-Alfort","Cholet","Meaux","Chelles","Pantin","\xC9vry","Fontenay-sous-Bois","Fr\xE9jus","Vannes","Bondy","Le Blanc-Mesnil","La Roche-sur-Yon","Saint-Louis","Arles","Clamart","Narbonne","Annecy","Sartrouville","Grasse","Laval","Belfort","Bobigny","\xC9vreux","Vincennes","Montrouge","Sevran","Albi","Charleville-M\xE9zi\xE8res","Suresnes","Martigues","Corbeil-Essonnes","Saint-Ouen","Bayonne","Cagnes-sur-Mer","Brive-la-Gaillarde","Carcassonne","Massy","Blois","Aubagne","Saint-Brieuc","Ch\xE2teauroux","Chalon-sur-Sa\xF4ne","Mantes-la-Jolie","Meudon","Saint-Malo","Ch\xE2lons-en-Champagne","Alfortville","S\xE8te","Salon-de-Provence","Vaulx-en-Velin","Puteaux","Rosny-sous-Bois","Saint-Herblain","Gennevilliers","Le Cannet","Livry-Gargan","Saint-Priest","Istres","Valenciennes","Choisy-le-Roi","Caluire-et-Cuire","Boulogne-sur-Mer","Bastia","Angoul\xEAme","Garges-l\xE8s-Gonesse","Castres","Thionville","Wattrelos","Talence","Saint-Laurent-du-Maroni","Douai","Noisy-le-Sec","Tarbes","Arras","Al\xE8s","La Courneuve","Bourg-en-Bresse","Compi\xE8gne","Gap","Melun","Le Lamentin","Rez\xE9","Saint-Germain-en-Laye","Marcq-en-Bar\u0153ul","Gagny","Anglet","Draguignan","Chartres","Bron","Bagneux","Colomiers","Saint-Martin-d'H\xE8res","Pontault-Combault","Montlu\xE7on","Jou\xE9-l\xE8s-Tours","Saint-Joseph","Poissy","Savigny-sur-Orge","Cherbourg-Octeville","Mont\xE9limar","Villefranche-sur-Sa\xF4ne","Stains","Saint-Beno\xEEt","Bagnolet","Ch\xE2tillon","Le Port","Sainte-Genevi\xE8ve-des-Bois","\xC9chirolles","Roanne","Villepinte","Saint-Chamond","Conflans-Sainte-Honorine","Auxerre","Nevers","Neuilly-sur-Marne","La Ciotat","Tremblay-en-France","Thonon-les-Bains","Vitrolles","Haguenau","Six-Fours-les-Plages","Agen","Creil","Annemasse","Saint-Rapha\xEBl","Marignane","Romans-sur-Is\xE8re","Montigny-le-Bretonneux","Le Perreux-sur-Marne","Franconville","M\xE2con","Saint-Leu","Cambrai","Ch\xE2tenay-Malabry","Sainte-Marie","Villeneuve-Saint-Georges","Houilles","\xC9pinal","Lens","Li\xE9vin","Les Mureaux","Schiltigheim","La Possession","Meyzieu","Dreux","Nogent-sur-Marne","Plaisir","Mont-de-Marsan","Palaiseau","Ch\xE2tellerault","Goussainville","L'Ha\xFF-les-Roses","Viry-Ch\xE2tillon","Vigneux-sur-Seine","Chatou","Trappes","Clichy-sous-Bois","Rillieux-la-Pape","Villenave-'Ornon","Maubeuge","Charenton-le-Pont","Malakoff","Matoury","Dieppe","Athis-Mons","Savigny-le-Temple","P\xE9rigueux","Baie-Mahault","Vandoeuvre-l\xE8s-Nancy","Pontoise","Aix-les-Bains","Cachan","Vienne","Thiais","Orange","Saint-M\xE9dard-en-Jalles","Villemomble","Saint-Cloud","Saint-Laurent-du-Var","Yerres","Saint-\xC9tienne-du-Rouvray","Sotteville-l\xE8s-Rouen","Draveil","Le Chesnay","Bois-Colombes","Le Plessis-Robinson","La Garenne-Colombes","Lambersart","Soissons","Pierrefitte-sur-Seine","Carpentras","Villiers-sur-Marne","Vanves","Menton","Bergerac","Ermont","Bezons","Grigny","Guyancourt","Saumur","Herblay","Ris-Orangis","Villiers-le-Bel","Bourgoin-Jallieu","Vierzon","Le Gosier","D\xE9cines-Charpieu","H\xE9nin-Beaumont","Fresnes","Aurillac","Sannois","Vallauris","Illkirch-Graffenstaden","Alen\xE7on","\xC9lancourt","Tournefeuille","B\xE8gles","Gonesse","Oullins","Brunoy","Taverny","Armenti\xE8res","Montfermeil","Rambouillet","Villeparisis","Le Kremlin-Bic\xEAtre","Sucy-en-Brie","Kourou","Montb\xE9liard","Romainville","Cavaillon","Saint-Dizier","Br\xE9tigny-sur-Orge","Saint-S\xE9bastien-sur-Loire","Saintes","La Teste-de-Buch","Villeneuve-la-Garenne","B\xE9thune","Bussy-Saint-Georges","Vichy","La Garde","Agde","Laon","Sens","Lunel","Miramas","Biarritz","Le Grand-Quevilly","Orvault","Les Ulis","Champs-sur-Marne","Rochefort","Muret","Sainte-Anne","Eaubonne","\xC9tampes","Gradignan","Vernon","Petit-Bourg","Libourne","Abbeville","Rodez","Saint-Ouen-l'Aum\xF4ne","Torcy","Maisons-Laffitte","Montgeron","Villeneuve-sur-Lot","Cormeilles-en-Parisis","\xC9pernay","S\xE8vres","Dole","Le Robert","Le Bouscat","Blagnac","Frontignan","Cenon","Mandelieu-la-Napoule","Vertou","Les Lilas","Bruay-la-Buissi\xE8re","Les Pavillons-sous-Bois","Chaumont","Roissy-en-Brie","Le Moule","Le Petit-Quevilly","Manosque","Saint-Mand\xE9","Fontenay-aux-Roses","Orly","Le Creusot","Oyonnax","La Madeleine","Sainte-Suzanne","Millau","Combs-la-Ville","Fontaine","Deuil-la-Barre","Coudekerque-Branche","Auch","Lanester","Beaune","Montigny-l\xE8s-Metz","Hazebrouck","Longjumeau","Sainte-Foy-l\xE8s-Lyon","Forbach","Sarreguemines","Mons-en-Bar\u0153ul","La Valette-du-Var","H\xE9rouville-Saint-Clair","Morsang-sur-Orge","Grande-Synthe","La Celle-Saint-Cloud","Lisieux","Croix","Dammarie-les-Lys","V\xE9lizy-Villacoublay","Wasquehal","Saint-Gratien","Halluin","Neuilly-Plaisance","Montmorency","Dax","Lagny-sur-Marne","Le M\xE9e-sur-Seine","Saint-Genis-Laval","Fleury-les-Aubrais","Loos","Gif-sur-Yvette","Denain","Saint-Di\xE9-des-Vosges","Sainte-Rose","Saint-Michel-sur-Orge"].forEach((i,e)=>$.register(new Q(i,wm,e===0)))});var zT=b(YT=>{"use strict";Object.defineProperty(YT,"__esModule",{value:!0});kT();ST()});var Ra,hl,Am=n(()=>{Ft();Ra=class extends me{};t(Ra,"German");hl=Ra});var wS={};var NT=n(()=>{Am();er();tr();Object.entries({people:"German",nation:"Germany",colors:["#000","#FC0"]}).forEach(([i,e])=>he.register(new ge(hl,i,e)))});var AS={};var LT=n(()=>{Am();Et();gt();["Berlin","Hamburg","Munich","Cologne","Frankfurt","Stuttgart","D\xFCsseldorf","Dortmund","Essen","Leipzig","Bremen","Dresden","Hanover","Nuremberg","Duisburg","Bochum","Wuppertal","Bielefeld","Bonn","M\xFCnster","Karlsruhe","Mannheim","Augsburg","Wiesbaden","Gelsenkirchen","M\xF6nchengladbach","Braunschweig","Chemnitz","Kiel","Aachen","Halle","Magdeburg","Freiburg","Krefeld","L\xFCbeck","Oberhausen","Erfurt","Mainz","Rostock","Kassel","Hagen","Hamm","Saarbr\xFCcken","M\xFClheim an der Ruhr","Potsdam","Ludwigshafen am Rhein","Oldenburg","Leverkusen","Osnabr\xFCck","Solingen"].forEach((i,e)=>$.register(new Q(i,hl,e===0)))});var jT=b(WT=>{"use strict";Object.defineProperty(WT,"__esModule",{value:!0});NT();LT()});var xa,Gm,Wp=n(()=>{Ft();xa=class extends me{};t(xa,"Greek");Gm=xa});var GS={};var HT=n(()=>{Wp();er();tr();Object.entries({people:"Greek",nation:"Greece",colors:["#2175D8","#FFF"]}).forEach(([i,e])=>he.register(new ge(Gm,i,e)))});var BS={};var _T=n(()=>{Wp();Et();gt();["Athens","Thessaloniki","Patras","Piraeus","Larissa","Heraklion","Peristeri","Kallithea","Acharnes","Kalamaria","Nikaia","Glyfada","Volos","Ilio","Ilioupoli","Keratsini","Evosmos","Chalandri","Nea Smyrni","Marousi","Agios Dimitrios","Zografou","Egaleo","Nea Ionia","Ioannina","Palaio Faliro","Korydallos","Trikala","Vyronas","Agia Paraskevi","Galatsi","Agrinio","Chalcis","Petroupoli","Serres","Alexandroupoli","Xanthi","Katerini","Kalamata","Kavala","Chania","Lamia","Komotini","Irakleio","Rhodes","Kifissia","Stavroupoli","Chaidari","Drama","Veria","Alimos","Kozani","Polichni","Karditsa","Sykies","Ampelokipoi","Pylaia","Agioi Anargyroi","Argyroupoli","Ano Liosia","Nea Ionia","Rethymno","Ptolemaida","Tripoli","Cholargos","Vrilissia","Aspropyrgos","Corinth","Gerakas","Metamorfosi","Giannitsa","Voula","Kamatero","Mytilene","Neapoli","Eleftherio-Kordelio","Chios","Agia Varvara","Kaisariani","Nea Filadelfeia","Moschato","Perama","Salamina","Eleusis","Corfu","Pyrgos","Megara","Kilkis","Dafni","Thebes","Melissia","Argos","Arta","Artemida","Livadeia","Pefki","Oraiokastro","Aigio","Kos","Koropi","Preveza","Naousa","Orestiada","Peraia","Edessa","Florina","Panorama","Nea Erythraia1","Elliniko1","Amaliada","Pallini","Sparta","Agios Ioannis Rentis","Thermi","Vari","Nea Makri","Tavros","Alexandreia","Menemeni","Paiania","Kalyvia Thorikou","Nafplio","Drapetsona","Efkarpia","Papagou","Nafpaktos","Kastoria","Grevena","Pefka","Nea Alikarnassos","Missolonghi","Gazi","Ierapetra","Kalymnos","Rafina","Loutraki","Agios Nikolaos","Ermoupoli","Ialysos","Mandra","Tyrnavos","Glyka Nera","Ymittos","Neo Psychiko"].forEach((i,e)=>$.register(new Q(i,Gm,e===0)))});var qT=b(KT=>{"use strict";Object.defineProperty(KT,"__esModule",{value:!0});HT();_T()});var va,Bm,jp=n(()=>{Ft();va=class extends me{};t(va,"Indian");Bm=va});var US={};var VT=n(()=>{jp();er();tr();Object.entries({people:"Indian",nation:"India",colors:["#138808","#FF9933"]}).forEach(([i,e])=>he.register(new ge(Bm,i,e)))});var MS={};var JT=n(()=>{jp();Et();gt();["Delhi","Mumbai","Bangalore","Hyderabad","Ahmedabad","Chennai","Kolkata","Surat","Pune","Jaipur","Lucknow","Kanpur","Nagpur","Indore","Thane","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara","Ghaziabad","Ludhiana","Agra","Nashik","Faridabad","Meerut","Rajkot","Kalyan-Dombivli","Vasai-Virar","Varanasi","Srinagar","Aurangabad","Dhanbad","Amritsar","Navi Mumbai","Allahabad","Howrah","Ranchi","Gwalior","Jabalpur","Coimbatore","Vijayawada","Jodhpur","Madurai","Raipur","Kota","Chandigarh","Guwahati","Solapur","Hubli\u2013Dharwad","Tiruchirappalli","Bareilly","Moradabad","Mysore","Tiruppur","Gurgaon","Aligarh","Jalandhar","Bhubaneswar","Salem","Mira-Bhayandar","Warangal","Jalgaon","Guntur","Bhiwandi","Saharanpur","Gorakhpur","Bikaner","Amravati","Noida","Jamshedpur","Bhilai","Cuttack","Firozabad","Kochi","Nellore","Bhavnagar","Dehradun","Durgapur","Asansol","Rourkela","Nanded","Kolhapur","Ajmer","Akola","Gulbarga","Jamnagar","Ujjain","Loni","Siliguri","Jhansi","Ulhasnagar","Jammu","Sangli-Miraj & Kupwad","Mangalore","Erode","Belgaum","Ambattur","Tirunelveli","Malegaon","Gaya","Thiruvananthapuram","Udaipur","Maheshtala","Davanagere","Kozhikode","Kurnool","Rajpur Sonarpur","Rajahmundry","Bokaro","South Dumdum","Bellary","Patiala","Gopalpur","Agartala","Bhagalpur","Muzaffarnagar","Bhatpara","Panihati","Latur","Dhule","Tirupati","Rohtak","Korba","Bhilwara","Berhampur","Muzaffarpur","Ahmednagar","Mathura","Kollam","Avadi","Kadapa","Kamarhati","Sambalpur","Bilaspur","Shahjahanpur","Satara","Bijapur","Kakinada","Rampur","Shimoga","Chandrapur","Junagadh","Thrissur","Alwar","Bardhaman","Kulti","Nizamabad","Parbhani","Tumkur","Khammam","Ozhukarai","Bihar Sharif","Panipat","Darbhanga","Bally","Aizawl","Dewas","Ichalkaranji","Karnal","Bathinda","Jalna","Eluru","Barasat","Kirari Suleman Nagar","Purnia","Satna","Mau","Sonipat","Farrukhabad","Sagar","Durg","Imphal","Ratlam","Hapur","Arrah","Anantapur","Karimnagar","Etawah","Ambarnath","North Dumdum","Bharatpur","Begusarai","New Delhi","Gandhidham","Baranagar","Tiruvottiyur","Pondicherry","Sikar","Thoothukudi","Rewa","Mirzapur","Raichur","Pali","Ramagundam","Haridwar","Vijayanagaram","Katihar","Nagercoil","Sri Ganganagar","Karawal Nagar","Mango","Thanjavur","Bulandshahr","Uluberia","Katni","Sambhal","Singrauli","Nadiad","Secunderabad","Naihati","Yamunanagar","Bidhannagar","Pallavaram","Bidar","Munger","Panchkula","Burhanpur","Raurkela Industrial Township","Kharagpur","Dindigul","Gandhinagar","Hospet","Nangloi Jat","Malda","Ongole","Deoghar","Chapra","Haldia","Khandwa","Nandyal","Morena","Amroha","Anand","Bhind","Bhalswa Jahangir Pur","Madhyamgram","Bhiwani","Berhampore","Ambala","Morbi","Fatehpur","Raebareli","Mahaboobnagar","Chittoor","Bhusawal","Orai","Bahraich","Vellore","Mehsana","Raiganj","Sirsa","Danapur","Serampore","Sultan Pur Majra","Guna","Jaunpur","Panvel","Shivpuri","Surendranagar Dudhrej","Unnao","Chinsurah","Alappuzha","Kottayam","Machilipatnam","Shimla","Adoni","Udupi","Tenali","Proddatur","Saharsa","Hindupur","Sasaram","Hajipur","Bhimavaram","Kumbakonam","Dehri","Madanapalle","Siwan","Bettiah","Guntakal","Srikakulam","Motihari","Dharmavaram","Gudivada","Phagwara","Narasaraopet","Suryapet","Miryalaguda","Tadipatri","Karaikudi","Kishanganj","Jamalpur","Ballia","Kavali","Tadepalligudem","Amaravati","Buxar","Jehanabad","Aurangabad","Gangtok"].forEach((i,e)=>$.register(new Q(i,Bm,e===0)))});var ZT=b($T=>{"use strict";Object.defineProperty($T,"__esModule",{value:!0});VT();JT()});var ba,Um,Hp=n(()=>{Ft();ba=class extends me{};t(ba,"Mongol");Um=ba});var DS={};var QT=n(()=>{Hp();er();tr();Object.entries({people:"Mongol",nation:"Mongolia",colors:["#DA2032","#0066B3"]}).forEach(([i,e])=>he.register(new ge(Um,i,e)))});var ES={};var XT=n(()=>{Hp();Et();gt();["Ulaanbaatar","Erdenet","Darkhan","Choibalsan","M\xF6r\xF6n","Nalaikh","Bayankhongor","\xD6lgii","Khovd","Arvaikheer","Ulaangom","Baganuur","Sainshand","Tsetserleg","S\xFCkhbaatar","\xD6nd\xF6rkhaan","Dalanzadgad","Z\xFC\xFCnkharaa","Uliastai","Altai","Baruun-Urt","Mandalgovi","Zuunmod","Zamyn-\xDC\xFCd","Bulgan","Kharkhorin","Choir","Bor-\xD6nd\xF6r","Sharyngo"].forEach((i,e)=>$.register(new Q(i,Um,e===0)))});var tP=b(eP=>{"use strict";Object.defineProperty(eP,"__esModule",{value:!0});QT();XT()});var Ca,Mm,_p=n(()=>{Ft();Ca=class extends me{};t(Ca,"Roman");Mm=Ca});var FS={};var rP=n(()=>{_p();er();tr();Object.entries({people:"Roman",nation:"Rome",colors:["#A20101","#D1B24F"]}).forEach(([i,e])=>he.register(new ge(Mm,i,e)))});var kS={};var iP=n(()=>{_p();Et();gt();["Roma","Ariminum","Belum","Placentia","Tarraco","Italica","Mod","Salernum","Bononia","Forum Livii","Regium Lepidi","Aquileia","Ascrivium","Valentia Edetanorum","Scalabis","Villa Euracini","Palma","Colonia Narbo Martius","Massa","Pistoria","Segovia","Gerunda","Pompaelo","Naissus","Brigantium","Florentia","Vesontio","Lutetia Parisiorum","Atuatuca Tungrorum","Iulia Romula Hispalis","Augusta Raurica","Noviodunum","Lugdunum","Siscia","Marsonia","Augusta Treverorum","Castra Legionis","Augusta Taurinorum","Augusta Praetoria Salassorum","Emerita Augusta","Norba Caesarina","Lucus Augusta","Caesarea","Bracara Augusta","Novaesium","Castra Vetera","Pons Drusi","Ovilava","Iuvavum","Augusta Vindelicorum","Turicum","Asturica Augusta","Borbetomagus","Caesaraugusta","Sirmium","Sorviodurum","Mogontiacum","Argentoratum","Bonna","Noviomagus","Castellum apud Confluentes","Divodurum","Caesaromagus","Ambianum","Faventia Paterna Barcino","Abila","Lousonna","Ulpia Noviomagus Batavorum","Rigomagus","Aquae Mattiacorum","Mursa","Emona","Vindonissa","Aventicum","Praetorium Agrippinae","Lugdunum Batavorum","Aequum","Londinium","Albanianis","Lauri","Durovernum Cantiacorum","Regulbium","Rutupiae","Viminacium","Camulodunum","Traiectum","Matilo","Forum Hadriani","Nigrum Pullum","Lindum Colonia","Ratae Corieltauvorum","Durocobrivis","Colonia Agrippina","Durocornovium","Verulamium","Letocetum","Dubris","Danum","Mediolanum","Isca Dumnoniorum","Blestium","Viroconium Cornoviorum","Aquae Sulis","Durnovaria","Lindinis","Ad Flexum","Clausentum","Venta Belgarum","Calleva Atrebatum","Duroliponte","Concangis","Condate","Corinium Dobunnorum","Eboracum","Luguvalium","Arae Flaviae","Isca Augusta","Lagentium","Lopodunum","Moridunum","Venta Silurum","Deva Victrix","Mamucium","Olicana","Vinovia","Bonames","Coria","Gerulata","Vindobona","Biriciana","Cannstatt Castrum","Colonia Nervia Glevensium","Sumelocenna","Lopodunum","Traiectum ad Nicrem","Castra Batavar","Nida","Lactodurum","Bovium","Burgodunum","Lentia","Aquae Granni","Complutum","Aeminium","Traiectum ad Mosam","Coriovallum","Portus Lemanis","Andautonia","Salona","Cibalae","Aquae Helveticae","Aquincum","Apulum","Pons Aelius","Durovigutum","Aelia Capitolina","Ala","Castra Regina","Theranda","Pomaria","Partiscum","Gesoriacum","Aurelia Aquensis","Urbs Aurelianorum","Venetiae","Ragusium"].forEach((i,e)=>$.register(new Q(i,Mm,e===0)))});var nP=b(oP=>{"use strict";Object.defineProperty(oP,"__esModule",{value:!0});rP();iP()});var Ta,Ol,Dm=n(()=>{Ft();Ta=class extends me{};t(Ta,"Russian");Ol=Ta});var SS={};var aP=n(()=>{Dm();er();tr();Object.entries({people:"Russian",nation:"Russia",colors:["#0032A0","#DA291C"]}).forEach(([i,e])=>he.register(new ge(Ol,i,e)))});var YS={};var sP=n(()=>{Dm();Et();gt();["Moscow","Saint Petersburg","Novosibirsk","Yekaterinburg","Nizhny Novgorod","Kazan","Chelyabinsk","Omsk","Samara","Ufa","Rostov-on-Don","Krasnoyarsk","Voronezh","Perm","Volgograd","Krasnodar","Saratov","Tyumen","Makhachkala","Tolyatti","Barnaul","Ulyanovsk","Izhevsk","Vladivostok","Irkutsk","Khabarovsk","Yaroslavl","Tomsk","Orenburg","Kemerovo","Novokuznetsk","Tula","Ryazan","Kirov","Astrakhan","Naberezhnye Chelny","Sochi","Penza","Lipetsk","Cheboksary","Balashikha","Kaliningrad","Kursk","Stavropol","Ulan-Ude","Bryansk","Tver","Magnitogorsk","Ivanovo","Belgorod","Surgut","Vladimir","Arkhangelsk","Nizhny Tagil","Kaluga","Chita","Saransk","Yakutsk","Smolensk","Podolsk","Volzhsky","Vladikavkaz","Vologda","Cherepovets","Kurgan","Oryol","Grozny","Murmansk","Tambov","Petrozavodsk","Sterlitamak","Kostroma","Nizhnevartovsk","Novorossiysk","Yoshkar-Ola","Taganrog","Komsomolsk-on-Amur","Khimki","Syktyvkar","Nalchik","Nizhnekamsk","Shakhty","Dzerzhinsk","Bratsk","Orsk","Angarsk","Engels","Blagoveshchensk","Stary Oskol","Veliky Novgorod","Korolyov","Pskov","Mytishchi","Biysk","Lyubertsy","Prokopyevsk","Yuzhno-Sakhalinsk","Balakovo","Armavir","Rybinsk","Severodvinsk","Abakan","Petropavlovsk-Kamchatsky","Norilsk","Syzran","Volgodonsk","Ussuriysk","Kamensk-Uralsky","Novocherkassk","Zlatoust","Elektrostal","Almetyevsk","Krasnogorsk","Salavat","Miass","Nakhodka","Kopeysk","Pyatigorsk","Rubtsovsk","Berezniki","Kolomna","Maykop","Odintsovo","Khasavyurt","Kovrov","Kislovodsk","Neftekamsk","Nefteyugansk","Novocheboksarsk","Serpukhov","Shchyolkovo","Novomoskovsk","Bataysk","Pervouralsk","Domodedovo","Derbent","Cherkessk","Orekhovo-Zuyevo","Nevinnomyssk","Dimitrovgrad","Nazran","Kyzyl","Oktyabrsky","Obninsk","Kaspiysk","Novy Urengoy","Ramenskoye","Kamyshin","Murom","Zhukovsky"].forEach((i,e)=>$.register(new Q(i,Ol,e===0)))});var mP=b(lP=>{"use strict";Object.defineProperty(lP,"__esModule",{value:!0});aP();sP()});var Pa,Em,Kp=n(()=>{Ft();Pa=class extends me{};t(Pa,"Zulu");Em=Pa});var zS={};var pP=n(()=>{Kp();er();tr();Object.entries({people:"Zulu",nation:"Zulus",colors:["#FFFD1E","#000"]}).forEach(([i,e])=>he.register(new ge(Em,i,e)))});var NS={};var uP=n(()=>{Kp();Et();gt();["uMgungundlovu","Nobamba","Bulawayo","KwaDukuza","Nongoma","oNdini","Nodwengu","Ndondakusuka","Babanango","Khangela","Kwahlomendlini","Hlobane","eThekwini","Mlambongwenya","Eziqwaqweni","Isiphezi","Masotsheni","Mtunzini","Nyakamubi","Hlatikulu","Mthonjaneni","Empangeni","Pongola","Tungela","Kwamashu","Ingwavuma","Hluhluwe","Mtubatuba","Mhlahlandlela","Mthatha","Maseru","Lobamba","Qunu"].forEach((i,e)=>$.register(new Q(i,Em,e===0)))});var yP=b(cP=>{"use strict";Object.defineProperty(cP,"__esModule",{value:!0});pP();uP()});var LS={};var fP=n(()=>{B();Sh();O.register(Zv)});var gP=b(dP=>{"use strict";Object.defineProperty(dP,"__esModule",{value:!0});fP()});var WS={};var hP=n(()=>{B();Yh();O.register(Qv)});var RP=b(OP=>{"use strict";Object.defineProperty(OP,"__esModule",{value:!0});hP()});var jS={};var xP=n(()=>{B();zh();O.register(Xv)});var bP=b(vP=>{"use strict";Object.defineProperty(vP,"__esModule",{value:!0});xP()});var HS={};var CP=n(()=>{B();Nh();O.register(eb)});var PP=b(TP=>{"use strict";Object.defineProperty(TP,"__esModule",{value:!0});CP()});var _S={};var IP=n(()=>{B();Lh();O.register(tb)});var AP=b(wP=>{"use strict";Object.defineProperty(wP,"__esModule",{value:!0});IP()});var KS={};var GP=n(()=>{B();Wh();O.register(rb)});var UP=b(BP=>{"use strict";Object.defineProperty(BP,"__esModule",{value:!0});GP()});var qS={};var MP=n(()=>{B();jh();O.register(ib)});var EP=b(DP=>{"use strict";Object.defineProperty(DP,"__esModule",{value:!0});MP()});var VS={};var FP=n(()=>{B();Hh();O.register(ob)});var SP=b(kP=>{"use strict";Object.defineProperty(kP,"__esModule",{value:!0});FP()});var JS={};var YP=n(()=>{B();_h();O.register(nb)});var NP=b(zP=>{"use strict";Object.defineProperty(zP,"__esModule",{value:!0});YP()});var $S={};var LP=n(()=>{B();Kh();O.register(ab)});var jP=b(WP=>{"use strict";Object.defineProperty(WP,"__esModule",{value:!0});LP()});var ZS={};var HP=n(()=>{B();qh();O.register(sb)});var KP=b(_P=>{"use strict";Object.defineProperty(_P,"__esModule",{value:!0});HP()});var QS={};var qP=n(()=>{B();Vh();O.register(lb)});var JP=b(VP=>{"use strict";Object.defineProperty(VP,"__esModule",{value:!0});qP()});var XS={};var $P=n(()=>{B();Jh();O.register(mb)});var QP=b(ZP=>{"use strict";Object.defineProperty(ZP,"__esModule",{value:!0});$P()});var eY={};var XP=n(()=>{B();$h();O.register(pb)});var tI=b(eI=>{"use strict";Object.defineProperty(eI,"__esModule",{value:!0});XP()});var tY={};var rI=n(()=>{B();Zh();O.register(ub)});var oI=b(iI=>{"use strict";Object.defineProperty(iI,"__esModule",{value:!0});rI()});var rY={};var nI=n(()=>{B();Qh();O.register(cb)});var sI=b(aI=>{"use strict";Object.defineProperty(aI,"__esModule",{value:!0});nI()});var iY={};var lI=n(()=>{B();Xh();O.register(yb)});var pI=b(mI=>{"use strict";Object.defineProperty(mI,"__esModule",{value:!0});lI()});var oY={};var uI=n(()=>{B();eO();O.register(fb)});var yI=b(cI=>{"use strict";Object.defineProperty(cI,"__esModule",{value:!0});uI()});var nY={};var fI=n(()=>{B();tO();O.register(db)});var gI=b(dI=>{"use strict";Object.defineProperty(dI,"__esModule",{value:!0});fI()});var aY={};var hI=n(()=>{B();rO();O.register(gb)});var RI=b(OI=>{"use strict";Object.defineProperty(OI,"__esModule",{value:!0});hI()});var sY={};var xI=n(()=>{B();iO();O.register(hb)});var bI=b(vI=>{"use strict";Object.defineProperty(vI,"__esModule",{value:!0});xI()});var lY={};var CI=n(()=>{B();oO();O.register(Ob)});var PI=b(TI=>{"use strict";Object.defineProperty(TI,"__esModule",{value:!0});CI()});var mY={};var II=n(()=>{B();nO();O.register(Rb)});var AI=b(wI=>{"use strict";Object.defineProperty(wI,"__esModule",{value:!0});II()});var pY={};var GI=n(()=>{B();aO();O.register(xb)});var UI=b(BI=>{"use strict";Object.defineProperty(BI,"__esModule",{value:!0});GI()});var uY={};var MI=n(()=>{B();sO();O.register(vb)});var EI=b(DI=>{"use strict";Object.defineProperty(DI,"__esModule",{value:!0});MI()});var cY={};var FI=n(()=>{B();lO();O.register(bb)});var SI=b(kI=>{"use strict";Object.defineProperty(kI,"__esModule",{value:!0});FI()});var yY={};var YI=n(()=>{B();mO();O.register(Cb)});var NI=b(zI=>{"use strict";Object.defineProperty(zI,"__esModule",{value:!0});YI()});var fY={};var LI=n(()=>{B();pO();O.register(Tb)});var jI=b(WI=>{"use strict";Object.defineProperty(WI,"__esModule",{value:!0});LI()});var dY={};var HI=n(()=>{B();uO();O.register(Pb)});var KI=b(_I=>{"use strict";Object.defineProperty(_I,"__esModule",{value:!0});HI()});var gY={};var qI=n(()=>{B();cO();O.register(Ib)});var JI=b(VI=>{"use strict";Object.defineProperty(VI,"__esModule",{value:!0});qI()});var hY={};var $I=n(()=>{B();yO();O.register(wb)});var QI=b(ZI=>{"use strict";Object.defineProperty(ZI,"__esModule",{value:!0});$I()});var OY={};var XI=n(()=>{B();fO();O.register(Ab)});var tw=b(ew=>{"use strict";Object.defineProperty(ew,"__esModule",{value:!0});XI()});var RY={};var rw=n(()=>{B();dO();O.register(Gb)});var ow=b(iw=>{"use strict";Object.defineProperty(iw,"__esModule",{value:!0});rw()});var xY={};var nw=n(()=>{B();gO();O.register(Bb)});var sw=b(aw=>{"use strict";Object.defineProperty(aw,"__esModule",{value:!0});nw()});var vY={};var lw=n(()=>{B();hO();O.register(Ub)});var pw=b(mw=>{"use strict";Object.defineProperty(mw,"__esModule",{value:!0});lw()});var bY={};var uw=n(()=>{B();OO();O.register(Mb)});var yw=b(cw=>{"use strict";Object.defineProperty(cw,"__esModule",{value:!0});uw()});var CY={};var fw=n(()=>{B();RO();O.register(Db)});var gw=b(dw=>{"use strict";Object.defineProperty(dw,"__esModule",{value:!0});fw()});var TY={};var hw=n(()=>{B();xO();O.register(Eb)});var Rw=b(Ow=>{"use strict";Object.defineProperty(Ow,"__esModule",{value:!0});hw()});var PY={};var xw=n(()=>{B();vO();O.register(Fb)});var bw=b(vw=>{"use strict";Object.defineProperty(vw,"__esModule",{value:!0});xw()});var IY={};var Cw=n(()=>{B();bO();O.register(kb)});var Pw=b(Tw=>{"use strict";Object.defineProperty(Tw,"__esModule",{value:!0});Cw()});var wY={};var Iw=n(()=>{B();CO();O.register(Sb)});var Aw=b(ww=>{"use strict";Object.defineProperty(ww,"__esModule",{value:!0});Iw()});var AY={};var Gw=n(()=>{B();TO();O.register(Yb)});var Uw=b(Bw=>{"use strict";Object.defineProperty(Bw,"__esModule",{value:!0});Gw()});var GY={};var Mw=n(()=>{B();PO();O.register(zb)});var Ew=b(Dw=>{"use strict";Object.defineProperty(Dw,"__esModule",{value:!0});Mw()});var BY={};var Fw=n(()=>{B();IO();O.register(Nb)});var Sw=b(kw=>{"use strict";Object.defineProperty(kw,"__esModule",{value:!0});Fw()});var UY={};var Yw=n(()=>{B();wO();O.register(Lb)});var Nw=b(zw=>{"use strict";Object.defineProperty(zw,"__esModule",{value:!0});Yw()});var MY={};var Lw=n(()=>{B();AO();O.register(Wb)});var jw=b(Ww=>{"use strict";Object.defineProperty(Ww,"__esModule",{value:!0});Lw()});var DY={};var Hw=n(()=>{B();GO();O.register(jb)});var Kw=b(_w=>{"use strict";Object.defineProperty(_w,"__esModule",{value:!0});Hw()});var EY={};var qw=n(()=>{B();BO();O.register(Hb)});var Jw=b(Vw=>{"use strict";Object.defineProperty(Vw,"__esModule",{value:!0});qw()});var FY={};var $w=n(()=>{B();UO();O.register(_b)});var Qw=b(Zw=>{"use strict";Object.defineProperty(Zw,"__esModule",{value:!0});$w()});var kY={};var Xw=n(()=>{B();MO();O.register(Kb)});var tA=b(eA=>{"use strict";Object.defineProperty(eA,"__esModule",{value:!0});Xw()});var SY={};var rA=n(()=>{B();DO();O.register(qb)});var oA=b(iA=>{"use strict";Object.defineProperty(iA,"__esModule",{value:!0});rA()});var YY={};var nA=n(()=>{B();EO();O.register(Vb)});var sA=b(aA=>{"use strict";Object.defineProperty(aA,"__esModule",{value:!0});nA()});var zY={};var lA=n(()=>{B();FO();O.register(Jb)});var pA=b(mA=>{"use strict";Object.defineProperty(mA,"__esModule",{value:!0});lA()});var NY={};var uA=n(()=>{B();kO();O.register($b)});var yA=b(cA=>{"use strict";Object.defineProperty(cA,"__esModule",{value:!0});uA()});var LY={};var fA=n(()=>{B();SO();O.register(Zb)});var gA=b(dA=>{"use strict";Object.defineProperty(dA,"__esModule",{value:!0});fA()});var WY={};var hA=n(()=>{B();YO();O.register(Qb)});var RA=b(OA=>{"use strict";Object.defineProperty(OA,"__esModule",{value:!0});hA()});var jY={};var xA=n(()=>{B();zO();O.register(Xb)});var bA=b(vA=>{"use strict";Object.defineProperty(vA,"__esModule",{value:!0});xA()});var HY={};var CA=n(()=>{B();NO();O.register(eC)});var PA=b(TA=>{"use strict";Object.defineProperty(TA,"__esModule",{value:!0});CA()});var _Y={};var IA=n(()=>{B();LO();O.register(tC)});var AA=b(wA=>{"use strict";Object.defineProperty(wA,"__esModule",{value:!0});IA()});var KY={};var GA=n(()=>{B();WO();O.register(rC)});var UA=b(BA=>{"use strict";Object.defineProperty(BA,"__esModule",{value:!0});GA()});var qY={};var MA=n(()=>{B();jO();O.register(iC)});var EA=b(DA=>{"use strict";Object.defineProperty(DA,"__esModule",{value:!0});MA()});var VY={};var FA=n(()=>{B();KO();O.register(aC)});var SA=b(kA=>{"use strict";Object.defineProperty(kA,"__esModule",{value:!0});FA()});var JY={};var YA=n(()=>{B();HO();O.register(oC)});var NA=b(zA=>{"use strict";Object.defineProperty(zA,"__esModule",{value:!0});YA()});var $Y={};var LA=n(()=>{B();_O();O.register(nC)});var jA=b(WA=>{"use strict";Object.defineProperty(WA,"__esModule",{value:!0});LA()});var ZY={};var HA=n(()=>{B();qO();O.register(sC)});var KA=b(_A=>{"use strict";Object.defineProperty(_A,"__esModule",{value:!0});HA()});var QY={};var qA=n(()=>{B();VO();O.register(lC)});var JA=b(VA=>{"use strict";Object.defineProperty(VA,"__esModule",{value:!0});qA()});var XY={};var $A=n(()=>{B();JO();O.register(mC)});var QA=b(ZA=>{"use strict";Object.defineProperty(ZA,"__esModule",{value:!0});$A()});var ez,XA,eG=n(()=>{sp();T();K();ez=t((i=P)=>[new Jn(new m((e,r)=>{i.emit("city:building-complete",e,r)}))],"getRules"),XA=ez});var tz,tG,rG=n(()=>{rt();rr();$n();_e();K();$s();T();tz=t((i=j,e=z,r=ye,o=Qt,a=P)=>[new cr(new m(s=>o.getByCity(s).progress().set(0))),new cr(new m(s=>r.getByCity(s).shrink())),new cr(new m((s,p,u)=>{a.emit("city:captured",s,p,u)})),new cr(new m(s=>e.getByCity(s).forEach(p=>p.destroy())))],"getRules"),tG=tz});var QO,Gf,ei,zs=n(()=>{Ve();QO=t(i=>i instanceof L?-i.value():-i,"negate"),Gf=class extends L{add(e,r=""){super.add(QO(e),r)}set(e,r=""){super.set(QO(e),r)}subtract(e,r=""){super.subtract(QO(e),r)}};t(Gf,"NegativeYield");ei=t(i=>{["add","set","subtract"].forEach(e=>Object.defineProperty(i.prototype,e,Object.getOwnPropertyDescriptor(Gf.prototype,e)||Object.create(null)))},"makeNegative")});var Fm,iG,XO=n(()=>{ll();zs();Fm=class extends Ko{};t(Fm,"PopulationSupportFood");ei(Fm);iG=Fm});var Ns,oG,eR=n(()=>{ll();zs();Ns=class extends Ko{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ns,"UnitSupportFood");ei(Ns);oG=Ns});var Ls,tR,rR=n(()=>{im();zs();Ls=class extends ra{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ls,"UnitSupportProduction");ei(Ls);tR=Ls});var rz,nG,aG=n(()=>{Dn();dn();rr();on();_e();Fl();w();T();XO();gn();eR();rR();rz=t((i=ye,e=pt,r=z)=>[new et(new m(o=>new iG(i.getByCity(o).size()*2))),...[[We,1,Ui,Ht],[We,2,bt,nt,at,ft]].map(([o,a,...s])=>new et(new l(p=>r.getByCity(p).some(u=>u instanceof o)),new l(p=>e.getByPlayer(p.player()).is(...s)),new m(p=>r.getByCity(p).filter(u=>u instanceof o).map(u=>new oG(a,u))))),new et(new l(o=>e.getByPlayer(o.player()).is(Ui,Ht)),new l(o=>{let a=i.getByCity(o);return r.getByCity(o).filter(s=>[St,Y,Le,dr].some(p=>s instanceof p)).length>a.size()}),new m(o=>{let a=i.getByCity(o);return r.getByCity(o).filter(s=>[St,Y,Le,dr].some(p=>s instanceof p)).slice(a.size()).map(s=>new tR(1,s))})),new et(new l(o=>e.getByPlayer(o.player()).is(bt,nt,at,ft)),new m(o=>r.getByCity(o).filter(a=>[St,Y,Le,dr].some(s=>a instanceof s)).map(a=>new tR(1,a))))],"getRules"),nG=rz});var iz,sG,lG=n(()=>{Ll();$n();rr();rt();K();En();$i();I();gi();tc();Pc();Mu();T();om();w();iz=t((i=Ne,e=Qt,r=ye,o=j,a=ae,s=d,p=bn,u=P)=>[...[we,ke].map(y=>new jo(new l(c=>i.getByTile(c.tile()).every(f=>!(f instanceof y))),new m(c=>i.register(new y(c.tile()))))),new jo(new m(y=>e.register(new jl(y,p,s)))),new jo(new m(y=>r.register(new ol(y,s)))),new jo(new m(y=>o.register(y))),new jo(new m(y=>{u.emit("city:created",y)})),new jo(new m(y=>hs(y,a,r)))],"getRules"),sG=iz});var oz,mG,pG=n(()=>{rt();K();gi();_e();Zs();T();En();oz=t((i=Ne,e=j,r=P,o=z)=>[new yr(new m(a=>i.getByTile(a.tile()).filter(s=>s instanceof we).forEach(s=>i.unregister(s)))),new yr(new m(a=>e.unregister(a))),new yr(new m((a,s)=>{r.emit("city:destroyed",a,s)})),new yr(new m(a=>o.getByCity(a).forEach(s=>s.destroy())))],"getRules"),mG=oz});var Bf,Uf,iR=n(()=>{G();Bf=class extends g{};t(Bf,"FoodExhausted");Uf=Bf});var nz,uG,cG=n(()=>{T();iR();nz=t(()=>[new Uf(new m(i=>i.shrink()))],"getRules"),uG=nz});var az,yG,fG=n(()=>{I();w();T();Lg();iR();az=t((i=d)=>[new pp(new l(e=>e.progress().value()>=e.cost().value()),new m(e=>e.grow())),new pp(new l(e=>e.progress().value()<0),new m(e=>{i.process(Uf,e)}))],"getRules"),yG=az});var sz,dG,gG=n(()=>{rr();$i();w();T();bc();om();sz=t((i=ye,e=ae)=>[new In(new m(r=>r.empty())),new In(new m(r=>r.cost().set((r.size()+1)*10,"city-grow"))),new In(new l(r=>r.city().tilesWorked().length<r.size()+1),new m(r=>hs(r.city(),e,i))),new In(new l(r=>r.city().tilesWorked().length>r.size()+1),new m(r=>r.city().tilesWorked().entries().slice(r.size()+1).forEach(o=>r.city().tilesWorked().unregister(o))))],"getRules"),dG=sz});var lz,hG,OG=n(()=>{zg();T();lz=t(()=>[new Oc(new m(i=>10*(i.size()+1)))],"getRules"),hG=lz});var hn,Mf=n(()=>{oa();zs();hn=class extends ia{};t(hn,"Corruption");ei(hn)});var Fo,RG,Df=n(()=>{Ve();Fo=class extends L{};t(Fo,"Happiness");RG=Fo});var Wi,xG,qp=n(()=>{Ve();Wi=class extends L{};t(Wi,"Luxuries");xG=Wi});var Kt,Ef=n(()=>{Ve();Kt=class extends L{};t(Kt,"Research")});var Ue,Ws,Rl=n(()=>{Ve();Ue=class extends L{};t(Ue,"Unhappiness");Ws=Ue});var js=n(()=>{na();Mf();Rc();Hl();Df();qp();XO();Ef();oa();Rl();eR();rR()});var Ff,Yn,km=n(()=>{G();Ff=class extends g{};t(Ff,"CivilDisorder");Yn=Ff});var kf,ko,Sm=n(()=>{G();kf=class extends g{};t(kf,"ProcessYield");ko=kf});var Sf,xl,Yf=n(()=>{G();Sf=class extends g{};t(Sf,"Unsupported");xl=Sf});var mz,vG,bG=n(()=>{$n();rr();na();js();I();_e();km();w();T();Sm();Yf();mz=t((i=Qt,e=ye,r=z,o=d)=>[new ko(new l(a=>a instanceof J),new m((a,s,p)=>{let u=e.getByCity(s),y=new Pn(a);p.forEach(c=>{if(!(c instanceof Ns)||y.value()>=0)return;let f=c.unit();f!==null&&(o.process(xl,s,f,c),y.subtract(c))}),u.add(y),u.check()})),new ko(new l(a=>a instanceof H),new m((a,s,p)=>{let u=i.getByCity(s),y=a.clone();p.filter(f=>f instanceof Ls).sort((f,h)=>(f.unit()?.tile().distanceFrom(s.tile())??0)-(h.unit()?.tile().distanceFrom(s.tile())??0)).forEach(f=>{if(y.value()>=0)return;let h=f.unit();h!==null&&(o.process(xl,s,h,f),y.subtract(f))});let c=s.yields();o.get(Yn).some(f=>f.validate(s,c))||u.add(y),u.check()}))],"getRules"),vG=mz});var pz,CG,TG=n(()=>{rr();$i();w();T();Wg();om();pz=t((i=ye,e=ae)=>[new il(new l(r=>r.size()>0),new m(r=>r.cost().set((r.size()+1)*10,"city-shrink"))),new il(new l(r=>r.size()>0),new l(r=>r.city().tilesWorked().length>r.size()+1),new m(r=>r.city().tilesWorked().entries().slice(r.size()+1).forEach(o=>r.city().tilesWorked().unregister(o)))),new il(new l(r=>r.size()>0),new l(r=>r.city().tilesWorked().length<r.size()+1),new m(r=>hs(r.city(),e,i))),new il(new l(r=>r.size()<=0),new m(r=>r.city().destroy()))],"getRules"),CG=pz});var zf,Re,ur=n(()=>{Ge();xe();zf=class extends F{constructor(){super(k)}getByCity(e){return this.filter(r=>r.city()===e)}};t(zf,"CityImprovementRegistry");Re=new zf});var uz,PG,IG=n(()=>{dn();ur();js();on();T();qn();$O();Za();Nl();Zi();uz=t((i=Re,e=pt)=>[new Ho(new Kn,new m((r,o)=>{let a=e.getByPlayer(r.player()),[s]=i.filter(c=>c instanceof UC&&r.player()===c.city().player()).map(c=>c.city()),p=Ke(o,re),u=a.is(bt)?10:a.is(nt)?0:s?s.tile().distanceFrom(r.tile()):32,[y]=[[Ui,8],[bt,20],[nt,0],[Ht,12],[at,16],[ft,24]].filter(([c])=>a.is(c)).map(([,c])=>c);return new hn(y?Math.min(Math.floor(p*u*3/(10*y)),p):0,u.toFixed(2))})),new Ho(new Fr(0),new m(r=>r.tilesWorked().entries().flatMap(o=>o.yields(r.player()).flatMap(a=>new a.constructor(a.value(),o.id()+": "+a.values().map(([,s])=>s).join("-"))))))],"getRules"),PG=uz});var cz,wG,AG=n(()=>{Fg();$n();rt();Zn();w();T();cz=t((i=Qt,e=j)=>[new ht(new l(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).some(o=>!o.building())),new m(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).filter(o=>!o.building()).map(o=>new Cn(r,o)))),new ht(new l(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).some(o=>!!o.building())),new m(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).filter(o=>!!o.building()).map(o=>new as(r,o))))],"getRules"),wG=cz});var yz,GG,BG=n(()=>{rr();rt();K();dm();w();Ap();T();yz=t((i=j,e=ye,r=P)=>[new qo(new l((o,a,s)=>s instanceof vs&&s.to()===o.tile()&&i.getByTile(s.to())!==null),new m(o=>{let a=i.getByTile(o.tile());e.getByCity(a).shrink()})),new qo(new m((o,a,s)=>r.emit("unit:defeated",o,a,s)))],"getRules"),GG=yz});var fz,UG,MG=n(()=>{T();Yf();fz=t(()=>[new xl(new m((i,e)=>e.destroy()))],"getRules"),UG=fz});var dz={};var DG=n(()=>{eG();rG();aG();lG();pG();cG();fG();gG();OG();bG();TG();IG();I();AG();BG();MG();d.register(...XA(),...tG(),...nG(),...sG(),...mG(),...uG(),...yG(),...dG(),...hG(),...vG(),...CG(),...PG(),...wG(),...GG(),...UG())});var FG=b(EG=>{"use strict";Object.defineProperty(EG,"__esModule",{value:!0});DG()});var vl,kG=n(()=>{Rl();zs();vl=class extends Ws{#e;constructor(e,r){super(e,r.id()),this.#e=r}cityImprovement(){return this.#e}};t(vl,"CityImprovementContent");ei(vl)});var Ym,SG=n(()=>{Df();Ym=class extends RG{};t(Ym,"LuxuryHappiness")});var bl,YG=n(()=>{Rl();zs();bl=class extends Ws{#e;constructor(e,r){super(e,r.id()),this.#e=r}unit(){return this.#e}};t(bl,"MartialLaw");ei(bl)});var Ia,zG=n(()=>{Rl();Ia=class extends Ws{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ia,"MilitaryUnhappiness")});var zm,NG=n(()=>{Rl();zm=class extends Ws{};t(zm,"PopulationUnhappiness")});var Nf=n(()=>{Ef()});var Nm=n(()=>{kG();js();Df();qp();SG();YG();zG();NG();na();Nf();Rl()});var Lf,Wf,oR=n(()=>{G();Lf=class extends g{};t(Lf,"CelebrateLeader");Wf=Lf});var gz,LG,WG=n(()=>{rr();Nm();oR();w();Zi();gz=t((i=ye)=>[new Wf(new l(e=>i.getByCity(e).size()>2),new l((e,r=e.yields())=>{let[o,a]=aa(r,Fo,Ue);return a===0&&Math.floor(o)>=i.getByCity(e).size()/2}))],"getRules"),LG=gz});var hz,jG,HG=n(()=>{Dn();rr();dn();Nm();on();_e();Nl();w();T();hz=t((i=ye,e=pt,r=z)=>[new Ho(new m(o=>new zm(Math.max(i.getByCity(o).size()-5,0)))),...[[ft,1],[nt,2]].map(([o,a])=>new Ho(new l(s=>{try{return e.getByPlayer(s.player()).is(o)}catch{return!1}}),new l(s=>r.getByCity(s).filter(p=>[St,Y,Le].some(u=>p instanceof u)&&p.tile()!==s.tile()).length>0),new m(s=>r.getByCity(s).filter(p=>[St,Y,Le].some(u=>p instanceof u)&&p.tile()!==s.tile()).map(p=>new Ia(a,p)))))],"getRules"),jG=hz});var Oz,_G,KG=n(()=>{Nm();km();w();Zi();Oz=t(()=>[new Yn(new l((i,e=i.yields())=>{let[r,o]=aa(e,Fo,Ue);return o>r}))],"getRules"),_G=Oz});var jf,On,nR=n(()=>{Rg();jf=class extends cu{validate(...e){return!this.criteria().length||this.criteria().some(r=>r.validate(...e))}};t(jf,"Or");On=jf});var Rz,qG,VG=n(()=>{dn();Mi();rr();Nm();ur();on();He();I();_e();Fl();w();T();Dn();Bl();qn();sr();nR();Zi();Rz=t((i=d,e=ye,r=Re,o=pt,a=N,s=z)=>[new et(new l(p=>o.getByPlayer(p.player()).is(Ui,bt,Ht,at)),new m((p,u)=>s.getByTile(p.tile()).filter(y=>y instanceof Y).slice(0,Math.min(4,Ke(u,Ue))).map(y=>new bl(1,y)))),...[[Bt,1],[Bt,1,jt],[Zr,3],[mr,4]].map(([p,u,...y])=>new et(new Xe,new l(c=>r.getByCity(c).some(f=>f instanceof p)),new On(new l(c=>y.length===0),new l(c=>y.every(f=>a.getByPlayer(c.player()).completed(f)))),new l((c,f)=>Ke(f,Ue)>0),new m((c,f)=>new vl(Math.min(u,Ke(f,Ue)),r.getByCity(c).filter(h=>h instanceof p)[0])))),new et(new Qa,new m((p,u)=>new Ym(Math.floor(Ke(u,Wi)/2),Wi.name)))],"getRules"),qG=Rz});var Hf,wa,Vp=n(()=>{G();Hf=class extends g{};t(Hf,"TurnStart");wa=Hf});var xz,JG,$G=n(()=>{rt();K();I();oR();km();T();qn();Vp();xz=t((i=j,e=d,r=P)=>[new wa(new Xe,new m(o=>i.getByPlayer(o).forEach(a=>{e.get(Yn).some(s=>s.validate(a,a.yields()))&&r.emit("city:civil-disorder",a),e.get(Wf).some(s=>s.validate(a,a.yields()))&&r.emit("city:leader-celebration",a)})))],"getRules"),JG=xz});var vz={};var ZG=n(()=>{I();WG();HG();KG();VG();$G();d.register(...LG(),...jG(),..._G(),...qG(),...JG())});var XG=b(QG=>{"use strict";Object.defineProperty(QG,"__esModule",{value:!0});ZG()});var bz={};var eB=n(()=>{Mi();Ll();bn.register(Jr,lr,$r,mr,go,Zr,br,_t,Qr,Ct,Cr,Tr,pr,ho,Tt,dt,Pt,Oo,Ro,Bt,Pr)});var Cz,tB,rB=n(()=>{Mi();sr();op();ur();He();w();T();Cz=t((i=Re,e=N)=>[new Zt(new m((r,o)=>new l(()=>!i.getByCity(r).some(a=>a instanceof o)))),...[[Jr,Lr],[go,Lt],[Zr,Lr],[br,gr],[Qr,cn],[Cr,vr],[pr,Ti],[dt,Lt],[Bt,bi],[lr,vi],[mr,vt],[_t,xt],[Ct,ct],[ho,Wt],[Tr,Vr],[Tt,lo],[Pt,Ai],[Oo,yn],[Ro,yo],[Pr,ar]].map(([r,o])=>new Zt(new l((a,s)=>s===r),new m(a=>new l(()=>e.getByPlayer(a.player()).completed(o))))),...[[lr,pr],[Pr,Cr],[Ct,_t],[Tt,_t],[Pt,_t],[Tr,Ct,Tt,Pt]].map(([r,...o])=>new Zt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByCity(a).some(s=>o.some(p=>s instanceof p)))))),...[[br,dt],[Ct,Tt,Pt],[Tt,Pt,Ct],[Pt,Ct,Tt]].map(([r,...o])=>new Zt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByCity(a).every(s=>!o.some(p=>s instanceof p))))))],"getRules"),tB=Cz});var Tz,iB,oB=n(()=>{Mi();ap();Tz=t(()=>[...[[Jr,120],[$r,40],[go,120],[Zr,100],[br,80],[Qr,60],[Cr,80],[pr,80],[dt,200],[Bt,40],[lr,120],[mr,160],[_t,200],[Ct,240],[ho,160],[Tr,320],[Tt,160],[Pt,160],[Oo,200],[Ro,200],[Pr,160]].flatMap(([i,e])=>Wl(i,e))],"getRules"),iB=Tz});var Pz,nB,aB=n(()=>{ur();$s();T();Mi();Pz=t((i=Re)=>[new cr(new m(e=>{let[r]=i.getByCity(e).filter(o=>o instanceof dt);!r||i.unregister(r)}))],"getRules"),nB=Pz});var ue,aR=n(()=>{Hl();zs();ue=class extends sc{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("cityImprovement")}cityImprovement(){return this.#e}};t(ue,"CityImprovementMaintenanceGold");ei(ue)});var _f=n(()=>{js();aR();Mf();Rc();qp();Nf();oa()});var Iz,sB,lB=n(()=>{Mi();sr();ur();He();_f();Fl();w();T();Iz=t((i=Re,e=N)=>[...[[Jr,ue,2],[lr,ue,3],[mr,ue,3],[go,ue,2],[Zr,ue,2],[br,ue,1],[_t,ue,4],[Qr,ue,1],[Ct,ue,4],[Cr,ue,1],[Tr,ue,6],[pr,ue,1],[ho,ue,4],[Tt,ue,2],[dt,ue,0],[Pt,ue,4],[Oo,ue,2],[Ro,ue,4],[Bt,ue,1],[Pr,ue,3]].map(([r,o,a])=>new et(new l(s=>i.getByCity(s).some(p=>p instanceof r)),new m(s=>{let[p]=i.getByCity(s).filter(u=>u instanceof r);return new o(a,p)}))),...[[$r,ue,0,null,yt],[$r,ue,1,yt,ut],[$r,ue,2,ut,null]].map(([r,o,a,s,p])=>new et(new l(u=>i.getByCity(u).some(y=>y instanceof r)),new l(u=>s===null||e.getByPlayer(u.player()).completed(s)),new l(u=>p===null||!e.getByPlayer(u.player()).completed(p)),new m(u=>{let[y]=i.getByCity(u).filter(c=>c instanceof r);return new o(a,y)})))],"getRules"),sB=Iz});var wz,mB,pB=n(()=>{ur();rt();I();Mu();w();T();Mi();wz=t((i=j,e=Re,r=d)=>[new jo(new l(o=>i.getByPlayer(o.player()).length===0),new m(o=>e.register(new dt(o,r))))],"getRules"),mB=wz});var Az,uB,cB=n(()=>{ur();w();Zs();T();Az=t((i=Re)=>[new yr(new l(e=>i.getByCity(e).length>0),new m(e=>i.getByCity(e).forEach(r=>i.unregister(r))))],"getRules"),uB=Az});var Gz,yB,fB=n(()=>{Mi();ur();w();T();_f();bc();Gz=t((i=Re)=>[new In(new l(e=>!i.getByCity(e.city()).some(r=>r instanceof Jr)),new l(e=>e.size()>10),new m(e=>e.shrink())),new In(new l(e=>i.getByCity(e.city()).some(r=>r instanceof Qr)),new m(e=>e.add(new Pn(e.cost().value()/2))))],"getRules"),yB=Gz});var Bz,dB,gB=n(()=>{ur();K();jg();T();Bz=t((i=Re,e=P)=>[new up(new m(r=>i.register(r))),new up(new m((r,o)=>{e.emit("city-improvement:created",r,o)}))],"getRules"),dB=Bz});var Uz,hB,OB=n(()=>{Mi();ur();_f();w();T();vg();ju();Zi();Uz=t((i=Re)=>[...[[pr,Xt,.5],[pr,Wi,.5],[lr,Xt,.5],[lr,Wi,.5],[Cr,Kt,.5],[Pr,Kt,.5],[_t,H,.5],[Pt,H,.5],[Ct,H,.5],[Tt,H,.5],[Tr,H,.5],[br,hn,.5]].map(([e,r,o])=>new Qs(new NR,new l(a=>i.getByCity(a).some(s=>s instanceof e)),new m((a,s)=>new r(Math.floor(Ke(s,r)*o),e.name))))],"getRules"),hB=Uz});var Mz,RB,xB=n(()=>{ur();la();Mi();Qc();w();T();kp();Mz=t((i=Re,e=or)=>[new Qn(new l(r=>r.city()!==null),new l(r=>i.getByCity(r.city()).some(o=>o instanceof $r)),new m(r=>e.register(new pa(r))))],"getRules"),RB=Mz});var Dz={};var vB=n(()=>{I();rB();oB();aB();lB();pB();cB();fB();gB();OB();xB();d.register(...tB(),...iB(),...nB(),...sB(),...mB(),...uB(),...yB(),...dB(),...hB(),...RB())});var CB=b(bB=>{"use strict";Object.defineProperty(bB,"__esModule",{value:!0});eB();vB()});var PB={};iu(PB,{default:()=>Ez,registerCityNames:()=>TB});var TB,Ez,IB=n(()=>{Et();gt();TB=t((i=$)=>{["Bergen","Cannae","Capua","Cordoba","Cremona","Crete","Cunaxa","Damascus","Dublin","Genoa","Ghent","Issus","Lisbon","Mecca","Melbourne","Milan","Naples","Pisa","Prague","Salamis","Salzburg","Seville","Sidon","Sydney","Tarsus","Toronto","Turin","Tyre","Utica","Venice","Verona"].forEach(e=>i.register(new Q(e,null)))},"registerCityNames"),Ez=TB});var sR=n(()=>{vm();Sp();Yp();zp();Np();Im();Lp();Am();Wp();jp();Hp();_p();Dm();Kp()});var Kf,qf,lR=n(()=>{Ki();Ft();Kf=class extends Ee{constructor(){super(me)}};t(Kf,"CivilizationRegistry");qf=new Kf});var AB={};iu(AB,{default:()=>Fz,registerCivilizations:()=>wB});var wB,Fz,GB=n(()=>{sR();lR();wB=t((i=qf)=>{i.register(ca,ya,fa,da,ga,ha,Oa,Ra,xa,va,ba,Ca,Ta,Pa)},"registerCivilizations"),Fz=wB});var Aa,BB=n(()=>{st();vm();Aa=class extends te{static civilization(){return dl}name(){return"Abraham Lincoln"}};t(Aa,"AbrahamLincoln")});var UB=n(()=>{st();vm()});var MB=n(()=>{BB();UB()});var Ga,DB=n(()=>{st();Sp();Ga=class extends te{static civilization(){return bm}name(){return"Moctezuma II"}};t(Ga,"MoctezumaII")});var EB=n(()=>{DB()});var Ba,FB=n(()=>{st();Yp();Ba=class extends te{static civilization(){return Cm}name(){return"Hammurabi"}};t(Ba,"Hammurabi")});var kB=n(()=>{FB()});var Ua,SB=n(()=>{st();zp();Ua=class extends te{static civilization(){return Tm}name(){return"Mao Zedong"}};t(Ua,"MaoZedong")});var YB=n(()=>{SB()});var Ma,zB=n(()=>{st();Np();Ma=class extends te{static civilization(){return Pm}name(){return"Ramesses II"}};t(Ma,"RamessesII")});var NB=n(()=>{zB()});var Da,LB=n(()=>{st();Im();Da=class extends te{static civilization(){return gl}name(){return"Elizabeth I"}};t(Da,"ElizabethI")});var WB=n(()=>{st();Im()});var jB=n(()=>{LB();WB()});var Ea,HB=n(()=>{st();Lp();Ea=class extends te{static civilization(){return wm}name(){return"Napoleon I"}};t(Ea,"NapoleonI")});var _B=n(()=>{HB()});var Fa,KB=n(()=>{st();Am();Fa=class extends te{static civilization(){return hl}name(){return"Frederick the Great"}};t(Fa,"FrederickTheGreat")});var qB=n(()=>{st();Am()});var VB=n(()=>{KB();qB()});var ka,JB=n(()=>{st();Wp();ka=class extends te{static civilization(){return Gm}name(){return"Alexander the Great"}};t(ka,"AlexanderTheGreat")});var $B=n(()=>{JB()});var Sa,ZB=n(()=>{st();jp();Sa=class extends te{static civilization(){return Bm}name(){return"Mahatma Gandhi"}};t(Sa,"MahatmaGandhi")});var QB=n(()=>{ZB()});var Ya,XB=n(()=>{st();Hp();Ya=class extends te{static civilization(){return Um}name(){return"Genghis Khan"}};t(Ya,"GenghisKhan")});var eU=n(()=>{XB()});var za,tU=n(()=>{st();_p();za=class extends te{static civilization(){return Mm}name(){return"Julius Caesar"}};t(za,"JuliusCaesar")});var rU=n(()=>{tU()});var iU=n(()=>{st();Dm()});var Na,oU=n(()=>{st();Dm();Na=class extends te{static civilization(){return Ol}name(){return"Joseph Stalin"}};t(Na,"JosephStalin")});var nU=n(()=>{iU();oU()});var La,aU=n(()=>{st();Kp();La=class extends te{static civilization(){return Em}name(){return"Shaka"}};t(La,"Shaka")});var sU=n(()=>{aU()});var mR=n(()=>{MB();EB();kB();YB();NB();jB();_B();VB();$B();QB();eU();rU();nU();sU()});var mU={};iu(mU,{default:()=>kz,registerLeaders:()=>lU});var lU,kz,pU=n(()=>{mR();_l();lU=t((i=Tn)=>{i.register(Aa,Ga,Ba,Ua,Ma,Da,Ea,Fa,ka,Sa,Ya,za,Na,La)},"registerLeaders"),kz=lU});var Vf,Lm,Jf=n(()=>{lp();Vf=class extends ls{};t(Vf,"Aggression");Lm=Vf});var $f,Wm,uU=n(()=>{Jf();$f=class extends Lm{constructor(e){super(e,1)}};t($f,"Aggressive");Wm=$f});var Zf,jm,Qf=n(()=>{lp();Zf=class extends ls{};t(Zf,"Militarism");jm=Zf});var Xf,Wa,cU=n(()=>{Qf();Xf=class extends jm{constructor(e){super(e,0)}};t(Xf,"Civilized");Wa=Xf});var ed,Hm,td=n(()=>{lp();ed=class extends ls{};t(ed,"Development");Hm=ed});var rd,_m,yU=n(()=>{td();rd=class extends Hm{constructor(e){super(e,1)}};t(rd,"Expansionist");_m=rd});var id,od,fU=n(()=>{Jf();id=class extends Lm{constructor(e){super(e,0)}};t(id,"Friendly");od=id});var nd,ad,dU=n(()=>{Qf();nd=class extends jm{constructor(e){super(e,1)}};t(nd,"Militaristic");ad=nd});var sd,Cl,gU=n(()=>{Jf();sd=class extends Lm{constructor(e){super(e,.5)}};t(sd,"Normal");Cl=sd});var ld,Km,hU=n(()=>{td();ld=class extends Hm{constructor(e){super(e,.5)}};t(ld,"Normal");Km=ld});var md,pd,OU=n(()=>{Qf();md=class extends jm{constructor(e){super(e,.5)}};t(md,"Normal");pd=md});var ud,Jp,RU=n(()=>{td();ud=class extends Hm{constructor(e){super(e,0)}};t(ud,"Perfectionist");Jp=ud});var vU={};iu(vU,{default:()=>Sz,registerTraits:()=>xU});var xU,Sz,bU=n(()=>{mR();kg();uU();cU();yU();fU();dU();gU();hU();OU();RU();xU=t((i=yc)=>{[[Aa,od,Km,Wa],[Ga,Cl,Jp,Wa],[Ba,od,Jp,Wa],[Ua,Cl,Km,Wa],[Ma,Cl,Km,Wa],[Da,Cl,_m,pd],[Ea,Wm,_m,Wa],[Fa,Wm,Jp,Wa],[ka,Cl,_m,ad],[Sa,od,Jp,pd],[Ya,Wm,_m,ad],[za,Cl,_m,Wa],[Na,Wm,Km,ad],[La,Wm,Km,pd]].forEach(([e,...r])=>r.forEach(o=>i.register(new o(e))))},"registerTraits"),Sz=xU});var TU=b(CU=>{"use strict";Object.defineProperty(CU,"__esModule",{value:!0});var Yz=(IB(),R(PB)),zz=(GB(),R(AB)),Nz=(pU(),R(mU)),Lz=(bU(),R(vU));(0,Yz.default)();(0,zz.default)();(0,Nz.default)();(0,Lz.default)()});var cd,yd,pR=n(()=>{cd=class{#e=[];constructor(...e){this.#e.push(...e)}isBetween(...e){return e.every(r=>this.#e.includes(r))&&e.length===this.#e.length}players(){return this.#e}};t(cd,"Interaction");yd=cd});var fd,PU,IU=n(()=>{xe();pR();fd=class extends F{constructor(){super(yd)}getByPlayer(e){return this.entries().filter(r=>r.players().includes(e))}getByPlayers(...e){return this.entries().filter(r=>r.isBetween(...e))}};t(fd,"InteractionRegistry");PU=new fd});var qm,wU=n(()=>{pR();qm=class extends yd{constructor(...e){let r=e.map(o=>o.player());super(...r)}};t(qm,"Contact")});var AU=n(()=>{wU()});var Wz,GU,BU=n(()=>{IU();_e();AU();w();T();At();Wz=t((i=PU,e=z)=>[new q(new l(r=>r.tile().getNeighbours().some(o=>e.getByTile(o).some(a=>a.player()!==r.player()))),new m(r=>r.tile().getNeighbours().forEach(o=>e.getByTile(o).filter(a=>a.player()!==r.player()).forEach(a=>i.register(new qm(r,a))))))],"getRules"),GU=Wz});var jz={};var UU=n(()=>{I();BU();d.register(...GU())});var DU=b(MU=>{"use strict";Object.defineProperty(MU,"__esModule",{value:!0});UU()});var dd,gd,uR=n(()=>{dd=class{#e;#t;#r;constructor(e,r,o){this.#e=e,this.#t=r,this.#r=o}civilizationType(){return this.#e}mapGenerator(){return this.#t}startTile(){return this.#r}startTileForMap(e){let{x:r,y:o}=this.#r;return e.get(r,o)}};t(dd,"CivilizationStartTile");gd=dd});var Hz,Rn,cR=n(()=>{Hz=t((i,e,r,o)=>{for(;r<0;)r+=e;for(;o<0;)o+=i;return r=r%e,o=o%i,o*e+r},"coordsToIndex"),Rn=Hz});var _z,Tl,hd=n(()=>{_z=t((i,e,r)=>{let o=i*e;for(;r<0;)r+=o;return r=r%o,[r%e,Math.floor(r/e)]},"indexToCoords"),Tl=_z});var Kz,EU,FU=n(()=>{hd();Kz=t((i,e,r,o)=>{let[a,s]=Tl(i,e,r),[p,u]=Tl(i,e,o),y=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[c]=y.map(([f,h])=>[f*e,h*i]).map(([f,h])=>[a-p+f,s-u+h]).map(f=>Math.hypot(...f)).sort((f,h)=>f-h);return c},"distanceFrom"),EU=Kz});var qz,Pl,yR=n(()=>{cR();hd();qz=t((i,e,r,o=!0)=>{let[a,s]=Tl(i,e,r),p=Rn(i,e,a,s-1),u=Rn(i,e,a+1,s-1),y=Rn(i,e,a+1,s),c=Rn(i,e,a+1,s),f=Rn(i,e,a,s+1),h=Rn(i,e,a-1,s+1),U=Rn(i,e,a-1,s),D=Rn(i,e,a-1,s-1);return o?[p,y,f,U]:[p,u,y,c,f,h,U,D]},"getNeighbours"),Pl=qz});var Vm,Od,Rd=n(()=>{cR();FU();yR();hd();Vm=class{#e;#t;#r;constructor(e,r,o={}){this.#e=e,this.#t=o,this.#r=r}coordsToIndex(e,r){return Rn(this.#e,this.#r,e,r)}distanceFrom(e,r){return EU(this.#e,this.#r,e,r)}generate(){throw new Error(`Generator#generate(): Must be overridden in '${this.constructor.name}'.`)}getNeighbours(e,r=!0){return Pl(this.#e,this.#r,e,r)}height(){return this.#e}indexToCoords(e){return Tl(this.#e,this.#r,e)}options(){return this.#t}width(){return this.#r}};t(Vm,"Generator");Od=Vm});var Vz,xd,Jm,vd=n(()=>{hh();Oh();_y();Rd();mm();Rh();xh();vh();bh();Up();Jy();Ch();Th();Vz={A:Pv,D:Iv,F:Hy,G:As,H:wv,J:Av,M:Gv,O:Bv,P:sm,R:Vy,S:Uv,T:Mv},xd=class extends Od{async generate(){return Array.from(`OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOAAAAAAAOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOAAOAOAAAOAAAAAAAAOOOOOOAOOOOOGGOOOOOTAGOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOTTTTAOOOOAAAAAAAAOOOOAAAAAATOOOOOAAOOOOOOOOOOOOOOOAAOOOOOTOOOOOOOOOOOOOOOOOO
OOOTTTTTTTTTAAOAOAAAAAOOOAAAAATOOOOOOOOOOOOOOOAOOOOOFFAAFFFFFOOFFFOOOOFFFOOOOOOO
OTPTGPPPPTTTTTOTAAAOOAOOOAAAATOOOOOOOOOOOOOOOAOOAAOFFGAFFFFFFFAFFFFFFFFFFOTOOOOO
OOOOOPGTPTOOTTAAAAAAAAOOAAGGOOOOOOOOOOGAAOOOOOOGOGFFFGFFFFFFFFAFFAFFFFFGFGGOOOOO
OOOOOGGFGPPTTAAOOOAOTOOOAGOOOOAOOOOOOAFGFPGFOAAFGTGFFFFFFFFFFFFFFFGFFGOGFFOOOOOO
OOOOPMGFPPPPTTOOOATAAOOOOOOOOOOOOOOOGFPGGFOFFFFFFGFFFFFFFFFFFFFFGFFFFGOOFOOOOOOO
OOOOPMGFGPPOTTTAATTTTOOOOOOOOOOHOOOPFGOGGGFFFGFGGGFFFFFFFFFFFFFFFFFFOOOOFGOOOOOO
OOOOPHFFGPGOPPPOPTTTTOOOOOOOOOGROOOOOPOGFGFFGFFFGFGFGGFGGFFFGFFFFFFFGOOOOPOOOOOO
OOOOGGHFGPPPPPPPPPTPPOOOOOOOOOOFOOOFOOOFFFRFFFFRGFPFFPFGPFGFFOFFFFFGPPGOOOOOOOOO
OOOGGGMGGGPPPOPPPPPOPOOOOOOOOOGGOOOGPPFFFGRRFRRRGGFGGGGGPGGFFFFDPPPPPPOOOOOOOOOO
OOOGGFMGRGRPGORRGOPOOOOOOOOOOOOOOGRGGGGFFGFRFRPGPGGGGGPPPPPPPPPPPPPPGPGOOOOOOOOO
OOGGGMMGRGRGGGGOOOOOOOOOOOOOOOOOGGRMMGGGGPGRPRRPPPPPPPPPPPPPPPPPPPPPGPGOPGOOOOOO
OOGGPPHGRRRGGGOOOOOOOOOOOOOOOOOOPGGGGFGRRGPRPDOOPPOPPPDPDDDPPPPPPDPPPGOOGOOOOOOO
OOGFPPFGGRGGGPOOOOOOOOOOOOOOOOPPPPOGHOOGRFOOOHPOGPPDPDPDDPPPPPPDDPPOPGOOMGOOOOOO
OOGPPDDGGRGGOOOOOOOOOOOOOOOOOOPPPOOOGHOOOGPPPPPOPPPPDPPHPDDDDDDPPPGOOOOOOPOOOOOO
OOPOGDDPOOOPOOOOOOOOOOOOOOOOOOOOOOOOOGOOOOOPPPPGPPPPPPHHMHHHHHHHHMHPGOOGOOOOOOOO
OOPOGDDOOOOPOOOOOOOOOOOOOOOOOOGPPDDOOOOOOOOPPRRHPPPDPPHPGHMMMMMHHHPPPGOOOOOOOOOO
OOOOGDGOOOOOOOOOOOOOOOOOOOOOOODPHHPPPGODPOPPPGRRPPPPPHHRDPGMHHMHHPPRRROOOOOOOOOO
OOOOGGPOPOOOGPOOOOOOOOOOOOOOOPPHDDDPPPPDDRGDPPDOPPPPHPRRDGGGHHHHHPGPPPOOOOOOOOOO
OOOOOGGPGOOOOGPOOOOOOOOOOOOOPPDDDDDPDDDDDRDOPDDOOOOHHRRDPGGRGGGHGPGGPOOOOOOOOOOO
OOOOOOOOGGOOOOOOOOOOOOOOOOOOPDDDDDDDDDDDSRSODDDDDDOOOOPPGGGRRPPGFGGGOOOGOOOOOOOO
OOOOOOOOOGOOOOOOOOOOOOOOOOOPDDDDDDPPPDDDDRDOOPDDDDPOOOOGGGGGOOGGGGGOOOOPGOOOOOOO
OOOOOOOOOPPOGPPGOOOOOOOOOOODDDDDDDPDDDDDDRDDOODDDDOOOOOOGGGOOOPPGGOOOOOGGOOOOOOO
OOOOOOOOOOPGFPPPGOOOOOOOOOODDDDDDDDPDPDPPDHHDOOPDOOOOOOOGGOOOOOGGGGOOOOOFGOOOOOO
OOOOOOOOOOOGHGGGGGGOOOOOOOOPPDPPPPDDDPPPPPPMDPOOGOOOOOOOPGOOOOOOOGGOOOOOOGOOOOOO
OOOOOOOOOOOHJJJGGGGROOOOOOOOPPDPPPPPPPPPPPPHMDPOOOOOOOOOOGOOOOOOOOOOOPOOOOOOOOOO
OOOOOOOOOOGHJRRJJRRRGOOOOOOOOPPPGOPPGPGGGGGGMDDPOOOOOOOOOOOOOOOOOOOGPPOOGPOOOOOO
OOOOOOOOOOPGJJRRRRJGFGGOOOOOOOOOOOOGGGGJJJGGODPPOOOOOOOOOOOOOOOGFGOOPGFGGGOGOOOO
OOOOOOOOOOOFGGJJGJJFGGGPOOOOOOOOOOOGGJJRRRGGHPPOOOOOOOOOOOOOOOOOGFOOGOPGOOOPGGOO
OOOOOOOOOOOGHGGGGGGGGGGOOOOOOOOOOOOGGRRRJJHOGGOOOOOOOOOOOOOOOOOOOGOOOOOOOOOOOGGO
OOOOOOOOOOOOGMFGGGGGGPOOOOOOOOOOOOOOGRJJJGHMGOOOOOOOOOOOOOOOOOOOOPPOOOOOGOOOOOOO
OOOOOOOOOOOOGFMGGFGPPPOOOOOOOOOOOOOORRGGGGGMPOOOOOOOOOOOOOOOOOOOOOGOOOOOOOPGOOOO
OOOOOOOOOOOOOOHMGGRPGGOOOOOOOOOOOOOOOGGGGGGHGOOOOOOOOOOOOOOOOOOOOOOOOOOGGPGPGGOO
OOOOOOOOOOOOOOGHGGRGGOOOOOOOOOOOOOOOODPPGGGGGGOOOOOOOOOOOOOOOOOOOOOOOOOGGPPPPGOO
OOOOOOOOOOOOOOGMGPRROOOOOOOOOOOOOOOOPPPPPPPGGGOPOOOOOOOOOOOOOOOOOOOOGGPPPDDDPPPO
OOOOOOOOOOOOOOGMGGGPOOOOOOOOOOOOOOOOHPDDPPGGOOOPOOOOOOOOOOOOOOOOOOOGGGPDDDDDDPFO
OOOOOOOOOOOOOOPMGGGOOOOOOOOOOOOOOOOOOPPDPPGGOOOGOOOOOOOOOOOOOOOOOOOGPDDDDDDDDPPO
OOOOOOOOOOOOOOOMGPOOOOOOOOOOOOOOOOOOOHPPPGGGOOGPOOOOOOOOOOOOOOOOOOOGDDDDDPDDDPGO
OOOOOOOOOOOOOOOGGOOOOOOOOOOOOOOOOOOOOHPPGHGOOOPOOOOOOOOOOOOOOOOOOOODDDDDDDPDDHFO
OOOOOOOOOOOOOOOPGOOOOOOOOOOOOOOOOOOOOODPGHGOOOOOOOOOOOOOOOOOOOOOOOODDDOOGDDDHGOO
OOOOOOOOOOOOOOOOGOOOOOOOOOOOOOOOOOOOOOPGGGOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOGHHHGOOO
OOOOOOOOOOOOOOOOFOOOOOOOOOOOOOOOOOOOOOGOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOPGOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
`.replace(/\n/g,"")).map(e=>new Vz[e])}height(){return 50}width(){return 80}};t(xd,"Earth");Jm=xd});var bd,kU,SU=n(()=>{uR();vd();bd=class extends gd{constructor(e,r){super(e,Jm,r)}};t(bd,"EarthStartTile");kU=bd});var $p,tTe,YU,zU=n(()=>{uR();xe();$p=class extends Al{constructor(){super(gd)}getByCivilization(e){let[r]=this.getBy("civilizationType",e);if(!r)throw new TypeError(`${e.name} does not have a registered start tile.`);return r}getStartTileByCivilizationAndWorld(e,r){return this.getByCivilization(e).startTileForMap(r)}};t($p,"CivilizationStartTileRegistry");tTe=new $p,YU=$p});var Cd,Td,fR=n(()=>{zU();vd();Cd=class extends YU{entries(){return super.entries().filter(e=>e.mapGenerator()===Jm)}};t(Cd,"EarthStartTileRegistry");Td=new Cd});var Jz={};var NU=n(()=>{sR();SU();fR();Td.register(...[[ca,{x:12,y:18}],[ya,{x:5,y:23}],[fa,{x:45,y:22}],[da,{x:66,y:19}],[ga,{x:41,y:24}],[ha,{x:31,y:14}],[Oa,{x:33,y:16}],[Ra,{x:38,y:15}],[xa,{x:39,y:18}],[va,{x:57,y:26}],[ba,{x:49,y:19}],[Ca,{x:36,y:19}],[Ta,{x:44,y:12}],[Pa,{x:42,y:42}]].map(([i,e])=>new kU(i,e)))});var WU=b(LU=>{"use strict";Object.defineProperty(LU,"__esModule",{value:!0});NU()});var $z,jU,HU=n(()=>{w();T();oh();$z=t(()=>[new gs(new l(i=>i<252),new m(i=>i*20-4020)),new gs(new l(i=>i>251),new l(i=>i<302),new m(i=>(i-151)*10+1e3)),new gs(new l(i=>i>301),new l(i=>i<352),new m(i=>(i-201)*5+1500)),new gs(new l(i=>i>351),new l(i=>i<402),new m(i=>(i-251)*2+1750)),new gs(new l(i=>i>401),new m(i=>i-301+1850))],"getRules"),jU=$z});var Zz={};var _U=n(()=>{I();HU();d.register(...jU())});var qU=b(KU=>{"use strict";Object.defineProperty(KU,"__esModule",{value:!0});_U()});var Qz,VU,JU=n(()=>{Eg();rt();to();He();Ah();w();T();ll();im();oa();Qz=t((i=N,e=j)=>[new yl(new l((r,o)=>i.getByPlayer(o.player()).available().length>0),new m((r,o)=>new ts(r,o))),new yl(new l(r=>[fe,ie,ee].some(o=>r.tile().terrain()instanceof o)),new l((r,o)=>r.tile().getSurroundingArea().score(null,[[Ko,8],[ra,3],[ia,1]])>=150),new l(r=>r.tile().getSurroundingArea(4).every(o=>e.getByTile(o)===null)),new m((r,o)=>new rs(r,o))),new yl(new m((r,o)=>new os(r,o))),new yl(new m((r,o)=>new ns(r,o)))],"getRules"),VU=Qz});var Xz,$U,ZU=n(()=>{K();Gh();T();Xz=t((i=P)=>[new sf(new m((e,r)=>{i.emit("goody-hut:action-performed",e,r)}))],"getRules"),$U=Xz});var eN,QU,XU=n(()=>{K();ks();Bh();T();eN=t((i=kr,e=P,r=()=>Math.random())=>[new Om(new m(o=>i.unregister(o))),new Om(new m((o,a)=>{let s=o.actions(a),p=s[Math.floor(s.length*r())];o.action(p)})),new Om(new m((o,a)=>{e.emit("goody-hut:discovered",o,a)}))],"getRules"),QU=eN});var Pd,$m,dR=n(()=>{G();Pd=class extends g{};t(Pd,"Distribution");$m=Pd});var tN,eM,tM=n(()=>{ks();w();dR();tN=t((i=kr,e=()=>Math.random())=>[new $m(new l(r=>r.isLand())),new $m(new l(r=>r.getSurroundingArea(3).every(o=>i.getByTile(o)===null))),new $m(new l(()=>e()<.05))],"getRules"),eM=tN});var rN,rM,iM=n(()=>{ks();gn();I();T();Dg();rN=t((i=kr,e=()=>Math.random(),r=d)=>[new mc(new m((o,a)=>{let s=[Ir,wr],p=s[Math.floor(s.length*e())];return new p(null,a.player(),a.tile(),r)}))],"getRules"),rM=rN});var iN,oM,nM=n(()=>{ks();w();T();At();iN=t((i=kr)=>[new q(new l(e=>i.getByTile(e.tile())!==null),new m(e=>{i.getByTile(e.tile()).process(e)}))],"getRules"),oM=iN});var Id,Hs,wd=n(()=>{G();Id=class extends g{};t(Id,"Built");Hs=Id});var oN,aM,sM=n(()=>{ks();I();wd();T();Uh();dR();oN=t((i=kr,e=d)=>[new Hs(new m(r=>{let o=e.get($m);r.forEach(a=>{o.every(s=>s.validate(a))&&i.register(new pf(a))})}))],"getRules"),aM=oN});var nN={};var lM=n(()=>{JU();ZU();XU();tM();iM();I();nM();sM();d.register(...VU(),...$U(),...QU(),...eM(),...rM(),...oM(),...aM())});var pM=b(mM=>{"use strict";Object.defineProperty(mM,"__esModule",{value:!0});lM()});var aN={};var uM=n(()=>{dn();hf();Rm.register(bt,nt,Ht,at,ft)});var sN,cM,yM=n(()=>{on();dn();w();T();Vg();Zn();sN=t((i=pt)=>[new ht(new l(e=>!i.getByPlayer(e).is(Ui)),new m(e=>[new cs(e,i.getByPlayer(e))]))],"getRules"),cM=sN});var lN,fM,dM=n(()=>{hf();on();I();al();dn();T();Bl();Fh();lN=t((i=Rm,e=pt,r=d)=>[new li(new Qa,new m(o=>{let a=new vf(o,i,r);a.set(new Ht),e.register(a)}))],"getRules"),fM=lN});var mN,gM,hM=n(()=>{sr();dn();He();Dh();w();mN=t((i=N)=>[new Ep(new l(e=>e===Ht)),...[[bt,Rt],[nt,ao],[at,Hr],[ft,Gi]].map(([e,r])=>new Ep(new l(o=>o===e),new l((o,a)=>i.getByPlayer(a).completed(r))))],"getRules"),gM=mN});var pN,OM,RM=n(()=>{K();$i();Eh();w();T();pN=t((i=P,e=ae)=>[new Fp(new m((r,o)=>{i.emit("player:government:changed",r,o)})),new Fp(new l(r=>{try{return e.getByPlayer(r),!0}catch(o){if(o instanceof TypeError&&o.message.match(/Wrong number of player worlds exist/))return!1;throw o}}),new m(r=>{e.getByPlayer(r).entries().forEach(a=>a.tile().clearYieldCache(r))}))],"getRules"),OM=pN});var uN={};var xM=n(()=>{I();yM();dM();hM();RM();d.register(...cM(),...fM(),...gM(),...OM())});var bM=b(vM=>{"use strict";Object.defineProperty(vM,"__esModule",{value:!0});uM();xM()});var Ad,CM,TM=n(()=>{G();Ad=class extends g{};t(Ad,"TurnEnd");CM=Ad});var cN,PM,IM=n(()=>{Ip();K();I();TM();cN=t((i=ta,e=d,r=P)=>[["player:turn-end",o=>{i.unregister(o),e.process(CM,o);let[a]=i.entries();if(!a){r.emit("turn:end");return}r.emit("player:turn-start",a)}]],"getEvents"),PM=cN});var yN,wM,AM=n(()=>{fl();K();I();Vp();yN=t((i=Eo,e=P,r=d)=>[["player:turn-start",o=>{r.process(wa,o),i.getByPlayer(o).takeTurn().catch(s=>console.error(s)).finally(()=>{e.emit("player:turn-end",o)})}]],"getEvents"),wM=yN});var fN,GM,BM=n(()=>{Ip();K();ds();fN=t((i=ui,e=ta,r=P)=>[["turn:start",()=>{e.register(...i.entries());let[o]=e.entries();r.emit("player:turn-start",o)}]],"getEvents"),GM=fN});var dN={};var UM=n(()=>{K();IM();AM();BM();[...PM(),...wM(),...GM()].forEach(([i,e])=>P.on(i,e))});var Gd,zn,Zp=n(()=>{G();Gd=class extends g{};t(Gd,"Defeated");zn=Gd});var gN,MM,DM=n(()=>{rt();I();$s();w();Zp();T();gN=t((i=j,e=d)=>[new cr(new l((r,o,a)=>i.getByPlayer(a).filter(s=>s!==r).length===0),new m((r,o,a)=>{e.process(zn,a,o)}))],"getRules"),MM=gN});var hN,EM,FM=n(()=>{rt();I();w();Zp();Zs();T();hN=t((i=j,e=d)=>[new yr(new l((r,o)=>i.getByPlayer(r.player()).filter(a=>a!==r).length===0),new m((r,o)=>e.process(zn,r.player(),o)))],"getRules"),EM=hN});var gR,ON,kM,SM=n(()=>{Zn();w();T();Ec();Za();gR=new ht(new Fr(9001),new l(i=>{gR.disable();let e=i.mandatoryActions();return gR.enable(),e.length===0}),new m(i=>[new Dc(i,null)])),ON=t(()=>[gR],"getRules"),kM=ON});var RN,YM,zM=n(()=>{K();al();T();RN=t((i=P)=>[new li(new m(e=>{i.emit("player:added",e)}))],"getRules"),YM=RN});var xN,NM,LM=n(()=>{Ip();K();ds();w();Zp();T();xN=t((i=ta,e=ui,r=P)=>[new zn(new l(o=>i.includes(o)),new m(o=>i.unregister(o))),new zn(new l(o=>e.includes(o)),new m(o=>e.unregister(o))),new zn(new m((o,a)=>{r.emit("player:defeated",o,a)}))],"getRules"),NM=xN});var Bd,Ud,hR=n(()=>{G();Bd=class extends g{};t(Bd,"Spawn");Ud=Bd});var vN,WM,jM=n(()=>{I();T();ZO();hR();vN=t((i=d)=>[new Ud(new m((e,r)=>{new oT(null,e,r,i)}))],"getRules"),WM=vN});var bN,HM,_M=n(()=>{rt();I();_e();T();ll();Bl();Sm();im();oa();Vp();Zi();bN=t((i=d,e=j,r=z)=>[new wa(new Qa,new m(o=>{e.getByPlayer(o).forEach(a=>{let s=a.yields();aa(s,Ko,ra,ia).reduce((p,u,y)=>(p[y].set(u,"Consolidated"),p),[new Ko(0,"Consolidated"),new ra(0,"Consolidated"),new ia(0,"Consolidated")]).forEach(p=>i.process(ko,p,a,s))})})),new wa(new m(o=>r.getByPlayer(o).forEach(a=>{a.moves().set(a.movement());let s=a.busy();if(!s){a.setActive(),a.setWaiting(!1);return}!s.validate()||s.process()})))],"getRules"),HM=bN});var CN,KM,qM=n(()=>{K();T();qg();CN=t((i=P)=>[new jc(new m((e,r)=>{i.emit("player:visibility-changed",e,r)}))],"getRules"),KM=CN});var TN,VM,JM=n(()=>{ds();$i();Ty();T();TN=t((i=ui,e=ae)=>[new sa(new m(r=>{r.clearYieldCache(null),i.forEach(o=>{e.getByPlayer(o).getByTile(r)!==null&&r.clearYieldCache(o)})}))],"getRules"),VM=TN});var PN,$M,ZM=n(()=>{rt();I();w();Zp();ey();T();PN=t((i=j,e=d)=>[new Xn(new l((r,o)=>i.getByPlayer(r.player()).length===0),new m((r,o)=>e.process(zn,r.player(),o)))],"getRules"),$M=PN});var IN,QM,XM=n(()=>{$i();T();Xg();IN=t((i=ae)=>[new ry(new m((e,r)=>{e.clearYieldCache(r);let o=i.getByPlayer(r);o.register(e),o.getByTile(e).update()}))],"getRules"),QM=IN});var Md,Dd,OR=n(()=>{G();Md=class extends g{};t(Md,"PickStartTile");Dd=Md});var wN,eD,tD=n(()=>{lR();fl();K();ds();$i();I();wd();T();ll();mm();OR();Up();_c();im();Jy();oa();hR();wN=t((i=qf,e=Eo,r=P,o=ui,a=ae,s=d,p=()=>Math.random())=>[new Hs(new m(u=>o.entries().forEach(y=>a.register(new Vl(y,u))))),new Hs(new m(u=>{let y=new Map,c=new Map,f=t((A,E=null)=>(y.has(A)||y.set(A,A.score(E,[[Ko,8],[ra,3],[ia,1]])),y.get(A)),"tileScore"),h=t((A,E=null)=>(c.has(A)||c.set(A,A.getSurroundingArea().entries().reduce((V,se)=>V+f(se,E),0)),c.get(A)),"areaScore");r.emit("world:generate-start-tiles");let U=[],D=u.entries().filter(A=>[As,sm,Vy].some(E=>A.terrain()instanceof E)).map(A=>({tile:A,score:h(A)})).sort(({score:A},{score:E})=>E-A).map(({tile:A})=>A);r.emit("world:start-tiles",D),e.entries().reduce((A,E)=>A.then(async()=>{let V=E.player();await E.chooseCivilization(i.entries()),i.unregister(V.civilization().sourceClass());let[se]=s.process(Dd,u,V,U);if(!se)throw new TypeError("Not enough `startingSquare`s.");U.push(se),s.process(Ud,V,se)}),Promise.resolve()).then(()=>r.emit("game:start"))})),new Hs(new m(u=>{r.emit("world:built",u)}))],"getRules"),eD=wN});var AN={};var rD=n(()=>{DM();FM();I();SM();zM();LM();jM();_M();qM();JM();ZM();XM();tD();d.register(...MM(),...EM(),...kM(),...YM(),...NM(),...WM(),...HM(),...KM(),...VM(),...$M(),...QM(),...eD())});var oD=b(iD=>{"use strict";Object.defineProperty(iD,"__esModule",{value:!0});UM();rD()});var GN={};var nD=n(()=>{sr();B();O.register(Ri,ro,xi,Fn,ut,vi,io,Yr,bi,nn,oo,gr,zr,Rt,Ci,Nr,Lr,no,Ti,ao,hr,ct,an,sn,kn,so,ua,ln,yt,mn,xt,Or,Pi,pn,Rr,Nt,Wr,Lt,Wt,xr,Ii,jr,Hr,jt,nr,_r,lo,Kr,wi,un,cn,qr,yn,Ai,vt,Vr,mo,po,uo,co,yo,Gi,fn,fo,Bi,ar,vr)});var aD=n(()=>{Yg()});var BN,sD,lD=n(()=>{He();Zn();aD();w();T();BN=t((i=N)=>[new ht(new l(e=>i.getByPlayer(e).researching()===null),new l(e=>i.getByPlayer(e).available().length>0),new m(e=>[new rl(e,i.getByPlayer(e))]))],"getRules"),sD=BN});var UN,mD,pD=n(()=>{B();He();I();al();T();wu();UN=t((i=O,e=N,r=d,o=()=>Math.random())=>[new li(new m(a=>e.register(new Ml(a,i,r)))),new li(new m(a=>{let s=e.getByPlayer(a);for(let p=0,u=Math.min(s.available().length,Math.floor(4*o()));p<u;p++){let y=s.available();s.addAdvance(y[Math.floor(o()*y.length)])}}))],"getRules"),mD=UN});var MN,uD,cD=n(()=>{He();$s();T();w();MN=t((i=N,e=()=>Math.random())=>[new cr(new l((r,o,a)=>i.getByPlayer(a).complete().some(s=>!i.getByPlayer(o).completed(s.constructor))),new m((r,o,a)=>{let s=i.getByPlayer(o),p=i.getByPlayer(a).complete().filter(u=>!s.completed(u.constructor));s.addAdvance(p.map(u=>u.constructor)[Math.floor(e()*p.length)])}))],"getRules"),uD=MN});var DN,yD,fD=n(()=>{K();Ru();T();DN=t((i=P)=>[new Xa(new m((e,r)=>{i.emit("player:research-complete",e,r)}))],"getRules"),yD=DN});var EN,dD,gD=n(()=>{bg();T();EN=t(()=>[new vu(new m((i,e)=>(e.complete().length+1)*(6+2*0)))],"getRules"),dD=EN});var FN,hD,OD=n(()=>{km();He();I();w();T();Sm();Nf();FN=t((i=N,e=d)=>[new ko(new l(r=>r instanceof Kt),new l((r,o,a)=>!e.get(Yn).some(s=>s.validate(o,a))),new m((r,o)=>i.getByPlayer(o.player()).add(r)))],"getRules"),hD=FN});var kN,RD,xD=n(()=>{sr();w();T();Cg();kN=t(()=>[...[[Ri,so,hr],[xi,xr,jt],[Fn,fo,wi],[ut,zr,co],[vi,Gi,Bi],[io,Lr,Pi],[nn,ar,Ii],[oo,kn,mn],[gr,ro],[zr,Ai,sn],[Rt,Kr,xt],[Ci,ct,xr],[Nr,sn,Gi],[Lr,Ti,Lt],[no,vi,xt],[Ti,Yr],[ao,Kr,Rr],[hr,jr,Nt],[ct,an,hr],[an,Lr,fn],[sn,yt,nn],[kn,Lt,Hr],[so,zr,wi],[ua,lo,yo],[ln,no,Ii],[yt,Or,Pi],[xt,qr,vi],[Or,an,Rr],[Pi,Yr],[pn,Wt,Rt],[Rr,gr,vr],[Nt,nr,wi],[Wr,ro],[Wt,no,ut],[xr,ro,Lt],[Ii,Kr,Bi],[jr,yt,ar],[Hr,gr,jt],[jt,bi],[nr,xi,Wr],[_r,Wt,Fn],[lo,_r,ct],[Kr,jt,Rr],[wi,nr,xr],[un,Ai,po],[qr,io,uo],[yn,ao,Wt],[Ai,no,nn],[vt,Kr,vr],[Vr,Ci,un],[mo,ct,Ri],[po,Ci,mo],[uo,Or,wi],[co,jr,xt],[yo,Wt,un],[Gi,gr,Rr],[fo,xi,ar],[Bi,gr,Ti],[ar,Kr,xr],[vr,ro]].map(([i,...e])=>new Cu(new l(r=>r===i),new m((r,o)=>e.every(a=>o.some(s=>s instanceof a)))))],"getRules"),RD=kN});var SN,vD,bD=n(()=>{K();T();Tg();SN=t((i=P)=>[new Pu(new m((e,r)=>{i.emit("player:research",e,r)}))],"getRules"),vD=SN});var YN={};var CD=n(()=>{lD();pD();cD();fD();gD();I();OD();xD();bD();d.register(...sD(),...mD(),...uD(),...yD(),...dD(),...hD(),...RD(),...vD())});var PD=b(TD=>{"use strict";Object.defineProperty(TD,"__esModule",{value:!0});nD();CD()});var Ed,_s,Qp=n(()=>{Ve();Ed=class extends L{};t(Ed,"TradeRate");_s=Ed});var ja,ID=n(()=>{qp();Qp();ja=class extends _s{};t(ja,"Luxuries"),ja.tradeYield=xG});var Ha,wD=n(()=>{Ef();Qp();Ha=class extends _s{};t(Ha,"Research"),Ha.tradeYield=Kt});var _a,AD=n(()=>{Hl();Qp();_a=class extends _s{};t(_a,"Tax"),_a.tradeYield=sc});var RR=n(()=>{ID();wD();AD()});var Fd,Ks,Xp=n(()=>{Ki();Qp();Fd=class extends Ee{constructor(){super(_s)}};t(Fd,"AvailableTradeRateRegistry");Ks=new Fd});var zN={};var GD=n(()=>{RR();Xp();Ks.register(ja,Ha,_a)});var BD=n(()=>{Mf();oa()});var kd,Sd,xR=n(()=>{Z();kd=class extends Ye{#e=100;#t;#r=[];constructor(e,...r){super(),this.#t=e,this.#r=r,this.addKey("all")}all(){return[...this.#r]}balance(e){if(this.total()===1)return;let r=1-e.value(),o=this.#r.filter(s=>s!==e),a=o.reduce((s,p)=>s+p.value(),0);o.forEach(s=>s.set(s.value()/a*r)),this.total()<1&&o[Math.floor(o.length*Math.random())].add(1-this.total()),this.total()>1&&o[Math.floor(o.length*Math.random())].subtract(1-this.total())}get(e){let[r]=this.#r.filter(o=>o instanceof e);return r}player(){return this.#t}set(e,r){let o=this.get(e);o.set(r),this.balance(o)}setAll(e){if(e.reduce((r,[,o])=>r+o,0)!==1)throw new TypeError("Invalid rates provided, must sum to 1.");e.forEach(([r,o])=>this.get(r).set(o))}total(){return Math.round(this.#r.reduce((e,r)=>e+r.value(),0)*this.#e)/this.#e}};t(kd,"PlayerTradeRates");Sd=kd});var Yd,qs,eu=n(()=>{xe();xR();Yd=class extends F{constructor(){super(Sd)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTradeRates for player");return r[0]}};t(Yd,"PlayerTradeRatesRegistry");qs=new Yd});var NN,UD,MD=n(()=>{Xp();BD();eu();T();Nl();Zi();NN=t((i=Ks,e=qs)=>[new zl(new m((r,o)=>{let a=e.getByPlayer(r.player()),s=Math.max(0,Ke(o,re)),p=s;return i.entries().map(u=>{let y=u.tradeYield,c=Math.min(Math.ceil(s*a.get(u).value()),p);return p-=c,new y(c,u.name)})}))],"getRules"),UD=NN});var LN,DD,ED=n(()=>{eu();Zn();Sg();T();LN=t((i=qs)=>[new ht(new m(e=>[new ms(e,i.getByPlayer(e))]))],"getRules"),DD=LN});var WN,FD,kD=n(()=>{Xp();eu();RR();al();T();xR();WN=t((i=Ks,e=qs)=>[new li(new m(r=>{let o=[new _a(.5),new Ha(.5),new ja(0)],a=i.entries(),s=new Sd(r,...a.map(p=>{let[u]=o.filter(y=>y instanceof p);return new p(u||0)}));e.register(s)}))],"getRules"),FD=WN});var zd,jN,SD,YD=n(()=>{Xp();rt();I();T();Bl();Sm();Vp();Zi();zd=[],jN=t((i=d,e=j,r=Ks)=>[new wa(new Qa,new m(o=>{zd.length===0&&r.entries().forEach(a=>zd.push(a.tradeYield)),e.getByPlayer(o).forEach(a=>{let s=a.yields();aa(s,...zd).reduce((p,u,y)=>(p[y].set(u,"Consolidated"),p),zd.map(p=>new p)).forEach(p=>i.process(ko,p,a,s))})}))],"getRules"),SD=jN});var HN={};var zD=n(()=>{I();MD();ED();kD();YD();d.register(...UD(),...DD(),...FD(),...SD())});var LD=b(ND=>{"use strict";Object.defineProperty(ND,"__esModule",{value:!0});GD();zD()});var _N,WD,jD=n(()=>{Ge();w();T();Ug();ea();_N=t(()=>[new el(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(Pe,i.building().item())),new l(i=>i.progress().value()===0),new m((i,e)=>{let r=i.remaining()/10;return e.add(Math.floor((r+4)*10*r)),e})),new el(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(Pe,i.building().item())),new l(i=>i.progress().value()>0),new m((i,e)=>{let r=i.remaining()/10;return e.add(Math.floor(5*r**2+20*r)),e})),new el(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(k,i.building().item())),new l(i=>i.progress().value()===0),new m((i,e)=>(e.add(i.remaining()*4),e))),new el(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(k,i.building().item())),new l(i=>i.progress().value()>0),new m((i,e)=>(e.add(i.remaining()*2),e)))],"getRules"),WD=_N});var KN,HD,_D=n(()=>{rt();Zn();Hg();T();KN=t((i=j)=>[new ht(new m(e=>i.getByPlayer(e).map(r=>new ps(e,r))))],"getRules"),HD=KN});var qN,KD,qD=n(()=>{tl();al();T();Mg();qN=t((i=si)=>[new li(new m(e=>i.register(new nc(e))))],"getRules"),KD=qN});var VD=n(()=>{aR();Hl()});var Nd,Ld,vR=n(()=>{G();Nd=class extends g{};t(Nd,"Updated");Ld=Nd});var VN,JD,$D=n(()=>{VD();ur();K();tl();I();Bg();km();w();T();Sm();vR();VN=t((i=si,e=d,r=Re,o=P)=>[new ko(new l(a=>a instanceof Xt),new m((a,s,p)=>{let u=i.getByPlayer(s.player());p.forEach(y=>{if(y instanceof ue){if(u.value()<y.value()){let c=y.cityImprovement(),f=new Zu(c.constructor,s,e);r.unregister(c),u.add(f.cost().value()),o.emit("city:unsupported-improvement",s,c);return}u.subtract(y.value(),s.name())}})})),new ko(new l(a=>a instanceof Xt),new l((a,s,p)=>!e.get(Yn).some(u=>u.validate(s,p))),new m((a,s)=>{let p=i.getByPlayer(s.player());p.add(a,s.name()),e.process(Ld,p,s)}))],"getRules"),JD=VN});var JN,ZD,QD=n(()=>{K();w();T();vR();JN=t((i=P)=>[new Ld(new l(e=>e.value()<0),new m((e,r)=>{i.emit("player:treasury-exhausted",e.player(),e,r)}))],"getRules"),ZD=JN});var $N={};var XD=n(()=>{I();jD();_D();qD();$D();QD();d.register(...WD(),...HD(),...KD(),...JD(),...ZD())});var tE=b(eE=>{"use strict";Object.defineProperty(eE,"__esModule",{value:!0});XD()});var ZN={};var rE=n(()=>{gn();Ll();bn.register(xo,vo,bo,Di,Co,To,Ei,Fi,Po,Io,Xr,ki,Ir,Si,Yi,wo,zi,Ao,Go,Ni,We,Li,Bo,wr,Uo,Mo,Ar,Do)});var Wd,Zm,bR=n(()=>{G();Wd=class extends g{};t(Wd,"Available");Zm=Wd});var jd,iE,CR,QN,oE,nE=n(()=>{Zg();Dn();dm();gt();rt();to();En();$t();I();Jo();gi();hm();ci();_e();la();xg();bR();w();T();nR();gn();jd=new l((i,e,r=i.tile())=>i instanceof ot),iE=new l((i,e,r=i.tile())=>i instanceof Le),CR=t((i,e)=>e.getByTile(i)!==null,"tileHasCity"),QN=t((i=$,e=j,r=d,o=Ne,a=or,s=z,p=lt,u=Un,y=Be)=>[new Ot(Xl,pi,new On(new $a(jd,new l((c,f,h=c.tile())=>h.isLand()),new l((c,f)=>f.isLand()),new l((c,f)=>s.getByTile(f).every(h=>h.player()===c.player()))),new $a(iE,new On(new l((c,f,h=c.tile())=>h.isWater()),new l((c,f,h=c.tile())=>e.getByTile(h)?.player()===c.player())),new On(new l((c,f)=>f.isWater()),new l((c,f)=>e.getByTile(f)?.player()===c.player()))),new l(c=>c instanceof St)),new On(new l((c,f)=>!(c instanceof ot)),new l((c,f,h=c.tile())=>!(h.getNeighbours().some(U=>s.getByTile(U).some(D=>D instanceof ot&&D.tile().terrain()instanceof W&&D.player()!==c.player()))&&f.getNeighbours().some(U=>s.getByTile(U).some(D=>D instanceof ot&&D.tile().terrain()instanceof W&&D.player()!==c.player())))),new l((c,f)=>s.getByTile(f).filter(h=>h.player()===c.player()).length>0),new l((c,f)=>{let h=e.getByTile(f);return h===null?!1:h.player()===c.player()})),new l((c,f)=>{let h=e.getByTile(f);return h===null?!0:h.player()===c.player()}),new l((c,f)=>!s.getByTile(f).some(h=>h.player()!==c.player())),new m((c,f,h=c.tile())=>new kt(h,f,c,r))),new Ot(Xl,pi,new On(new l(c=>c instanceof St),new $a(jd,new l((c,f)=>f.isLand())),new $a(iE,new On(new l((c,f)=>f.isWater()),new $a(new l((c,f)=>s.getByTile(f).some(h=>h.player()!==c.player())))))),new l((c,f)=>s.getByTile(f).some(h=>h.player()!==c.player())),new m((c,f,h=c.tile())=>new vs(h,f,c,r,s))),new Ot(Xl,pi,jd,new l((c,f)=>CR(f,e)),new l((c,f)=>s.getByTile(f).length===0),new l((c,f)=>e.getByTile(f).player()!==c.player()),new m((c,f,h=c.tile())=>{let U=e.getByTile(f);return new am(h,f,c,U,r)})),new Ot(pi,wn,new l(c=>c instanceof Y),new l((c,f)=>o.getByTile(f).filter(h=>[we,$e,ir,ke].some(U=>h instanceof U)).length>0),new m((c,f,h=c.tile())=>new Ds(h,f,c,r,o,y))),new Ot(pi,wn,new l(c=>c instanceof Y),new l((c,f,h=c.tile())=>h.isLand()),new m((c,f,h=c.tile())=>new Ms(h,f,c,r,y,a))),new Ot(pi,wn,new m((c,f,h=c.tile())=>new ma(h,f,c,r,y))),new Ot(pi,wn,new m((c,f,h=c.tile())=>new pm(h,f,c,r))),new Ot(wn,new m((c,f,h=c.tile())=>new Xi(h,f,c,r))),new Ot(pi,wn,new l(c=>c instanceof We),new l((c,f,h=c.tile())=>h.isLand()),new l((c,f,h=c.tile())=>!CR(h,e)),new m((c,f,h=c.tile())=>new ym(h,f,c,i,r))),...[[we,bs,new On(new l((c,f,h=c.tile())=>h.terrain()instanceof ee),new l((c,f,h=c.tile())=>h.getAdjacent().some(U=>U.terrain()instanceof ee||U.terrain()instanceof Jt||o.getByTile(U).some(D=>D instanceof we)&&!CR(U,e))))],[$e,Cs],[ke,Ts],[ir,Ps,new l((c,f)=>o.getByTile(f).some(h=>h instanceof ke))]].map(([c,f,...h])=>new Ot(new l(U=>U instanceof dr),pi,new l((U,D,A=U.tile())=>r.get(Zm).some(E=>E.validate(A,c,U.player()))),wn,...h,new m((U,D,A=U.tile())=>new f(A,D,U,r,y)))),...[[Ze,Gs],[qe,Is],[ie,Es],[Qe,Bs]].map(([c,f])=>new Ot(pi,wn,new l(h=>h instanceof dr),new l((h,U,D=h.tile())=>D.terrain()instanceof c),new m((h,U,D=h.tile())=>new f(D,U,h,r,p,y)))),new Ot(Xl,pi,jd,new l((c,f)=>f.terrain()instanceof Jt),new l((c,f)=>s.getByTile(f).every(h=>h.player()===c.player())),new l((c,f)=>s.getByTile(f).filter(h=>h instanceof zt).some(h=>h.hasCapacity()&&h.canStow(c))),new m((c,f,h=c.tile())=>{let[U]=s.getByTile(f).filter(D=>D instanceof zt).filter(D=>D.hasCapacity()&&D.canStow(c));return new um(h,f,c,U,r)})),new Ot(Xl,new l(c=>{try{return u.getByUnit(c),!0}catch{return!1}}),new On(new l((c,f)=>!(c instanceof ot)),new l((c,f)=>f.isLand())),new l((c,f,h=c.tile())=>u.getByUnit(c).transport().tile()===h),new m((c,f,h=c.tile())=>{let U=u.getByUnit(c).transport();return new Us(h,f,c,U,r)})),new Ot(pi,wn,new l(c=>c instanceof zt),new l(c=>c.hasCargo()),new l((c,f)=>f.getNeighbours().some(h=>h.isLand())),new m((c,f,h=c.tile())=>new fm(h,f,c,r)))],"getRules"),oE=QN});var XN,aE,sE=n(()=>{la();Qg();w();T();kp();XN=t((i=or)=>[new em(new l(e=>e.moves().value()>0),new m(e=>e.setActive())),new em(new l(e=>e.busy()!==null),new m(e=>e.setBusy())),...[di].map(e=>new em(new l(r=>i.getByUnit(r).some(o=>o instanceof e)),new m(r=>i.unregister(...i.getByUnit(r).filter(o=>o instanceof e)))))],"getRules"),aE=XN});var e1,lE,mE=n(()=>{sr();op();gn();He();w();T();Dn();e1=t((i=N)=>[new Zt(new l((e,r)=>Object.prototype.isPrototypeOf.call(Le,r)),new m(e=>new l(()=>e.tile().isCoast()))),...[[xo,Vr],[vo,co],[bo,Ri],[Di,jr],[To,Ri],[Co,Bi],[Ei,xr],[Fi,fn],[Po,zr],[Io,vr],[Xr,so],[ki,Nt],[Ir,mn],[Si,uo],[Yi,oo],[wo,pn],[zi,yt],[Ao,mo],[Go,Nr],[Ni,nr],[Li,Yr],[Bo,Wt],[wr,Pi],[Uo,ut],[Mo,xt],[Ar,Wr]].map(([e,r])=>new Zt(new l((o,a)=>a===e),new m(o=>new l(()=>i.getByPlayer(o.player()).completed(r))))),...[[Di,Vr],[Ei,jr],[Fi,oo],[ki,xt],[Ir,Nr],[Si,zr],[Yi,ut],[zi,Nr],[Ni,Nt],[Li,yt],[wr,Nr],[Ar,nr],[Do,yt]].map(([e,r])=>new Zt(new l((o,a)=>a===e),new m(o=>new l(()=>!i.getByPlayer(o.player()).completed(r)))))],"getRules"),lE=e1});var t1,pE,uE=n(()=>{ap();gn();t1=t(()=>[...[[xo,80],[vo,160],[bo,120],[Di,40],[Co,50],[To,160],[Ei,40],[Fi,40],[Po,80],[Io,30],[Xr,60],[ki,40],[Ir,20],[Si,50],[Yi,40],[wo,50],[zi,30],[Ao,160],[Go,30],[Ni,40],[We,40],[Li,20],[Bo,50],[wr,20],[Uo,80],[Mo,50],[Ar,40],[Do,10]].flatMap(([i,e])=>Wl(i,e))],"getRules"),pE=t1});var r1,cE,yE=n(()=>{rr();sp();w();T();gn();r1=t((i=ye)=>[new Jn(new l((e,r)=>r instanceof We),new m(e=>i.getByCity(e.city()).shrink()))],"getRules"),cE=r1});var i1,fE,dE=n(()=>{K();_e();Qc();T();i1=t((i=z,e=P)=>[new Qn(new m(r=>i.register(r))),new Qn(new m(r=>r.applyVisibility())),new Qn(new m(r=>r.moves().set(r.movement()))),new Qn(new m(r=>{e.emit("unit:created",r)}))],"getRules"),fE=i1});var o1,gE,hE=n(()=>{K();_e();Ap();T();o1=t((i=z,e=P)=>[new qo(new m(r=>{r.setDestroyed(),i.unregister(r)})),new qo(new m((r,o)=>{e.emit("unit:defeated",r,o)}))],"getRules"),gE=o1});var n1,OE,RE=n(()=>{K();la();_e();ey();T();n1=t((i=z,e=or,r=P)=>[new Xn(new m((o,a)=>{r.emit("unit:destroyed",o,a)})),new Xn(new m(o=>i.unregister(o))),new Xn(new m(o=>{o.setActive(!1),o.setDestroyed()})),new Xn(new m(o=>e.getByUnit(o).forEach(a=>e.unregister(a))))],"getRules"),OE=n1});var Hd,Qm,TR=n(()=>{G();Hd=class extends g{};t(Hd,"LostAtSea");Qm=Hd});var a1,xE,vE=n(()=>{K();T();TR();a1=t((i=P)=>[new Qm(new m(e=>{i.emit("unit:lost-at-sea",e)})),new Qm(new m(e=>e.destroy(null)))],"getRules"),xE=a1});var s1,bE,CE=n(()=>{dm();K();I();hm();w();T();TR();At();Dn();gn();rt();s1=t((i=Un,e=d,r=()=>Math.random(),o=P,a=j)=>[new q(new m((s,p)=>{o.emit("unit:moved",s,p)})),new q(new m(s=>s.applyVisibility())),new q(new l(s=>s.moves().value()<=.1),new m(s=>s.moves().set(0))),new q(new l(s=>s.moves().value()<.1),new m(s=>s.setActive(!1))),new q(new l(s=>s instanceof zt),new l((s,p)=>p instanceof kt),new l(s=>s.hasCargo()),new m((s,p)=>s.cargo().forEach(u=>u.action(p.forUnit(u))))),new q(new l((s,p)=>p instanceof Us),new m(s=>{let p=i.getByUnit(s);p.transport().unload(s),i.unregister(p)})),new q(new l(s=>s instanceof Ar),new l(s=>s.moves().value()===0),new l(s=>!s.tile().isCoast()),new l(()=>r()<=.5),new m(s=>{e.process(Qm,s)})),new q(new l(s=>s instanceof Xr),new l(s=>s.moves().value()===0),new l(s=>a.getByTile(s.tile())!==null),new m(s=>{e.process(Qm,s)}))],"getRules"),bE=s1});var TE,l1,PE,IE=n(()=>{to();Dn();dm();En();gi();hm();w();T();yi();TE=[[Gt,2],[Ce,1],[qe,2],[fe,1],[Ae,2],[Ze,2],[Se,3],[it,1],[ie,1],[ee,1],[Qe,2],[mt,1]],l1=t((i=Ne,e=Un)=>[...TE.map(([r,o])=>new be(new l((a,s)=>s instanceof kt),new l(a=>a instanceof ot),new l((a,s)=>s.to().terrain()instanceof r),new m(()=>o))),new be(new l((r,o)=>o instanceof kt),new l(r=>r instanceof St||r instanceof Le),new m(()=>1)),new be(new l((r,o)=>o instanceof kt),new l(r=>r instanceof ot),new l((r,o)=>i.getByTile(o.from()).some(a=>a instanceof ke)),new l((r,o)=>i.getByTile(o.to()).some(a=>a instanceof ke)),new m(()=>1/3)),new be(new l((r,o)=>o instanceof kt),new l(r=>r instanceof ot),new l((r,o)=>i.getByTile(o.from()).some(a=>a instanceof ir)),new l((r,o)=>i.getByTile(o.to()).some(a=>a instanceof ir)),new m(()=>0)),new be(new l((r,o)=>o instanceof kt),new l(r=>r instanceof ot),new l(r=>{try{return e.getByUnit(r),!0}catch{return!1}}),new l(r=>e.getByUnit(r).transport()instanceof zt),new m(()=>0)),...[[bs,2],[Cs,3],[Ts,1],[Ps,2],[Is,2],[Gs,3],[Bs,3],[Ms,1],[Ds,1],[Es,3],[ma,0]].flatMap(([r,o])=>TE.map(([a,s])=>new be(new l((p,u)=>u instanceof r),new l(p=>p.tile().terrain()instanceof a),new m(()=>o*s))))],"getRules"),PE=l1});var m1,wE,AE=n(()=>{Og();_e();Zn();w();T();m1=t((i=z)=>[new ht(new l(e=>i.getByPlayer(e).some(r=>r.active()&&r.moves().value())),new m(e=>i.getByPlayer(e).filter(r=>r.active()&&r.moves().value()>0).sort((r,o)=>(r.waiting()?1:0)-(o.waiting()?1:0)).map(r=>new Va(e,r)))),new ht(new l(e=>i.getByPlayer(e).some(r=>!r.active()||!r.moves().value())),new m(e=>i.getByPlayer(e).filter(r=>!r.active()||r.moves().value()===0).sort((r,o)=>(r.waiting()?1:0)-(o.waiting()?1:0)).map(r=>new Ja(e,r))))],"getRules"),wE=m1});var p1,GE,BE=n(()=>{T();gh();Ih();p1=t(()=>[new rf(new m(i=>i.action(new Cv(i.tile(),i.tile(),i))))],"getRules"),GE=p1});var u1,UE,ME=n(()=>{Ql();gn();kp();I();la();tm();tm();w();T();u1=t((i=or,e=d)=>[...[[xo,12,2,2],[vo,18,12,4,2],[bo,12,1,8,2],[Di,8],[Co,0],[To,1,12,5,2],[Ei,6],[Fi,4,1,2],[Po,6,6,6,2],[Io,0,0,2],[Xr,4,2,10,2],[ki,2,2,3],[Ir,2,1,2],[Si,4,4,4],[Yi,4,2,2],[wo,6,6,3],[zi,3,2],[Ao,99,0,16],[Go,3,5],[Ni,1,1,3],[We,0],[Li,1,2],[Bo,8,2,3,2],[wr,3],[Uo,10,5,3],[Mo,0,3,4],[Ar,1,0,3],[Do]].flatMap(([r,o=1,a=1,s=1,p=1])=>bx(r,o,a,s,p)),...[[di,1,mi],[pa,.5,Vi,mi]].flatMap(([r,o,...a])=>a.map(s=>new sl(new l((p,u)=>u instanceof s),new l(p=>i.getByUnit(p).some(u=>u instanceof r)),new m((p,u)=>{let y=new s;e.process(fs,p.constructor,y),u.add(y.value()*o,r.name)}))))],"getRules"),UE=u1});var c1,DE,EE=n(()=>{K();T();Yf();c1=t((i=P)=>[new xl(new m((e,r)=>{i.emit("unit:unsupported",e,r)}))],"getRules"),DE=c1});var y1,FE,kE=n(()=>{w();T();ch();y1=t((i=()=>Math.random())=>[new Gp(new l((e,r)=>e.moves().value()>=r),new m((e,r)=>(e.moves().subtract(r),!0))),new Gp(new l((e,r)=>e.moves().value()<r),new m((e,r)=>{let o=e.moves().value();return e.moves().set(0),o>=r*.5*i()}))],"getRules"),FE=y1});var f1={};var SE=n(()=>{nE();sE();mE();uE();yE();dE();hE();RE();I();vE();CE();IE();AE();BE();ME();EE();kE();d.register(...oE(),...aE(),...lE(),...pE(),...cE(),...fE(),...gE(),...OE(),...xE(),...bE(),...PE(),...wE(),...GE(),...UE(),...DE(),...FE())});var zE=b(YE=>{"use strict";Object.defineProperty(YE,"__esModule",{value:!0});rE();SE()});var Nn,NE=n(()=>{Ie();Nn=class extends Oe{};t(Nn,"ApolloProgram")});var Gr,LE=n(()=>{Ie();Gr=class extends ve{};t(Gr,"Colossus")});var ti,WE=n(()=>{Ie();ti=class extends ve{};t(ti,"CopernicusObservatory")});var So,jE=n(()=>{Ie();So=class extends Oe{};t(So,"CureForCancer")});var Ln,HE=n(()=>{Ie();Ln=class extends Oe{};t(Ln,"DarwinsVoyage")});var Br,_E=n(()=>{Ie();Br=class extends ve{};t(Br,"GreatLibrary")});var Yo,KE=n(()=>{Ie();Yo=class extends ve{};t(Yo,"GreatWall")});var ri,qE=n(()=>{Ie();ri=class extends ve{};t(ri,"HangingGardens")});var Wn,VE=n(()=>{Ie();Wn=class extends Oe{};t(Wn,"HooverDam")});var zo,JE=n(()=>{Ie();zo=class extends Oe{};t(zo,"IsaacNewtonsCollege")});var ji,$E=n(()=>{Ie();ji=class extends Oe{};t(ji,"JsBachsCathedral")});var ii,ZE=n(()=>{Ie();ii=class extends Oe{};t(ii,"Lighthouse")});var No,QE=n(()=>{Ie();No=class extends ve{};t(No,"MagellansExpedition")});var jn,XE=n(()=>{Ie();jn=class extends Oe{};t(jn,"ManhattanProject")});var Ur,eF=n(()=>{Ie();Ur=class extends Oe{};t(Ur,"MichelangelosChapel")});var qt,tF=n(()=>{Ie();qt=class extends ve{};t(qt,"Oracle")});var Lo,rF=n(()=>{Ie();Lo=class extends ve{};t(Lo,"Pyramids")});var Wo,iF=n(()=>{Ie();Wo=class extends Oe{};t(Wo,"SetiProgram")});var Mr,oF=n(()=>{Ie();Mr=class extends Oe{};t(Mr,"ShakespearesTheatre")});var Hn,nF=n(()=>{Ie();Hn=class extends Oe{};t(Hn,"UnitedNations")});var Hi,aF=n(()=>{Ie();Hi=class extends Oe{};t(Hi,"WomensSuffrage")});var Ka=n(()=>{NE();LE();WE();jE();HE();_E();KE();qE();VE();JE();$E();ZE();QE();XE();eF();tF();rF();iF();oF();nF();aF()});var d1={};var sF=n(()=>{Ka();Ll();bn.register(Nn,Gr,ti,So,Ln,Br,Yo,ri,Wn,zo,ji,ii,No,jn,Ur,qt,Lo,Wo,Mr,Hn,Hi)});var _d,It,_n=n(()=>{xe();Ie();_d=class extends F{constructor(){super(ve)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.filter(r=>r.city().player()===e)}};t(_d,"WonderRegistry");It=new _d});var g1,lF,mF=n(()=>{Ka();sr();op();He();_n();w();T();Ie();g1=t((i=N,e=It)=>[new Zt(new l((r,o)=>Object.isPrototypeOf.call(ve,o)),new m((r,o)=>new l(()=>e.filter(a=>a instanceof o).length===0))),...[[Gr,Yr],[ti,xi],[Br,Rr],[Yo,Lt],[ri,cn],[ii,Wr],[No,nr],[qt,bi],[Lo,Lt],[Nn,po],[So,ln],[Ln,qr],[Wn,ct],[zo,fo],[ji,vt],[jn,_r],[Ur,vt],[Wo,Ci],[Mr,Ii],[Hn,Rt],[Hi,xt]].map(([r,o])=>new Zt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByPlayer(a.player()).completed(o)))))],"getRules"),lF=g1});var h1,pF,uF=n(()=>{Ka();ap();h1=t(()=>[...[[Nn,600],[Gr,200],[ti,300],[So,600],[Ln,300],[Br,300],[Yo,300],[ri,300],[Wn,600],[zo,400],[ji,400],[ii,200],[No,400],[jn,600],[Ur,300],[qt,300],[Lo,300],[Wo,600],[Mr,400],[Hn,600],[Hi,600]].flatMap(([i,e])=>Wl(i,e))],"getRules"),pF=h1});var O1,cF,yF=n(()=>{$n();K();_n();sp();w();T();Ie();O1=t((i=Qt,e=It,r=P)=>[new Jn(new l((o,a)=>a instanceof ve),new m((o,a)=>{let s=a.constructor;e.register(a),i.filter(p=>p.building()?.item()===s).forEach(p=>p.revalidate())})),new Jn(new l((o,a)=>a instanceof ve),new m((o,a)=>{r.emit("wonder:built",a,o.city())}))],"getRules"),cF=O1});var Xm,_i,tu=n(()=>{_n();w();Xm=t((i,e=It)=>new l(r=>e.getByCity(r).some(o=>o instanceof i)),"cityHasWonder"),_i=t((i,e=It)=>new l(r=>e.getByPlayer(r.player()).some(o=>o instanceof i)),"playerHasWonder")});var fF,xn,Kd,ru=n(()=>{He();w();fF=t((i,e=N)=>new l(r=>e.getByPlayer(r.player()).completed(i)),"discoveredByPlayer"),xn=t((i,e=N)=>new l(()=>i===null||!e.some(r=>r.completed(i))),"notDiscoveredByAnyPlayer"),Kd=t((i,e=N)=>new l(r=>i===null||!e.getByPlayer(r.player()).completed(i)),"notDiscoveredByPlayer")});var qd,dF=n(()=>{ur();w();qd=t((i,e=Re)=>new l(r=>e.getByCity(r).some(o=>o instanceof i)),"hasCityImprovement")});var R1,gF,hF=n(()=>{Mi();ur();sr();Ka();on();He();_e();_n();tu();ru();Fl();w();T();qn();Nm();Za();js();dF();Zi();R1=t((i=Re,e=pt,r=N,o=z,a=It)=>[new et(new Xe,_i(qt,a),qd(Bt,i),Kd(jt,r),xn(vt,r),new m((s,p)=>new Ue(-Math.min(1,Ke(p,Ue)),qt.name))),new et(new Xe,_i(qt,a),qd(Bt,i),fF(jt,r),xn(vt,r),new m((s,p)=>new Ue(-Math.min(2,Ke(p,Ue)),qt.name))),new et(new Fr(4e3),Xm(Mr,a),xn(ct,r),new m((s,p)=>new Ue(-Ke(p,Ue),Mr.name))),new et(new Xe,_i(ji,a),new m((s,p)=>new Ue(-Math.min(2,Ke(p,Ue)),ji.name))),new et(new Xe,_i(Ur,a),qd(mr,i),xn(Rt,r),new m((s,p)=>new Ue(-Math.min(4,Ke(p,Ue)),Ur.name))),new et(new Xe,_i(Hi,a),new l((s,p)=>p.some(u=>u instanceof Ia)),new m((s,p)=>p.flatMap(u=>u instanceof Ia?new Ue(-1,Hi.name):[])))],"getRules"),gF=R1});var x1,OF,RF=n(()=>{_n();Zs();w();T();x1=t((i=It)=>[new yr(new l(e=>i.getByCity(e).length>0),new m(e=>i.getByCity(e).forEach(r=>i.unregister(r))))],"getRules"),OF=x1});var v1,xF,vF=n(()=>{Ka();sr();js();He();_n();tu();Nl();T();Za();ru();v1=t((i=N,e=It)=>[new Ho(new Fr(500),Xm(Gr,e),xn(hr,i),new m(r=>new re(r.tilesWorked().filter(o=>o.yields().some(a=>a instanceof re)).length,Gr.name))),...[[ri,1,Or],[So,1,null]].map(([r,o,a])=>new Ho(_i(r,e),xn(a,i),new m(()=>new Fo(o,r.name))))],"getRules"),xF=v1});var b1,bF,CF=n(()=>{Ka();He();_n();tu();sr();T();qn();js();ju();ru();Zi();b1=t((i=N,e=It)=>[...[[ti,Kt,1,ut]].map(([r,o,a,s])=>new Qs(new Xe,Xm(r,e),xn(s,i),new m((p,u)=>new o(Ke(u,o)*a,r.name)))),...[[Wo,Kt,.5,null]].map(([r,o,a,s])=>new Qs(new Xe,_i(r,e),xn(s,i),new m((p,u)=>new o(Ke(u,o)*a,r.name))))],"getRules"),bF=b1});var Vd,Jd,PR=n(()=>{G();Vd=class extends g{};t(Vd,"Obsolete");Jd=Vd});var C1,TF,PF=n(()=>{sr();Ka();He();I();_n();Ru();w();T();PR();C1=t((i=N,e=d,r=It)=>[new Xa(new l(()=>r.some(o=>o instanceof Br)),new l((o,a)=>{let[s]=r.filter(u=>u instanceof Br).map(u=>u.city().player());return!i.getByPlayer(s).completed(a.sourceClass())}),new l((o,a)=>i.filter(s=>s.completed(a.sourceClass())).length>=3),new m((o,a)=>{let[s]=r.filter(u=>u instanceof Br).map(u=>u.city().player());return i.getByPlayer(s).addAdvance(a.sourceClass())})),...[[Gr,hr],[ti,ut],[Br,ar],[Yo,yt],[ri,Or],[zo,_r],[ii,Nt],[Ur,Rt],[qt,vt],[Lo,Rt],[Mr,ct]].map(([o,a])=>new Xa(new l(()=>r.entries().some(s=>s instanceof o)),new l((s,p)=>p instanceof a),new m(()=>{let[s]=r.filter(p=>p instanceof o);e.process(Jd,s,s.city())})))],"getRules"),TF=C1});var T1,IF,wF=n(()=>{Ka();He();_n();w();T();qn();sr();Ql();Dn();tm();ru();tu();T1=t((i=It,e=N)=>[new hp(new Xe,new l((r,o)=>o instanceof Ji),new l(r=>r instanceof Le),_i(ii,i),Kd(Nt,e),new m((r,o)=>o.add(1))),new hp(new Xe,new l((r,o)=>o instanceof Ji),new l(r=>r instanceof Le),_i(No,i),new m((r,o)=>o.add(1)))],"getRules"),IF=T1});var P1,AF,GF=n(()=>{K();T();PR();P1=t((i=P)=>[new Jd(new m((e,r)=>{i.emit("wonder:obsolete",e,r)}))],"getRules"),AF=P1});var I1={};var BF=n(()=>{mF();uF();yF();hF();RF();vF();CF();I();PF();wF();GF();d.register(...lF(),...pF(),...cF(),...gF(),...OF(),...xF(),...bF(),...TF(),...IF(),...AF())});var MF=b(UF=>{"use strict";Object.defineProperty(UF,"__esModule",{value:!0});sF();BF()});var w1,DF,EF=n(()=>{to();En();He();sr();gi();bR();w();w1=t((i=N,e=Ne)=>[...[[we,Ce,fe,Ae,ie,ee],[$e,Ce,Ae,Se],[ke,Gt,Ce,qe,fe,Ae,Ze,Se,ie,Qe,mt]].map(([r,...o])=>new Zm(new l((a,s)=>s===r),new l(a=>o.some(s=>a.terrain()instanceof s)),new l((a,s)=>!e.getByTile(a).some(p=>p instanceof s)))),...[[ke,io,ee]].map(([r,o,...a])=>new Zm(new l((s,p)=>p===r),new l(s=>a.some(p=>s.terrain()instanceof p)),new l((s,p)=>!e.getByTile(s).some(u=>u instanceof p)),new l((s,p,u)=>i.getByPlayer(u).completed(o)))),...[[ir,qr,ke,Gt,Ce,qe,fe,Ae,Ze,Se,ie,ee,Qe,mt]].map(([r,o,a,...s])=>new Zm(new l((p,u)=>u===r),new l(p=>s.some(u=>p.terrain()instanceof u)),new l((p,u)=>!e.getByTile(p).some(y=>y instanceof u)),new l(p=>e.getByTile(p).some(u=>u instanceof a)),new l((p,u,y)=>i.getByPlayer(y).completed(o))))],"getRules"),DF=w1});var A1,FF,kF=n(()=>{K();En();gi();Ty();w();T();A1=t((i=Ne,e=P)=>[new sa(new l((r,o)=>i.getByTile(r).every(a=>o.constructor!==a.constructor)),new m((r,o)=>i.register(o))),new sa(new m(r=>r.clearYieldCache(null))),new sa(new m((r,o)=>{e.emit("tile-improvement:built",r,o)})),...[[$e,we],[we,$e]].map(([r,o])=>new sa(new l((a,s)=>s instanceof r),new l(a=>i.getByTile(a).some(s=>s instanceof o)),new m(a=>i.unregister(...i.getByTile(a).filter(s=>s instanceof o)))))],"getRules"),FF=A1});var $d,Zd,IR=n(()=>{Ki();fi();$d=class extends Ee{constructor(){super(ze)}};t($d,"AvailableTerrainFeatureRegistry");Zd=new $d});var G1,SF,YF=n(()=>{IR();I();Pg();T();lm();G1=t((i=d,e=Zd)=>[new Fu(new m(r=>{let o=i.get(ws);e.entries().forEach(a=>o.filter(s=>s.validate(a,r)).forEach(s=>s.process(a,r)))}))],"getRules"),SF=G1});var Ut,wR=n(()=>{G();Ut=class extends g{};t(Ut,"Distribution")});var B1,zF,NF=n(()=>{to();wR();$t();w();T();B1=t(()=>[new Ut(new l(i=>i===Gt),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:0,to:.01,fill:!0},{from:.01,to:.02},{from:.98,to:.99},{from:.99,to:1,fill:!0}])),new Ut(new l(i=>i===Ce),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.4,to:.45},{from:.45,to:.55,coverage:.025,cluster:!0,clusterChance:.1},{from:.55,to:.6}])),new Ut(new l(i=>i===qe),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.05,to:.2},{from:.2,to:.4,cluster:!0,clusterChance:.1,coverage:.1},{from:.4,to:.6},{from:.6,to:.8,cluster:!0,clusterChance:.1,coverage:.1},{from:.8,to:.95}])),new Ut(new l(i=>i===fe),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{fill:!0}])),new Ut(new l(i=>i===Ae),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.1,to:.9,path:!0,pathChance:.1,coverage:.06}])),new Ut(new l(i=>i===Ze),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.3,to:.45,cluster:!0,clusterChance:.2,coverage:.08},{from:.55,to:.7,cluster:!0,clusterChance:.2,coverage:.08}])),new Ut(new l(i=>i===Se),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.01,to:.1,coverage:.3,path:!0},{from:.1,to:.9,path:!0},{from:.9,to:.99,coverage:.3,path:!0}])),new Ut(new l(i=>i===it),new l((i,e)=>e.some(r=>r.constructor===Jt)),new m(()=>[{fill:!0}])),new Ut(new l(i=>i===ie),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.01,to:.2,coverage:.3},{from:.2,to:.4},{from:.1,to:.4,cluster:!0},{from:.4,to:.6},{from:.6,to:.8},{from:.6,to:.9,cluster:!0},{from:.8,to:.99,coverage:.3}])),new Ut(new l(i=>i===ee),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.1,to:.9,coverage:.1,path:!0,pathChance:.5}])),new Ut(new l(i=>i===Qe),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.2,to:.4,cluster:!0},{from:.6,to:.8,cluster:!0}])),new Ut(new l(i=>i===mt),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.01,to:.15,cluster:!0,coverage:.15},{from:.85,to:.99,cluster:!0,coverage:.15}]))],"getRules"),zF=B1});var Qd,Xd,AR=n(()=>{G();Qd=class extends g{};t(Qd,"DistributionGroups");Xd=Qd});var U1,LF,WF=n(()=>{to();T();AR();U1=t(()=>[new Xd(new m(()=>[it,fe,Qe,Se,Ze,Ae,qe,Ce,ie,mt,Gt,ee]))],"getRules"),LF=U1});var M1,jF,HF=n(()=>{to();Dp();Jo();lm();M1=t((i=lt)=>[...[[Zo,.2,Ae],[Qo,.2,it],[hi,.2,qe,mt],[Xo,.2,Ze],[en,.2,Se],[eo,.2,ie],[Oi,.2,Ce],[tn,.2,Qe],[rn,.2,Gt],[$o,.5,fe,ee]].flatMap(([r,o,...a])=>a.flatMap(s=>ev(s,r,o,i)))],"getRules"),jF=M1});var eg,tg,_F=n(()=>{G();eg=class extends g{};t(eg,"Pillaged");tg=eg});var D1,KF,qF=n(()=>{K();gi();_F();w();T();D1=t((i=Ne,e=P)=>[new tg(new l((r,o)=>i.getByTile(r).includes(o)),new m((r,o)=>i.unregister(o))),new tg(new m(r=>r.clearYieldCache(null))),new tg(new m((r,o)=>{e.emit("tile-improvement:pillaged",r,o)}))],"getRules"),KF=D1});var GR,BR,UR,E1,F1,k1,S1,VF,JF=n(()=>{fR();K();na();to();T();OR();GR=new Map,BR=new Map,UR=new Map,E1=t((i,e=null)=>(BR.has(i)||BR.set(i,i.score(e,[[J,8],[H,3],[re,1]])),BR.get(i)),"tileScore"),F1=t((i,e=null)=>(UR.has(i)||UR.set(i,i.getSurroundingArea().entries().reduce((r,o)=>r+E1(o,e),0)),UR.get(i)),"areaScore"),k1=t((i,e=P)=>{if(!GR.has(i)){e.emit("world:generate-start-tiles");let r=i.entries().filter(o=>[fe,ie,ee].some(a=>o.terrain()instanceof a)).map(o=>({tile:o,score:F1(o)})).sort(({score:o},{score:a})=>a-o).map(({tile:o})=>o);GR.set(i,r),e.emit("world:start-tiles",r)}return GR.get(i)},"pickStartTiles"),S1=t((i=Td,e=P,r=()=>Math.random())=>[new Dd(new m((o,a,s)=>{if(e.option("earth",!1))try{return i.getStartTileByCivilizationAndWorld(a.civilization().sourceClass(),o)}catch{s.push(...i.entries().map(y=>y.startTileForMap(o)))}let p=k1(o,e);return p.forEach(u=>{s.some(y=>y.distanceFrom(u)<=4)&&p.splice(p.indexOf(u),1)}),p[Math.floor(p.length*r())]}))],"getRules"),VF=S1});var rg,ep,ig=n(()=>{Rd();Ki();rg=class extends Ee{constructor(){super(Od)}};t(rg,"GeneratorRegistry");ep=new rg});var og,ng,MR=n(()=>{G();og=class extends g{};t(og,"PickGenerator");ng=og});var ag,sg,DR=n(()=>{G();ag=class extends g{};t(ag,"Start");sg=ag});var lg,$F,ZF=n(()=>{Z();I();wd();xe();qi();lg=class extends S{#e;#t;#r;#i=new Al(ce);#o;constructor(e,r=d){super(),this.#e=e,this.#t=e.height(),this.#o=e.width(),this.#r=r,this.addKey("height","tiles","width")}build(){return new Promise(e=>{this.#e.generate().then(r=>{r.forEach((o,a)=>{let s=new ce(a%this.#o,Math.floor(a/this.#o),o,this,this.#r);this.#i.register(s)}),this.#r.process(Hs,this),e(this)})})}entries(){return this.#i.entries()}filter(e){return this.entries().filter(e)}forEach(e){return this.#i.forEach(e)}get(e,r){return this.entries()[this.#e.coordsToIndex(e,r)]}height(){return this.#t}includes(e){return this.#i.includes(e)}map(e){return this.#i.map(e)}register(...e){this.#i.register(...e)}tiles(){return this.entries()}width(){return this.#o}};t(lg,"World");$F=lg});var Y1,QF,XF=n(()=>{ig();I();K();T();MR();DR();ZF();Y1=t((i=d,e=ep,r=P)=>[new sg(new m(()=>{let[o]=i.process(ng),a=new o(parseInt(r.option("height",100),10),parseInt(r.option("width",160),10),{landCoverage:parseFloat(r.option("landCoverage",.4)),landSize:parseFloat(r.option("landSize",.2)),maxIterations:parseInt(r.option("maxIterations",20),10)});new $F(a,i).build()}))],"getRules"),QF=Y1});var z1,e0,t0=n(()=>{Dp();to();na();En();dn();on();Jo();gi();w();T();Ag();z1=t((i=Ne,e=lt,r=pt)=>[...[[J,qe,1],[J,fe,2],[J,Ae,1],[J,Ze,1],[J,it,1],[J,ie,1],[J,ee,2],[J,Qe,1],[J,mt,1],[H,Ce,1],[H,qe,2],[H,Se,1],[H,ie,1]].map(([o,a,s])=>new ai(new l(p=>p.terrain()instanceof a),new m(()=>new o(s,a.name)))),...[[H,Zo,2],[J,Qo,1],[J,hi,1],[re,Xo,2],[re,en,3],[H,eo,1],[J,Oi,2],[H,tn,3],[J,rn,2],[H,$o,1]].map(([o,a,s])=>new ai(new l(p=>e.getByTerrain(p.terrain()).some(u=>u instanceof a)),new m(()=>new o(s,a.name)))),...[[H,Zo,1],[J,Qo,1],[J,hi,1],[re,Xo,2],[re,en,2],[H,eo,1],[J,Oi,1],[H,tn,1],[J,rn,1]].map(([o,a,s])=>new ai(new l((p,u)=>{if(!u)return!1;try{return r.getByPlayer(u).is(bt,nt,at,ft)}catch{return!1}}),new l(p=>e.getByTerrain(p.terrain()).some(u=>u instanceof a)),new m(()=>new o(s,a.name)))),new ai(new l(o=>o.terrain()instanceof it),new m(()=>new re(2,it.name))),new ai(new l(o=>o.terrain()instanceof ee),new m(()=>new re(1))),new ai(new l((o,a)=>{if(!a)return!1;try{return r.getByPlayer(a).is(nt,ft)}catch{return!1}}),new l(o=>o.terrain()instanceof ee||o.terrain()instanceof it),new m(()=>new re(1,it.name))),...[[Ce,J,we,1],[Ce,H,$e,1],[Ae,J,we,1],[Ae,H,$e,2],[Se,H,$e,1],[ie,J,we,1]].map(([o,a,s,p])=>new ai(new l(u=>u.terrain()instanceof o),new l(u=>i.getByTile(u).some(y=>y instanceof s)),new m(()=>new a(p,s.name)))),...[[Ce,H,$e,1],[fe,J,we,1],[Ae,H,$e,1],[Se,H,$e,1],[ee,J,we,1]].map(([o,a,s,p])=>new ai(new l((u,y)=>{if(!y)return!1;try{return r.getByPlayer(y).is(bt,nt,at,ft)}catch{return!1}}),new l(u=>u.terrain()instanceof o),new l(u=>i.getByTile(u).some(y=>y instanceof s)),new m(()=>new a(p,s.name)))),...[Ce,fe,ie].map(o=>new ai(new l(a=>a.terrain()instanceof o),new l(a=>i.getByTile(a).some(s=>s instanceof ke)),new m(()=>new re(1,ke.name)))),...[Ce,fe,ie].map(o=>new ai(new l((a,s)=>{if(!s)return!1;try{return r.getByPlayer(s).is(nt,ft)}catch{return!1}}),new l(a=>a.terrain()instanceof o),new l(a=>i.getByTile(a).some(s=>s instanceof ke)),new m(()=>new re(1,ke.name))))],"getRules"),e0=z1});var N1,r0,i0=n(()=>{na();gi();w();T();qn();En();wg();N1=t((i=Ne)=>[...[[J,.5],[H,.5],[re,.5]].map(([e,r])=>new Yu(new Kn,new l((o,a,s)=>s.some(p=>p instanceof e)),new l(o=>i.getByTile(o).some(a=>a instanceof ir)),new m((o,a,s)=>{let p=s.filter(u=>u instanceof e).reduce((u,y)=>u+y.value(),0);s.push(new e(Math.floor(p*r),ir.name))})))],"getRules"),r0=N1});var L1,o0,n0=n(()=>{K();ig();vd();T();MR();L1=t((i=ep,e=P,r=()=>Math.random())=>[new ng(new m(()=>{if(e.option("earth",!1))return Jm;let o=i.entries();if(o.length===0)throw new TypeError("No available `World` generators.");return o[Math.floor(o.length*r())]}))],"getRules"),o0=L1});var W1={};var a0=n(()=>{EF();kF();YF();NF();WF();HF();I();qF();JF();XF();t0();i0();n0();d.register(...DF(),...FF(),...SF(),...zF(),...LF(),...jF(),...KF(),...VF(),...QF(),...e0(),...r0(),...o0())});var mg,pg,ER=n(()=>{Ki();kl();mg=class extends Ee{constructor(){super(vn)}};t(mg,"TerrainRegistry");pg=new mg});var j1={};var s0=n(()=>{to();ER();pg.register(Gt,Ce,qe,fe,Ae,Ze,Se,it,ie,ee,Qe,mt)});var H1={};var l0=n(()=>{Dp();IR();Zd.register(Zo,Qo,hi,Xo,en,eo,Oi,tn,rn,$o)});var p0=b(m0=>{"use strict";Object.defineProperty(m0,"__esModule",{value:!0});a0();s0();l0()});var _1,u0,c0=n(()=>{rt();Vt();_o();qi();_1=t((i=j)=>[new oe(_,"cities",e=>i.getByPlayer(e)),new oe(ce,"city",e=>i.getByTile(e))],"getAdditionalData"),u0=_1});var K1={};var y0=n(()=>{Dt();c0();ne.register(...u0())});var d0=b(f0=>{"use strict";Object.defineProperty(f0,"__esModule",{value:!0});y0()});var q1,g0,h0=n(()=>{$n();Vt();Vn();q1=t((i=Qt)=>[new oe(tt,"build",e=>i.getByCity(e))],"getAdditionalData"),g0=q1});var V1={};var O0=n(()=>{Dt();h0();ne.register(...g0())});var x0=b(R0=>{"use strict";Object.defineProperty(R0,"__esModule",{value:!0});O0()});var J1,v0,b0=n(()=>{rr();Vt();Vn();J1=t((i=ye)=>[new oe(tt,"growth",e=>i.getByCity(e))],"getAdditionalData"),v0=J1});var $1={};var C0=n(()=>{Dt();b0();ne.register(...v0())});var P0=b(T0=>{"use strict";Object.defineProperty(T0,"__esModule",{value:!0});C0()});var Z1,I0,w0=n(()=>{ur();Vt();Vn();Z1=t((i=Re)=>[new oe(tt,"improvements",e=>i.getByCity(e))],"getAdditionalData"),I0=Z1});var Q1={};var A0=n(()=>{Dt();w0();ne.register(...I0())});var B0=b(G0=>{"use strict";Object.defineProperty(G0,"__esModule",{value:!0});A0()});var X1,U0,M0=n(()=>{ks();Vt();qi();X1=t((i=kr)=>[new oe(ce,"goodyHut",e=>i.getByTile(e))],"getAdditionalData"),U0=X1});var eL={};var D0=n(()=>{Dt();M0();ne.register(...U0())});var F0=b(E0=>{"use strict";Object.defineProperty(E0,"__esModule",{value:!0});D0()});var tL,k0,S0=n(()=>{on();Vt();_o();tL=t((i=pt)=>[new oe(_,"government",e=>i.getByPlayer(e))],"getAdditionalData"),k0=tL});var rL={};var Y0=n(()=>{S0();Dt();ne.register(...k0())});var N0=b(z0=>{"use strict";Object.defineProperty(z0,"__esModule",{value:!0});Y0()});var iL,L0,W0=n(()=>{$i();Vt();_o();iL=t((i=ae)=>[new oe(_,"world",e=>i.getByPlayer(e))],"getAdditionalData"),L0=iL});var oL={};var j0=n(()=>{Dt();W0();ne.register(...L0())});var _0=b(H0=>{"use strict";Object.defineProperty(H0,"__esModule",{value:!0});j0()});var nL,K0,q0=n(()=>{He();Vt();_o();nL=t((i=N)=>[new oe(_,"research",e=>i.getByPlayer(e))],"getAdditionalData"),K0=nL});var aL={};var V0=n(()=>{Dt();q0();ne.register(...K0())});var $0=b(J0=>{"use strict";Object.defineProperty(J0,"__esModule",{value:!0});V0()});var sL,Z0,Q0=n(()=>{Jo();Vt();kl();sL=t((i=lt)=>[new oe(vn,"features",e=>i.getByTerrain(e))],"getAdditionalData"),Z0=sL});var lL={};var X0=n(()=>{Dt();Q0();ne.register(...Z0())});var tk=b(ek=>{"use strict";Object.defineProperty(ek,"__esModule",{value:!0});X0()});var mL,rk,ik=n(()=>{gi();Vt();qi();mL=t((i=Ne)=>[new oe(ce,"improvements",e=>i.getByTile(e))],"getAdditionalData"),rk=mL});var pL={};var ok=n(()=>{Dt();ik();ne.register(...rk())});var ak=b(nk=>{"use strict";Object.defineProperty(nk,"__esModule",{value:!0});ok()});var uL,sk,lk=n(()=>{eu();Vt();_o();uL=t((i=qs)=>[new oe(_,"rates",e=>i.getByPlayer(e))],"getAdditionalData"),sk=uL});var cL={};var mk=n(()=>{Dt();lk();ne.register(...sk())});var uk=b(pk=>{"use strict";Object.defineProperty(pk,"__esModule",{value:!0});mk()});var yL,ck,yk=n(()=>{tl();Vt();_o();yL=t((i=si)=>[new oe(_,"treasury",e=>i.getByPlayer(e))],"getAdditionalData"),ck=yL});var fL={};var fk=n(()=>{Dt();yk();ne.register(...ck())});var gk=b(dk=>{"use strict";Object.defineProperty(dk,"__esModule",{value:!0});fk()});var ug,hk,Ok=n(()=>{G();ug=class extends g{};t(ug,"End");hk=ug});var cg,Rk,xk=n(()=>{G();cg=class extends g{};t(cg,"Start");Rk=cg});var dL,vk,bk=n(()=>{K();I();ci();Ok();DR();xk();dL=t((i=d,e=P,r=Be)=>[["engine:start",()=>{i.process(sg)}],...["game:start","turn:end"].map(o=>[o,()=>{e.emit("turn:start",r.increment())}]),["turn:end",()=>{i.process(hk,r)}],["turn:start",()=>{i.process(Rk,r)}]],"getEvents"),vk=dL});var gL={};var Ck=n(()=>{K();bk();[...vk()].forEach(([i,e])=>{P.on(i,e)})});var Pk=b(Tk=>{"use strict";Object.defineProperty(Tk,"__esModule",{value:!0});Ck()});var hL,Ik,wk=n(()=>{_e();Vt();Vn();_o();qi();hL=t((i=z)=>[new oe(tt,"units",e=>i.getByCity(e)),new oe(_,"units",e=>i.getByPlayer(e)),new oe(ce,"units",e=>i.getByTile(e))],"getAdditionalData"),Ik=hL});var OL={};var Ak=n(()=>{Dt();wk();ne.register(...Ik())});var Bk=b(Gk=>{"use strict";Object.defineProperty(Gk,"__esModule",{value:!0});Ak()});var RL,Uk,Mk=n(()=>{la();Vt();ea();RL=t((i=or)=>[new oe(Pe,"improvements",e=>i.getByUnit(e))],"getAdditionalData"),Uk=RL});var xL={};var Dk=n(()=>{Dt();Mk();ne.register(...Uk())});var Fk=b(Ek=>{"use strict";Object.defineProperty(Ek,"__esModule",{value:!0});Dk()});var yg,kk,Sk=n(()=>{Ki();kh();yg=class extends Ee{constructor(){super(Tf)}};t(yg,"AIClientRegistry");kk=new yg});var vL={};var Yk=n(()=>{Sk();xm();kk.register(Sn)});var bL,zk,Nk=n(()=>{fl();_e();$s();w();T();xm();bL=t((i=z,e=Eo)=>[new cr(new l((r,o)=>e.getByPlayer(o)instanceof Sn),new m((r,o,a)=>e.getByPlayer(o).cityLost(r,a,!1)))],"getRules"),zk=bL});var CL,Lk,Wk=n(()=>{fl();_e();w();Zs();T();xm();CL=t((i=z,e=Eo)=>[new yr(new l(r=>e.getByPlayer(r.player())instanceof Sn),new m((r,o)=>e.getByPlayer(r.player()).cityLost(r,o,!0)))],"getRules"),Lk=CL});var TL,jk,Hk=n(()=>{fl();_e();w();Ap();T();xm();TL=t((i=z,e=Eo)=>[new qo(new l(r=>e.getByPlayer(r.player())instanceof Sn),new m((r,o)=>e.getByPlayer(r.player()).unitDestroyed(r,o&&o.player())))],"getRules"),jk=TL});var PL={};var _k=n(()=>{I();Nk();Wk();Hk();d.register(...zk(),...jk(),...Lk())});var qk=b(Kk=>{"use strict";Object.defineProperty(Kk,"__esModule",{value:!0});Yk();_k()});var fg,Vk,Jk=n(()=>{wR();Rd();$t();I();ER();AR();yR();fg=class extends Vm{#e;#t;#r;#i;#o;#a;#n;#l;#s;#m;constructor(e=100,r=160,o={},a=d,s=pg,p=()=>Math.random()){super(e,r);let{landCoverage:u=.4,landSize:y=.2,maxIterations:c=10,clusterChance:f=.05,coverage:h=.25,pathChance:U=.05}=o;this.#e=u,this.#t=y,this.#r=c,this.#i=f,this.#o=h,this.#a=U,this.#s=a,this.#m=s,this.#l=p,this.#n=new Array(this.height()*this.width()).fill(0).map(()=>new Jt)}async generateIslands(){let e=this.height(),r=this.width(),o=this.#t+this.#l()*.2,a=this.#e,s=this.#r,p=Math.ceil(e*r/100*o),u=new Array(e*r).fill(0);for(;u.length===0||u.filter(y=>y===1).length/u.length<a;){let y={},c=[],f=[],h=Math.floor(e*r*Math.random()),U=t(D=>{D in y||(y[D]=0),y[D]++},"flagAsSeen");for(u[h]=1,c.push(h),U(h),f.push(...Pl(e,r,h));f.length;){let D=f.shift();if((y[D]||0)<=s&&(Math.random()>.3?(u[D]=1,c.push(D),Pl(e,r,D).filter(A=>f.indexOf(A)===-1).forEach(A=>f.push(A))):Pl(e,r,D).forEach(A=>{let E=f.indexOf(A);E>-1&&f.splice(E,1)}),U(D)),c.length>p||u.filter(A=>A===1).length/u.length>=a)break}if(u.filter(D=>D===1).length/u.length>=a)break}this.#n=u.map(y=>y===1?new W:new Jt)}generate(){return this.generateIslands().then(()=>this.populateTerrain().then(()=>this.#n))}getNeighbours(e,r=!0){return Pl(this.height(),this.width(),e,r)}populateTerrain(){return new Promise(e=>{let r=this.#s.get(Ut);this.#s.get(Xd).filter(o=>o.validate()).map(o=>{let a=o.process();if(!a)throw new TypeError("Unexpected data from DistributionGroups.");return a}).forEach(o=>o.forEach(a=>r.filter(s=>s.validate(a,this.#n)).map(s=>{let p=s.process(a,this.#n);if(!p)throw new TypeError("Unexpected data from Distribution.");return p}).forEach(s=>s.forEach(({cluster:p=!1,clusterChance:u=this.#i,coverage:y=this.#o,fill:c=!1,from:f=0,path:h=!1,pathChance:U=this.#a,to:D=1})=>{let A=Object.keys(this.#n).map(V=>parseInt(V,10)).filter(V=>this.#n[V]instanceof a.__proto__).filter(V=>V>=f*this.height()*this.width()&&V<=D*this.height()*this.width());if(c){A.forEach(V=>{this.#n[V]=new a});return}let E=A.length*y;for(;E>0;){let V=A[Math.floor(this.#l()*A.length)];if(this.#n[V]=new a,E--,p){let se=this.getNeighbours(V).filter(wt=>!(this.#n[wt]instanceof a));for(;se.length&&E>0;){let wt=se.shift();u>=this.#l()/this.distanceFrom(V,wt)&&(this.#n[wt]=new a,E--,se.push(...this.getNeighbours(wt).filter(Dr=>!(this.#n[Dr]instanceof a)).filter(Dr=>this.#n[Dr]instanceof a.__proto__).filter(Dr=>!se.includes(Dr))))}}if(h){let se=V;for(;U>=this.#l();){let wt=this.getNeighbours(se).filter(Dr=>this.#n[Dr]instanceof a.__proto__&&!(this.#n[Dr]instanceof a));se=wt[Math.floor(this.#l()*wt.length)],this.#n[se]=new a,E--}}}})))),e()})}};t(fg,"BaseGenerator");Vk=fg});var IL={};var $k=n(()=>{Jk();ig();ep.register(Vk)});var Qk=b(Zk=>{"use strict";Object.defineProperty(Zk,"__esModule",{value:!0});$k()});var wL={};var uHe,cHe,yHe,fHe,dHe,gHe,hHe,OHe,RHe,xHe,vHe,bHe,CHe,THe,PHe,IHe,wHe,AHe,GHe,BHe,UHe,MHe,DHe,EHe,FHe,kHe,SHe,YHe,zHe,NHe,LHe,WHe,jHe,HHe,_He,KHe,qHe,VHe,JHe,$He,ZHe,QHe,XHe,e_e,t_e,r_e,i_e,o_e,n_e,a_e,s_e,l_e,m_e,p_e,u_e,c_e,y_e,f_e,d_e,g_e,h_e,O_e,R_e,x_e,v_e,b_e,C_e,T_e,P_e,I_e,w_e,A_e,G_e,B_e,U_e,M_e,D_e,E_e,F_e,k_e,S_e,Y_e,z_e,N_e,L_e,W_e,j_e,H_e,__e,K_e,q_e,V_e,J_e,$_e,Z_e,Q_e,X_e,eKe,tKe,rKe,iKe,oKe,nKe,aKe,sKe,lKe,mKe,pKe,uKe,cKe,yKe,fKe,dKe,gKe,Xk=n(()=>{"use strict";uHe=C(dT()),cHe=C(RT()),yHe=C(CT()),fHe=C(wT()),dHe=C(UT()),gHe=C(FT()),hHe=C(zT()),OHe=C(jT()),RHe=C(qT()),xHe=C(ZT()),vHe=C(tP()),bHe=C(nP()),CHe=C(mP()),THe=C(yP()),PHe=C(gP()),IHe=C(RP()),wHe=C(bP()),AHe=C(PP()),GHe=C(AP()),BHe=C(UP()),UHe=C(EP()),MHe=C(SP()),DHe=C(NP()),EHe=C(jP()),FHe=C(KP()),kHe=C(JP()),SHe=C(QP()),YHe=C(tI()),zHe=C(oI()),NHe=C(sI()),LHe=C(pI()),WHe=C(yI()),jHe=C(gI()),HHe=C(RI()),_He=C(bI()),KHe=C(PI()),qHe=C(AI()),VHe=C(UI()),JHe=C(EI()),$He=C(SI()),ZHe=C(NI()),QHe=C(jI()),XHe=C(KI()),e_e=C(JI()),t_e=C(QI()),r_e=C(tw()),i_e=C(ow()),o_e=C(sw()),n_e=C(pw()),a_e=C(yw()),s_e=C(gw()),l_e=C(Rw()),m_e=C(bw()),p_e=C(Pw()),u_e=C(Aw()),c_e=C(Uw()),y_e=C(Ew()),f_e=C(Sw()),d_e=C(Nw()),g_e=C(jw()),h_e=C(Kw()),O_e=C(Jw()),R_e=C(Qw()),x_e=C(tA()),v_e=C(oA()),b_e=C(sA()),C_e=C(pA()),T_e=C(yA()),P_e=C(gA()),I_e=C(RA()),w_e=C(bA()),A_e=C(PA()),G_e=C(AA()),B_e=C(UA()),U_e=C(EA()),M_e=C(SA()),D_e=C(NA()),E_e=C(jA()),F_e=C(KA()),k_e=C(JA()),S_e=C(QA()),Y_e=C(FG()),z_e=C(XG()),N_e=C(CB()),L_e=C(TU()),W_e=C(DU()),j_e=C(WU()),H_e=C(qU()),__e=C(pM()),K_e=C(bM()),q_e=C(oD()),V_e=C(PD()),J_e=C(LD()),$_e=C(tE()),Z_e=C(zE()),Q_e=C(MF()),X_e=C(p0()),eKe=C(d0()),tKe=C(x0()),rKe=C(P0()),iKe=C(B0()),oKe=C(F0()),nKe=C(N0()),aKe=C(_0()),sKe=C($0()),lKe=C(tk()),mKe=C(ak()),pKe=C(uk()),uKe=C(gk()),cKe=C(Pk()),yKe=C(Bk()),fKe=C(Fk()),dKe=C(qk()),gKe=C(Qk())});Og();Eg();Fg();pc();_l();var mp=class extends ss{#e;#t;constructor(e,r=Tn,o=()=>Math.random()){super(e),this.#e=r,this.#t=o}chooseCivilization(e){let r=e[Math.floor(e.length*this.#t())],o=this.player(),a=new r;o.setCivilization(a),this.chooseLeader(a)}chooseLeader(e){let r=this.#e.getByCivilization(e.constructor),o=r[Math.floor(r.length*this.#t())];e.setLeader(new o)}};t(mp,"Client");Sg();fr();Yg();Vn();Pc();Ge();Ft();Hg();Z();var us,Mc=class{constructor(){de(this,us,[])}add(e,r,o=null){v(this,us).push({[e]:{type:"add",index:o,value:r}})}clear(){v(this,us).splice(0)}remove(e,r=null){v(this,us).push({[e]:{type:"remove",index:r}})}transferData(){return v(this,us).slice(0).map(e=>{let r={};return Object.entries(e).forEach(([o,{type:a,index:s,value:p}])=>{r[o]={type:a,index:s,value:typeof p=="function"?p():p}}),r})}update(e,r,o=null){v(this,us).push({[e]:{type:"update",index:o,value:r}})}};t(Mc,"DataQueue"),us=new WeakMap;var lx=Mc;Ec();Vs();_o();Kg();_c();var Kc=class extends Error{constructor(e,r,o){super(e)}};t(Kc,"RetryFailed");var fx=Kc;var cp,yp,Jl,fp,$l,dp,gp,qc=class{constructor(e,r=5,o=100){de(this,cp,0);de(this,yp,void 0);de(this,Jl,void 0);de(this,fp,void 0);de(this,$l,void 0);de(this,dp,void 0);de(this,gp,void 0);De(this,Jl,e),De(this,fp,r),De(this,$l,setInterval(()=>this.run(),o)),De(this,yp,new Promise((a,s)=>{De(this,gp,a),De(this,dp,s)}))}run(){if(++SR(this,cp)._>v(this,fp)){clearInterval(v(this,$l)),v(this,dp).call(this,new fx("Retry failed.",v(this,Jl),v(this,cp)));return}v(this,Jl).call(this)&&(clearInterval(v(this,$l)),v(this,gp).call(this))}then(){return v(this,yp)}};t(qc,"Retryable"),cp=new WeakMap,yp=new WeakMap,Jl=new WeakMap,fp=new WeakMap,$l=new WeakMap,dp=new WeakMap,gp=new WeakMap;var dx=qc;Vg();Z();var Vc=class extends Ye{constructor(e){super(),Object.assign(this,e),this.addKey(...Object.keys(e))}};t(Vc,"TransferObject");var Jc=Vc;qi();ea();Z();rr();var Op,Rp,xp,vp,eh=class extends Ye{constructor(r,o,a,s){super();de(this,Op,void 0);de(this,Rp,void 0);de(this,xp,{size:0});de(this,vp,void 0);De(this,Op,r),De(this,Rp,a),v(this,xp).size=s,De(this,vp,o),this.addKey("_","growth","name","player","tile")}static fromCity(r){let o=ye.getByCity(r);return new eh(r.name(),r.tile(),r.player(),o.size())}_(){return"City"}name(){return v(this,Op)}player(){return v(this,Rp)}growth(){return v(this,xp)}tile(){return v(this,vp)}},ny=eh;t(ny,"City"),Op=new WeakMap,Rp=new WeakMap,xp=new WeakMap,vp=new WeakMap;var Cx=ny;Z();var bp,th=class extends Ye{constructor(r){super();de(this,bp,void 0);De(this,bp,r),this.addKey("_","civilization")}static fromPlayer(r){return new th(r.civilization())}_(){return"Player"}civilization(){return v(this,bp)}},ay=th;t(ay,"Player"),bp=new WeakMap;var Tx=ay;Z();var Cp,Tp,Pp,rh=class extends Ye{constructor(r,o,a){super();de(this,Cp,void 0);de(this,Tp,void 0);de(this,Pp,void 0);De(this,Cp,r),De(this,Tp,o),De(this,Pp,a),this.addKey("_","tile","player")}static fromUnit(r){return new rh(r.constructor.name,r.tile(),r.player())}_(){return v(this,Cp)}player(){return v(this,Pp)}tile(){return v(this,Tp)}},sy=rh;t(sy,"Unit"),Cp=new WeakMap,Tp=new WeakMap,Pp=new WeakMap;var Px=sy;Ie();B();rt();Ip();K();_l();ds();He();tl();$i();ci();_e();Z();I();ci();oh();var gy=class extends S{#e=new Map;#t;#r;constructor(e=Be,r=d){super(),this.#t=r,this.#r=e,this.addKey("value")}value(e=this.#r.value()){if(!this.#e.has(e)){let[o]=this.#t.process(gs,e);this.#e.set(e,o)}let r=this.#e.get(e);if(typeof r!="number")throw new TypeError("Invalid cache result.");return r}};t(gy,"Year");var hy=new gy;om();ih();var Gx=t(i=>i instanceof Ye?{"#ref":i.id()}:i,"referenceObject"),Fe=t((...i)=>e=>i.some(r=>e instanceof r)?Gx(e):e,"filterToReference"),Ax=t((...i)=>e=>i.some(r=>e instanceof r)?e:Gx(e),"filterToReferenceAllExcept"),nh=new Map,ah=new Map,sh=new Map,pe,X,ml,Os,An,wp,Oy=class extends mp{constructor(r,o,a){super(r);de(this,pe,t((r=o=>o)=>o=>o instanceof _&&o!==this.player()?(nh.has(o)||nh.set(o,Tx.fromPlayer(o)),nh.get(o)):o instanceof Pe&&o.player()!==this.player()?(ah.has(o)||ah.set(o,Px.fromUnit(o)),ah.get(o)):o instanceof tt&&o.player()!==this.player()?(sh.has(o)||sh.set(o,Cx.fromCity(o)),sh.get(o)):o instanceof ce?ae.getByPlayer(this.player()).get(o.x(),o.y()):o instanceof Te?{_:o.constructor.name}:r(o),"#dataFilter"));de(this,X,new lx);de(this,ml,void 0);de(this,Os,void 0);de(this,An,void 0);de(this,wp,!1);De(this,ml,new py),De(this,An,o),De(this,Os,a),v(this,Os).call(this,"action",(...s)=>{v(this,ml).emit("action",...s)}),v(this,Os).call(this,"cheat",({name:s,value:p})=>{if(s==="RevealMap"){let u=ae.getByPlayer(this.player()),[y]=u.entries();y.tile().map().entries().forEach(c=>{if(u.includes(c))return;u.register(c);let f=u.getByTile(c);v(this,X).add(u.id(),()=>c.toPlainObject(v(this,pe).call(this)),`entries[${u.entries().indexOf(f)}]`)})}if(s==="GrantAdvance"){let[u]=O.filter(c=>c.name===p),y=N.getByPlayer(this.player());if(!u||y.completed(u))return;y.addAdvance(u),v(this,X).add(y.id(),y.toPlainObject(v(this,pe).call(this,Fe(_))))}if(s==="GrantGold"){let u=si.getByPlayer(this.player());u.add(p),v(this,X).add(u.id(),u.toPlainObject(v(this,pe).call(this,Fe(_))))}if(s==="ModifyUnit"){let{unitId:u,properties:y}=p,[c]=z.getBy("id",u);if(!c)return;["attack","defence","moves","movement","visibility"].forEach(f=>{f in y&&c[f]().set(y[f])}),v(this,X).add(c.id(),c.toPlainObject(v(this,pe).call(this,Fe(_))))}this.sendPatchData()}),P.on("engine:plugins:load:failed",(s,p)=>{console.log(s+" failed to load"),console.error(p)}),P.on("player:visibility-changed",(s,p)=>{if(p!==this.player())return;let u=ae.getByPlayer(this.player()),y=u.getByTile(s);if(y===null){new dx(()=>{let c=u.getByTile(s);return c===null?!1:(v(this,X).add(u.id(),()=>s.toPlainObject(v(this,pe).call(this,Fe(_))),`tiles[${u.entries().indexOf(c)}]`),!0)},2,20);return}v(this,X).add(u.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_))),`tiles[${u.entries().indexOf(y)}]`)}),["unit:created","unit:defeated"].forEach(s=>{P.on(s,p=>{let u=ae.getByPlayer(this.player()),y=u.getByTile(p.tile());if(!!y&&(v(this,X).update(y.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_)))),p.player()===this.player())){if(s==="unit:created"){let c=z.getByPlayer(this.player()),f=c.indexOf(p),h=z.getByCity(p.city()),U=h.indexOf(p),D=z.getByTile(p.tile()),A=D.indexOf(p);v(this,X).add(r.id(),()=>p.toPlainObject(v(this,pe).call(this,Fe(ce,_,ql,tt))),`units[${f}]`),v(this,X).add(y.id(),()=>p.toPlainObject(v(this,pe).call(this,Fe(Pe))),`units[${A}]`),p.city()!==null&&v(this,X).add(p.city().id(),()=>p.toPlainObject(v(this,pe).call(this,Fe(Pe))),`units[${U}]`);return}v(this,X).update(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,Ax(_,Pe))))}})}),["unit:destroyed"].forEach(s=>{P.on(s,(p,u)=>{p.player()===this.player()&&p.city()!==null&&v(this,X).update(p.city().id(),()=>p.city().toPlainObject(v(this,pe).call(this,Fe(Cn,ol,k,_,ql,ce,Pe))))})}),["unit:moved"].forEach(s=>{P.on(s,(p,u)=>{let y=ae.getByPlayer(this.player()),c=y.getByTile(u.from()),f=y.getByTile(u.to());!c&&!f||(c&&v(this,X).update(c.id(),()=>c.toPlainObject(v(this,pe).call(this,Fe(_,tt)))),f&&v(this,X).update(f.id(),()=>f.toPlainObject(v(this,pe).call(this,Fe(_,tt)))),p.player()===this.player()&&p.city()!==null&&v(this,X).update(p.city().id(),()=>p.city().toPlainObject(v(this,pe).call(this,Fe(Cn,ol,k,_,ql,ce,Pe)))))})}),["tile-improvement:built","tile-improvement:pillaged"].forEach(s=>{P.on(s,p=>{let u=ae.getByPlayer(this.player()),y=u.getByTile(p);y&&v(this,X).update(y.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_,tt))))})}),P.on("city:captured",(s,p,u)=>{if(u===this.player()){j.getByPlayer(this.player()).indexOf(s)!==-1&&v(this,X).update(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,Ax(_)))),this.sendNotification(`${p.civilization().name()} have captured our city ${s.name()}!`);return}if(p===this.player()){this.sendNotification(`We have captured ${s.name()} from ${u.civilization().name()}!`);return}}),["city:created","city:captured","city:destroyed","city:grow","city:shrink"].forEach(s=>{P.on(s,p=>{let u=ae.getByPlayer(this.player()),y=u.getByTile(p.tile());!y||v(this,X).update(y.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_))))})}),P.on("city:shrink",s=>{s.player()===this.player()&&this.sendNotification(`Population decrease in ${s.name()}.`)}),P.on("city:unit-unsupported",(s,p)=>{s.player()===this.player()&&this.sendNotification(`${s.name()} cannot support ${p.constructor.name}.`)}),P.on("city:unsupported-improvement",(s,p)=>{s.player()===this.player()&&this.sendNotification(`${s.name()} cannot support ${p.constructor.name}.`)}),P.on("city:food-storage-exhausted",s=>{s.player()===this.player()&&this.sendNotification(`Food storage exhausted in ${s.name()}!`)}),P.on("city:building-complete",(s,p)=>{let u=ae.getByPlayer(this.player());if(s.city().player()!==this.player()&&p instanceof ve){this.sendNotification(`${u.getByTile(s.city().tile())?s.city().name():"A faraway city"} has completed work on ${p.constructor.name}!`);return}s.city().player()!==this.player()&&!(p instanceof ve)||(v(this,X).update(s.id(),()=>s.toPlainObject(v(this,pe).call(this,Fe(ce,Pe,_)))),this.sendNotification(`${s.city().name()} has completed work on ${p.constructor.name}!`))}),P.on("player:research-complete",(s,p)=>{s.player()===this.player()&&(v(this,X).update(s.id(),()=>s.toPlainObject(v(this,pe).call(this,Fe(_)))),this.sendNotification(`You have discovered the secrets of ${p.constructor.name}!`))}),P.on("goody-hut:action-performed",(s,p)=>{let u=s.tile();if(!!z.getByTile(u).some(c=>c.player()===this.player())){if(p instanceof ts){this.sendNotification("You have discovered scrolls of ancient wisdom...");return}if(p instanceof rs){this.sendNotification("You have discovered an advanced tribe...");return}if(p instanceof os){this.sendNotification("You have discovered valuable treasure...");return}if(p instanceof ns){this.sendNotification("You have discovered a friendly tribe of skilled mercenaries...");return}}}),P.on("player:defeated",(s,p)=>{s===this.player()&&(this.sendNotification("You have been defeated!"),ui.unregister(...ui.entries()),ta.unregister(...ta.entries()),v(this,An).call(this,"restart",null)),this.sendNotification(`${s.civilization().name()} defeated${p?` by ${p.civilization().name()}`:""}.`)}),P.on("city:civil-disorder",s=>{s.player()===this.player()&&this.sendNotification(`Civil disorder in ${s.name()}!`)})}chooseCivilization(r){let o=t(a=>(this.player().setCivilization(new a),this.chooseLeader(this.player().civilization())),"makeChoice");return new Promise((a,s)=>{if(r.length===1){let[p]=r;o(p).then(()=>a());return}v(this,An).call(this,"chooseCivilization",new Jc({choices:r}).toPlainObject()),v(this,Os).call(this,"chooseCivilization",p=>{let[u]=r.filter(y=>y.name===p);if(!u){s(`Invalid civilization ${p} (options: ${r.map(y=>y.name).join(", ")})`);return}o(u).then(()=>a())})})}chooseLeader(r){return new Promise((o,a)=>{let s=Tn.getByCivilization(r.constructor);if(s.length===1){let[p]=s;r.setLeader(new p),o();return}v(this,An).call(this,"chooseLeader",new Jc({choices:s}).toPlainObject()),v(this,Os).call(this,"chooseLeader",p=>{let[u]=s.filter(y=>y.name===p);if(!u){a(`Invalid civilization ${p} (options: ${s.map(y=>y.name).join(", ")})`);return}r.setLeader(new u),o()})})}handleAction(...r){let[o]=r,a=this.player(),s=a.actions(),p=s.filter(f=>f instanceof ni),{name:u,id:y}=o;if(u==="ReassignWorkers"){let[f]=j.getBy("id",o.city);return f&&(Ix(f),v(this,X).update(f.id(),f.toPlainObject(v(this,pe).call(this,Fe(_,ce))))),!1}if(u==="EndTurn")return p.length===1&&p.every(f=>f instanceof nl);if(!u)return console.log("action not specified"),!1;let[c]=s.filter(f=>f.constructor.name===u&&y===(f.value()?f.value().id():void 0));if(!c)return console.log("action not specified"),!1;if(c instanceof Va){let{unitAction:f,target:h}=o,U=c.value(),A=[...U.actions(),...Object.values(U.actionsForNeighbours())].flat().filter(V=>V.constructor.name===f);for(;A.length!==1;){if(A.length===0)return console.log(`action not found: ${f}`),!1;let[V]=ae.getByPlayer(this.player()).filter(se=>se.id()===h);if(!V)return console.log(`tile not found: ${h}`),!1;if(A=A.filter(se=>se.to()===V.tile()),A.length>1&&!h)return console.log(`too many actions found: ${f} (${A.length})`),!1}let[E]=A;return E.perform(),!1}if(c instanceof Ja){let f=c.value();return f.moves().value()>0&&v(this,X).update(f.id(),f.toPlainObject(v(this,pe).call(this,Fe(_,ce)))),f.activate(),!1}if(c instanceof Cn||c instanceof as){let f=c.value(),{chosen:h}=o;if(!h)return console.log("no build item specified"),!1;let[U]=f.available().filter(D=>D.item().name===h);return U?(f.build(U.item()),!1):(console.log(`build item not available: ${h}`),!1)}if(c instanceof ax){let f=c.value(),{chosen:h}=o;if(!h)return this.sendNotification("no build item specified"),!1;let[U]=f.available().filter(D=>D.name===h);return U?(f.research(U),!1):(console.log(`build item not available: ${h}`),!1)}if(c instanceof ps){let f=c.value(),h=si.getByPlayer(this.player());return h.buy(f),v(this,X).update(h.id(),h.toPlainObject(v(this,pe).call(this,Fe(_)))),!1}if(c instanceof cs){let f=c.value(),{chosen:h}=o,[U]=f.available().filter(A=>A.name===h);if(!U)return console.error(`Government type: '${h}' not found.`),!1;f.set(new U);let D=ae.getByPlayer(this.player());return v(this,X).update(D.id(),D.toPlainObject(v(this,pe).call(this,Fe(_)))),j.getByPlayer(this.player()).forEach(A=>v(this,X).update(A.id(),A.toPlainObject(v(this,pe).call(this,Fe(_,ce,Pe))))),!1}if(c instanceof ms){let f=c.value(),{value:h}=o;return f.setAll(h.map(([U,D])=>{let[A]=f.all().filter(E=>E.constructor.name===U);return[A.constructor,D]})),j.getByPlayer(this.player()).forEach(U=>v(this,X).update(U.id(),U.toPlainObject(v(this,pe).call(this,Fe(_,ce,Pe))))),!1}return console.log(`unhandled action: ${JSON.stringify(o)}`),!1}sendInitialData(){let r={player:this.player(),turn:Be,year:hy},o=new Jc(r);v(this,An).call(this,"gameData",o.toPlainObject(v(this,pe).call(this))),De(this,wp,!0)}sendPatchData(){v(this,An).call(this,"gameDataPatch",v(this,X).transferData()),v(this,X).clear()}sendNotification(r){v(this,An).call(this,"gameNotification",{message:r})}takeTurn(){return new Promise((r,o)=>{v(this,wp)||this.sendInitialData(),setTimeout(()=>{v(this,X).update(Be.id(),()=>Be.toPlainObject()),v(this,X).update(hy.id(),()=>hy.toPlainObject()),v(this,X).add(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,Fe(ce,me)))),this.sendPatchData()},1);let a=t((...s)=>{try{if(this.handleAction(...s)){v(this,ml).off("action",a),this.sendPatchData(),setTimeout(()=>r(),100);return}v(this,X).update(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,Fe(Vl,ce,tt)))),this.sendPatchData()}catch(p){o(p)}},"listener");v(this,ml).on("action",a)})}};t(Oy,"DataTransferClient"),pe=new WeakMap,X=new WeakMap,ml=new WeakMap,Os=new WeakMap,An=new WeakMap,wp=new WeakMap;var Bx=Oy;_o();xm();fl();K();ds();var Mt,dg=class{constructor(e){de(this,Mt,void 0);De(this,Mt,e),e.receive("start",()=>{this.bindEvents(),this.start()}),e.receive("setOption",({name:r,value:o})=>{v(this,Mt).send("notification",`setting ${r} to ${o}`),P.setOption(r,o)}),e.receive("getOptions",r=>e.send("getOptions",r.reduce((o,a)=>(o[a]=P.option(a),o),{}))),e.receive("setOptions",r=>{Object.entries(r).forEach(([o,a])=>P.setOption(o,a)),e.send("setOptions")})}bindEvents(){v(this,Mt).send("notification","binding events"),P.on("engine:initialise",()=>v(this,Mt).send("notification","initialising...")),P.on("engine:plugins:load:success",e=>v(this,Mt).send("notification",`loaded plugin: ${e}`)),P.on("engine:plugins-loaded",()=>v(this,Mt).send("notification","plugins loaded")),P.on("engine:start",()=>v(this,Mt).send("notification","starting...")),P.on("world:generate-start-tiles",()=>v(this,Mt).send("notification","generating start tiles...")),P.on("world:built",()=>v(this,Mt).send("notification","world built")),P.on("game:start",()=>v(this,Mt).send("notification","game start")),P.on("turn:start",e=>v(this,Mt).send("notification",`turn start ${e}`)),P.on("player:turn-start",e=>v(this,Mt).send("notification",`player turn-start: ${e.civilization().constructor.name}`))}start(){P.on("engine:start",()=>{new Array(parseInt(P.option("players"),10)).fill(0).forEach((e,r)=>{let o=new _,a=r===0?new Bx(o,(s,p)=>v(this,Mt).send(s,p),(s,p)=>v(this,Mt).receive(s,p)):new Sn(o);ui.register(o),Eo.register(a),v(this,Mt).send("notification","generating world...")})}),P.start(),Promise.resolve().then(()=>(Xk(),wL)).then(()=>P.emit("plugins:load:end"))}};t(dg,"Game"),Mt=new WeakMap;var eS=dg;var gg=class{async request(e){return new Promise(r=>{this.send(e.channel(),...e.args()),this.receiveOnce(e.channel(),o=>r(o))})}};t(gg,"AbstractTransport");var tS=gg;var hg=class extends tS{receive(e,r){addEventListener("message",({data:{channel:o,data:a}})=>{o===e&&r(a)})}receiveOnce(e,r){addEventListener("message",({data:{channel:o,data:a}})=>{o===e&&r(a)},{once:!0})}send(e,r){postMessage({channel:e,data:r})}};t(hg,"ParentTransport");var rS=hg;var GKe=new eS(new rS);})();
//# sourceMappingURL=backend.js.map
