"use strict";(()=>{var mq=Object.create;var ou=Object.defineProperty;var lq=Object.getOwnPropertyDescriptor;var pq=Object.getOwnPropertyNames;var fq=Object.getPrototypeOf,uq=Object.prototype.hasOwnProperty;var t=(o,e)=>ou(o,"name",{value:e,configurable:!0});var i=(o,e)=>()=>(o&&(e=o(o=0)),e);var I=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports),Jc=(o,e)=>{for(var r in e)ou(o,r,{get:e[r],enumerable:!0})},vI=(o,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of pq(e))!uq.call(o,a)&&a!==r&&ou(o,a,{get:()=>e[a],enumerable:!(n=lq(e,a))||n.enumerable});return o};var w=(o,e,r)=>(r=o!=null?mq(fq(o)):{},vI(e||!o||!o.__esModule?ou(r,"default",{value:o,enumerable:!0}):r,o)),R=o=>vI(ou({},"__esModule",{value:!0}),o);var bI=(o,e,r)=>{if(!e.has(o))throw TypeError("Cannot "+r)};var T=(o,e,r)=>(bI(o,e,"read from private field"),r?r.call(o):e.get(o)),ne=(o,e,r)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,r)},ce=(o,e,r,n)=>(bI(o,e,"write to private field"),n?n.call(o,r):e.set(o,r),r),CI=(o,e,r,n)=>({set _(a){ce(o,e,a,r)},get _(){return T(o,e,n)}});var F,Bm,he=i(()=>{F=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return this.#e.some(r=>e instanceof r)}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(n=>{let a=n[e];return a instanceof Function?a.bind(n)()===r:n[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let n=this.#t.indexOf(r);n>-1&&this.#t.splice(n,1)})}};t(F,"EntityRegistry");Bm=F});var $c,re,Nt=i(()=>{$c=class{#e;#t;#r;constructor(e,r,n){this.#e=r,this.#t=n,this.#r=e}data(...e){return this.#t(...e)}key(){return this.#e}type(){return this.#r}};t($c,"AdditionalData");re=$c});var Zc,le,Qt=i(()=>{he();Nt();Zc=class extends F{constructor(){super(re)}getByType(e){return this.filter(r=>r.type()===e||Object.prototype.isPrototypeOf.call(r.type(),e)||Object.prototype.isPrototypeOf.call(r.type().prototype,e))}};t(Zc,"AdditionalDataRegistry");le=new Zc});var cq,Qv,TI=i(()=>{J();cq=t(o=>{let e=o instanceof fe?o.sourceClass():o,r=[];for(;e instanceof Function;)r.push(e),e=Object.getPrototypeOf(e);return r.map(n=>n.name)},"generateInheritance"),Qv=cq});var Qc,yq,iu,k,fe,J=i(()=>{Qt();he();TI();Qc={},yq=t(o=>{let e=o.sourceClass().name,r=Qc[e];return r||(Qc[e]=0),r>=Number.MAX_SAFE_INTEGER&&(Qc[e]=BigInt(r)),e+"-"+(++Qc[e]).toString(36)},"idProvider"),iu=t((o,e,r=a=>a,n=le)=>{if(o=r(o),o instanceof Bm&&(o=o.entries()),Array.isArray(o))return o.map(a=>iu(a,e,r,n));if(o instanceof k){let a=o.id();if(!(a in e)){let s={_:o.sourceClass().name,__:Qv(o)};e[a]=s,o.keys().forEach(m=>{let f=o[m]instanceof Function?o[m]():o[m];s[m]=iu(f,e,r,n)}),n.getByType(o.sourceClass()).forEach(m=>{s[m.key()]=iu(m.data(o),e,r,n)})}return{"#ref":a}}return o instanceof Function?{_:o.name,__:Qv(o)}:o&&o instanceof Object?Object.entries(o).reduce((a,[s,m])=>(a[s]=iu(m,e,r,n),a),{}):o},"toPlainObject"),k=class{#e;#t=["id"];constructor(){this.#e=yq(this)}addKey(...e){this.#t.push(...e)}id(){return this.#e}keys(){return this.#t}sourceClass(){return this.constructor}toPlainObject(e=n=>n,r=le){let n={};return{hierarchy:iu(this,n,e,r),objects:n}}};t(k,"DataObject");fe=k});var ap,$r,vs=i(()=>{J();ap=class extends k{#e;#t;constructor(e,r){super(),this.#e=e,this.#t=r,this.addKey("value")}player(){return this.#e}value(){return this.#t}};t(ap,"PlayerAction");$r=ap});var Xc,_i,hl=i(()=>{vs();Xc=class extends $r{};t(Xc,"MandatoryPlayerAction");_i=Xc});var Aa,Xv=i(()=>{hl();Aa=class extends _i{};t(Aa,"ActiveUnit")});var PI=i(()=>{Xv();Xv()});var Ba,eb=i(()=>{vs();Ba=class extends $r{};t(Ba,"InactiveUnit")});var II=i(()=>{eb();eb()});var wI=i(()=>{PI();II()});var tb=i(()=>{wI()});var Gm,AI=i(()=>{vs();Gm=class extends $r{};t(Gm,"ChangeProduction")});var bs,BI=i(()=>{hl();bs=class extends _i{};t(bs,"CityBuild")});var rb=i(()=>{AI();BI()});var ey,GI,MI=i(()=>{J();ey=class extends k{#e;constructor(e){super(),this.addKey("value"),this.#e=e}value(){return this.#e}};t(ey,"Choice");GI=ey});var Mm,Um,sp=i(()=>{J();MI();Mm=class extends k{#e=[];#t;#r;constructor(e,r,n){super(),this.addKey("choices","data","key"),e.forEach(a=>this.#e.push(new GI(a))),this.#t=n,this.#r=r}choices(){return this.#e}data(){return this.#t}key(){return this.#r}};t(Mm,"ChoiceMeta");Um=Mm});var Dm,UI,ty=i(()=>{Dm=class{#e;#t;constructor(e,r=()=>Math.random()){this.#e=e,this.#t=r}async chooseFromList(e){let r=e.choices();return r[Math.floor(this.#t()*r.length)].value()}player(){return this.#e}async takeTurn(){throw new TypeError("Client#takeTurn must be implemented.")}};t(Dm,"Client");UI=Dm});var ry,xl,oy=i(()=>{ty();ry=class extends Dm{};t(ry,"AIClient");xl=ry});var Em,DI=i(()=>{vs();Em=class extends $r{};t(Em,"AdjustTradeRates")});var ob=i(()=>{DI()});var mp,l,U=i(()=>{mp=class{#e=null;constructor(e){e&&(this.#e=e)}validate(...e){return this.#e===null?!0:this.#e(...e)}};t(mp,"Criterion");l=mp});var iy,ny,ib=i(()=>{U();iy=class extends l{#e=[];constructor(...e){super(),e.forEach(r=>{this.#e.push(r)})}criteria(){return this.#e}validate(...e){return this.#e.every(r=>r.validate(...e))}};t(iy,"Criteria");ny=iy});var ay,Cs,sy=i(()=>{ib();ay=class extends ny{};t(ay,"And");Cs=ay});var my,p,b=i(()=>{my=class{#e;constructor(e){this.#e=e}apply(...e){return this.#e(...e)}};t(my,"Effect");p=my});var ly,pi,km=i(()=>{ly=class{#e;constructor(e=2e3){this.#e=e}value(){return this.#e}};t(ly,"Priority");pi=ly});var Xs,Ts,Ol=i(()=>{km();Xs=class extends pi{constructor(){super(1e3)}};t(Xs,"High");Ts=Xs});var Rt,py,fy=i(()=>{km();Rt=class extends pi{constructor(){super(3e3)}};t(Rt,"Low");py=Rt});var lp,EI=i(()=>{km();lp=class extends pi{constructor(){super(2e3)}};t(lp,"Normal")});var em=i(()=>{Ol();fy();EI()});var uy,x,M=i(()=>{sy();U();b();em();uy=class{#e;#t=!0;#r;#o=new lp;constructor(...e){let r=[];e.forEach(n=>{if(n instanceof p){if(this.#r)throw new TypeError("Rule: effect already specified, but another was provided.");this.#r=n;return}if(n instanceof l){r.push(n);return}this.#o=n}),r.length&&(this.#e=new Cs(...r))}disable(){this.#t=!1}enable(){this.#t=!0}enabled(){return this.#t}priority(){return this.#o}process(...e){if(!!this.#t&&this.#r instanceof p)return this.#r.apply(...e)}validate(...e){return this.#t?this.#e instanceof l?this.#e.validate(...e):!0:!1}};t(uy,"Rule");x=uy});var cy,Ge,Zr=i(()=>{M();cy=class extends x{};t(cy,"Busy");Ge=cy});var tm,nb=i(()=>{hl();tm=class extends _i{};t(tm,"ChooseResearch")});var kI,ab=i(()=>{nb();nb();kI=tm});var Rl,c,SI,A=i(()=>{he();M();Rl=class extends F{#e=new Map;constructor(){super(x)}entries(){return super.entries().sort((e,r)=>e.priority().value()-r.priority().value())}get(e){return this.#e.has(e)||this.#e.set(e,this.filter(r=>r.enabled()&&r instanceof e)),this.#e.get(e)||[]}invalidateCache(e){this.#e.delete(e instanceof x?e.constructor:e)}process(e,...r){return this.get(e).filter(n=>n.validate(...r)).map(n=>n.process(...r))}register(...e){super.register(...e),e.forEach(r=>this.invalidateCache(r))}unregister(...e){super.unregister(...e),e.forEach(r=>this.invalidateCache(r))}};t(Rl,"RuleRegistry");c=new Rl,SI=Rl});var yy,pp,sb=i(()=>{M();yy=class extends x{};t(yy,"CanBeWorked");pp=yy});var dy,gy,mb=i(()=>{M();dy=class extends x{};t(dy,"Created");gy=dy});var hy,Ps,fp=i(()=>{J();A();mb();hy=class extends k{#e;constructor(e=c){super(),this.#e=e,this.#e.process(gy,this)}clone(){return new this.constructor(this.#e)}};t(hy,"Terrain");Ps=hy});var Q,FI=i(()=>{fp();Q=class extends Ps{};t(Q,"Land")});var Qr,lb=i(()=>{fp();Qr=class extends Ps{};t(Qr,"Water")});var Xr=i(()=>{FI();lb()});var Sm,Y,We=i(()=>{J();Sm=class extends k{#e=[];#t=null;constructor(e=0,r="initial"){super(),this.addKey("value","values"),this.add(e,r)}add(e,r=""){if(e instanceof Sm)return this.add(e.value(),r);this.#e.push([e,r]),this.#t=null}clone(){return new this.constructor(this)}set(e,r=""){if(this.#e.splice(0),e instanceof Sm)return this.set(e.value(),r);this.#e.push([e,r]),this.#t=e}subtract(e,r=""){if(e instanceof Sm)return this.subtract(e.value(),r);this.#e.push([-e,r]),this.#t=null}value(){return this.#t===null&&(this.#t=this.#e.reduce((e,[r])=>e+r,0)),this.#t}values(){return this.#e}};t(Sm,"Yield");Y=Sm});var xy,Oy,pb=i(()=>{M();xy=class extends x{};t(xy,"YieldModifier");Oy=xy});var Ry,Ki,fb=i(()=>{M();Ry=class extends x{};t(Ry,"Yield");Ki=Ry});var up,xe,qi=i(()=>{J();Xr();A();nu();We();pb();fb();up=class extends k{#e;#t=[];#r;#o;#i;#n;#a=new Map;constructor(e,r,n,a,s=c){super(),this.#i=e,this.#n=r,this.#o=n,this.#e=a,this.#r=s,this.addKey("terrain","isCoast","isLand","isWater","x","y","yields")}clearYieldCache(e=null){this.#a.delete(e)}getAdjacent(){return this.getAdjacentDirections().map(e=>this.getNeighbour(e))}getAdjacentDirections(){return["n","e","s","w"]}getNeighbour(e){return e==="n"?this.#e.get(this.#i,this.#n-1):e==="ne"?this.#e.get(this.#i+1,this.#n-1):e==="e"?this.#e.get(this.#i+1,this.#n):e==="se"?this.#e.get(this.#i+1,this.#n+1):e==="s"?this.#e.get(this.#i,this.#n+1):e==="sw"?this.#e.get(this.#i-1,this.#n+1):e==="w"?this.#e.get(this.#i-1,this.#n):this.#e.get(this.#i-1,this.#n-1)}getNeighbouringDirections(){return["n","ne","e","se","s","sw","w","nw"]}getNeighbours(){return this.#t.length||(this.#t=this.getNeighbouringDirections().map(e=>this.getNeighbour(e))),this.#t}getSurroundingArea(e=2){return cp.fromSurrounding(this,e)}distanceFrom(e){let r=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[n]=r.map(([a,s])=>Math.hypot(this.#i-e.x()+a*this.#e.width(),this.#n-e.y()+s*this.#e.height())).sort((a,s)=>a-s);return n}isCoast(){let e=this;return e.isWater()&&e.getNeighbours().some(r=>r.isLand())||e.isLand()&&e.getNeighbours().some(r=>r.isWater())}isLand(){return this.#o instanceof Q}isNeighbourOf(e){return this.getNeighbours().includes(e)}isWater(){return this.#o instanceof Qr}map(){return this.#e}score(e=null,r=[[Y,3]]){return this.yields(e).map(a=>{let[s]=r.filter(([f])=>a instanceof f),m=s?s[1]||1:0;return a.value()*m}).reduce((a,s)=>a+s,0)}terrain(){return this.#o}setTerrain(e){this.#o=e}x(){return this.#i}y(){return this.#n}yields(e=null){if(!this.#a.has(e)){let r=this.#r.process(Ki,this,e).flat();this.#r.process(Oy,this,e,r).flat(),this.#a.set(e,r)}return this.#a.get(e)}};t(up,"Tile");xe=up});var yp,cp,nu=i(()=>{he();qi();yp=class extends F{static from(...e){return new this(...e)}static fromSurrounding(e,r=2){let n=t(a=>{let s=[];for(let m=e.x()-a;m<=e.x()+a;m++)for(let f=e.y()-a;f<=e.y()+a;f++)s.push([m,f]);return s},"gen");return this.from(...n(r).map(([a,s])=>e.map().get(a,s)))}constructor(...e){super(up),this.register(...e)}push(...e){this.register(...e)}shift(){let[e]=this.entries();return this.unregister(e),e}score(e=null,r=[]){return this.entries().reduce((n,a)=>n+a.score(e,r),0)}yields(e=null){return this.entries().flatMap(r=>r.yields(e))}};t(yp,"Tileset");cp=yp});var vy,Fm,by=i(()=>{J();vy=class extends fe{#e;#t;constructor(e,r){super(),this.#e=r,this.#t=e,this.addKey("city","tile")}city(){return this.#e}tile(){return this.#t}};t(vy,"WorkedTile");Fm=vy});var Cy,Se,fi=i(()=>{A();sb();he();nu();by();Cy=class extends Bm{#e;constructor(e=c){super(Fm),this.#e=e}getByCity(e){return this.getBy("city",e)}getByTile(e){let[r]=this.getBy("tile",e);return r??null}getTilesByCity(e){return cp.from(...this.filter(r=>r.city()===e).map(r=>r.tile()))}register(...e){e.forEach(r=>{let n=r.tile();if(this.getByTile(n)!==null)throw new TypeError(`Tile ${n.x()}, ${n.y()} is already worked!`);super.register(r)})}tileCanBeWorkedBy(e,r){return this.#e.process(pp,e,r).every(n=>n)}tileIsWorked(e){return!!this.getByTile(e)}unregisterByTile(e){let r=this.getByTile(e);r!==null&&this.unregister(r)}};t(Cy,"WorkedTileRegistry");Se=new Cy});var Ty,eo,vl=i(()=>{M();Ty=class extends x{};t(Ty,"Captured");eo=Ty});var Py,Iy,ub=i(()=>{M();Py=class extends x{};t(Py,"Tiles");Iy=Py});var wy,Gt,dp=i(()=>{M();wy=class extends x{};t(wy,"Cost");Gt=wy});var Ay,Ga,By=i(()=>{M();Ay=class extends x{};t(Ay,"Created");Ga=Ay});var Gy,Uo,bl=i(()=>{M();Gy=class extends x{};t(Gy,"Destroyed");Uo=Gy});var gp,Ma,hp=i(()=>{M();gp=class extends x{};t(gp,"Yield");Ma=gp});var My,Cl,Uy=i(()=>{M();My=class extends x{};t(My,"YieldModifier");Cl=My});var Dy,it,Is=i(()=>{J();A();fi();vl();ub();dp();By();bl();We();hp();Uy();Dy=class extends k{#e=!1;#t;#r;#o;#i;#n;#a;#m;constructor(e,r,n,a=c,s=Se){super(),this.#t=n,this.#r=e,this.#o=e,this.#n=r,this.#i=a,this.#m=s,[this.#a]=this.#i.process(Iy,this),this.#i.process(Ga,this),this.addKey("destroyed","name","originalPlayer","player","tile","tiles","tilesWorked","yields")}capture(e){let r=this.#o;this.#o=e,this.#i.process(eo,this,e,r)}destroy(e=null){this.#e=!0,this.#i.process(Uo,this,e)}destroyed(){return this.#e}name(){return this.#t}setName(e){this.#t=e}originalPlayer(){return this.#r}player(){return this.#o}tile(){return this.#n}tiles(){return this.#a}tilesWorked(){return this.#m.getTilesByCity(this)}yields(){let e=[];return[this.#i.get(Ma),this.#i.get(Cl),this.#i.get(Gt)].flat().forEach(r=>{if(!r.validate(this,e))return;let n=r.process(this,e);if(!!n){if(n instanceof Y){e.push(n);return}n.forEach(a=>e.push(a))}}),e}};t(Dy,"City");it=Dy});var Ey,ky,cb=i(()=>{M();Ey=class extends x{};t(Ey,"Cost");ky=Ey});var Vi,yb,Sy=i(()=>{We();Vi=class extends Y{};t(Vi,"FoodStorage");yb=Vi});var Fy,au,db=i(()=>{M();Fy=class extends x{};t(Fy,"FoodStorage");au=Fy});var Ny,ws,Wy=i(()=>{M();Ny=class extends x{};t(Ny,"Grow");ws=Ny});var Yy,xp,gb=i(()=>{M();Yy=class extends x{};t(Yy,"Shrink");xp=Yy});var Ly,Tl,zy=i(()=>{J();A();cb();Sy();db();Wy();gb();Ly=class extends k{#e;#t=new yb(1/0);#r=new yb;#o;#i=1;constructor(e,r=c){super(),this.#e=e,this.#o=r,this.setCost(),this.addKey("cost","progress","size")}add(e){this.#r.add(e)}check(){this.#o.process(au,this)}city(){return this.#e}cost(){return this.#t}setCost(){let e=this.#o.process(ky,this);e.length>0&&this.#t.set(e[0],"setCost")}empty(){this.#r.subtract(this.#r.value())}grow(){this.#i++,this.#o.process(ws,this)}progress(){return this.#r}shrink(){this.#i--,this.#o.process(xp,this)}size(){return this.#i}};t(Ly,"CityGrowth");Tl=Ly});var Nm,NI,jy=i(()=>{J();A();Nm=class extends k{static build(e,r=c){throw new TypeError("createFromObject: Must be overridden in extending class")}};t(Nm,"Buildable");NI=Nm});var Hy,su,hb=i(()=>{M();Hy=class extends x{};t(Hy,"Created");su=Hy});var _y,K,Ve=i(()=>{jy();A();hb();_y=class extends Nm{#e;#t=!1;#r;constructor(e,r=c){super(),this.addKey("destroyed"),this.#e=e,this.#r=r,this.#r.process(su,this,e)}static build(e,r=c){return new this(e,r)}city(){return this.#e}destroy(){this.#t=!0}destroyed(){return this.#t}};t(_y,"CityImprovement");K=_y});var Ky,Me,to=i(()=>{J();Ky=class extends k{#e;#t;#r;constructor(e,r,n){super(),this.#e=e,this.#t=r,this.#r=n,this.addKey("name","value")}civilization(){return this.#e}name(){return this.#t}value(){return this.#r}};t(Ky,"Attribute");Me=Ky});var Op,Te,Br=i(()=>{he();to();Op=class extends F{constructor(){super(Me)}getByCivilization(e){return this.getBy("civilization",e)}getByName(e){return this.getBy("name",e)}};t(Op,"AttributeRegistry");Te=new Op});var qy,ye,Gr=i(()=>{qy=class{#e;#t;#r=!1;constructor(e,r,n=!1){this.#e=e,this.#t=r,this.#r=n}name(){return this.#e}civilization(){return this.#t}capital(){return this.#r}};t(qy,"CityName");ye=qy});var Vy,ae,Wt=i(()=>{he();Gr();Vy=class extends F{#e=1;#t;constructor(e=()=>Math.random()){super(ye),this.#t=e}takeByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1);return r instanceof ye?(this.unregister(r),r.name()):this.takeUnassociated()}takeCapitalByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1).filter(n=>n.capital());return r instanceof ye?(this.unregister(r),r.name()):this.takeByCivilization(e)}takeUnassociated(){let[e]=this.getBy("civilization",null).sort(()=>Math.floor(this.#t()*3)-1);return e instanceof ye?(this.unregister(e),e.name()):`City #${this.#e++}`}};t(Vy,"CityNameRegistry");ae=new Vy});var Jy,ve,Mr=i(()=>{Br();Wt();J();Jy=class extends k{#e=null;#t;#r=new Op;constructor(e=Te,r=ae){super(),this.#t=r,this.#r.register(...e.getByCivilization(this.sourceClass())),this.addKey("name","leader","attributes")}attributes(){return this.#r.entries()}name(){return this.constructor.name}leader(){return this.#e}setLeader(e){this.#e=e}getCityName(e=!1){let r=this.sourceClass();return e?this.#t.takeCapitalByCivilization(r):this.#t.takeByCivilization(r)}};t(Jy,"Civilization");ve=Jy});var Wm,WI=i(()=>{vs();Wm=class extends ap{};t(Wm,"CompleteProduction")});var xb=i(()=>{WI()});var Pl,Zy,Qy=i(()=>{hl();Pl=class extends _i{};t(Pl,"EndTurn");Zy=Pl});var Xy,ed,Ob=i(()=>{Xy=class{#e={};on(e,r){e in this.#e||(this.#e[e]=[]),this.#e[e].push(r)}once(e,r){let n=t((...a)=>{r(...a),this.off(e,n)},"onceHandler");this.on(e,n)}off(e,r){if(!(e in this.#e))return;let n=this.#e[e].indexOf(r);n!==-1&&this.#e[e].splice(n,1)}emit(e,...r){e in this.#e&&this.#e[e].forEach(n=>n(...r))}};t(Xy,"EventEmitter");ed=Xy});var Xe,As,rm=i(()=>{We();Xe=class extends Y{};t(Xe,"Unhappiness");As=Xe});var Rb,td,ui,Lm=i(()=>{We();Rb=t(o=>o instanceof Y?-o.value():-o,"negate"),td=class extends Y{add(e,r=""){super.add(Rb(e),r)}set(e,r=""){super.set(Rb(e),r)}subtract(e,r=""){super.subtract(Rb(e),r)}};t(td,"NegativeYield");ui=t(o=>{["add","set","subtract"].forEach(e=>Object.defineProperty(o.prototype,e,Object.getOwnPropertyDescriptor(td.prototype,e)||Object.create(null)))},"makeNegative")});var Bs,rd=i(()=>{rm();Lm();Bs=class extends As{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("cityImprovement")}cityImprovement(){return this.#e}};t(Bs,"CityImprovementContent");ui(Bs)});var LI=i(()=>{rd();rd()});var je,ci,Gs=i(()=>{We();je=class extends Y{};t(je,"Gold");ci=je});var de,od=i(()=>{Gs();Lm();de=class extends ci{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("cityImprovement")}cityImprovement(){return this.#e}};t(de,"CityImprovementMaintenanceGold");ui(de)});var zI=i(()=>{od();od()});var oe,om,Ms=i(()=>{We();oe=class extends Y{};t(oe,"Trade");om=oe});var yi,id=i(()=>{Ms();Lm();yi=class extends om{};t(yi,"Corruption");ui(yi)});var jI=i(()=>{id();id()});var X,Ua,Us=i(()=>{We();X=class extends Y{};t(X,"Food");Ua=X});var HI=i(()=>{Us();Us()});var _I=i(()=>{Sy();Sy()});var KI=i(()=>{Gs();Gs()});var Da,nd,Rp=i(()=>{We();Da=class extends Y{};t(Da,"Happiness");nd=Da});var qI=i(()=>{Rp();Rp()});var ro,VI,mu=i(()=>{We();ro=class extends Y{};t(ro,"Luxuries");VI=ro});var JI=i(()=>{mu();mu()});var im,ad=i(()=>{Rp();im=class extends nd{};t(im,"LuxuryHappiness")});var $I=i(()=>{ad();ad()});var Ds,sd=i(()=>{rm();Lm();Ds=class extends As{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ds,"MartialLaw");ui(Ds)});var ZI=i(()=>{sd();sd()});var On,md=i(()=>{rm();On=class extends As{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(On,"MilitaryUnhappiness")});var QI=i(()=>{md();md()});var nm,XI,ld=i(()=>{Us();Lm();nm=class extends Ua{};t(nm,"PopulationSupportFood");ui(nm);XI=nm});var ew=i(()=>{ld();ld()});var am,pd=i(()=>{rm();am=class extends As{};t(am,"PopulationUnhappiness")});var tw=i(()=>{pd();pd()});var $,sm,mm=i(()=>{We();$=class extends Y{};t($,"Production");sm=$});var rw=i(()=>{mm();mm()});var ct,vp=i(()=>{We();ct=class extends Y{};t(ct,"Research")});var ow=i(()=>{vp();vp()});var iw=i(()=>{Ms();Ms()});var nw=i(()=>{rm();rm()});var Ea,aw,fd=i(()=>{Us();Lm();Ea=class extends Ua{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ea,"UnitSupportFood");ui(Ea);aw=Ea});var sw=i(()=>{fd();fd()});var ka,vb,ud=i(()=>{mm();Lm();ka=class extends sm{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(ka,"UnitSupportProduction");ui(ka);vb=ka});var mw=i(()=>{ud();ud()});var cd=i(()=>{LI();zI();jI();HI();_I();KI();qI();JI();$I();ZI();QI();ew();tw();rw();ow();iw();nw();sw();mw()});var lm=i(()=>{cd()});var yd,yt,Sa=i(()=>{M();yd=class extends x{};t(yd,"Action");yt=yd});var dd,Ji,Il=i(()=>{M();dd=class extends x{};t(dd,"Added");Ji=dd});var gd,bb,lw=i(()=>{vs();gd=class extends $r{};t(gd,"HiddenPlayerAction");bb=gd});var hd,q,Do=i(()=>{J();A();Sa();Il();lw();hl();hd=class extends k{#e=null;#t;constructor(e=c){super(),this.#t=e,this.#t.process(Ji,this),this.addKey("actions","civilization","mandatoryActions")}action(){let[e]=this.actions();return e}actions(){return this.#t.process(yt,this).flat().filter(e=>!(e instanceof bb))}civilization(){if(this.#e===null)throw new TypeError("Player#civilization is unset.");return this.#e}hasActions(){return!!this.action()}hasMandatoryActions(){return this.actions().some(e=>e instanceof _i)}hiddenActions(){return this.#t.process(yt,this).flat().filter(e=>e instanceof bb)}mandatoryAction(){let[e]=this.mandatoryActions();return e}mandatoryActions(){return this.actions().filter(e=>e instanceof _i)}setCivilization(e){this.#e=e}};t(hd,"Player");q=hd});var xd,pw,fw=i(()=>{M();xd=class extends x{};t(xd,"Created");pw=xd});var zm,te,Mt=i(()=>{J();zm=class extends k{#e=0;constructor(){super(),this.addKey("value")}increment(){return this.#e++,this.#e}value(){return this.#e}};t(zm,"Turn");te=new zm});var Rn,uw,bp=i(()=>{J();A();Do();fw();Mt();Rn=class extends k{#e=new Set;#t=c;#r=te;#o;constructor(...e){super(),e.forEach(r=>{r instanceof q&&this.#e.add(r),r instanceof Rl&&(this.#t=r),r instanceof zm&&(this.#r=r)}),this.#o=this.#r.value(),this.addKey("players","when"),this.#t.process(pw,this)}isBetween(...e){let r=Array.from(new Set(e));return r.every(n=>this.#e.has(n))&&r.length===this.#e.size}players(){return Array.from(this.#e)}ruleRegistry(){return this.#t}when(){return this.#o}};t(Rn,"Interaction");uw=Rn});var jm,cw,Od=i(()=>{bp();A();jm=class extends Rn{#e;#t;constructor(e,r,n=c){super(...r.players(),n),this.#e=e,this.#t=r,this.addKey("by","for","negotiation")}by(){return this.#e}for(){return this.players().filter(e=>e!==this.#e)}negotiation(){return this.#t}};t(jm,"Action");cw=jm});var Rd,Cp,vd=i(()=>{M();Rd=class extends x{};t(Rd,"Step");Cp=Rd});var bd,Tp,Cb=i(()=>{M();bd=class extends x{};t(bd,"Resolved");Tp=bd});var Pp,Hm,Ip=i(()=>{Od();A();vd();Cb();Pp=class extends jm{#e=null;constructor(e,r,n=c){super(e,r,n),this.addKey("resolution","resolved")}choices(){return this.ruleRegistry().process(Cp,this.negotiation())}resolution(){return this.#e}async resolve(e){this.#e=e,await Promise.all(this.ruleRegistry().process(Tp,e,this))}resolved(){return this.#e!==null}};t(Pp,"Proposal");Hm=Pp});var Cd,vn,lu=i(()=>{Ip();Cd=class extends Hm{};t(Cd,"Initiate");vn=Cd});var wl,yw,Tb=i(()=>{vs();wl=class extends $r{};t(wl,"LaunchSpaceship");yw=wl});var bn,dw=i(()=>{We();bn=class extends Y{};t(bn,"Attack")});var $i,gw=i(()=>{We();$i=class extends Y{};t($i,"Defence")});var Cn,hw,Pb=i(()=>{We();Cn=class extends Y{};t(Cn,"Movement");hw=Cn});var wp,xw=i(()=>{Pb();wp=class extends hw{};t(wp,"Moves")});var _m,Ow=i(()=>{We();_m=class extends Y{};t(_m,"Visibility")});var Ap=i(()=>{dw();gw();Pb();xw();Ow()});var vt,Ib,di,Es,Bp,wb=i(()=>{U();b();M();vt=class extends x{};t(vt,"Action");Ib=vt,di=new l(o=>o.moves().value()>=.1),Es=new l((o,e,r=o.tile())=>r===e),Bp=new l((o,e,r=o.tile())=>e.isNeighbourOf(r))});var Td,Gp,Ab=i(()=>{M();Td=class extends x{};t(Td,"Activate");Gp=Td});var Pd,pm,Id=i(()=>{M();Pd=class extends x{};t(Pd,"Created");pm=Pd});var wd,Fa,pu=i(()=>{M();wd=class extends x{};t(wd,"Destroyed");Fa=wd});var Ad,Bd,Bb=i(()=>{M();Ad=class extends x{};t(Ad,"Visibility");Bd=Ad});var Km,fm,fu,Rw,Mp=i(()=>{Ap();U();b();M();Km=class extends x{};t(Km,"BaseYield");fm=class extends x{};t(fm,"Yield");fu=fm,Rw=t((o,e=1,r=1,n=1,a=1)=>[...[[bn,e],[$i,r],[Cn,n],[_m,a]].flatMap(([s,m])=>[new fm(new l(f=>f instanceof o),new l((f,u)=>u instanceof s),new p((f,u)=>u.set(m))),new Km(new l(f=>f===o),new l((f,u)=>u instanceof s),new p((f,u)=>u.set(m)))])],"unitYield")});var uu,Fe,ks=i(()=>{Ap();jy();A();wb();Ab();Id();pu();Bb();Mp();uu=class extends Nm{#e=!0;#t=null;#r;#o=!1;#i=new wp;#n;#a;#m=null;#s;#l=!1;constructor(e,r,n,a=c){super(),this.#r=e,this.#n=r,this.#s=n,this.#a=a,this.addKey("actions","actionsForNeighbours","active","attack","busy","city","defence","destroyed","movement","moves","player","status","tile","visibility","waiting"),this.#a.process(pm,this)}static build(e,r=c){return new this(e,e.player(),e.tile(),r)}action(e,...r){return e.perform(...r)}actions(e=this.#s,r=this.#s){return typeof e=="string"&&(e=r.getNeighbour(e)),this.#a.process(Ib,this,e,r)}actionsForNeighbours(e=this.#s){return e.getNeighbouringDirections().reduce((r,n)=>({...r,[n]:this.#a.process(Ib,this,e.getNeighbour(n),e)}),{})}activate(){this.#a.process(Gp,this)}active(){return this.#e}setActive(e=!0){this.#e=e}applyVisibility(){this.#s.getSurroundingArea(this.visibility().value()).forEach(e=>{this.#a.process(Bd,e,this.#n)})}attack(){let[e]=this.yield(new bn);return e}busy(){return this.#t}setBusy(e=null){this.#t=e}city(){return this.#r}defence(){let[e]=this.yield(new $i);return e}destroy(e=null){this.#a.process(Fa,this,e)}destroyed(){return this.#o}setDestroyed(){this.#o=!0}movement(){let[e]=this.yield(new Cn);return e}moves(){return this.#i}player(){return this.#n}status(){return this.#m}setStatus(e){this.#m=e}tile(){return this.#s}setTile(e){this.#s=e}visibility(){let[e]=this.yield(new _m);return e}waiting(){return this.#l}setWaiting(e=!0){this.#l=e}yield(...e){let r=this.#a.get(fu);return e.forEach(n=>r.filter(a=>a.validate(this,n)).forEach(a=>a.process(this,n))),e}};t(uu,"Unit");Fe=uu});var Gd,L,He=i(()=>{he();ks();Gd=class extends F{constructor(){super(Fe)}getByCity(e){return this.filter(r=>r.city()===e&&!r.destroyed())}getByPlayer(e,r=!1){return r?this.getBy("player",e):this.filter(n=>n.player()===e&&!n.destroyed())}getByTile(e){return this.filter(r=>r.tile()===e&&!r.destroyed())}};t(Gd,"UnitRegistry");L=new Gd});var Ss,Fs,um=i(()=>{A();J();Ss=class extends k{#e;#t;#r;#o;constructor(e,r,n,a=c){super(),this.#e=e,this.#t=a,this.#r=r,this.#o=n,this.addKey("from","to")}forUnit(e){return new this.constructor(this.#e,this.#r,e,this.#t)}from(){return this.#e}perform(...e){}ruleRegistry(){return this.#t}to(){return this.#r}unit(){return this.#o}};t(Ss,"Action");Fs=Ss});var Md,Na,cu=i(()=>{M();Md=class extends x{};t(Md,"Defeated");Na=Md});var Ud,j,dt=i(()=>{M();Ud=class extends x{};t(Ud,"Moved");j=Ud});var Zi,Gb=i(()=>{A();He();um();cu();dt();Zi=class extends Fs{#e;#t;constructor(e,r,n,a=c,s=L,m=()=>Math.random()){super(e,r,n,a),this.#t=s,this.#e=m}perform(){let[e]=this.#t.getByTile(this.to()).sort((n,a)=>a.defence().value()-n.defence().value()),r=Math.min(1,this.unit().moves().value());if(this.unit().attack().value()*r*this.#e()>=e.defence().value()*this.#e()){this.ruleRegistry().process(Na,e,this.unit(),this),this.unit().moves().subtract(r,this.constructor.name),this.ruleRegistry().process(j,this.unit(),this);return}this.ruleRegistry().process(Na,this.unit(),e,this),this.ruleRegistry().process(j,this.unit(),this)}};t(Zi,"Attack")});var vw=i(()=>{Gb();Gb()});var Dd,bw,Cw=i(()=>{Zr();Dd=class extends Ge{};t(Dd,"BuildingIrrigation");bw=Dd});var Ed,bt,Tn=i(()=>{um();A();Mt();Zr();U();b();dt();Ed=class extends Ss{#e;constructor(e,r,n,a=c,s=te){super(e,r,n,a),this.#e=s}perform(e,r=()=>{},n=Ge){let a=this.#e.value()+e;this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new n(new l(()=>this.#e.value()===a),new p((...s)=>{let m=this.unit();m.setActive(),m.setBusy(),r(...s),this.ruleRegistry().process(j,this.unit(),this)})))}};t(Ed,"DelayedAction");bt=Ed});var kd,cm,Sd=i(()=>{M();kd=class extends x{};t(kd,"Built");cm=kd});var Fd,Wa,Al=i(()=>{J();A();Sd();Fd=class extends k{#e;constructor(e,r=c){super(),this.#e=e,r.process(cm,e,this)}tile(){return this.#e}};t(Fd,"TileImprovement");Wa=Fd});var Ue,Tw,Nd=i(()=>{Al();Ue=class extends Wa{};t(Ue,"Irrigation");Tw=Ue});var Wd,we,gi=i(()=>{M();Wd=class extends x{};t(Wd,"MovementCost");we=Wd});var Ya,Mb=i(()=>{Cw();Tn();Nd();dt();gi();Ya=class extends bt{perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e||0,()=>{new Tw(this.unit().tile())},bw),this.ruleRegistry().process(j,this.unit(),this)}};t(Ya,"BuildIrrigation")});var Pw=i(()=>{Mb();Mb()});var Yd,Iw,ww=i(()=>{Zr();Yd=class extends Ge{};t(Yd,"BuildingMine");Iw=Yd});var et,Aw,Ld=i(()=>{Al();et=class extends Wa{};t(et,"Mine");Aw=et});var La,Ub=i(()=>{ww();Tn();Ld();dt();gi();La=class extends bt{perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e||0,()=>{new Aw(this.unit().tile())},Iw),this.ruleRegistry().process(j,this.unit(),this)}};t(La,"BuildMine")});var Bw=i(()=>{Ub();Ub()});var zd,Gw,Mw=i(()=>{Zr();zd=class extends Ge{};t(zd,"BuildingRailroad");Gw=zd});var Xt,Uw,jd=i(()=>{Al();Xt=class extends Wa{};t(Xt,"Railroad");Uw=Xt});var za,Db=i(()=>{Mw();Tn();dt();gi();jd();za=class extends bt{perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e||0,()=>{new Uw(this.unit().tile())},Gw),this.ruleRegistry().process(j,this.unit(),this)}};t(za,"BuildRailroad")});var Dw=i(()=>{Db();Db()});var Hd,Ew,kw=i(()=>{Zr();Hd=class extends Ge{};t(Hd,"BuildingRoad");Ew=Hd});var Ye,Sw,_d=i(()=>{Al();Ye=class extends Wa{};t(Ye,"Road");Sw=Ye});var ja,Eb=i(()=>{kw();Tn();dt();gi();_d();ja=class extends bt{perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e||0,()=>{new Sw(this.unit().tile())},Ew),this.ruleRegistry().process(j,this.unit(),this)}};t(ja,"BuildRoad")});var Fw=i(()=>{Eb();Eb()});var Kd,yu,kb=i(()=>{M();Kd=class extends x{};t(Kd,"ValidateMove");yu=Kd});var nt,qm,Bl=i(()=>{um();dt();gi();kb();nt=class extends Ss{perform(){return this.validate()?(this.unit().setTile(this.to()),this.ruleRegistry().process(j,this.unit(),this),!0):!1}movementCost(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>r-n);return e}validate(){let[e]=this.ruleRegistry().process(yu,this.unit(),this.movementCost());return e}};t(nt,"Move");qm=nt});var Ha,Sb=i(()=>{A();Bl();Ha=class extends qm{#e;constructor(e,r,n,a,s=c){super(e,r,n,s),this.#e=a}perform(){return super.perform()?(this.#e.capture(this.unit().player()),!0):!1}};t(Ha,"CaptureCity")});var Nw=i(()=>{Sb();Sb()});var qd,at,Qi=i(()=>{J();qd=class extends fe{#e;constructor(e){super(),this.#e=e}clone(e=this.terrain()){return new this.constructor(e)}terrain(){return this.#e}};t(qd,"TerrainFeature");at=qd});var Fb,Vd,Yt,_a=i(()=>{he();Qi();Fb=new Map,Vd=class extends F{constructor(){super(at)}getByTerrain(e){return Fb.has(e)||Fb.set(e,this.getBy("terrain",e)),Fb.get(e)}};t(Vd,"TerrainFeatureRegistry");Yt=new Vd});var Jd,Ww,Yw=i(()=>{Zr();Jd=class extends Ge{};t(Jd,"ClearingForest");Ww=Jd});var pe,Up,Dp=i(()=>{Xr();pe=class extends Q{};t(pe,"Plains");Up=pe});var Ka,Nb=i(()=>{A();_a();Mt();Yw();Tn();dt();gi();Dp();Ka=class extends bt{#e;constructor(e,r,n,a=c,s=Yt,m=te){super(e,r,n,a,m),this.#e=s}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{let r=new Up,n=this.#e.getByTerrain(this.from().terrain());this.#e.register(...n.map(a=>a.clone(r))),this.#e.unregister(...n),this.from().setTerrain(r)},Ww),this.ruleRegistry().process(j,this.unit(),this)}};t(Ka,"ClearForest")});var Lw=i(()=>{Nb();Nb()});var $d,zw,jw=i(()=>{Zr();$d=class extends Ge{};t($d,"ClearingJungle");zw=$d});var du,Vm,Hw,Ep=i(()=>{_a();U();b();M();du=class extends x{};t(du,"Feature");Vm=du,Hw=t((o,e,r=.2,n=Yt,a=()=>Math.random())=>[new du(new l(s=>s===e),new l((s,m)=>m instanceof o),new l(()=>a()<=r),new p((s,m)=>n.register(new s(m))))],"feature")});var Oe,Jm,Gl=i(()=>{Xr();Oe=class extends Q{};t(Oe,"Grassland");Jm=Oe});var hi,Zd,gu=i(()=>{Qi();hi=class extends at{};t(hi,"Shield");Zd=hi});var qa,Wb=i(()=>{A();_a();Mt();jw();Tn();Ep();Gl();dt();gi();gu();qa=class extends bt{#e;constructor(e,r,n,a=c,s=Yt,m=te){super(e,r,n,a,m),this.#e=s}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{let r=new Jm,n=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(Vm,Zd,r),this.#e.unregister(...n),this.from().setTerrain(r)},zw),this.ruleRegistry().process(j,this.unit(),this)}};t(qa,"ClearJungle")});var _w=i(()=>{Wb();Wb()});var Qd,Kw,qw=i(()=>{Zr();Qd=class extends Ge{};t(Qd,"ClearingSwamp");Kw=Qd});var Va,Yb=i(()=>{A();_a();Mt();qw();Tn();Ep();Gl();dt();gi();gu();Va=class extends bt{#e;constructor(e,r,n,a=c,s=Yt,m=te){super(e,r,n,a,m),this.#e=s}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{let r=new Jm,n=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(Vm,Zd,r),this.#e.unregister(...n),this.from().setTerrain(r)},Kw),this.ruleRegistry().process(j,this.unit(),this)}};t(Va,"ClearSwamp")});var Vw=i(()=>{Yb();Yb()});var ym,Lb=i(()=>{um();dt();ym=class extends Fs{perform(){this.unit().destroy(),this.ruleRegistry().process(j,this.unit(),this)}};t(ym,"Disband")});var Jw=i(()=>{Lb();Lb()});var Ja,zb=i(()=>{A();Bl();Ja=class extends qm{#e;constructor(e,r,n,a,s=c){super(e,r,n,s),this.#e=a}perform(){return super.perform()?(this.unit().moves().set(0),this.#e.unload(this.unit()),!0):!1}};t(Ja,"Disembark")});var $w=i(()=>{zb();zb()});var Xd,Zw,Qw=i(()=>{Zr();U();Xd=class extends Ge{constructor(){super(new l(()=>!1))}};t(Xd,"Stowed");Zw=Xd});var dm,jb=i(()=>{A();Bl();dt();Qw();dm=class extends qm{#e;constructor(e,r,n,a,s=c){super(e,r,n,s),this.#e=a}perform(){return super.perform()?(this.#e.stow(this.unit(),this.from()),this.unit().setBusy(new Zw),this.unit().setActive(!1),this.ruleRegistry().process(j,this.unit(),this),!0):!1}};t(dm,"Embark")});var Xw=i(()=>{jb();jb()});var eg,kp,tg=i(()=>{J();eg=class extends fe{#e;constructor(e){super(),this.#e=e}unit(){return this.#e}};t(eg,"UnitImprovement");kp=eg});var rg,oo,gm=i(()=>{he();tg();rg=class extends F{constructor(){super(kp)}getByUnit(e){return this.getBy("unit",e)}};t(rg,"UnitImprovementRegistry");oo=new rg});var og,eA,tA=i(()=>{Zr();og=class extends Ge{};t(og,"Fortified");eA=og});var Eo,rA,ig=i(()=>{tg();Eo=class extends kp{};t(Eo,"Fortified");rA=Eo});var ng,oA,iA=i(()=>{Zr();ng=class extends Ge{};t(ng,"Fortifying");oA=ng});var $a,Hb=i(()=>{A();Mt();gm();tA();U();Tn();ig();iA();dt();gi();$a=class extends bt{#e;constructor(e,r,n,a=c,s=te,m=oo){super(e,r,n,a,s),this.#e=m}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{this.unit().moves().set(0),this.unit().setActive(!1),this.unit().setBusy(new eA(new l(()=>!1))),this.#e.register(new rA(this.unit()))},oA),this.ruleRegistry().process(j,this.unit(),this)}};t($a,"Fortify")});var nA=i(()=>{Hb();Hb()});var hm,_b=i(()=>{Wt();A();fi();um();Is();dt();hm=class extends Fs{#e;#t;constructor(e,r,n,a=ae,s=c,m=Se){super(e,r,n,s),this.#e=a,this.#t=m}perform(){new it(this.unit().player(),this.unit().tile(),this.#e.takeCapitalByCivilization(this.unit().player().civilization().constructor),this.ruleRegistry(),this.#t),this.unit().destroy(),this.ruleRegistry().process(j,this.unit(),this)}};t(hm,"FoundCity")});var aA=i(()=>{_b();_b()});var st,sA,Pn=i(()=>{st=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return typeof e=="function"&&this.#e.some(r=>Object.prototype.isPrototypeOf.call(r,e)||Object.prototype.isPrototypeOf.call(r.prototype,e))}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(n=>{let a=n[e];return a instanceof Function?a.bind(n)()===r:n[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let n=this.#t.indexOf(r);n>-1&&this.#t.splice(n,1)})}};t(st,"ConstructorRegistry");sA=st});var Sp,mA,Kb=i(()=>{Sp=class{#e;#t;#r;constructor(e,r,n){this.#e=n,this.#t=r,this.#r=e}end(){return this.#e}generate(){throw new Error(`PathFinder#generate: Must be overridden in '${this.constructor.name}'.`)}start(){return this.#t}unit(){return this.#r}};t(Sp,"PathFinder");mA=Sp});var ag,Ns,Fp=i(()=>{Pn();Kb();ag=class extends st{constructor(){super(mA)}};t(ag,"PathFinderRegistry");Ns=new ag});var Np,lA,qb,Vb=i(()=>{J();Np=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}key(){return this.#e}value(){return this.#t}};t(Np,"StrategyNote");lA=t((...o)=>o.map(e=>e instanceof k?e.id():typeof e=="string"?e:e.toString()).join("-"),"generateKey"),qb=Np});var sg,$m,hu=i(()=>{he();Vb();sg=class extends F{constructor(){super(qb)}getByKey(e){return this.getBy("key",e)[0]}getOrCreateByKey(e,r){let n=this.getByKey(e);if(n)return n;let a=new qb(e,r);return this.register(a),a}register(...e){e.forEach(r=>{if(this.getByKey(r.key()))throw new TypeError(`Entity with key '${r.key()}' already exists.`);super.register(r)})}replace(...e){e.forEach(r=>{let n=this.getByKey(r.key());n&&this.unregister(n),this.register(r)})}};t(sg,"StrategyNoteRegistry");$m=new sg});var mg,lg,Jb=i(()=>{Zr();mg=class extends Ge{};t(mg,"GoTo");lg=mg});var pg,pA,fA=i(()=>{pg=class extends Error{};t(pg,"NoPathAvailable");pA=pg});var fg,uA,cA=i(()=>{fg=class extends Error{};t(fg,"NoPathFinderAvailable");uA=fg});var In,yA,ug=i(()=>{um();In=class extends Ss{perform(){this.unit().moves().subtract(this.unit().moves())}};t(In,"NoOrders");yA=In});var dq,cg,$b=i(()=>{hu();Bl();ug();Ou();dq=t((o,e,r=$m)=>{for(;o.moves().value()>.25;){let[a]=o.actions(e.shift()).filter(s=>s instanceof qm);if(!a)break;a.perform()}if(e.length===0){o.setBusy(),o.setActive();let a=r.getByKey(xu(o));a&&r.unregister(a)}if(o.moves().value()>.25)return;let[n]=o.actions().filter(a=>a instanceof yA);if(n){n.perform();return}o.moves().set(0),o.setActive(!1)},"moveAlongPath"),cg=dq});var xu,xm,Ou=i(()=>{Fp();A();Vb();hu();um();Jb();U();b();dt();fA();cA();$b();xu=t(o=>lA(o,"currentPath"),"generateKey"),xm=class extends Fs{#e;#t;constructor(e,r,n,a=c,s=Ns,m=$m){super(e,r,n,a),this.#e=s,this.#t=m}perform(){let[e]=this.#e.entries();if(!e)throw new uA;let r=new e(this.unit(),this.unit().tile(),this.to()).generate();if(!r)throw new pA;this.unit().setBusy(),r.shift(),this.#t.replace(new Np(xu(this.unit()),r)),cg(this.unit(),r),this.unit().setBusy(new lg(new l(()=>this.unit().tile()===r.end()),new p(()=>{this.unit().setActive(),this.unit().setBusy()}))),this.ruleRegistry().process(j,this.unit(),this)}};t(xm,"GoTo")});var dA=i(()=>{Ou();Ou()});var gA=i(()=>{Bl();Bl()});var hA=i(()=>{ug();ug()});var yg,Je,xi=i(()=>{he();Al();yg=class extends F{constructor(){super(Wa)}getByTile(e){return this.getBy("tile",e)}};t(yg,"TileImprovementRegistry");Je=new yg});var Za,Zb=i(()=>{A();xi();Mt();Tn();dt();gi();Za=class extends bt{#e;constructor(e,r,n,a=c,s=Je,m=te){super(e,r,n,a,m),this.#e=s}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{let[r]=this.#e.getByTile(this.from());this.#e.unregister(r)}),this.ruleRegistry().process(j,this.unit(),this)}};t(Za,"Pillage")});var xA=i(()=>{Zb();Zb()});var $e,dg,Ru=i(()=>{Xr();$e=class extends Q{};t($e,"Forest");dg=$e});var ko,OA,gg=i(()=>{Qi();ko=class extends at{};t(ko,"Horse");OA=ko});var hg,RA,vA=i(()=>{Zr();hg=class extends Ge{};t(hg,"PlantingForest");RA=hg});var Qa,Qb=i(()=>{A();_a();Mt();Tn();Ep();Ru();gg();dt();gi();vA();Qa=class extends bt{#e;constructor(e,r,n,a=c,s=Yt,m=te){super(e,r,n,a,m),this.#e=s}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{let r=new dg,n=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(Vm,OA,r),this.#e.unregister(...n),this.from().setTerrain(r)},RA),this.ruleRegistry().process(j,this.unit(),this)}};t(Qa,"PlantForest")});var bA=i(()=>{Qb();Qb()});var xg,CA,TA=i(()=>{Zr();xg=class extends Ge{};t(xg,"Sleeping");CA=xg});var wn,PA,Og=i(()=>{A();Mt();He();U();Tn();b();TA();wn=class extends bt{#e;constructor(e,r,n,a=c,s=te,m=L){super(e,r,n,a,s),this.#e=m}perform(){this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new CA(new l(()=>this.from().getSurroundingArea(this.unit().visibility().value()).some(e=>this.#e.getByTile(e).some(r=>r.player()!==this.unit().player()))),new p(()=>{this.unit().setActive(),this.unit().setBusy()})))}};t(wn,"Sleep");PA=wn});var IA=i(()=>{Og();Og()});var Xa,wA=i(()=>{A();He();vu();Xa=class extends Zi{#e;constructor(e,r,n,a,s=c,m=L){super(e,r,n,s,m),this.#e=a,this.addKey("enemy")}enemy(){return this.#e}};t(Xa,"SneakAttack")});var An,AA=i(()=>{A();vu();An=class extends Ha{#e;constructor(e,r,n,a,s,m=c){super(e,r,n,a,m),this.#e=s,this.addKey("enemy")}enemy(){return this.#e}};t(An,"SneakCaptureCity")});var Om,Xb=i(()=>{um();dt();Om=class extends Fs{perform(){this.unit().setWaiting(),this.unit().cargo().forEach(e=>{e.moves().set(e.movement()),e.activate()}),this.ruleRegistry().process(j,this.unit(),this)}};t(Om,"Unload")});var BA=i(()=>{Xb();Xb()});var vu=i(()=>{vw();Pw();Bw();Dw();Fw();Nw();Lw();_w();Vw();Jw();$w();Xw();nA();aA();dA();gA();hA();xA();bA();IA();wA();AA();BA()});var Ml=i(()=>{vu()});var Rg,vg,eC=i(()=>{M();Rg=class extends x{};t(Rg,"Interaction");vg=Rg});var bg,Rm,Cg=i(()=>{Od();bg=class extends cw{};t(bg,"Terminate");Rm=bg});var Tg,GA,MA=i(()=>{Tg=class extends Error{};t(Tg,"Terminated");GA=Tg});var Pg,tC,UA=i(()=>{Pg=class extends Error{};t(Pg,"Unsupported");tC=Pg});var Ig,Wp,rC=i(()=>{bp();eC();Do();vd();Cg();MA();UA();Ig=class extends Rn{#e=[];constructor(...e){if(e.filter(n=>n instanceof q).length!==2)throw new tC;super(...e);let[r]=e.filter(n=>n instanceof q);if(!r)throw new tC("Not enough `Player`s for `Negotiation`.");this.addKey("interactions","lastInteraction","terminated")}interactions(){return this.#e}lastInteraction(){return this.#e.length===0?null:this.#e[this.#e.length-1]}nextSteps(){let e=this.ruleRegistry().process(Cp,this);return e.length===0&&e.push(new Rm(this.players()[0],this,this.ruleRegistry())),e}proceed(e){if(this.terminated())throw new GA;this.#e.push(e),this.ruleRegistry().process(vg,e,this)}terminated(){return this.#e.some(e=>e instanceof Rm)}};t(Ig,"Negotiation");Wp=Ig});var Ag,Bg,oC=i(()=>{M();Ag=class extends x{};t(Ag,"Yield");Bg=Ag});var Gg,Ct,es=i(()=>{A();jy();oC();Gg=class extends NI{#e;#t;constructor(e,r=c){super(),this.#e=e,this.#t=r,this.addKey("city","yields")}static build(e,r=c){return new this(e,r)}city(){return this.#e}yields(){return this.#t.process(Bg,this).flat()}};t(Gg,"Part");Ct=Gg});var Mg,Zm,iC=i(()=>{Qt();J();qi();Mg=class extends k{#e={};#t;#r;#o;constructor(e,r,n=le){super(),this.#t=n,this.#r=r,this.#o=e,this.addKey("isCoast","isLand","isWater","terrain","x","y","yields"),this.setAdditionalData()}addKey(...e){super.addKey(...e)}isCoast(){return this.#o.isCoast()}isLand(){return this.#o.isLand()}isWater(){return this.#o.isWater()}player(){return this.#r}setAdditionalData(){this.#t.getByType(xe).forEach(e=>{this.#e[e.key()]=e.data(this.#o),Object.defineProperty(this,e.key(),{configurable:!0,value:()=>e.data(this.#o)}),this.addKey(e.key())})}terrain(){return this.#o.terrain()}tile(){return this.#o}update(){this.#o.clearYieldCache(this.#r),this.setAdditionalData()}x(){return this.#o.x()}y(){return this.#o.y()}yields(){return this.#o.yields(this.#r)}};t(Mg,"PlayerTile");Zm=Mg});var Ug,DA,EA=i(()=>{fp();Ug=class extends Ps{};t(Ug,"Unknown");DA=Ug});var Dg,kA,SA=i(()=>{qi();EA();Dg=class extends xe{constructor(e,r,n){super(e,r,new DA,n)}};t(Dg,"UndiscoveredTile");kA=Dg});var Eg,kg,nC=i(()=>{M();Eg=class extends x{};t(Eg,"VisibilityChanged");kg=Eg});var Sg,Ul,Fg=i(()=>{J();A();iC();qi();SA();nC();Sg=class extends k{#e;#t;#r=[];#o;constructor(e,r,n=c){super(),this.#e=e,this.#o=r,this.#t=n,this.addKey("height","tiles","width")}entries(){return this.#r}filter(e){return this.entries().filter(e)}forEach(e){return this.#r.forEach(e)}get(e,r){let[n]=this.entries().filter(a=>a.x()===e&&a.y()===r);return n||new kA(e,r,this.#o)}getByTile(e){let[r]=this.filter(n=>n.tile()===e);return r??null}height(){return this.#o.height()}includes(e){return e instanceof xe?!!this.getByTile(e):this.#r.includes(e)}map(e){return this.#r.map(e)}player(){return this.#e}register(...e){e.forEach(r=>{this.includes(r)||(this.#r.push(new Zm(r,this.#e)),this.#t.process(kg,r,this.player()))})}tiles(){return this.entries()}width(){return this.#o.width()}};t(Sg,"PlayerWorld");Ul=Sg});var Yg,Bn,Dl=i(()=>{Od();A();Yg=class extends jm{#e;constructor(e,r,n=c){super(e,r.negotiation(),n),this.#e=r,this.addKey("proposal")}proposal(){return this.#e}};t(Yg,"Resolution");Bn=Yg});var ts,aC=i(()=>{vs();ts=class extends $r{};t(ts,"Revolution")});var WA=i(()=>{aC();aC()});var YA=i(()=>{WA()});var sC=i(()=>{YA()});var jg,ie,er=i(()=>{he();zy();jg=class extends F{constructor(){super(Tl)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of CityGrowths returned.");return r[0]}};t(jg,"CityGrowthRegistry");ie=new jg});var De,Ae,Le=i(()=>{Ve();De=class extends K{};t(De,"Wonder");Ae=De});var qg,C,E=i(()=>{J();qg=class extends fe{};t(qg,"Advance");C=qg});var Vg,v,D=i(()=>{E();Pn();Vg=class extends st{constructor(){super(C)}};t(Vg,"AdvanceRegistry");v=new Vg});var Jg,Z,mt=i(()=>{he();Is();Jg=class extends F{constructor(){super(it)}getByPlayer(e,r=!1){return r?this.getBy("player",e):this.filter(n=>n.player()===e&&!n.destroyed())}getByTile(e){let[r]=this.filter(n=>n.tile()===e&&!n.destroyed());return r??null}};t(Jg,"CityRegistry");Z=new Jg});var $g,Lt,rs=i(()=>{he();ty();$g=class extends F{constructor(){super(UI)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of Clients for Player.");return r[0]}};t($g,"ClientRegistry");Lt=new $g});var _p,Xi,Qm=i(()=>{he();Do();_p=class extends F{constructor(){super(q)}};t(_p,"PlayerRegistry");Xi=new _p});var Zg,os,Kp=i(()=>{Qm();Zg=class extends _p{};t(Zg,"CurrentPlayerRegistry");os=new Zg});var Qg,P,ee=i(()=>{Ob();Qg=class extends ed{#e={};#t=!1;debug(e){if(!!this.option("debug"))return e()}emit(e,...r){return this.debug(()=>console.log(`Engine#emit: ${String(e)}: ${r}`)),super.emit(e,...r)}loadPlugins(){return this.emit("plugins:load:start"),new Promise((e,r)=>{this.once("plugins:load:end",()=>e())})}option(e,r=null){return this.#e[e]||r}setOption(e,r){this.#e[e]!==r&&(this.#e[e]=r,this.emit("option:changed",e,r))}start(){this.#t||(this.#t=!0,this.emit("engine:initialise"),this.loadPlugins().then(()=>{this.emit("engine:start")}))}};t(Qg,"Engine");P=new Qg});var Xg,Ur,vm=i(()=>{he();bp();Xg=class extends F{constructor(){super(Rn)}getByPlayer(e){return this.entries().filter(r=>r.players().includes(e))}getByPlayers(...e){return this.entries().filter(r=>r.isBetween(...e))}};t(Xg,"InteractionRegistry");Ur=new Xg});var eh,Xm,th=i(()=>{M();eh=class extends x{};t(eh,"Complete");Xm=eh});var rh,oh,fC=i(()=>{M();rh=class extends x{};t(rh,"Cost");oh=rh});var ih,nh,uC=i(()=>{M();ih=class extends x{};t(ih,"Requirements");nh=ih});var El,KA=i(()=>{We();El=class extends Y{};t(El,"Research")});var qA=i(()=>{KA()});var ah,qp,sh=i(()=>{M();ah=class extends x{};t(ah,"Started");qp=ah});var mh,Vp,lh=i(()=>{D();J();A();th();fC();uC();qA();sh();mh=class extends k{#e;#t=[];#r=null;#o;#i=new El(1/0);#n=new El(0);#a;constructor(e,r=v,n=c){super(),this.#e=r,this.#o=e,this.#a=n,this.addKey("available","complete","cost","progress","researching")}add(e){this.#n.add(e),this.check()}addAdvance(e){if(this.#t.some(n=>n instanceof e))return;this.#r===e&&(this.#r=null);let r=new e;this.#t.push(r),this.#a.process(Xm,this,r)}available(){let e=this.#a.get(nh);return this.#e.filter(r=>e.filter(n=>n.validate(r,this.#t)).every(n=>n.process(r,this.#t)===!0)&&!this.#t.some(n=>n instanceof r))}check(){if(this.#r!==null&&this.#n.value()>=this.#i.value()){let e=new this.#r;this.#t.push(e),this.#r=null,this.#n.subtract(this.#i),this.#i.set(1/0),this.#a.process(Xm,this,e)}}complete(){return this.#t}completed(e){return this.#t.some(r=>r instanceof e)}cost(){return this.#i}player(){return this.#o}progress(){return this.#n}research(e){let[r]=this.#a.process(oh,e,this);this.#i.set(r),this.#r=e,this.#a.process(qp,this,e)}researching(){return this.#r}};t(mh,"PlayerResearch");Vp=mh});var ph,H,_e=i(()=>{he();lh();ph=class extends F{constructor(){super(Vp)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of results for player.");return r[0]}};t(ph,"PlayerResearchRegistry");H=new ph});var fh,Gn,kl=i(()=>{he();fh=class extends F{constructor(){super(Function)}accepts(e){return"build"in e}};t(fh,"AvailableCityBuildItemsRegistry");Gn=new fh});var Dt,VA,Jp=i(()=>{U();M();Dt=class extends x{process(e,r){let n=super.process(e,r);if(!(n instanceof mp))throw new TypeError("Invalid build rule.");return n}};t(Dt,"Build");VA=Dt});var uh,ch,cC=i(()=>{J();uh=class extends fe{#e;constructor(e){super(),this.addKey("value"),this.#e=e}value(){return this.#e}};t(uh,"BuildCost");ch=uh});var Fu,JA,el,gq,$p=i(()=>{cC();U();b();M();Fu=class extends x{};t(Fu,"BuildCost");JA=Fu,el=t((o,e)=>gq([[o,e]]),"buildCost"),gq=t(o=>o.map(([e,r])=>new Fu(new l(n=>n.item()===e),new p(()=>new ch(r)))),"buildCosts")});var yh,dh,yC=i(()=>{A();cC();$p();J();yh=class extends fe{#e;#t=new ch(1/0);#r;#o;constructor(e,r=null,n=c){super(),this.#r=e,this.#e=r,this.#o=n,this.addKey("cost","item")}cost(){if(!Number.isFinite(this.#t.value())){let[e]=this.#o.process(JA,this,this.#e);e&&(this.#t=e)}return this.#t}item(){return this.#r}};t(yh,"BuildItem");dh=yh});var Sl,$A=i(()=>{We();Sl=class extends Y{};t(Sl,"BuildProgress")});var ZA=i(()=>{$A()});var gh,QA,XA=i(()=>{M();gh=class extends x{};t(gh,"BuildingCancelled");QA=gh});var hh,en,Zp=i(()=>{M();hh=class extends x{};t(hh,"BuildingComplete");en=hh});var xh,tl,Nu=i(()=>{kl();J();A();Jp();yC();ZA();XA();Zp();xh=class extends k{#e;#t=null;#r;#o=new Sl(1/0);#i=new Sl;#n;constructor(e,r=Gn,n=c){super(),this.#e=r,this.#r=e,this.#n=n,this.addKey("available","building","city","cost","progress","remaining")}add(e){this.#i.add(e)}available(){let e=this.#n.get(VA);return this.#e.filter(r=>e.filter(n=>n.validate(this.city(),r)).every(n=>n.process(this.city(),r).validate())).map(r=>new dh(r,this.city(),this.#n))}build(e){let r=this.getAvailable(e);if(!r)throw new TypeError(`Cannot build ${e.name}, it's not available.`);this.#t=r,this.#o.set(this.#t.cost().value())}building(){return this.#t}check(){if(this.#i.value()>=this.#o.value()&&this.#t){let e=this.#t.item().build(this.#r,this.#n);return this.#i.set(0),this.#t=null,this.#o.set(1/0),this.#n.process(en,this,e),e}return null}city(){return this.#r}cost(){return this.#o}getAvailable(e){return this.available().filter(r=>r.item()===e)[0]}progress(){return this.#i}remaining(){return this.#o.value()-this.#i.value()}revalidate(){this.#t&&!this.getAvailable(this.#t.item())&&(this.#t=null,this.#o.set(1/0),this.#n.process(QA,this))}};t(xh,"CityBuild");tl=xh});var Oh,zt,is=i(()=>{he();Nu();Oh=class extends F{constructor(){super(tl)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of entities returned.");return r[0]}};t(Oh,"CityBuildRegistry");zt=new Oh});var Rh,Mn,Wu=i(()=>{M();Rh=class extends x{};t(Rh,"Spend");Mn=Rh});var vh,eB,tB=i(()=>{M();vh=class extends x{};t(vh,"Rush");eB=vh});var bh,Ch,dC=i(()=>{is();A();J();Wu();We();tB();bh=class extends fe{#e;#t;#r;#o=0;#i;constructor(e,r,n=zt,a=c){super(),this.addKey("value","yield"),this.#e=n,this.#t=e,this.#r=a,this.#i=r}add(e){if(e instanceof Y){this.add(e.value());return}this.#o+=e}buy(e){let r=this.#e.getByCity(e),[n]=this.cost(e).filter(s=>s.resource()===this.#i),a=n.value();e.player()!==this.#t||this.value()<a||(this.#r.process(eB,r,n),r.add(new Y(r.remaining())),this.subtract(a))}cost(e){let r=this.#e.getByCity(e);return this.#r.process(Mn,r)}player(){return this.#t}set(e){this.#o=0,this.add(e)}subtract(e){if(e instanceof Y){this.add(e.value());return}this.#o-=e}value(){return this.#o}yield(){return this.#i}};t(bh,"PlayerTreasury");Ch=bh});var Th,tn,Fl=i(()=>{he();dC();Th=class extends F{constructor(){super(Ch)}getByPlayer(e){return this.getBy("player",e)}getByPlayerAndType(e,r){let n=this.filter(a=>a.player()===e&&a.yield()===r);if(n.length!==1)throw new TypeError(`Wrong number of playerTreasuries: ${n.length}`);return n[0]}};t(Th,"PlayerTreasuryRegistry");tn=new Th});var Ph,se,Oi=i(()=>{he();Fg();Ph=class extends F{constructor(){super(Ul)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError(`Wrong number of player worlds exist for player: ${e.id()}`);return r[0]}};t(Ph,"PlayerWorldRegistry");se=new Ph});var Ih,rl,gC=i(()=>{M();Ih=class extends x{};t(Ih,"Year");rl=Ih});var wh,Ws,Yu=i(()=>{J();A();Mt();gC();wh=class extends k{#e=new Map;#t;#r;constructor(e=te,r=c){super(),this.#t=r,this.#r=e,this.addKey("value")}value(e=this.#r.value()){if(!this.#e.has(e)){let[n]=this.#t.process(rl,e);this.#e.set(e,n)}let r=this.#e.get(e);if(typeof r!="number")throw new TypeError("Invalid cache result.");return r}};t(wh,"Year");Ws=new wh});var Nl,tt,Un=i(()=>{Nl=t((o,...e)=>o.reduce((r,n)=>{let a=e.findIndex(s=>n instanceof s);return a===-1||(r[a]+=n.value()),r},e.map(()=>0)),"reduceYields"),tt=t((o,e)=>Nl(o,e).shift()??0,"reduceYield")});var rB,hC,xC,Lu,Ah,OC,zu,RC=i(()=>{er();cd();Oi();fi();Un();by();rB=t(o=>hC(o.tiles().entries(),o),"getHighestValueCityTiles"),hC=t((o,e,r=[[X,8],[$,3*(tt(e.tilesWorked().yields(e.player()),$)===0?3:1)],[oe,1*(tt(e.tilesWorked().yields(e.player()),oe)===0?2:1)]])=>o.sort((n,a)=>a.score(e.player(),r)-n.score(e.player(),r)),"sortTiles"),xC=t((o,e=se,r=Se)=>rB(o).filter(n=>r.tileCanBeWorkedBy(n,o)&&e.getByPlayer(o.player()).includes(n)),"getHighestValueAvailableCityTiles"),Lu=t((o,e=se,r=ie,n=Se)=>{n.getBy("city",o).forEach(a=>n.unregister(a)),n.register(new Fm(o.tile(),o)),Ah(o,e,r,n)},"reassignWorkers"),Ah=t((o,e=se,r=ie,n=Se)=>{let a=r.getByCity(o);xC(o,e,n).some(s=>o.tilesWorked().length>=a.size()+1?!0:(n.register(new Fm(s,o)),!1))},"assignWorkers"),OC=t((o,e=se,r=ie,n=Se)=>{let[a]=xC(o,e,n);!a||n.register(new Fm(a,o))},"assignWorker"),zu=t((o,e)=>hC(o.tilesWorked().entries().filter(r=>r!==o.tile()),o).slice(e.size()),"reduceWorkers")});var Qp,ol=i(()=>{RC();RC();Qp=Ah});var Et,aB,Uh=i(()=>{Xr();Et=class extends Q{};t(Et,"Arctic");aB=Et});var sB=i(()=>{Uh();Uh()});var Ie,mB,Dh=i(()=>{Xr();Ie=class extends Q{};t(Ie,"Desert");mB=Ie});var lB=i(()=>{Dh();Dh()});var pB=i(()=>{Ru();Ru()});var fB=i(()=>{Gl();Gl()});var Ee,uB,Eh=i(()=>{Xr();Ee=class extends Q{};t(Ee,"Hills");uB=Ee});var cB=i(()=>{Eh();Eh()});var rt,yB,kh=i(()=>{Xr();rt=class extends Q{};t(rt,"Jungle");yB=rt});var dB=i(()=>{kh();kh()});var ze,gB,Sh=i(()=>{Xr();ze=class extends Q{};t(ze,"Mountains");gB=ze});var hB=i(()=>{Sh();Sh()});var lt,xB,Fh=i(()=>{lb();lt=class extends Qr{};t(lt,"Ocean");xB=lt});var OB=i(()=>{Fh();Fh()});var RB=i(()=>{Dp();Dp()});var me,Nh,_u=i(()=>{Xr();me=class extends Q{};t(me,"River");Nh=me});var vB=i(()=>{_u();_u()});var ot,bB,Wh=i(()=>{Xr();ot=class extends Q{};t(ot,"Swamp");bB=ot});var CB=i(()=>{Wh();Wh()});var gt,TB,Yh=i(()=>{Xr();gt=class extends Q{};t(gt,"Tundra");TB=gt});var PB=i(()=>{Yh();Yh()});var IB=i(()=>{sB();lB();pB();fB();cB();dB();hB();OB();RB();vB();CB();PB()});var En=i(()=>{IB()});var wB=i(()=>{Us();Us()});var AB=i(()=>{mm();mm()});var BB=i(()=>{Ms();Ms()});var GB=i(()=>{wB();AB();BB()});var Xp=i(()=>{GB()});var ht,ef,tf=i(()=>{ks();ht=class extends Fe{};t(ht,"Air");ef=ht});var MB=i(()=>{tf();tf()});var Ke,Lh,Ku=i(()=>{ks();Ke=class extends Fe{};t(Ke,"Land");Lh=Ke});var V,ur=i(()=>{Ku();V=class extends Lh{};t(V,"Fortifiable")});var UB=i(()=>{ur();ur()});var DB=i(()=>{Ku();Ku()});var Ne,Ys,il=i(()=>{ks();Ne=class extends Fe{};t(Ne,"Naval");Ys=Ne});var EB=i(()=>{il();il()});var zh,jh,CC=i(()=>{zh=class{#e;#t;#r;constructor(e,r,n){this.#t=e,this.#r=r,this.#e=n}sourceTile(){return this.#e}transport(){return this.#t}unit(){return this.#r}};t(zh,"TransportManifest");jh=zh});var Hh,kn,Yl=i(()=>{he();CC();Hh=class extends F{constructor(){super(jh)}getByTransport(e){return this.getBy("transport",e)}getByUnit(e){let r=this.getBy("unit",e);if(r.length!==1)throw new TypeError(`Wrong number of results. (${r.length})`);return r[0]}};t(Hh,"TransportRegistry");kn=new Hh});var nl,kB=i(()=>{We();nl=class extends Y{};t(nl,"Capacity")});var al,SB=i(()=>{We();al=class extends Y{};t(al,"CargoWeight")});var TC=i(()=>{kB();SB()});var _h,Kh,PC=i(()=>{M();_h=class extends x{};t(_h,"Stowed");Kh=_h});var qh,FB,NB=i(()=>{M();qh=class extends x{};t(qh,"Unloaded");FB=qh});var Vh,WB,YB=i(()=>{M();Vh=class extends x{};t(Vh,"CanStow");WB=Vh});var Jh,LB,$h=i(()=>{TC();A();Yl();ks();PC();CC();NB();YB();Jh=t(o=>t(class extends o{#e=c;#t=kn;canStow(r){return this.#e.process(WB,this,r).every(n=>n)}capacity(){let[r]=this.yield(new nl);return r}cargo(){return this.#t.getByTransport(this).map(r=>r.unit())}cargoWeight(){let[r]=this.yield(new al);return r}hasCapacity(){return this.cargoWeight().value()<this.capacity().value()}hasCargo(){return this.#t.getByTransport(this).length>0}setRuleRegistry(r){this.#e=r}setTransportRegistry(r){this.#t=r}stow(r,n=r.tile()){return!this.hasCapacity()||!this.canStow(r)?!1:(this.#t.register(new jh(this,r,n)),this.#e.process(Kh,r,this),!0)}unload(r){try{let n=this.#t.getByUnit(r);return this.#t.unregister(n),this.#e.process(FB,r,this),!0}catch{return!1}}},"Transport"),"Transport"),LB=Jh});var jt,Ls,sl=i(()=>{A();Yl();il();$h();jt=class extends LB(Ys){constructor(e,r,n,a=c,s=kn){super(e,r,n,a),this.setRuleRegistry(a),this.setTransportRegistry(s)}};t(jt,"NavalTransport");Ls=jt});var zB=i(()=>{sl();sl()});var jB=i(()=>{$h();$h()});var cr,Zh=i(()=>{Ku();cr=class extends Lh{};t(cr,"Worker")});var HB=i(()=>{Zh();Zh()});var IC=i(()=>{MB();UB();DB();EB();zB();jB();HB()});var zs=i(()=>{IC()});var Ri,wC=i(()=>{Qi();Ri=class extends at{};t(Ri,"Coal")});var _B=i(()=>{wC();wC()});var vi,AC=i(()=>{Qi();vi=class extends at{};t(vi,"Fish")});var KB=i(()=>{AC();AC()});var io,BC=i(()=>{Qi();io=class extends at{};t(io,"Game")});var qB=i(()=>{BC();BC()});var bi,GC=i(()=>{Qi();bi=class extends at{};t(bi,"Gems")});var VB=i(()=>{GC();GC()});var Ci,MC=i(()=>{Qi();Ci=class extends at{};t(Ci,"Gold")});var JB=i(()=>{MC();MC()});var $B=i(()=>{gg();gg()});var no,UC=i(()=>{Qi();no=class extends at{};t(no,"Oasis")});var ZB=i(()=>{UC();UC()});var Ti,DC=i(()=>{Qi();Ti=class extends at{};t(Ti,"Oil")});var QB=i(()=>{DC();DC()});var Pi,EC=i(()=>{Qi();Pi=class extends at{};t(Pi,"Seal")});var XB=i(()=>{EC();EC()});var eG=i(()=>{gu();gu()});var tG=i(()=>{_B();KB();qB();VB();JB();$B();ZB();QB();XB();eG()});var qu=i(()=>{tG()});var Qh,Ll,kC=i(()=>{M();Qh=class extends x{};t(Qh,"Action");Ll=Qh});var Xh,ex,SC=i(()=>{M();Xh=class extends x{};t(Xh,"ActionPerformed");ex=Xh});var tx,rf,FC=i(()=>{M();tx=class extends x{};t(tx,"Discovered");rf=tx});var rx,ox,NC=i(()=>{J();A();kC();SC();FC();rx=class extends k{#e;#t;constructor(e,r=c){super(),this.#e=r,this.#t=e,this.addKey("tile")}action(e){this.#e.process(ex,this,e),e.perform()}actions(e){return this.#e.process(Ll,this,e)}process(e){this.#e.process(rf,this,e)}tile(){return this.#t}};t(rx,"GoodyHut");ox=rx});var ix,Ii,ml=i(()=>{NC();he();ix=class extends F{constructor(){super(ox)}getByTile(e){let r=this.filter(n=>n.tile()===e);return r.length===0?null:r[0]}};t(ix,"GoodyHutRegistry");Ii=new ix});var rG=i(()=>{Nd();Nd()});var oG=i(()=>{Ld();Ld()});var WC=i(()=>{Al()});var iG=i(()=>{WC();WC()});var nG=i(()=>{_d();_d()});var aG=i(()=>{jd();jd()});var sG=i(()=>{rG();oG();iG();nG();aG()});var js=i(()=>{sG()});var nx,wi,ll=i(()=>{J();nx=class extends fe{};t(nx,"Government");wi=nx});var ax,of,sx=i(()=>{Pn();ll();ax=class extends st{constructor(){super(wi)}};t(ax,"AvailableGovernmentRegistry");of=new ax});var mx,Vu,LC=i(()=>{M();mx=class extends x{};t(mx,"Availability");Vu=mx});var lx,Ju,zC=i(()=>{M();lx=class extends x{};t(lx,"Changed");Ju=lx});var px,fx,jC=i(()=>{sx();J();A();LC();zC();px=class extends k{#e;#t=null;#r;#o;constructor(e,r=of,n=c){super(),this.#r=e,this.#e=r,this.#o=n,this.addKey("available","current")}available(){return this.#e.filter(e=>this.#o.get(Vu).some(r=>r.validate(e,this.#r)))}current(){return this.#t}is(...e){return e.some(r=>this.#t instanceof r)}player(){return this.#r}set(e){this.#t=e,this.#o.process(Ju,this.#r,e)}};t(px,"PlayerGovernment");fx=px});var ux,Ht,ns=i(()=>{he();jC();ux=class extends F{constructor(){super(fx)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerGovernments for player.");return r[0]}};t(ux,"PlayerGovernmentRegistry");Ht=new ux});var cx,as,yx=i(()=>{Dl();cx=class extends Bn{};t(cx,"Accept");as=cx});var dx,Hs,gx=i(()=>{A();Ip();dx=class extends Hm{#e;constructor(e,r,n,a=c){super(r,n,a),this.#e=e,this.addKey("advances")}advances(){return this.#e}};t(dx,"ExchangeKnowledge");Hs=dx});var mG=i(()=>{ig();ig()});var ss,HC=i(()=>{tg();ss=class extends kp{};t(ss,"Veteran")});var lG=i(()=>{HC();HC()});var pG=i(()=>{mG();lG()});var $u=i(()=>{pG()});var rn,Zu,Qu=i(()=>{E();rn=class extends C{};t(rn,"AdvancedFlight");Zu=rn});var fG=i(()=>{Qu();Qu()});var So,uG,hx=i(()=>{E();So=class extends C{};t(So,"Alphabet");uG=So});var cG=i(()=>{hx();hx()});var ao,yG,xx=i(()=>{E();ao=class extends C{};t(ao,"Astronomy");yG=ao});var dG=i(()=>{xx();xx()});var on,gG,Ox=i(()=>{E();on=class extends C{};t(on,"AtomicTheory");gG=on});var hG=i(()=>{Ox();Ox()});var _t,Xu,ec=i(()=>{E();_t=class extends C{};t(_t,"Automobile");Xu=_t});var xG=i(()=>{ec();ec()});var so,OG,Rx=i(()=>{E();so=class extends C{};t(so,"Banking");OG=so});var RG=i(()=>{Rx();Rx()});var Fo,vG,vx=i(()=>{E();Fo=class extends C{};t(Fo,"BridgeBuilding");vG=Fo});var bG=i(()=>{vx();vx()});var No,bx,tc=i(()=>{E();No=class extends C{};t(No,"BronzeWorking");bx=No});var CG=i(()=>{tc();tc()});var mo,TG,Cx=i(()=>{E();mo=class extends C{};t(mo,"CeremonialBurial");TG=mo});var PG=i(()=>{Cx();Cx()});var Ai,IG,Tx=i(()=>{E();Ai=class extends C{};t(Ai,"Chemistry");IG=Ai});var wG=i(()=>{Tx();Tx()});var Sn,rc,oc=i(()=>{E();Sn=class extends C{};t(Sn,"Chivalry");rc=Sn});var AG=i(()=>{oc();oc()});var yr,BG,Px=i(()=>{E();yr=class extends C{};t(yr,"CodeOfLaws");BG=yr});var GG=i(()=>{Px();Px()});var Bi,ic,nc=i(()=>{E();Bi=class extends C{};t(Bi,"Combustion");ic=Bi});var MG=i(()=>{nc();nc()});var Tt,UG,Ix=i(()=>{E();Tt=class extends C{};t(Tt,"Communism");UG=Tt});var DG=i(()=>{Ix();Ix()});var lo,EG,wx=i(()=>{E();lo=class extends C{};t(lo,"Computers");EG=lo});var kG=i(()=>{wx();wx()});var Fn,zl,ac=i(()=>{E();Fn=class extends C{};t(Fn,"Conscription");zl=Fn});var SG=i(()=>{ac();ac()});var Dr,FG,Ax=i(()=>{E();Dr=class extends C{};t(Dr,"Construction");FG=Dr});var NG=i(()=>{Ax();Ax()});var Wo,WG,Bx=i(()=>{E();Wo=class extends C{};t(Wo,"Corporation");WG=Wo});var YG=i(()=>{Bx();Bx()});var po,LG,Gx=i(()=>{E();po=class extends C{};t(po,"Currency");LG=po});var zG=i(()=>{Gx();Gx()});var Yo,jG,Mx=i(()=>{E();Yo=class extends C{};t(Yo,"Democracy");jG=Yo});var HG=i(()=>{Mx();Mx()});var dr,_G,Ux=i(()=>{E();dr=class extends C{};t(dr,"Electricity");_G=dr});var KG=i(()=>{Ux();Ux()});var xt,qG,Dx=i(()=>{E();xt=class extends C{};t(xt,"Electronics");qG=xt});var VG=i(()=>{Dx();Dx()});var Gi,JG,Ex=i(()=>{E();Gi=class extends C{};t(Gi,"Engineering");JG=Gi});var $G=i(()=>{Ex();Ex()});var Mi,ZG,kx=i(()=>{E();Mi=class extends C{};t(Mi,"Explosives");ZG=Mi});var QG=i(()=>{kx();kx()});var nn,XG,Sx=i(()=>{E();nn=class extends C{};t(nn,"Feudalism");XG=nn});var eM=i(()=>{Sx();Sx()});var an,Fx,sc=i(()=>{E();an=class extends C{};t(an,"Flight");Fx=an});var tM=i(()=>{sc();sc()});var Nn,rM,Nx=i(()=>{E();Nn=class extends C{};t(Nn,"FusionPower");rM=Nn});var oM=i(()=>{Nx();Nx()});var Ui,iM,Wx=i(()=>{E();Ui=class extends C{};t(Ui,"GeneticEngineering");iM=Ui});var nM=i(()=>{Wx();Wx()});var tr,nf,mc=i(()=>{E();tr=class extends C{};t(tr,"Gunpowder");nf=tr});var aM=i(()=>{mc();mc()});var Wn,Yx,lc=i(()=>{E();Wn=class extends C{};t(Wn,"HorsebackRiding");Yx=Wn});var sM=i(()=>{lc();lc()});var rr,pc,fc=i(()=>{E();rr=class extends C{};t(rr,"Industrialization");pc=rr});var mM=i(()=>{fc();fc()});var gr,lM,Lx=i(()=>{E();gr=class extends C{};t(gr,"Invention");lM=gr});var pM=i(()=>{Lx();Lx()});var Di,zx,uc=i(()=>{E();Di=class extends C{};t(Di,"IronWorking");zx=Di});var fM=i(()=>{uc();uc()});var Yn,jx,cc=i(()=>{E();Yn=class extends C{};t(Yn,"LaborUnion");jx=Yn});var uM=i(()=>{cc();cc()});var hr,cM,Hx=i(()=>{E();hr=class extends C{};t(hr,"Literacy");cM=hr});var yM=i(()=>{Hx();Hx()});var Er,yc,dc=i(()=>{E();Er=class extends C{};t(Er,"Magnetism");yc=Er});var dM=i(()=>{dc();dc()});var Lo,_x,gc=i(()=>{E();Lo=class extends C{};t(Lo,"MapMaking");_x=Lo});var gM=i(()=>{gc();gc()});var Kt,hM,Kx=i(()=>{E();Kt=class extends C{};t(Kt,"Masonry");hM=Kt});var xM=i(()=>{Kx();Kx()});var xr,qx,hc=i(()=>{E();xr=class extends C{};t(xr,"MassProduction");qx=xr});var OM=i(()=>{hc();hc()});var fo,Vx,xc=i(()=>{E();fo=class extends C{};t(fo,"Mathematics");Vx=fo});var RM=i(()=>{xc();xc()});var uo,vM,Jx=i(()=>{E();uo=class extends C{};t(uo,"Medicine");vM=uo});var bM=i(()=>{Jx();Jx()});var Ei,Oc,Rc=i(()=>{E();Ei=class extends C{};t(Ei,"Metallurgy");Oc=Ei});var CM=i(()=>{Rc();Rc()});var kr,TM,$x=i(()=>{E();kr=class extends C{};t(kr,"Monarchy");TM=kr});var PM=i(()=>{$x();$x()});var qt,IM,Zx=i(()=>{E();qt=class extends C{};t(qt,"Mysticism");IM=qt});var wM=i(()=>{Zx();Zx()});var co,vc,bc=i(()=>{E();co=class extends C{};t(co,"Navigation");vc=co});var AM=i(()=>{bc();bc()});var Sr,BM,Qx=i(()=>{E();Sr=class extends C{};t(Sr,"NuclearFission");BM=Sr});var GM=i(()=>{Qx();Qx()});var zo,MM,Xx=i(()=>{E();zo=class extends C{};t(zo,"NuclearPower");MM=zo});var UM=i(()=>{Xx();Xx()});var Fr,DM,eO=i(()=>{E();Fr=class extends C{};t(Fr,"Philosophy");DM=Fr});var EM=i(()=>{eO();eO()});var yo,kM,tO=i(()=>{E();yo=class extends C{};t(yo,"Physics");kM=yo});var SM=i(()=>{tO();tO()});var ki,Cc,Tc=i(()=>{E();ki=class extends C{};t(ki,"Plastics");Cc=ki});var FM=i(()=>{Tc();Tc()});var Si,NM,rO=i(()=>{E();Si=class extends C{};t(Si,"Pottery");NM=Si});var WM=i(()=>{rO();rO()});var Nr,YM,oO=i(()=>{E();Nr=class extends C{};t(Nr,"Railroad");YM=Nr});var LM=i(()=>{oO();oO()});var Fi,zM,iO=i(()=>{E();Fi=class extends C{};t(Fi,"Recycling");zM=Fi});var jM=i(()=>{iO();iO()});var go,HM,nO=i(()=>{E();go=class extends C{};t(go,"Refining");HM=go});var _M=i(()=>{nO();nO()});var Pt,KM,aO=i(()=>{E();Pt=class extends C{};t(Pt,"Religion");KM=Pt});var qM=i(()=>{aO();aO()});var Ni,bm,af=i(()=>{E();Ni=class extends C{};t(Ni,"Robotics");bm=Ni});var VM=i(()=>{af();af()});var sn,sO,Pc=i(()=>{E();sn=class extends C{};t(sn,"Rocketry");sO=sn});var JM=i(()=>{Pc();Pc()});var jo,mO,Ic=i(()=>{E();jo=class extends C{};t(jo,"SpaceFlight");mO=jo});var $M=i(()=>{Ic();Ic()});var mn,lO,wc=i(()=>{E();mn=class extends C{};t(mn,"SteamEngine");lO=mn});var ZM=i(()=>{wc();wc()});var ln,pO,Ac=i(()=>{E();ln=class extends C{};t(ln,"Steel");pO=ln});var QM=i(()=>{Ac();Ac()});var Ho,XM,fO=i(()=>{E();Ho=class extends C{};t(Ho,"Superconductor");XM=Ho});var eU=i(()=>{fO();fO()});var ho,tU,uO=i(()=>{E();ho=class extends C{};t(ho,"TheRepublic");tU=ho});var rU=i(()=>{uO();uO()});var Ln,cO,Bc=i(()=>{E();Ln=class extends C{};t(Ln,"TheWheel");cO=Ln});var oU=i(()=>{Bc();Bc()});var _o,iU,yO=i(()=>{E();_o=class extends C{};t(_o,"TheoryOfGravity");iU=_o});var nU=i(()=>{yO();yO()});var Wi,dO,Gc=i(()=>{E();Wi=class extends C{};t(Wi,"Trade");dO=Wi});var aU=i(()=>{Gc();Gc()});var or,sU,gO=i(()=>{E();or=class extends C{};t(or,"University");sU=or});var mU=i(()=>{gO();gO()});var xo,hO,Mc=i(()=>{E();xo=class extends C{};t(xo,"Writing");hO=xo});var lU=i(()=>{Mc();Mc()});var xO=i(()=>{fG();cG();dG();hG();xG();RG();bG();CG();PG();wG();AG();GG();MG();DG();kG();SG();NG();YG();zG();HG();KG();VG();$G();QG();eM();tM();oM();nM();aM();sM();mM();pM();fM();uM();yM();dM();gM();xM();OM();RM();bM();CM();PM();wM();AM();GM();UM();EM();SM();FM();WM();LM();jM();_M();qM();VM();JM();$M();ZM();QM();eU();rU();oU();nU();aU();mU();lU()});var pn=i(()=>{xO()});var Oo,_C=i(()=>{ll();Oo=class extends wi{};t(Oo,"Anarchy")});var pU=i(()=>{_C();_C()});var It,KC=i(()=>{ll();It=class extends wi{};t(It,"Communism")});var fU=i(()=>{KC();KC()});var pt,qC=i(()=>{ll();pt=class extends wi{};t(pt,"Democracy")});var uU=i(()=>{qC();qC()});var Vt,VC=i(()=>{ll();Vt=class extends wi{};t(Vt,"Despotism")});var cU=i(()=>{VC();VC()});var ft,JC=i(()=>{ll();ft=class extends wi{};t(ft,"Monarchy")});var yU=i(()=>{JC();JC()});var Ot,$C=i(()=>{ll();Ot=class extends wi{};t(Ot,"Republic")});var dU=i(()=>{$C();$C()});var ZC=i(()=>{pU();fU();uU();cU();yU();dU()});var _s=i(()=>{ZC()});var OO,Ks,RO=i(()=>{Ip();OO=class extends Hm{};t(OO,"OfferPeace");Ks=OO});var Wr,QC=i(()=>{Ve();Wr=class extends K{};t(Wr,"Aqueduct")});var gU=i(()=>{QC();QC()});var ir,XC=i(()=>{Ve();ir=class extends K{};t(ir,"Bank")});var hU=i(()=>{XC();XC()});var Yr,eT=i(()=>{Ve();Yr=class extends K{};t(Yr,"Barracks")});var xU=i(()=>{eT();eT()});var nr,tT=i(()=>{Ve();nr=class extends K{};t(nr,"Cathedral")});var OU=i(()=>{tT();tT()});var Ko,rT=i(()=>{Ve();Ko=class extends K{};t(Ko,"CityWalls")});var RU=i(()=>{rT();rT()});var Lr,oT=i(()=>{Ve();Lr=class extends K{};t(Lr,"Colosseum")});var vU=i(()=>{oT();oT()});var Or,iT=i(()=>{Ve();Or=class extends K{};t(Or,"Courthouse")});var bU=i(()=>{iT();iT()});var Jt,nT=i(()=>{Ve();Jt=class extends K{};t(Jt,"Factory")});var CU=i(()=>{nT();nT()});var zr,aT=i(()=>{Ve();zr=class extends K{};t(zr,"Granary")});var TU=i(()=>{aT();aT()});var wt,sT=i(()=>{Ve();wt=class extends K{};t(wt,"HydroPlant")});var PU=i(()=>{sT();sT()});var Rr,mT=i(()=>{Ve();Rr=class extends K{};t(Rr,"Library")});var IU=i(()=>{mT();mT()});var vr,lT=i(()=>{Ve();vr=class extends K{};t(vr,"ManufacturingPlant")});var wU=i(()=>{lT();lT()});var ar,pT=i(()=>{Ve();ar=class extends K{};t(ar,"Marketplace")});var AU=i(()=>{pT();pT()});var qo,fT=i(()=>{Ve();qo=class extends K{};t(qo,"MassTransit")});var BU=i(()=>{fT();fT()});var At,uT=i(()=>{Ve();At=class extends K{};t(At,"NuclearPlant")});var GU=i(()=>{uT();uT()});var ut,cT=i(()=>{Ve();ut=class extends K{};t(ut,"Palace")});var MU=i(()=>{cT();cT()});var Bt,yT=i(()=>{Ve();Bt=class extends K{};t(Bt,"PowerPlant")});var UU=i(()=>{yT();yT()});var Vo,dT=i(()=>{Ve();Vo=class extends K{};t(Vo,"RecyclingCenter")});var DU=i(()=>{dT();dT()});var Jo,gT=i(()=>{Ve();Jo=class extends K{};t(Jo,"SdiDefence")});var EU=i(()=>{gT();gT()});var kt,hT=i(()=>{Ve();kt=class extends K{};t(kt,"Temple")});var kU=i(()=>{hT();hT()});var br,xT=i(()=>{Ve();br=class extends K{};t(br,"University")});var SU=i(()=>{xT();xT()});var OT=i(()=>{gU();hU();xU();OU();RU();vU();bU();CU();TU();PU();IU();wU();AU();BU();GU();MU();UU();DU();EU();kU();SU()});var fn=i(()=>{OT()});var vO,ms,bO=i(()=>{Fp();nu();vO=class extends yp{#e=1/0;end(){return this.entries()[this.length-1]}static for(e,r,n,a=Ns){let[s]=a.entries().map(m=>new m(e,r,n)).map(m=>m.generate()).sort((m,f)=>m.movementCost()-f.movementCost());return s&&(s.shift(),s)}movementCost(){return this.#e}setMovementCost(e){this.#e=e}push(...e){e.forEach(r=>{let n=this.end();if(this.length>0&&!r.isNeighbourOf(n))throw new TypeError(`Tile#push: Invalid element passed, ${r.x()},${r.y()} is not a neighbour of ${n.x()},${n.y()}.`);super.push(r)})}start(){return this.entries()[0]}};t(vO,"Path");ms=vO});var $o,RT=i(()=>{ur();$o=class extends V{};t($o,"Artillery")});var FU=i(()=>{RT();RT()});var Zo,vT=i(()=>{il();Zo=class extends Ys{};t(Zo,"Battleship")});var NU=i(()=>{vT();vT()});var jr,bT=i(()=>{tf();jr=class extends ef{};t(jr,"Bomber")});var WU=i(()=>{bT();bT()});var Ro,CT=i(()=>{ur();Ro=class extends V{};t(Ro,"Cannon")});var YU=i(()=>{CT();CT()});var Qo,TT=i(()=>{ur();Qo=class extends V{};t(Qo,"Caravan")});var LU=i(()=>{TT();TT()});var vo,PT=i(()=>{sl();vo=class extends Ls{};t(vo,"Carrier")});var zU=i(()=>{PT();PT()});var bo,IT=i(()=>{ur();bo=class extends V{};t(bo,"Catapult")});var jU=i(()=>{IT();IT()});var Co,wT=i(()=>{ur();Co=class extends V{};t(Co,"Chariot")});var HU=i(()=>{wT();wT()});var Xo,AT=i(()=>{il();Xo=class extends Ys{};t(Xo,"Cruiser")});var _U=i(()=>{AT();AT()});var ei,BT=i(()=>{ur();ei=class extends V{};t(ei,"Diplomat")});var KU=i(()=>{BT();BT()});var sr,GT=i(()=>{tf();sr=class extends ef{};t(sr,"Fighter")});var qU=i(()=>{GT();GT()});var Hr,MT=i(()=>{sl();Hr=class extends Ls{};t(Hr,"Frigate")});var VU=i(()=>{MT();MT()});var Cr,UT=i(()=>{ur();Cr=class extends V{};t(Cr,"Horseman")});var JU=i(()=>{UT();UT()});var To,DT=i(()=>{il();To=class extends Ys{};t(To,"Ironclad")});var $U=i(()=>{DT();DT()});var Po,ET=i(()=>{ur();Po=class extends V{};t(Po,"Knight")});var ZU=i(()=>{ET();ET()});var ti,kT=i(()=>{ur();ti=class extends V{};t(ti,"MechanizedInfantry")});var QU=i(()=>{kT();kT()});var Io,ST=i(()=>{ur();Io=class extends V{};t(Io,"Musketman")});var XU=i(()=>{ST();ST()});var mr,FT=i(()=>{tf();mr=class extends ef{};t(mr,"Nuclear")});var eD=i(()=>{FT();FT()});var ri,NT=i(()=>{ur();ri=class extends V{};t(ri,"Rifleman")});var tD=i(()=>{NT();NT()});var _r,WT=i(()=>{sl();_r=class extends Ls{};t(_r,"Sail")});var rD=i(()=>{WT();WT()});var qe,oD,CO=i(()=>{Zh();qe=class extends cr{};t(qe,"Settlers");oD=qe});var iD=i(()=>{CO();CO()});var wo,YT=i(()=>{ur();wo=class extends V{};t(wo,"Spearman")});var nD=i(()=>{YT();YT()});var Kr,LT=i(()=>{il();Kr=class extends Ys{};t(Kr,"Submarine")});var aD=i(()=>{LT();LT()});var Tr,zT=i(()=>{ur();Tr=class extends V{};t(Tr,"Swordman")});var sD=i(()=>{zT();zT()});var oi,jT=i(()=>{ur();oi=class extends V{};t(oi,"Tank")});var mD=i(()=>{jT();jT()});var Ao,HT=i(()=>{sl();Ao=class extends Ls{};t(Ao,"Transport")});var lD=i(()=>{HT();HT()});var lr,_T=i(()=>{sl();lr=class extends Ls{};t(lr,"Trireme")});var pD=i(()=>{_T();_T()});var ii,KT=i(()=>{ur();ii=class extends V{};t(ii,"Warrior")});var fD=i(()=>{KT();KT()});var uD=i(()=>{FU();NU();WU();YU();LU();zU();jU();HU();_U();KU();qU();VU();JU();$U();ZU();QU();XU();eD();tD();rD();iD();nD();aD();sD();mD();lD();pD();fD()});var zn=i(()=>{uD()});var TO,jn,PO=i(()=>{Dl();TO=class extends Bn{};t(TO,"Decline");jn=TO});var cD,Oq,Rq,IO,qs,sf=i(()=>{Ap();Ml();sp();is();er();mt();rs();En();ee();Xp();zs();qu();ml();vm();js();Fp();ns();_e();Fl();Oi();A();_a();xi();Mt();gm();He();yx();oy();Mp();Nu();Qy();gx();$u();Gs();lu();pn();_s();rC();RO();fn();bO();lh();Dl();zn();qi();ks();Le();ol();PO();cD=t((o,e)=>new Promise((r,n)=>setTimeout(()=>e===void 0?r():n(e),o)),"awaitTimeout"),Oq=t((o,e,r=Z)=>{let n=r.getByTile(o);return n===null?!1:n.player()===e},"hasPlayerCity"),Rq=15,IO=class extends xl{#e=e=>this.#u.getByPlayer(this.player()).some(r=>r.tiles().includes(e));#t=e=>{let r=this.#D.option("earth",!1),n=this.#u.getByPlayer(this.player()).length===0;if(r&&n)return!0;let a=this.#M.getByTerrain(e.terrain());return(e.terrain()instanceof Oe||e.terrain()instanceof me||e.terrain()instanceof pe||a.some(s=>s instanceof no)||a.some(s=>s instanceof io))&&e.getSurroundingArea().score(this.player(),[[X,4],[$,2],[oe,1]])>=160&&!e.getSurroundingArea(4).filter(s=>this.#u.getByTile(s)!==null).length};#r=e=>[Ie,pe,Oe,me].some(r=>e.terrain()instanceof r)&&!this.#R.getByTile(e).some(r=>r instanceof Ue)&&this.#e(e)&&[...e.getAdjacent(),e].some(r=>r.terrain()instanceof me||r.isCoast()||this.#R.getByTile(r).some(n=>n instanceof Ue)&&this.#u.getByTile(r)===null);#o=e=>[Ee,ze].some(r=>e.terrain()instanceof r)&&!this.#R.getByTile(e).some(r=>r instanceof et)&&this.#e(e);#i=e=>!this.#R.getByTile(e).some(r=>r instanceof Ye)&&this.#e(e);#n=new Map;#a=new Map;#m=new Map;#s=[];#l=[];#c=[];#h=[];#y=[];#d=[];#f=[];#u;#P;#b;#I;#w;#T;#g;#A;#B;#G;#x;#O;#M;#R;#U;#C;#p;#D;#v;constructor(e,r=Z,n=zt,a=ie,s=Ii,m=Ns,f=Ht,u=H,y=tn,O=se,B=c,N=Yt,W=Je,_=oo,d=L,g=P,h=Lt,G=Ur,z=te,Qe=()=>Math.random()){super(e),this.#u=r,this.#P=n,this.#b=a,this.#I=h,this.#w=s,this.#T=G,this.#g=m,this.#A=f,this.#B=u,this.#G=y,this.#x=O,this.#O=B,this.#M=N,this.#U=z,this.#C=_,this.#R=W,this.#p=d,this.#D=g,this.#v=Qe}scoreUnitMove(e,r){let n=e.actions(r),{attack:a,buildIrrigation:s,buildMine:m,buildRoad:f,captureCity:u,disembark:y,embark:O,fortify:B,foundCity:N,noOrders:W,sneakAttack:_}=n.reduce((Be,Jr)=>({...Be,[Jr.constructor.name.replace(/^./,sq=>sq.toLowerCase())]:Jr}),{});if(_&&!this.shouldAttack(_.enemy()))return-10;if(!n.length||n.length===1&&W||e instanceof V&&n.length===2&&B&&W)return-1;let d=0;this.#w.getByTile(r)!==null&&(d+=60),(N&&this.#t(r)||m&&this.#o(r)||s&&this.#r(r)||f&&this.#i(r))&&(d+=24);let h=this.#p.getByTile(r).sort((Be,Jr)=>Jr.defence().value()-Be.defence().value()),[G]=h,z=h.some(Be=>Be.player()===this.player());e instanceof jt&&e.hasCapacity()&&h.length&&z&&(d+=10),e instanceof jt&&e.hasCargo()&&r.isCoast()&&r.isWater()&&(d+=16),O&&(d+=16),y&&(d+=16),u&&(d+=100),a&&e.attack()>G.defence()&&(d+=24*(e.attack().value()-G.defence().value())),a&&e.attack().value()>=G.defence().value()&&(d+=16),a&&e.attack().value()>=G.defence().value()*(2/3)&&(d+=8);let Qe=this.#x.getByPlayer(this.player()),Ft=r.getNeighbours().filter(Be=>!Qe.includes(Be)).length;Ft>0&&(d+=Ft*3);let be=this.#m.get(e);return be instanceof xe&&r.distanceFrom(be)<e.tile().distanceFrom(be)&&(d+=14),(this.#n.get(e)||[]).includes(r)||(d*=4),d}async moveUnit(e){let r=0;for(;e.active()&&e.moves().value()>=.1;){if(r++>1e3){console.log("SimpleAIClient#moveUnit: loopCheck: aborting"),console.log(`${e.player().civilization().name()} ${e.constructor.name}`),console.log(e.actions()),console.log(e.actionsForNeighbours()),this.noOrders(e);return}let n=this.#a.get(e);if(n){let y=n.shift(),[O]=e.actions(y).filter(B=>B instanceof nt);if(O instanceof An&&!this.shouldAttack(O.enemy())){this.#a.delete(e);continue}if(O){e.action(O),n.length===0&&this.#a.delete(e),await this.canNegotiate(e);continue}if(n.length>0)continue;this.#a.delete(e)}let[a]=e.tile().getNeighbours().map(y=>[y,this.scoreUnitMove(e,y)]).filter(([,y])=>y>-1).sort(([,y],[,O])=>O-y||Math.floor(this.#v()*3)-1).map(([y])=>y);if(!a){this.noOrders(e);return}let s=e.actions(a),[m]=s,f=this.#n.get(e)||[],u=this.#m.get(e);if(!m||(m instanceof Xa||m instanceof An)&&!this.shouldAttack(m.enemy())){this.noOrders(e);return}u===a&&this.#m.delete(e),f.push(a),this.#n.set(e,f.slice(-50)),e.action(m)}await this.canNegotiate(e),e.moves().value()>0&&this.noOrders(e)}preProcessTurn(){this.#s.splice(0),this.#l.splice(0),this.#c.splice(0),this.#h.splice(0),this.#y.splice(0),this.#d.splice(0),this.#f.splice(0);let e=this.#x.getByPlayer(this.player());e.entries().forEach(r=>{let n=r.tile(),a=this.#u.getByTile(n),s=this.#p.getBy("tile",n),m=this.#f.includes(n)&&![...this.#m.values(),...[...this.#a.values()].map(f=>f.end())].includes(n);a&&a.player()===this.player()&&!s.length&&!this.#f.includes(n)&&!m?this.#f.push(n):a&&a.player()!==this.player()&&a.originalPlayer()===this.player()?this.#s.push(n):a&&a.player()!==this.player()&&!this.#l.includes(n)?this.#l.push(n):s.length&&s.some(f=>f.player()!==this.player())&&this.#c.includes(n)?this.#c.push(n):n.isLand()&&n.getNeighbours().some(f=>!e.includes(f))&&!this.#y.includes(n)&&!m?this.#y.push(n):n.isWater()&&n.getNeighbours().some(f=>!e.includes(f))&&this.#d.includes(n)&&!m&&this.#d.push(n),this.#t(n)&&this.#h.includes(n)&&!m&&this.#h.push(n)}),this.#u.getByPlayer(this.player()).forEach(r=>{let n=this.#p.getByTile(r.tile());Qp(r,this.#x,this.#b),!n.length&&!this.#f.includes(r.tile())&&this.#f.push(r.tile())})}async chooseFromList(e){if(e.key()!=="negotiation.next-step")return super.chooseFromList(e);let r=t(a=>this.shouldAttack(a.players().filter(m=>m!==this.player())[0])?a instanceof jn?10:-1:a instanceof Hs?30:a instanceof Ks?20:a instanceof as?10:0,"score"),[n]=e.choices().sort((a,s)=>r(s.value())-r(a.value()));return n.value()}takeTurn(){return new Promise(async(e,r)=>{try{let n=0;this.preProcessTurn();let[a]=this.#A.filter(m=>m.player()===this.player()),[s]=this.#B.filter(m=>m.player()===this.player());for(s.completed(kr)&&!a.is(ft)&&a.set(new ft);this.player().hasMandatoryActions();){let m=this.player().mandatoryAction(),f=m.value();if(n++>1e3){console.log(""),console.log(""),console.log(f),f instanceof Fe&&(console.log(f.actions()),f.tile().getNeighbours().forEach(u=>console.log(f.actions(u))),console.log(f.active()),console.log(f.busy()),console.log(f.moves().value()),console.log(this.#C.getByUnit(f))),this.noOrders(f),console.error("SimpleAIClient: Couldn't pick an action to do.");break}if(f instanceof Fe){let u=f,y=u.tile(),O=this.#m.get(u),B=u.actions(),{buildIrrigation:N,buildMine:W,buildRoad:_,fortify:d,foundCity:g,unload:h}=B.reduce((be,Ce)=>({...be,[Ce.constructor.name.replace(/^./,Be=>Be.toLowerCase())]:Ce}),{}),G=this.#p.getByTile(y);if(this.#n.get(u)||this.#n.set(u,[u.tile()]),u instanceof jt&&h&&y.isCoast()&&u.cargo().some(be=>!y.getNeighbours().some(Ce=>(this.#n.get(be)||[]).includes(Ce)))){u.action(h),u.setWaiting();continue}if(u instanceof cr){g&&this.#t(y)?u.action(g):N&&this.#r(y)?u.action(N):W&&this.#o(y)?u.action(W):_&&this.#i(y)?u.action(_):!O&&this.#h.length&&this.#m.set(u,this.#h.shift()),await this.moveUnit(u);continue}let[Qe]=G.filter(be=>this.#C.getByUnit(be).some(Ce=>Ce instanceof Eo)&&u.defence()>be.defence()),Ft=this.#u.getByTile(y);if(d&&Ft&&(Qe||G.length<=Math.ceil(this.#b.getByCity(Ft).size()/5))){u.action(d),Qe&&Qe.activate();continue}if(!O){if(u instanceof V&&u.defence().value()>0&&this.#f.length>0){let[be]=this.#f.sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#f.splice(this.#f.indexOf(be),1),this.#a.set(u,Ce))}else if(u.attack().value()>0&&this.#s.length>0){let[be]=this.#s.filter(Be=>u instanceof Ke&&Be.isLand()).sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#s.splice(this.#s.indexOf(be),1),this.#a.set(u,Ce))}else if(u.attack().value()>0&&this.#c.length>0){let[be]=this.#c.filter(Be=>u instanceof Ke&&Be.isLand()||u instanceof Ne&&Be.isWater()).sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#c.splice(this.#c.indexOf(be),1),this.#a.set(u,Ce))}else if(u instanceof Ke&&u.attack().value()>0&&this.#l.length>0){let[be]=this.#l.sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#l.splice(this.#l.indexOf(be),1),this.#a.set(u,Ce))}else if(u instanceof Ke&&this.#y.length>0){let[be]=this.#y.sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#y.splice(this.#y.indexOf(be),1),this.#a.set(u,Ce))}else if(u instanceof Ne&&this.#d.length>0){let[be]=this.#d.sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#d.splice(this.#d.indexOf(be),1),this.#a.set(u,Ce))}}await this.moveUnit(u);continue}if(f instanceof tl){this.buildItemInCity(f.city());continue}if(f instanceof Vp){let u=f.available();u.length&&f.research(u[Math.floor(u.length*this.#v())]);continue}if(m instanceof Zy)break;console.log(`Can't process: '${f.constructor.name}'`);break}e()}catch(n){if(typeof n=="string"){r(new Error(n));return}if(n instanceof Error){r(n);return}r(new Error(`An unknown error occurred: ${n}`))}})}buildItemInCity(e){let r=e.tile(),n=this.#P.getByCity(e),a=this.#p.getByTile(r),s=n.available(),m=[ut,qe],f=s.filter(d=>!m.includes(d.item())&&!Object.prototype.isPrototypeOf.call(Ae,d.item())),u=s.filter(d=>Object.prototype.isPrototypeOf.call(Ae,d.item())),y=f.filter(d=>Object.prototype.isPrototypeOf.call(Fe,d.item())),O=f[Math.floor(f.length*this.#v())].item(),B=t(d=>{let[[g]]=y.map(h=>{let G=h.item(),z=new d;return this.#O.process(Km,G,z),[G,z]}).sort(([,h],[,G])=>G.value()-h.value());return g},"getUnitByYield"),N=(d=>()=>d||(d=B($i)))(),W=(d=>()=>d||(d=B(bn)))();if(this.#p.getByTile(r).length<2&&N()){n.build(N());return}let _=this.#b.getByCity(n.city());if(s.some(d=>d.item()===qe)&&!this.#p.getByCity(n.city()).some(d=>d instanceof qe)&&this.#p.getByPlayer(this.player()).filter(d=>d instanceof qe).length<3&&_.size()>1){n.build(qe);return}if(this.#s.length>0||this.#l.length>0||this.#c.length>4){n.build(W());return}if(a.filter(d=>this.#C.getByUnit(d).filter(g=>g instanceof Eo)).length<2||this.#f.length){n.build(N());return}if(n.city().yields().filter(d=>d instanceof $).some(d=>d.value()>4)){let d=u.map(g=>g.item());n.build(d[Math.floor(this.#v()*d.length)])}O&&n.build(O)}cityLost(e,r,n){if(!r)return;let a=this.#x.getByPlayer(this.player());if(n){this.#l.push(...a.entries().filter(s=>Oq(s.tile(),this.player(),this.#u)).map(s=>s.tile())),this.#c.push(...a.entries().filter(s=>this.#p.getByTile(s.tile()).some(m=>m.player()===r)).map(s=>s.tile()));return}this.#s.push(e.tile())}unitDestroyed(e,r){let n=this.#u.getByTile(e.tile()),a=this.#p.getByTile(e.tile());n&&n.player()===this.player()&&a.length<2&&(this.buildItemInCity(n),this.#G.getByPlayerAndType(this.player(),ci).buy(n))}async canNegotiate(e){let r=Array.from(new Set(e.tile().getNeighbours().flatMap(n=>this.#p.getByTile(n).map(a=>a.player()).filter(a=>a!==this.player()))));r.length!==0&&await r.filter(n=>this.#T.getByPlayer(n).filter(a=>a instanceof Wp&&a.isBetween(n,this.player())).every(a=>this.#U.value()-a.when()>Rq)).reduce((n,a)=>n.then(()=>this.handleNegotiation(a)),Promise.resolve())}async handleNegotiation(e){let r=new Wp(this.player(),e,this.#O);for(r.proceed(new vn(this.player(),r,this.#O));!r.terminated();){let n=r.lastInteraction();if(await(n!==null?n.for():r.players().slice(1)).reduce(async(s,m)=>s.then(async()=>{let f=this.#I.getByPlayer(m),u=r.nextSteps(),O=await Promise.race([f.chooseFromList(new Mm(u,"negotiation.next-step",r)),f instanceof xl?cD(500,new Error(`Timeout waiting for ${f.player().id()} (${f.player().civilization().sourceClass().name}) - sent ${u.length} options`)):new Promise(()=>{})]);!O||(r.proceed(O),O instanceof Bn&&await O.proposal().resolve(O),await cD(20))}).catch(f=>console.error(f)),Promise.resolve()),r.terminated())break}return this.#T.register(r),r}noOrders(e){e.action(new In(e.tile(),e.tile(),e,this.#O))}shouldAttack(e){let r=this.#p.getByPlayer(this.player()).reduce((s,m)=>s+m.attack().value()+m.defence().value(),0),n=this.#p.getByPlayer(e).reduce((s,m)=>s+m.attack().value()+m.defence().value(),0);return r*1>=n}};t(IO,"SimpleAIClient");qs=IO});var Hn,jl,Hl=i(()=>{Mr();Hn=class extends ve{};t(Hn,"American");jl=Hn});var vq={};var yD=i(()=>{Hl();to();Br();Object.entries({people:"American",nation:"America",colors:["#0055A4","#FFF"]}).forEach(([o,e])=>Te.register(new Me(jl,o,e)))});var bq={};var dD=i(()=>{Hl();Gr();Wt();["Washington","New York","Los Angeles","Chicago","Houston","Phoenix","Philadelphia","San Antonio","San Diego","Dallas","San Jose","Austin","Jacksonville","Fort Worth","Columbus","San Francisco","Charlotte","Indianapolis","Seattle","Denver","Boston","El Paso","Detroit","Nashville","Portland","Memphis","Oklahoma City","Las Vegas","Louisville","Baltimore","Milwaukee","Albuquerque","Tucson","Fresno","Mesa","Sacramento","Atlanta","Kansas City","Colorado Springs","Miami","Raleigh","Omaha","Long Beach","Virginia Beach","Oakland","Minneapolis","Tulsa","Arlington","Tampa","New Orleans","Wichita","Cleveland","Bakersfield","Aurora","Anaheim","Honolulu","Santa Ana","Riverside","Corpus Christi","Lexington","Stockton","Henderson","Saint Paul","St. Louis","Cincinnati","Pittsburgh","Greensboro","Anchorage","Plano","Lincoln","Orlando","Irvine","Newark","Toledo","Durham","Chula Vista","Fort Wayne","Jersey City","St. Petersburg","Laredo","Madison","Chandler","Buffalo","Lubbock","Scottsdale","Reno","Glendale","Gilbert","Winston\u2013Salem","North Las Vegas","Norfolk","Chesapeake","Garland","Irving","Hialeah","Fremont","Boise","Richmond","Baton Rouge","Spokane","Des Moines","Tacoma","San Bernardino","Modesto","Fontana","Santa Clarita","Birmingham","Oxnard","Fayetteville","Moreno Valley","Rochester","Huntington Beach","Salt Lake City","Grand Rapids","Amarillo","Yonkers","Montgomery","Akron","Little Rock","Huntsville","Augusta","Port St. Lucie","Grand Prairie","Tallahassee","Overland Park","Tempe","McKinney","Mobile","Cape Coral","Shreveport","Frisco","Knoxville","Worcester","Brownsville","Vancouver","Fort Lauderdale","Sioux Falls","Ontario","Chattanooga","Providence","Newport News","Rancho Cucamonga","Santa Rosa","Oceanside","Salem","Elk Grove","Garden Grove","Pembroke Pines","Peoria","Eugene","Corona","Cary","Springfield","Fort Collins","Jackson","Alexandria","Hayward","Lancaster","Lakewood","Clarksville","Palmdale","Salinas","Hollywood","Pasadena","Sunnyvale","Macon","Pomona","Escondido","Killeen","Naperville","Joliet","Bellevue","Rockford","Savannah","Paterson","Torrance","Bridgeport","McAllen","Mesquite","Syracuse","Midland","Murfreesboro","Miramar","Dayton","Fullerton","Olathe","Orange","Thornton","Roseville","Denton","Waco","Surprise","Carrollton","West Valley City","Charleston","Warren","Hampton","Gainesville","Visalia","Coral Springs","Columbia","Cedar Rapids","Sterling Heights","New Haven","Stamford","Concord","Kent","Santa Clara","Elizabeth","Round Rock","Thousand Oaks","Lafayette","Athens","Topeka","Simi Valley","Fargo","Norman","Abilene","Wilmington","Hartford","Victorville","Pearland","Vallejo","Ann Arbor","Berkeley","Allentown","Richardson","Odessa","Arvada","Cambridge","Sugar Land","Beaumont","Lansing","Evansville","Independence","Fairfield","Provo","Clearwater","College Station","West Jordan","Carlsbad","El Monte","Murrieta","Temecula","Palm Bay","Costa Mesa","Westminster","North Charleston","Miami Gardens","Manchester","High Point","Downey","Clovis","Pompano Beach","Pueblo","Elgin","Lowell","Antioch","West Palm Beach","Everett","Ventura","Centennial","Lakeland","Gresham","Billings","Inglewood","Broken Arrow","Sandy Springs","Jurupa Valley","Hillsboro","Waterbury","Santa Maria","Boulder","Greeley","Daly City","Meridian","Lewisville","Davie","West Covina","League City","Tyler","Norwalk","San Mateo","Green Bay","Wichita Falls","Sparks","Burbank","Rialto","Allen","El Cajon","Las Cruces","Renton","Davenport","South Bend","Vista","Tuscaloosa","Clinton","Edison","Woodbridge","San Angelo","Kenosha","Vacaville"].forEach((o,e)=>ae.register(new ye(o,jl,e===0)))});var hD=I(gD=>{"use strict";Object.defineProperty(gD,"__esModule",{value:!0});yD();dD()});var _n,mf,lf=i(()=>{Mr();_n=class extends ve{};t(_n,"Aztec");mf=_n});var Cq={};var xD=i(()=>{lf();to();Br();Object.entries({people:"Aztec",nation:"Aztec",colors:["#A1DAB5","#EA6B76"]}).forEach(([o,e])=>Te.register(new Me(mf,o,e)))});var Tq={};var OD=i(()=>{lf();Gr();Wt();["Tenochtitlan","Teotihuacan","Tlatelolco","Texcoco","Tlaxcala","Calixtlahuaca","Xochicalco","Tlacopan","Atzcapotzalco","Tzintzuntzan","Malinalco","Tula","Tamuin","Teayo","Cempoala","Chalco","Tlalmanalco","Ixtapaluca","Huexotla","Tepexpan","Tepetlaoxtoc","Chiconautla","Zitlaltepec","Coyotepec","Tequixquiac","Jilotzingo","Tlapanaloya","Tultitan","Ecatepec","Coatepec","Chalchiuites","Chiauhita","Chapultepec","Itzapalapa","Ayotzinco","Iztapam"].forEach((o,e)=>ae.register(new ye(o,mf,e===0)))});var vD=I(RD=>{"use strict";Object.defineProperty(RD,"__esModule",{value:!0});xD();OD()});var Kn,pf,ff=i(()=>{Mr();Kn=class extends ve{};t(Kn,"Babylonian");pf=Kn});var Pq={};var bD=i(()=>{ff();to();Br();Object.entries({people:"Babylonian",nation:"Babylon",colors:["#D0B8A6","#2f7b00"]}).forEach(([o,e])=>Te.register(new Me(pf,o,e)))});var Iq={};var CD=i(()=>{ff();Gr();Wt();["Babilim","Eshnunna","Diniktum","Tutub","Der","Sippar","Kutha","Jemdet Nasr","Kish","Borsippa","Mashkan-shapir","Dilbat","Nippur","Marad","Adab","Isin","Kisurra","Shuruppak","Bad-tibira","Zabalam","Umma","Girsu","Lagash","Urum","Uruk","Larsa","Ur","Kuara","Eridu","Akshak","Akkad"].forEach((o,e)=>ae.register(new ye(o,pf,e===0)))});var PD=I(TD=>{"use strict";Object.defineProperty(TD,"__esModule",{value:!0});bD();CD()});var qn,uf,cf=i(()=>{Mr();qn=class extends ve{};t(qn,"Chinese");uf=qn});var wq={};var ID=i(()=>{cf();to();Br();Object.entries({people:"Chinese",nation:"China",colors:["#ee1c25","#ff0"]}).forEach(([o,e])=>Te.register(new Me(uf,o,e)))});var Aq={};var wD=i(()=>{cf();Gr();Wt();["Beijing","Shanghai","Chongqing","Tianjin","Guangzhou","Shenzhen","Chengdu","Nanjing","Wuhan","Xi'an","Hangzhou","Dongguan","Foshan","Shenyang","Harbin","Qingdao","Dalian","Jinan","Zhengzhou","Changsha","Kunming","Changchun","\xDCr\xFCmqi","Shantou","Hefei","Shijiazhuang","Ningbo","Taiyuan","Nanning","Xiamen","Fuzhou","Changzhou","Wenzhou","Nanchang","Tangshan","Guiyang","Wuxi","Lanzhou","Zhongshan","Handan","Huai'an","Weifang","Zibo","Shaoxing","Yantai","Huizhou","Luoyang","Nantong","Baotou","Liuzhou"].forEach((o,e)=>ae.register(new ye(o,uf,e===0)))});var BD=I(AD=>{"use strict";Object.defineProperty(AD,"__esModule",{value:!0});ID();wD()});var Vn,yf,df=i(()=>{Mr();Vn=class extends ve{};t(Vn,"Egyptian");yf=Vn});var Bq={};var GD=i(()=>{df();to();Br();Object.entries({people:"Egyptian",nation:"Egypt",colors:["#CE1126","#FFF"]}).forEach(([o,e])=>Te.register(new Me(yf,o,e)))});var Gq={};var MD=i(()=>{df();Gr();Wt();["Cairo","Alexandria","Gizeh","Shubra El-Kheima","Port Said","Suez","Luxor","al-Mansura","El-Mahalla El-Kubra","Tanta","Asyut","Ismailia","Fayyum","Zagazig","Aswan","Damietta","Damanhur","al-Minya","Beni Suef","Qena","Sohag","Hurghada","6th of October City","Shibin El Kom","Banha","Kafr el-Sheikh","Arish","Mallawi","10th of Ramadan City","Bilbais","Marsa Matruh","Idfu","Mit Ghamr","Al-Hamidiyya","Desouk","Qalyub","Abu Kabir","Kafr el-Dawwar","Girga","Akhmim","Matarey"].forEach((o,e)=>ae.register(new ye(o,yf,e===0)))});var DD=I(UD=>{"use strict";Object.defineProperty(UD,"__esModule",{value:!0});GD();MD()});var Jn,_l,Kl=i(()=>{Mr();Jn=class extends ve{};t(Jn,"English");_l=Jn});var Mq={};var ED=i(()=>{Kl();to();Br();Object.entries({people:"English",nation:"England",colors:["#FFF","#C8102E"]}).forEach(([o,e])=>Te.register(new Me(_l,o,e)))});var Uq={};var kD=i(()=>{Kl();Gr();Wt();["London","Birmingham","Liverpool","Leeds","Sheffield","Bristol","Manchester","Leicester","Coventry","Kingston upon Hull","Stoke-on-Trent","Wolverhampton","Nottingham","Plymouth","Southampton","Reading","Derby","Dudley","Newcastle upon Tyne","Northampton","Portsmouth","Luton","Preston","Sunderland","Norwich","Walsall","Bournemouth","Southend-on-Sea","Swindon","Huddersfield","Poole","Oxford","Middlesbrough","Blackpool","Oldbury","Boldon","Ipswich","York","West Bromwich","Peterborough","Stockport","Brighton","Slough","Gloucester","Rotherham","Cambridge","Exeter","Eastbourne","Sutton Coldfield","Blackburn","Colchester","Oldham","St Helens","Woking","Chesterfield","Crawley"].forEach((o,e)=>ae.register(new ye(o,_l,e===0)))});var FD=I(SD=>{"use strict";Object.defineProperty(SD,"__esModule",{value:!0});ED();kD()});var $n,gf,hf=i(()=>{Mr();$n=class extends ve{};t($n,"French");gf=$n});var Dq={};var ND=i(()=>{hf();to();Br();Object.entries({people:"French",nation:"France",colors:["#FFF","#0055A4"]}).forEach(([o,e])=>Te.register(new Me(gf,o,e)))});var Eq={};var WD=i(()=>{hf();Gr();Wt();["Paris","Marseille","Lyon","Toulouse","Nice","Nantes","Strasbourg","Montpellier","Bordeaux","Lille","Rennes","Reims","Le Havre","Saint-\xC9tienne","Toulon","Grenoble","Dijon","N\xEEmes","Angers","Villeurbanne","Le Mans","Saint-Denis","Aix-en-Provence","Clermont-Ferrand","Brest","Limoges","Tours","Amiens","Perpignan","Metz","Besan\xE7on","Boulogne-Billancourt","Orl\xE9ans","Mulhouse","Rouen","Caen","Argenteuil","Saint-Paul","Montreuil","Nancy","Roubaix","Tourcoing","Nanterre","Avignon","Vitry-sur-Seine","Cr\xE9teil","Dunkirk","Poitiers","Asni\xE8res-sur-Seine","Courbevoie","Versailles","Colombes","Fort-de-France","Aulnay-sous-Bois","Saint-Pierre","Rueil-Malmaison","Pau","Aubervilliers","Le Tampon","Champigny-sur-Marne","Antibes","B\xE9ziers","La Rochelle","Saint-Maur-des-Foss\xE9s","Cannes","Calais","Saint-Nazaire","M\xE9rignac","Drancy","Colmar","Ajaccio","Bourges","Issy-les-Moulineaux","Levallois-Perret","La Seyne-sur-Mer","Quimper","Noisy-le-Grand","Villeneuve-d'Ascq","Neuilly-sur-Seine","Valence","Antony","Cergy","V\xE9nissieux","Pessac","Troyes","Clichy","Ivry-sur-Seine","Chamb\xE9ry","Lorient","Les Abymes","Montauban","Sarcelles","Niort","Villejuif","Saint-Andr\xE9","Hy\xE8res","Saint-Quentin","Beauvais","\xC9pinay-sur-Seine","Cayenne","Maisons-Alfort","Cholet","Meaux","Chelles","Pantin","\xC9vry","Fontenay-sous-Bois","Fr\xE9jus","Vannes","Bondy","Le Blanc-Mesnil","La Roche-sur-Yon","Saint-Louis","Arles","Clamart","Narbonne","Annecy","Sartrouville","Grasse","Laval","Belfort","Bobigny","\xC9vreux","Vincennes","Montrouge","Sevran","Albi","Charleville-M\xE9zi\xE8res","Suresnes","Martigues","Corbeil-Essonnes","Saint-Ouen","Bayonne","Cagnes-sur-Mer","Brive-la-Gaillarde","Carcassonne","Massy","Blois","Aubagne","Saint-Brieuc","Ch\xE2teauroux","Chalon-sur-Sa\xF4ne","Mantes-la-Jolie","Meudon","Saint-Malo","Ch\xE2lons-en-Champagne","Alfortville","S\xE8te","Salon-de-Provence","Vaulx-en-Velin","Puteaux","Rosny-sous-Bois","Saint-Herblain","Gennevilliers","Le Cannet","Livry-Gargan","Saint-Priest","Istres","Valenciennes","Choisy-le-Roi","Caluire-et-Cuire","Boulogne-sur-Mer","Bastia","Angoul\xEAme","Garges-l\xE8s-Gonesse","Castres","Thionville","Wattrelos","Talence","Saint-Laurent-du-Maroni","Douai","Noisy-le-Sec","Tarbes","Arras","Al\xE8s","La Courneuve","Bourg-en-Bresse","Compi\xE8gne","Gap","Melun","Le Lamentin","Rez\xE9","Saint-Germain-en-Laye","Marcq-en-Bar\u0153ul","Gagny","Anglet","Draguignan","Chartres","Bron","Bagneux","Colomiers","Saint-Martin-d'H\xE8res","Pontault-Combault","Montlu\xE7on","Jou\xE9-l\xE8s-Tours","Saint-Joseph","Poissy","Savigny-sur-Orge","Cherbourg-Octeville","Mont\xE9limar","Villefranche-sur-Sa\xF4ne","Stains","Saint-Beno\xEEt","Bagnolet","Ch\xE2tillon","Le Port","Sainte-Genevi\xE8ve-des-Bois","\xC9chirolles","Roanne","Villepinte","Saint-Chamond","Conflans-Sainte-Honorine","Auxerre","Nevers","Neuilly-sur-Marne","La Ciotat","Tremblay-en-France","Thonon-les-Bains","Vitrolles","Haguenau","Six-Fours-les-Plages","Agen","Creil","Annemasse","Saint-Rapha\xEBl","Marignane","Romans-sur-Is\xE8re","Montigny-le-Bretonneux","Le Perreux-sur-Marne","Franconville","M\xE2con","Saint-Leu","Cambrai","Ch\xE2tenay-Malabry","Sainte-Marie","Villeneuve-Saint-Georges","Houilles","\xC9pinal","Lens","Li\xE9vin","Les Mureaux","Schiltigheim","La Possession","Meyzieu","Dreux","Nogent-sur-Marne","Plaisir","Mont-de-Marsan","Palaiseau","Ch\xE2tellerault","Goussainville","L'Ha\xFF-les-Roses","Viry-Ch\xE2tillon","Vigneux-sur-Seine","Chatou","Trappes","Clichy-sous-Bois","Rillieux-la-Pape","Villenave-'Ornon","Maubeuge","Charenton-le-Pont","Malakoff","Matoury","Dieppe","Athis-Mons","Savigny-le-Temple","P\xE9rigueux","Baie-Mahault","Vandoeuvre-l\xE8s-Nancy","Pontoise","Aix-les-Bains","Cachan","Vienne","Thiais","Orange","Saint-M\xE9dard-en-Jalles","Villemomble","Saint-Cloud","Saint-Laurent-du-Var","Yerres","Saint-\xC9tienne-du-Rouvray","Sotteville-l\xE8s-Rouen","Draveil","Le Chesnay","Bois-Colombes","Le Plessis-Robinson","La Garenne-Colombes","Lambersart","Soissons","Pierrefitte-sur-Seine","Carpentras","Villiers-sur-Marne","Vanves","Menton","Bergerac","Ermont","Bezons","Grigny","Guyancourt","Saumur","Herblay","Ris-Orangis","Villiers-le-Bel","Bourgoin-Jallieu","Vierzon","Le Gosier","D\xE9cines-Charpieu","H\xE9nin-Beaumont","Fresnes","Aurillac","Sannois","Vallauris","Illkirch-Graffenstaden","Alen\xE7on","\xC9lancourt","Tournefeuille","B\xE8gles","Gonesse","Oullins","Brunoy","Taverny","Armenti\xE8res","Montfermeil","Rambouillet","Villeparisis","Le Kremlin-Bic\xEAtre","Sucy-en-Brie","Kourou","Montb\xE9liard","Romainville","Cavaillon","Saint-Dizier","Br\xE9tigny-sur-Orge","Saint-S\xE9bastien-sur-Loire","Saintes","La Teste-de-Buch","Villeneuve-la-Garenne","B\xE9thune","Bussy-Saint-Georges","Vichy","La Garde","Agde","Laon","Sens","Lunel","Miramas","Biarritz","Le Grand-Quevilly","Orvault","Les Ulis","Champs-sur-Marne","Rochefort","Muret","Sainte-Anne","Eaubonne","\xC9tampes","Gradignan","Vernon","Petit-Bourg","Libourne","Abbeville","Rodez","Saint-Ouen-l'Aum\xF4ne","Torcy","Maisons-Laffitte","Montgeron","Villeneuve-sur-Lot","Cormeilles-en-Parisis","\xC9pernay","S\xE8vres","Dole","Le Robert","Le Bouscat","Blagnac","Frontignan","Cenon","Mandelieu-la-Napoule","Vertou","Les Lilas","Bruay-la-Buissi\xE8re","Les Pavillons-sous-Bois","Chaumont","Roissy-en-Brie","Le Moule","Le Petit-Quevilly","Manosque","Saint-Mand\xE9","Fontenay-aux-Roses","Orly","Le Creusot","Oyonnax","La Madeleine","Sainte-Suzanne","Millau","Combs-la-Ville","Fontaine","Deuil-la-Barre","Coudekerque-Branche","Auch","Lanester","Beaune","Montigny-l\xE8s-Metz","Hazebrouck","Longjumeau","Sainte-Foy-l\xE8s-Lyon","Forbach","Sarreguemines","Mons-en-Bar\u0153ul","La Valette-du-Var","H\xE9rouville-Saint-Clair","Morsang-sur-Orge","Grande-Synthe","La Celle-Saint-Cloud","Lisieux","Croix","Dammarie-les-Lys","V\xE9lizy-Villacoublay","Wasquehal","Saint-Gratien","Halluin","Neuilly-Plaisance","Montmorency","Dax","Lagny-sur-Marne","Le M\xE9e-sur-Seine","Saint-Genis-Laval","Fleury-les-Aubrais","Loos","Gif-sur-Yvette","Denain","Saint-Di\xE9-des-Vosges","Sainte-Rose","Saint-Michel-sur-Orge"].forEach((o,e)=>ae.register(new ye(o,gf,e===0)))});var LD=I(YD=>{"use strict";Object.defineProperty(YD,"__esModule",{value:!0});ND();WD()});var Zn,ql,Vl=i(()=>{Mr();Zn=class extends ve{};t(Zn,"German");ql=Zn});var kq={};var zD=i(()=>{Vl();to();Br();Object.entries({people:"German",nation:"Germany",colors:["#000","#FC0"]}).forEach(([o,e])=>Te.register(new Me(ql,o,e)))});var Sq={};var jD=i(()=>{Vl();Gr();Wt();["Berlin","Hamburg","Munich","Cologne","Frankfurt","Stuttgart","D\xFCsseldorf","Dortmund","Essen","Leipzig","Bremen","Dresden","Hanover","Nuremberg","Duisburg","Bochum","Wuppertal","Bielefeld","Bonn","M\xFCnster","Karlsruhe","Mannheim","Augsburg","Wiesbaden","Gelsenkirchen","M\xF6nchengladbach","Braunschweig","Chemnitz","Kiel","Aachen","Halle","Magdeburg","Freiburg","Krefeld","L\xFCbeck","Oberhausen","Erfurt","Mainz","Rostock","Kassel","Hagen","Hamm","Saarbr\xFCcken","M\xFClheim an der Ruhr","Potsdam","Ludwigshafen am Rhein","Oldenburg","Leverkusen","Osnabr\xFCck","Solingen"].forEach((o,e)=>ae.register(new ye(o,ql,e===0)))});var _D=I(HD=>{"use strict";Object.defineProperty(HD,"__esModule",{value:!0});zD();jD()});var Qn,xf,Of=i(()=>{Mr();Qn=class extends ve{};t(Qn,"Greek");xf=Qn});var Fq={};var KD=i(()=>{Of();to();Br();Object.entries({people:"Greek",nation:"Greece",colors:["#2175D8","#FFF"]}).forEach(([o,e])=>Te.register(new Me(xf,o,e)))});var Nq={};var qD=i(()=>{Of();Gr();Wt();["Athens","Thessaloniki","Patras","Piraeus","Larissa","Heraklion","Peristeri","Kallithea","Acharnes","Kalamaria","Nikaia","Glyfada","Volos","Ilio","Ilioupoli","Keratsini","Evosmos","Chalandri","Nea Smyrni","Marousi","Agios Dimitrios","Zografou","Egaleo","Nea Ionia","Ioannina","Palaio Faliro","Korydallos","Trikala","Vyronas","Agia Paraskevi","Galatsi","Agrinio","Chalcis","Petroupoli","Serres","Alexandroupoli","Xanthi","Katerini","Kalamata","Kavala","Chania","Lamia","Komotini","Irakleio","Rhodes","Kifissia","Stavroupoli","Chaidari","Drama","Veria","Alimos","Kozani","Polichni","Karditsa","Sykies","Ampelokipoi","Pylaia","Agioi Anargyroi","Argyroupoli","Ano Liosia","Rethymno","Ptolemaida","Tripoli","Cholargos","Vrilissia","Aspropyrgos","Corinth","Gerakas","Metamorfosi","Giannitsa","Voula","Kamatero","Mytilene","Neapoli","Eleftherio-Kordelio","Chios","Agia Varvara","Kaisariani","Nea Filadelfeia","Moschato","Perama","Salamina","Eleusis","Corfu","Pyrgos","Megara","Kilkis","Dafni","Thebes","Melissia","Argos","Arta","Artemida","Livadeia","Pefki","Oraiokastro","Aigio","Kos","Koropi","Preveza","Naousa","Orestiada","Peraia","Edessa","Florina","Panorama","Nea Erythraia1","Elliniko1","Amaliada","Pallini","Sparta","Agios Ioannis Rentis","Thermi","Vari","Nea Makri","Tavros","Alexandreia","Menemeni","Paiania","Kalyvia Thorikou","Nafplio","Drapetsona","Efkarpia","Papagou","Nafpaktos","Kastoria","Grevena","Pefka","Nea Alikarnassos","Missolonghi","Gazi","Ierapetra","Kalymnos","Rafina","Loutraki","Agios Nikolaos","Ermoupoli","Ialysos","Mandra","Tyrnavos","Glyka Nera","Ymittos","Neo Psychiko"].forEach((o,e)=>ae.register(new ye(o,xf,e===0)))});var JD=I(VD=>{"use strict";Object.defineProperty(VD,"__esModule",{value:!0});KD();qD()});var Xn,Rf,vf=i(()=>{Mr();Xn=class extends ve{};t(Xn,"Indian");Rf=Xn});var Wq={};var $D=i(()=>{vf();to();Br();Object.entries({people:"Indian",nation:"India",colors:["#138808","#FF9933"]}).forEach(([o,e])=>Te.register(new Me(Rf,o,e)))});var Yq={};var ZD=i(()=>{vf();Gr();Wt();["Delhi","Mumbai","Bangalore","Hyderabad","Ahmedabad","Chennai","Kolkata","Surat","Pune","Jaipur","Lucknow","Kanpur","Nagpur","Indore","Thane","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara","Ghaziabad","Ludhiana","Agra","Nashik","Faridabad","Meerut","Rajkot","Kalyan-Dombivli","Vasai-Virar","Varanasi","Srinagar","Aurangabad","Dhanbad","Amritsar","Navi Mumbai","Allahabad","Howrah","Ranchi","Gwalior","Jabalpur","Coimbatore","Vijayawada","Jodhpur","Madurai","Raipur","Kota","Chandigarh","Guwahati","Solapur","Hubli\u2013Dharwad","Tiruchirappalli","Bareilly","Moradabad","Mysore","Tiruppur","Gurgaon","Aligarh","Jalandhar","Bhubaneswar","Salem","Mira-Bhayandar","Warangal","Jalgaon","Guntur","Bhiwandi","Saharanpur","Gorakhpur","Bikaner","Amravati","Noida","Jamshedpur","Bhilai","Cuttack","Firozabad","Kochi","Nellore","Bhavnagar","Dehradun","Durgapur","Asansol","Rourkela","Nanded","Kolhapur","Ajmer","Akola","Gulbarga","Jamnagar","Ujjain","Loni","Siliguri","Jhansi","Ulhasnagar","Jammu","Sangli-Miraj & Kupwad","Mangalore","Erode","Belgaum","Ambattur","Tirunelveli","Malegaon","Gaya","Thiruvananthapuram","Udaipur","Maheshtala","Davanagere","Kozhikode","Kurnool","Rajpur Sonarpur","Rajahmundry","Bokaro","South Dumdum","Bellary","Patiala","Gopalpur","Agartala","Bhagalpur","Muzaffarnagar","Bhatpara","Panihati","Latur","Dhule","Tirupati","Rohtak","Korba","Bhilwara","Berhampur","Muzaffarpur","Ahmednagar","Mathura","Kollam","Avadi","Kadapa","Kamarhati","Sambalpur","Bilaspur","Shahjahanpur","Satara","Bijapur","Kakinada","Rampur","Shimoga","Chandrapur","Junagadh","Thrissur","Alwar","Bardhaman","Kulti","Nizamabad","Parbhani","Tumkur","Khammam","Ozhukarai","Bihar Sharif","Panipat","Darbhanga","Bally","Aizawl","Dewas","Ichalkaranji","Karnal","Bathinda","Jalna","Eluru","Barasat","Kirari Suleman Nagar","Purnia","Satna","Mau","Sonipat","Farrukhabad","Sagar","Durg","Imphal","Ratlam","Hapur","Arrah","Anantapur","Karimnagar","Etawah","Ambarnath","North Dumdum","Bharatpur","Begusarai","New Delhi","Gandhidham","Baranagar","Tiruvottiyur","Pondicherry","Sikar","Thoothukudi","Rewa","Mirzapur","Raichur","Pali","Ramagundam","Haridwar","Vijayanagaram","Katihar","Nagercoil","Sri Ganganagar","Karawal Nagar","Mango","Thanjavur","Bulandshahr","Uluberia","Katni","Sambhal","Singrauli","Nadiad","Secunderabad","Naihati","Yamunanagar","Bidhannagar","Pallavaram","Bidar","Munger","Panchkula","Burhanpur","Raurkela Industrial Township","Kharagpur","Dindigul","Gandhinagar","Hospet","Nangloi Jat","Malda","Ongole","Deoghar","Chapra","Haldia","Khandwa","Nandyal","Morena","Amroha","Anand","Bhind","Bhalswa Jahangir Pur","Madhyamgram","Bhiwani","Berhampore","Ambala","Morbi","Fatehpur","Raebareli","Mahaboobnagar","Chittoor","Bhusawal","Orai","Bahraich","Vellore","Mehsana","Raiganj","Sirsa","Danapur","Serampore","Sultan Pur Majra","Guna","Jaunpur","Panvel","Shivpuri","Surendranagar Dudhrej","Unnao","Chinsurah","Alappuzha","Kottayam","Machilipatnam","Shimla","Adoni","Udupi","Tenali","Proddatur","Saharsa","Hindupur","Sasaram","Hajipur","Bhimavaram","Kumbakonam","Dehri","Madanapalle","Siwan","Bettiah","Guntakal","Srikakulam","Motihari","Dharmavaram","Gudivada","Phagwara","Narasaraopet","Suryapet","Miryalaguda","Tadipatri","Karaikudi","Kishanganj","Jamalpur","Ballia","Kavali","Tadepalligudem","Amaravati","Buxar","Jehanabad","Gangtok"].forEach((o,e)=>ae.register(new ye(o,Rf,e===0)))});var XD=I(QD=>{"use strict";Object.defineProperty(QD,"__esModule",{value:!0});$D();ZD()});var ea,bf,Cf=i(()=>{Mr();ea=class extends ve{};t(ea,"Mongol");bf=ea});var Lq={};var eE=i(()=>{Cf();to();Br();Object.entries({people:"Mongol",nation:"Mongolia",colors:["#DA2032","#0066B3"]}).forEach(([o,e])=>Te.register(new Me(bf,o,e)))});var zq={};var tE=i(()=>{Cf();Gr();Wt();["Ulaanbaatar","Erdenet","Darkhan","Choibalsan","M\xF6r\xF6n","Nalaikh","Bayankhongor","\xD6lgii","Khovd","Arvaikheer","Ulaangom","Baganuur","Sainshand","Tsetserleg","S\xFCkhbaatar","\xD6nd\xF6rkhaan","Dalanzadgad","Z\xFC\xFCnkharaa","Uliastai","Altai","Baruun-Urt","Mandalgovi","Zuunmod","Zamyn-\xDC\xFCd","Bulgan","Kharkhorin","Choir","Bor-\xD6nd\xF6r","Sharyngo"].forEach((o,e)=>ae.register(new ye(o,bf,e===0)))});var oE=I(rE=>{"use strict";Object.defineProperty(rE,"__esModule",{value:!0});eE();tE()});var ta,Tf,Pf=i(()=>{Mr();ta=class extends ve{};t(ta,"Roman");Tf=ta});var jq={};var iE=i(()=>{Pf();to();Br();Object.entries({people:"Roman",nation:"Rome",colors:["#A20101","#D1B24F"]}).forEach(([o,e])=>Te.register(new Me(Tf,o,e)))});var Hq={};var nE=i(()=>{Pf();Gr();Wt();["Roma","Ariminum","Belum","Placentia","Tarraco","Italica","Mod","Salernum","Bononia","Forum Livii","Regium Lepidi","Aquileia","Ascrivium","Valentia Edetanorum","Scalabis","Villa Euracini","Palma","Colonia Narbo Martius","Massa","Pistoria","Segovia","Gerunda","Pompaelo","Naissus","Brigantium","Florentia","Vesontio","Lutetia Parisiorum","Atuatuca Tungrorum","Iulia Romula Hispalis","Augusta Raurica","Noviodunum","Lugdunum","Siscia","Marsonia","Augusta Treverorum","Castra Legionis","Augusta Taurinorum","Augusta Praetoria Salassorum","Emerita Augusta","Norba Caesarina","Lucus Augusta","Caesarea","Bracara Augusta","Novaesium","Castra Vetera","Pons Drusi","Ovilava","Iuvavum","Augusta Vindelicorum","Turicum","Asturica Augusta","Borbetomagus","Caesaraugusta","Sirmium","Sorviodurum","Mogontiacum","Argentoratum","Bonna","Noviomagus","Castellum apud Confluentes","Divodurum","Caesaromagus","Ambianum","Faventia Paterna Barcino","Abila","Lousonna","Ulpia Noviomagus Batavorum","Rigomagus","Aquae Mattiacorum","Mursa","Emona","Vindonissa","Aventicum","Praetorium Agrippinae","Lugdunum Batavorum","Aequum","Londinium","Albanianis","Lauri","Durovernum Cantiacorum","Regulbium","Rutupiae","Viminacium","Camulodunum","Traiectum","Matilo","Forum Hadriani","Nigrum Pullum","Lindum Colonia","Ratae Corieltauvorum","Durocobrivis","Colonia Agrippina","Durocornovium","Verulamium","Letocetum","Dubris","Danum","Mediolanum","Isca Dumnoniorum","Blestium","Viroconium Cornoviorum","Aquae Sulis","Durnovaria","Lindinis","Ad Flexum","Clausentum","Venta Belgarum","Calleva Atrebatum","Duroliponte","Concangis","Condate","Corinium Dobunnorum","Eboracum","Luguvalium","Arae Flaviae","Isca Augusta","Lagentium","Lopodunum","Moridunum","Venta Silurum","Deva Victrix","Mamucium","Olicana","Vinovia","Bonames","Coria","Gerulata","Vindobona","Biriciana","Cannstatt Castrum","Colonia Nervia Glevensium","Sumelocenna","Traiectum ad Nicrem","Castra Batavar","Nida","Lactodurum","Bovium","Burgodunum","Lentia","Aquae Granni","Complutum","Aeminium","Traiectum ad Mosam","Coriovallum","Portus Lemanis","Andautonia","Salona","Cibalae","Aquae Helveticae","Aquincum","Apulum","Pons Aelius","Durovigutum","Aelia Capitolina","Ala","Castra Regina","Theranda","Pomaria","Partiscum","Gesoriacum","Aurelia Aquensis","Urbs Aurelianorum","Venetiae","Ragusium"].forEach((o,e)=>ae.register(new ye(o,Tf,e===0)))});var sE=I(aE=>{"use strict";Object.defineProperty(aE,"__esModule",{value:!0});iE();nE()});var ra,Jl,$l=i(()=>{Mr();ra=class extends ve{};t(ra,"Russian");Jl=ra});var _q={};var mE=i(()=>{$l();to();Br();Object.entries({people:"Russian",nation:"Russia",colors:["#0032A0","#DA291C"]}).forEach(([o,e])=>Te.register(new Me(Jl,o,e)))});var Kq={};var lE=i(()=>{$l();Gr();Wt();["Moscow","Saint Petersburg","Novosibirsk","Yekaterinburg","Nizhny Novgorod","Kazan","Chelyabinsk","Omsk","Samara","Ufa","Rostov-on-Don","Krasnoyarsk","Voronezh","Perm","Volgograd","Krasnodar","Saratov","Tyumen","Makhachkala","Tolyatti","Barnaul","Ulyanovsk","Izhevsk","Vladivostok","Irkutsk","Khabarovsk","Yaroslavl","Tomsk","Orenburg","Kemerovo","Novokuznetsk","Tula","Ryazan","Kirov","Astrakhan","Naberezhnye Chelny","Sochi","Penza","Lipetsk","Cheboksary","Balashikha","Kaliningrad","Kursk","Stavropol","Ulan-Ude","Bryansk","Tver","Magnitogorsk","Ivanovo","Belgorod","Surgut","Vladimir","Arkhangelsk","Nizhny Tagil","Kaluga","Chita","Saransk","Yakutsk","Smolensk","Podolsk","Volzhsky","Vladikavkaz","Vologda","Cherepovets","Kurgan","Oryol","Grozny","Murmansk","Tambov","Petrozavodsk","Sterlitamak","Kostroma","Nizhnevartovsk","Novorossiysk","Yoshkar-Ola","Taganrog","Komsomolsk-on-Amur","Khimki","Syktyvkar","Nalchik","Nizhnekamsk","Shakhty","Dzerzhinsk","Bratsk","Orsk","Angarsk","Engels","Blagoveshchensk","Stary Oskol","Veliky Novgorod","Korolyov","Pskov","Mytishchi","Biysk","Lyubertsy","Prokopyevsk","Yuzhno-Sakhalinsk","Balakovo","Armavir","Rybinsk","Severodvinsk","Abakan","Petropavlovsk-Kamchatsky","Norilsk","Syzran","Volgodonsk","Ussuriysk","Kamensk-Uralsky","Novocherkassk","Zlatoust","Elektrostal","Almetyevsk","Krasnogorsk","Salavat","Miass","Nakhodka","Kopeysk","Pyatigorsk","Rubtsovsk","Berezniki","Kolomna","Maykop","Odintsovo","Khasavyurt","Kovrov","Kislovodsk","Neftekamsk","Nefteyugansk","Novocheboksarsk","Serpukhov","Shchyolkovo","Novomoskovsk","Bataysk","Pervouralsk","Domodedovo","Derbent","Cherkessk","Orekhovo-Zuyevo","Nevinnomyssk","Dimitrovgrad","Nazran","Kyzyl","Oktyabrsky","Obninsk","Kaspiysk","Novy Urengoy","Ramenskoye","Kamyshin","Murom","Zhukovsky"].forEach((o,e)=>ae.register(new ye(o,Jl,e===0)))});var fE=I(pE=>{"use strict";Object.defineProperty(pE,"__esModule",{value:!0});mE();lE()});var oa,If,wf=i(()=>{Mr();oa=class extends ve{};t(oa,"Zulu");If=oa});var qq={};var uE=i(()=>{wf();to();Br();Object.entries({people:"Zulu",nation:"Zulus",colors:["#FFFD1E","#000"]}).forEach(([o,e])=>Te.register(new Me(If,o,e)))});var Vq={};var cE=i(()=>{wf();Gr();Wt();["uMgungundlovu","Nobamba","Bulawayo","KwaDukuza","Nongoma","oNdini","Nodwengu","Ndondakusuka","Babanango","Khangela","Kwahlomendlini","Hlobane","eThekwini","Mlambongwenya","Eziqwaqweni","Isiphezi","Masotsheni","Mtunzini","Nyakamubi","Hlatikulu","Mthonjaneni","Empangeni","Pongola","Tungela","Kwamashu","Ingwavuma","Hluhluwe","Mtubatuba","Mhlahlandlela","Mthatha","Maseru","Lobamba","Qunu"].forEach((o,e)=>ae.register(new ye(o,If,e===0)))});var dE=I(yE=>{"use strict";Object.defineProperty(yE,"__esModule",{value:!0});uE();cE()});var Jq={};var gE=i(()=>{D();Qu();v.register(Zu)});var xE=I(hE=>{"use strict";Object.defineProperty(hE,"__esModule",{value:!0});gE()});var $q={};var OE=i(()=>{D();hx();v.register(uG)});var vE=I(RE=>{"use strict";Object.defineProperty(RE,"__esModule",{value:!0});OE()});var Zq={};var bE=i(()=>{D();xx();v.register(yG)});var TE=I(CE=>{"use strict";Object.defineProperty(CE,"__esModule",{value:!0});bE()});var Qq={};var PE=i(()=>{D();Ox();v.register(gG)});var wE=I(IE=>{"use strict";Object.defineProperty(IE,"__esModule",{value:!0});PE()});var Xq={};var AE=i(()=>{D();ec();v.register(Xu)});var GE=I(BE=>{"use strict";Object.defineProperty(BE,"__esModule",{value:!0});AE()});var e2={};var ME=i(()=>{D();Rx();v.register(OG)});var DE=I(UE=>{"use strict";Object.defineProperty(UE,"__esModule",{value:!0});ME()});var t2={};var EE=i(()=>{D();vx();v.register(vG)});var SE=I(kE=>{"use strict";Object.defineProperty(kE,"__esModule",{value:!0});EE()});var r2={};var FE=i(()=>{D();tc();v.register(bx)});var WE=I(NE=>{"use strict";Object.defineProperty(NE,"__esModule",{value:!0});FE()});var o2={};var YE=i(()=>{D();Cx();v.register(TG)});var zE=I(LE=>{"use strict";Object.defineProperty(LE,"__esModule",{value:!0});YE()});var i2={};var jE=i(()=>{D();Tx();v.register(IG)});var _E=I(HE=>{"use strict";Object.defineProperty(HE,"__esModule",{value:!0});jE()});var n2={};var KE=i(()=>{D();oc();v.register(rc)});var VE=I(qE=>{"use strict";Object.defineProperty(qE,"__esModule",{value:!0});KE()});var a2={};var JE=i(()=>{D();Px();v.register(BG)});var ZE=I($E=>{"use strict";Object.defineProperty($E,"__esModule",{value:!0});JE()});var s2={};var QE=i(()=>{D();nc();v.register(ic)});var ek=I(XE=>{"use strict";Object.defineProperty(XE,"__esModule",{value:!0});QE()});var m2={};var tk=i(()=>{D();Ix();v.register(UG)});var ok=I(rk=>{"use strict";Object.defineProperty(rk,"__esModule",{value:!0});tk()});var l2={};var ik=i(()=>{D();wx();v.register(EG)});var ak=I(nk=>{"use strict";Object.defineProperty(nk,"__esModule",{value:!0});ik()});var p2={};var sk=i(()=>{D();ac();v.register(zl)});var lk=I(mk=>{"use strict";Object.defineProperty(mk,"__esModule",{value:!0});sk()});var f2={};var pk=i(()=>{D();Ax();v.register(FG)});var uk=I(fk=>{"use strict";Object.defineProperty(fk,"__esModule",{value:!0});pk()});var u2={};var ck=i(()=>{D();Bx();v.register(WG)});var dk=I(yk=>{"use strict";Object.defineProperty(yk,"__esModule",{value:!0});ck()});var c2={};var gk=i(()=>{D();Gx();v.register(LG)});var xk=I(hk=>{"use strict";Object.defineProperty(hk,"__esModule",{value:!0});gk()});var y2={};var Ok=i(()=>{D();Mx();v.register(jG)});var vk=I(Rk=>{"use strict";Object.defineProperty(Rk,"__esModule",{value:!0});Ok()});var d2={};var bk=i(()=>{D();Ux();v.register(_G)});var Tk=I(Ck=>{"use strict";Object.defineProperty(Ck,"__esModule",{value:!0});bk()});var g2={};var Pk=i(()=>{D();Dx();v.register(qG)});var wk=I(Ik=>{"use strict";Object.defineProperty(Ik,"__esModule",{value:!0});Pk()});var h2={};var Ak=i(()=>{D();Ex();v.register(JG)});var Gk=I(Bk=>{"use strict";Object.defineProperty(Bk,"__esModule",{value:!0});Ak()});var x2={};var Mk=i(()=>{D();kx();v.register(ZG)});var Dk=I(Uk=>{"use strict";Object.defineProperty(Uk,"__esModule",{value:!0});Mk()});var O2={};var Ek=i(()=>{D();Sx();v.register(XG)});var Sk=I(kk=>{"use strict";Object.defineProperty(kk,"__esModule",{value:!0});Ek()});var R2={};var Fk=i(()=>{D();sc();v.register(Fx)});var Wk=I(Nk=>{"use strict";Object.defineProperty(Nk,"__esModule",{value:!0});Fk()});var v2={};var Yk=i(()=>{D();Nx();v.register(rM)});var zk=I(Lk=>{"use strict";Object.defineProperty(Lk,"__esModule",{value:!0});Yk()});var b2={};var jk=i(()=>{D();Wx();v.register(iM)});var _k=I(Hk=>{"use strict";Object.defineProperty(Hk,"__esModule",{value:!0});jk()});var C2={};var Kk=i(()=>{D();mc();v.register(nf)});var Vk=I(qk=>{"use strict";Object.defineProperty(qk,"__esModule",{value:!0});Kk()});var T2={};var Jk=i(()=>{D();lc();v.register(Yx)});var Zk=I($k=>{"use strict";Object.defineProperty($k,"__esModule",{value:!0});Jk()});var P2={};var Qk=i(()=>{D();fc();v.register(pc)});var eS=I(Xk=>{"use strict";Object.defineProperty(Xk,"__esModule",{value:!0});Qk()});var I2={};var tS=i(()=>{D();Lx();v.register(lM)});var oS=I(rS=>{"use strict";Object.defineProperty(rS,"__esModule",{value:!0});tS()});var w2={};var iS=i(()=>{D();uc();v.register(zx)});var aS=I(nS=>{"use strict";Object.defineProperty(nS,"__esModule",{value:!0});iS()});var A2={};var sS=i(()=>{D();cc();v.register(jx)});var lS=I(mS=>{"use strict";Object.defineProperty(mS,"__esModule",{value:!0});sS()});var B2={};var pS=i(()=>{D();Hx();v.register(cM)});var uS=I(fS=>{"use strict";Object.defineProperty(fS,"__esModule",{value:!0});pS()});var G2={};var cS=i(()=>{D();dc();v.register(yc)});var dS=I(yS=>{"use strict";Object.defineProperty(yS,"__esModule",{value:!0});cS()});var M2={};var gS=i(()=>{D();gc();v.register(_x)});var xS=I(hS=>{"use strict";Object.defineProperty(hS,"__esModule",{value:!0});gS()});var U2={};var OS=i(()=>{D();Kx();v.register(hM)});var vS=I(RS=>{"use strict";Object.defineProperty(RS,"__esModule",{value:!0});OS()});var D2={};var bS=i(()=>{D();hc();v.register(qx)});var TS=I(CS=>{"use strict";Object.defineProperty(CS,"__esModule",{value:!0});bS()});var E2={};var PS=i(()=>{D();xc();v.register(Vx)});var wS=I(IS=>{"use strict";Object.defineProperty(IS,"__esModule",{value:!0});PS()});var k2={};var AS=i(()=>{D();Jx();v.register(vM)});var GS=I(BS=>{"use strict";Object.defineProperty(BS,"__esModule",{value:!0});AS()});var S2={};var MS=i(()=>{D();Rc();v.register(Oc)});var DS=I(US=>{"use strict";Object.defineProperty(US,"__esModule",{value:!0});MS()});var F2={};var ES=i(()=>{D();$x();v.register(TM)});var SS=I(kS=>{"use strict";Object.defineProperty(kS,"__esModule",{value:!0});ES()});var N2={};var FS=i(()=>{D();Zx();v.register(IM)});var WS=I(NS=>{"use strict";Object.defineProperty(NS,"__esModule",{value:!0});FS()});var W2={};var YS=i(()=>{D();bc();v.register(vc)});var zS=I(LS=>{"use strict";Object.defineProperty(LS,"__esModule",{value:!0});YS()});var Y2={};var jS=i(()=>{D();Qx();v.register(BM)});var _S=I(HS=>{"use strict";Object.defineProperty(HS,"__esModule",{value:!0});jS()});var L2={};var KS=i(()=>{D();Xx();v.register(MM)});var VS=I(qS=>{"use strict";Object.defineProperty(qS,"__esModule",{value:!0});KS()});var z2={};var JS=i(()=>{D();eO();v.register(DM)});var ZS=I($S=>{"use strict";Object.defineProperty($S,"__esModule",{value:!0});JS()});var j2={};var QS=i(()=>{D();tO();v.register(kM)});var eF=I(XS=>{"use strict";Object.defineProperty(XS,"__esModule",{value:!0});QS()});var H2={};var tF=i(()=>{D();Tc();v.register(Cc)});var oF=I(rF=>{"use strict";Object.defineProperty(rF,"__esModule",{value:!0});tF()});var _2={};var iF=i(()=>{D();rO();v.register(NM)});var aF=I(nF=>{"use strict";Object.defineProperty(nF,"__esModule",{value:!0});iF()});var K2={};var sF=i(()=>{D();oO();v.register(YM)});var lF=I(mF=>{"use strict";Object.defineProperty(mF,"__esModule",{value:!0});sF()});var q2={};var pF=i(()=>{D();iO();v.register(zM)});var uF=I(fF=>{"use strict";Object.defineProperty(fF,"__esModule",{value:!0});pF()});var V2={};var cF=i(()=>{D();nO();v.register(HM)});var dF=I(yF=>{"use strict";Object.defineProperty(yF,"__esModule",{value:!0});cF()});var J2={};var gF=i(()=>{D();aO();v.register(KM)});var xF=I(hF=>{"use strict";Object.defineProperty(hF,"__esModule",{value:!0});gF()});var $2={};var OF=i(()=>{D();af();v.register(bm)});var vF=I(RF=>{"use strict";Object.defineProperty(RF,"__esModule",{value:!0});OF()});var Z2={};var bF=i(()=>{D();Pc();v.register(sO)});var TF=I(CF=>{"use strict";Object.defineProperty(CF,"__esModule",{value:!0});bF()});var Q2={};var PF=i(()=>{D();Ic();v.register(mO)});var wF=I(IF=>{"use strict";Object.defineProperty(IF,"__esModule",{value:!0});PF()});var X2={};var AF=i(()=>{D();wc();v.register(lO)});var GF=I(BF=>{"use strict";Object.defineProperty(BF,"__esModule",{value:!0});AF()});var eV={};var MF=i(()=>{D();Ac();v.register(pO)});var DF=I(UF=>{"use strict";Object.defineProperty(UF,"__esModule",{value:!0});MF()});var tV={};var EF=i(()=>{D();fO();v.register(XM)});var SF=I(kF=>{"use strict";Object.defineProperty(kF,"__esModule",{value:!0});EF()});var rV={};var FF=i(()=>{D();yO();v.register(iU)});var WF=I(NF=>{"use strict";Object.defineProperty(NF,"__esModule",{value:!0});FF()});var oV={};var YF=i(()=>{D();uO();v.register(tU)});var zF=I(LF=>{"use strict";Object.defineProperty(LF,"__esModule",{value:!0});YF()});var iV={};var jF=i(()=>{D();Bc();v.register(cO)});var _F=I(HF=>{"use strict";Object.defineProperty(HF,"__esModule",{value:!0});jF()});var nV={};var KF=i(()=>{D();Gc();v.register(dO)});var VF=I(qF=>{"use strict";Object.defineProperty(qF,"__esModule",{value:!0});KF()});var aV={};var JF=i(()=>{D();gO();v.register(sU)});var ZF=I($F=>{"use strict";Object.defineProperty($F,"__esModule",{value:!0});JF()});var sV={};var QF=i(()=>{D();Mc();v.register(hO)});var e0=I(XF=>{"use strict";Object.defineProperty(XF,"__esModule",{value:!0});QF()});var wO,ia,Af=i(()=>{M();wO=class extends x{};t(wO,"TurnStart");ia=wO});var mV,t0,r0=i(()=>{hu();He();b();Jb();fy();Af();Ou();$b();mV=t((o=$m,e=L)=>[new ia(new py,new p(r=>e.getByPlayer(r).forEach(n=>{if(!(n.busy()instanceof lg))return;let a=o.getByKey(xu(n));if(!a){n.setBusy(),n.setActive();return}let s=a.value();cg(n,s)})))],"getRules"),t0=mV});var lV={};var o0=i(()=>{A();r0();c.register(...t0())});var n0=I(i0=>{"use strict";Object.defineProperty(i0,"__esModule",{value:!0});o0()});var pV,a0,s0=i(()=>{Zp();b();ee();pV=t((o=P)=>[new en(new p((e,r)=>{o.emit("city:building-complete",e,r)}))],"getRules"),a0=pV});var fV,m0,l0=i(()=>{mt();He();fi();sb();b();fV=t((o=Z,e=L,r=Se)=>[new pp(new p(n=>!r.tileIsWorked(n))),new pp(new p((n,a)=>!e.getByTile(n).some(s=>s.player()!==a.player()))),new pp(new p((n,a)=>{let s=o.getByTile(n);return s===null?!0:s===a}))],"getRules"),m0=fV});var uV,p0,f0=i(()=>{mt();er();is();He();ee();vl();b();ol();Oi();fi();uV=t((o=Z,e=L,r=ie,n=zt,a=P,s=se,m=Se)=>[new eo(new p(f=>n.getByCity(f).progress().set(0))),new eo(new p(f=>r.getByCity(f).shrink())),new eo(new p((f,u,y)=>{a.emit("city:captured",f,u,y)})),new eo(new p(f=>e.getByCity(f).forEach(u=>u.destroy()))),new eo(new p(f=>Lu(f,s,r,m)))],"getRules"),p0=uV});var cV,u0,c0=i(()=>{zs();_s();er();ns();He();dp();U();b();ld();zn();fd();ud();cV=t((o=ie,e=Ht,r=L)=>[new Gt(new p(n=>new XI(o.getByCity(n).size()*2))),...[[qe,1,Oo,Vt],[qe,2,It,pt,ft,Ot]].map(([n,a,...s])=>new Gt(new l(m=>r.getByCity(m).some(f=>f instanceof n)),new l(m=>e.getByPlayer(m.player()).is(...s)),new p(m=>r.getByCity(m).filter(f=>f instanceof n).map(f=>new aw(a,f))))),new Gt(new l(n=>e.getByPlayer(n.player()).is(Oo,Vt)),new l(n=>{let a=o.getByCity(n);return r.getByCity(n).filter(s=>[ht,V,Ne,cr].some(m=>s instanceof m)).length>a.size()}),new p(n=>{let a=o.getByCity(n);return r.getByCity(n).filter(s=>[ht,V,Ne,cr].some(m=>s instanceof m)).slice(a.size()).map(s=>new vb(1,s))})),new Gt(new l(n=>e.getByPlayer(n.player()).is(It,pt,ft,Ot)),new p(n=>r.getByCity(n).filter(a=>[ht,V,Ne,cr].some(s=>a instanceof s)).map(a=>new vb(1,a))))],"getRules"),u0=cV});var AO,Bf,BO=i(()=>{M();AO=class extends x{};t(AO,"TileReassigned");Bf=AO});var yV,y0,d0=i(()=>{kl();is();er();mt();ee();js();Oi();A();xi();fi();Nu();zy();By();U();b();BO();by();ol();yV=t((o=Je,e=zt,r=ie,n=Z,a=se,s=c,m=Gn,f=P,u=Se)=>[...[Ue,Ye].map(y=>new Ga(new l(O=>o.getByTile(O.tile()).every(B=>!(B instanceof y))),new p(O=>o.register(new y(O.tile()))))),new Ga(new p(y=>e.register(new tl(y,m,s)))),new Ga(new p(y=>r.register(new Tl(y,s)))),new Ga(new p(y=>n.register(y))),new Ga(new p(y=>{f.emit("city:created",y)})),new Ga(new p(y=>{let O=u.getByTile(y.tile());O!==null&&u.unregister(O),u.register(new Fm(y.tile(),y)),O!==null&&s.process(Bf,O.city(),O.tile()),Qp(y,a,r,u)}))],"getRules"),y0=yV});var dV,g0,h0=i(()=>{mt();ee();xi();He();bl();b();js();fi();dV=t((o=Je,e=Z,r=P,n=L,a=Se)=>[new Uo(new p(s=>o.getByTile(s.tile()).filter(m=>m instanceof Ue).forEach(m=>o.unregister(m)))),new Uo(new p((s,m)=>{r.emit("city:destroyed",s,m)})),new Uo(new p(s=>n.getByCity(s).forEach(m=>m.destroy()))),new Uo(new p(s=>a.getByCity(s).forEach(m=>a.unregister(m))))],"getRules"),g0=dV});var GO,MO,qT=i(()=>{M();GO=class extends x{};t(GO,"FoodExhausted");MO=GO});var gV,x0,O0=i(()=>{b();qT();gV=t(()=>[new MO(new p(o=>o.shrink()))],"getRules"),x0=gV});var hV,R0,v0=i(()=>{A();U();b();db();qT();hV=t((o=c)=>[new au(new l(e=>e.progress().value()>=e.cost().value()),new p(e=>e.grow())),new au(new l(e=>e.progress().value()<0),new p(e=>{o.process(MO,e)}))],"getRules"),R0=hV});var xV,b0,C0=i(()=>{er();Oi();U();b();Wy();ol();fi();xV=t((o=ie,e=se,r=Se)=>[new ws(new p(n=>n.empty())),new ws(new p(n=>n.cost().set((n.size()+1)*10,"city-grow"))),new ws(new l(n=>n.city().tilesWorked().length<n.size()+1),new p(n=>OC(n.city(),e,o,r))),new ws(new l(n=>n.city().tilesWorked().length>n.size()+1),new p(n=>zu(n.city(),n).forEach(a=>r.unregisterByTile(a))))],"getRules"),b0=xV});var OV,T0,P0=i(()=>{cb();b();OV=t(()=>[new ky(new p(o=>10*(o.size()+1)))],"getRules"),T0=OV});var UO,Vs,Gf=i(()=>{M();UO=class extends x{};t(UO,"CivilDisorder");Vs=UO});var DO,ls,Mf=i(()=>{M();DO=class extends x{};t(DO,"ProcessYield");ls=DO});var EO,Zl,kO=i(()=>{M();EO=class extends x{};t(EO,"Unsupported");Zl=EO});var RV,I0,w0=i(()=>{is();er();lm();lm();A();He();Gf();U();b();Mf();kO();RV=t((o=zt,e=ie,r=L,n=c)=>[new ls(new l(a=>a instanceof X),new p((a,s,m)=>{let f=e.getByCity(s),u=new Vi(a);m.forEach(y=>{if(!(y instanceof Ea)||u.value()>=0)return;let O=y.unit();O!==null&&(n.process(Zl,s,O,y),u.subtract(y))}),f.add(u),f.check()})),new ls(new l(a=>a instanceof $),new p((a,s,m)=>{let f=o.getByCity(s),u=a.clone();m.filter(O=>O instanceof ka).sort((O,B)=>(B.unit()?.tile().distanceFrom(s.tile())??0)-(O.unit()?.tile().distanceFrom(s.tile())??0)).forEach(O=>{if(u.value()>=0)return;let B=O.unit();B!==null&&(n.process(Zl,s,B,O),u.subtract(O))});let y=s.yields();n.process(Vs,s,y).some(O=>O)||f.add(u),f.check()}))],"getRules"),I0=RV});var vV,A0,B0=i(()=>{er();Oi();U();b();gb();ol();fi();vV=t((o=ie,e=se,r=Se)=>[new xp(new l(n=>n.size()>0),new p(n=>n.cost().set((n.size()+1)*10,"city-shrink"))),new xp(new l(n=>n.size()>0),new l(n=>n.city().tilesWorked().length>n.size()+1),new p(n=>zu(n.city(),n).forEach(a=>r.unregisterByTile(a)))),new xp(new l(n=>n.size()<=0),new p(n=>n.city().destroy()))],"getRules"),A0=vV});var bV,G0,M0=i(()=>{er();Oi();fi();b();BO();ol();bV=t((o=se,e=ie,r=Se)=>[new Bf(new p(n=>Qp(n,o,e,r)))],"getRules"),G0=bV});var CV,U0,D0=i(()=>{b();ub();nu();CV=t(()=>[new Iy(new p(o=>cp.from(...o.tile().getSurroundingArea(2).filter((e,r)=>![0,4,20,24].includes(r)))))],"getRules"),U0=CV});var SO,ke,Bo=i(()=>{Ve();he();SO=class extends F{constructor(){super(K)}getByCity(e,r=!1){return this.filter(n=>n.city()===e&&!n.destroyed())}};t(SO,"CityImprovementRegistry");ke=new SO});var TV,E0,k0=i(()=>{_s();Bo();lm();ns();b();em();OT();km();hp();Un();TV=t((o=ke,e=Ht)=>[new Ma(new Xs,new p((r,n)=>{let a=e.getByPlayer(r.player()),[s]=o.filter(y=>y instanceof ut&&r.player()===y.city().player()).map(y=>y.city()),m=tt(n,oe),f=a.is(It)?10:a.is(pt)?0:s?s.tile().distanceFrom(r.tile()):32,[u]=[[Oo,8],[It,20],[pt,0],[Vt,12],[ft,16],[Ot,24]].filter(([y])=>a.is(y)).map(([,y])=>y);return new yi(u?Math.min(Math.floor(m*f*3/(10*u)),m):0,f.toFixed(2))})),new Ma(new pi(0),new p(r=>r.tilesWorked().entries().flatMap(n=>n.yields(r.player()).flatMap(a=>new a.constructor(a.value(),n.id()+": "+a.values().map(([,s])=>s).join("-"))))))],"getRules"),E0=TV});var PV,S0,F0=i(()=>{rb();is();mt();Sa();U();b();PV=t((o=zt,e=Z)=>[new yt(new l(r=>e.getByPlayer(r).map(n=>o.getByCity(n)).some(n=>!n.building())),new p(r=>e.getByPlayer(r).map(n=>o.getByCity(n)).filter(n=>!n.building()).map(n=>new bs(r,n)))),new yt(new l(r=>e.getByPlayer(r).map(n=>o.getByCity(n)).some(n=>!!n.building())),new p(r=>e.getByPlayer(r).map(n=>o.getByCity(n)).filter(n=>!!n.building()).map(n=>new Gm(r,n))))],"getRules"),S0=PV});var IV,N0,W0=i(()=>{er();mt();ee();Ml();U();cu();b();IV=t((o=Z,e=ie,r=P)=>[new Na(new l((n,a,s)=>s instanceof Zi&&s.to()===n.tile()&&o.getByTile(s.to())!==null),new p(n=>{let a=o.getByTile(n.tile());e.getByCity(a).shrink()})),new Na(new p((n,a,s)=>r.emit("unit:defeated",n,a,s)))],"getRules"),N0=IV});var wV,Y0,L0=i(()=>{A();fi();U();b();dt();BO();wV=t((o=c,e=Se)=>[new j(new l(r=>r.moves().value()===0),new l((r,n)=>e.tileIsWorked(n.to())),new l((r,n)=>{let a=e.getByTile(n.to());return a.city().player()===r.player()?!1:!e.tileCanBeWorkedBy(a.tile(),a.city())}),new p((r,n)=>{let a=e.getByTile(n.to());e.unregister(a),o.process(Bf,a.city(),n.to())}))],"getRules"),Y0=wV});var AV,z0,j0=i(()=>{b();kO();AV=t(()=>[new Zl(new p((o,e)=>e.destroy()))],"getRules"),z0=AV});var BV={};var H0=i(()=>{s0();l0();f0();c0();d0();h0();O0();v0();C0();P0();w0();B0();M0();D0();k0();A();F0();W0();L0();j0();c.register(...a0(),...m0(),...p0(),...u0(),...y0(),...g0(),...x0(),...R0(),...b0(),...T0(),...I0(),...A0(),...U0(),...G0(),...E0(),...S0(),...N0(),...Y0(),...z0())});var K0=I(_0=>{"use strict";Object.defineProperty(_0,"__esModule",{value:!0});H0()});var FO,NO,VT=i(()=>{Rp();rm();Un();FO=t((o,e=o.city().yields())=>{let r=o.city(),n=new Array(o.size()).fill(1),[a,s]=Nl(e,nd,As),m=n.length-1;for(;s>0&&m>-1;)n[m--]=0,s--;for(m=0;a>0&&m<n.length;)n[m]===0&&(n[m]=1,a--),n[m]===1&&(n[m++]=2,a--),n[m]===2&&m++;return n},"calculateCitizenState"),NO=t(o=>o.reduce(([e,r,n],a)=>[e+(a===0?1:0),r+(a===1?1:0),n+(a===2?1:0)],[0,0,0]),"citizenSummary")});var WO,Uf,YO=i(()=>{M();WO=class extends x{};t(WO,"CelebrateLeader");Uf=WO});var GV,q0,V0=i(()=>{er();VT();YO();U();b();GV=t((o=ie)=>[new Uf(new l(e=>o.getByCity(e).size()>2),new p((e,r=e.yields())=>{let n=o.getByCity(e),a=FO(n,r),[s,,m]=NO(a);return s===0&&Math.floor(m)>=n.size()/2}))],"getRules"),q0=GV});var MV,J0,$0=i(()=>{er();VT();Gf();b();MV=t((o=ie)=>[new Vs(new p((e,r=e.yields())=>{let n=o.getByCity(e),a=FO(n,r),[s,,m]=NO(a);return s>m}))],"getRules"),J0=MV});var Z0=i(()=>{vp();vp()});var Q0=i(()=>{Z0()});var JT=i(()=>{Q0()});var LO=i(()=>{rd();lm();Rp();mu();ad();sd();md();pd();Xp();JT();rm()});var zO,ni,jO=i(()=>{ib();zO=class extends ny{validate(...e){return!this.criteria().length||this.criteria().some(r=>r.validate(...e))}};t(zO,"Or");ni=zO});var UV,X0,eN=i(()=>{_s();fn();er();LO();Bo();ns();_e();A();He();dp();U();b();zs();Ol();em();pn();jO();Un();UV=t((o=c,e=ie,r=ke,n=Ht,a=H,s=L)=>[new Gt(new l(m=>n.getByPlayer(m.player()).is(Oo,It,Vt,ft)),new p((m,f)=>s.getByTile(m.tile()).filter(u=>u instanceof V).slice(0,Math.min(4,tt(f,Xe))).map(u=>new Ds(1,u)))),...[[kt,1],[kt,1,qt],[Lr,3],[nr,4]].map(([m,f,...u])=>new Gt(new Rt,new l(y=>r.getByCity(y).some(O=>O instanceof m)),new ni(new l(y=>u.length===0),new l(y=>u.every(O=>a.getByPlayer(y.player()).completed(O)))),new l((y,O)=>tt(O,Xe)>0),new p((y,O)=>new Bs(Math.min(f,tt(O,Xe)),r.getByCity(y).filter(B=>B instanceof m)[0])))),new Gt(new Ts,new p((m,f)=>new im(Math.floor(tt(f,ro)/2),ro.name)))],"getRules"),X0=UV});var DV,tN,rN=i(()=>{zs();er();_s();LO();ns();He();hp();U();b();DV=t((o=ie,e=Ht,r=L)=>[new Ma(new l(n=>o.getByCity(n).size()-5>0),new p(n=>new am(Math.max(o.getByCity(n).size()-5,0)))),...[[Ot,1],[pt,2]].map(([n,a])=>new Ma(new l(s=>{try{return e.getByPlayer(s.player()).is(n)}catch{return!1}}),new l(s=>r.getByCity(s).filter(m=>[ht,V,Ne].some(f=>m instanceof f)&&m.tile()!==s.tile()).length>0),new p(s=>r.getByCity(s).filter(m=>[ht,V,Ne].some(f=>m instanceof f)&&m.tile()!==s.tile()).map(m=>new On(a,m)))))],"getRules"),tN=DV});var HO,oN,iN=i(()=>{vs();HO=class extends $r{};t(HO,"CivilDisorder");oN=HO});var Df,Uc,EV,nN,$T=i(()=>{er();mt();ee();A();YO();Gf();b();em();Af();Df=new Set,Uc=new Set,EV=t((o=Z,e=c,r=P,n=ie)=>[new ia(new Rt,new p(a=>o.getByPlayer(a).forEach(s=>{let m=e.process(Vs,s,s.yields()).some(u=>u),f=e.process(Uf,s,s.yields()).some(u=>u);m&&r.emit("city:civil-disorder",s),m&&!Df.has(s)&&Df.add(s),!m&&Df.has(s)&&(r.emit("city:order-restored",s),Df.delete(s)),f&&!Uc.has(s)&&(r.emit("city:leader-celebration",s),Uc.add(s)),!f&&Uc.has(s)&&(r.emit("city:leader-celebration-ended",s),Uc.delete(s))}))),new ia(new Rt,new p(a=>o.getByPlayer(a).forEach(s=>{if(!Uc.has(s))return;n.getByCity(s).grow()})))],"getRules"),nN=EV});var kV,aN,sN=i(()=>{mt();Sa();iN();b();$T();kV=t((o=Z)=>[new yt(new p(e=>o.getByPlayer(e).filter(r=>Df.has(r)).map(r=>new oN(e,r))))],"getRules"),aN=kV});var SV={};var mN=i(()=>{V0();$0();eN();rN();A();sN();$T();c.register(...q0(),...tN(),...J0(),...X0(),...aN(),...nN())});var pN=I(lN=>{"use strict";Object.defineProperty(lN,"__esModule",{value:!0});mN()});var FV={};var fN=i(()=>{fn();kl();Gn.register(Wr,ir,Yr,nr,Ko,Lr,Or,Jt,zr,wt,Rr,vr,ar,qo,At,ut,Bt,Vo,Jo,kt,br)});var NV,uN,cN=i(()=>{fn();pn();Jp();Bo();_e();U();b();NV=t((o=ke,e=H)=>[new Dt(new p((r,n)=>new l(()=>!o.getByCity(r).some(a=>a instanceof n)))),...[[Wr,Dr],[Ko,Kt],[Lr,Dr],[Or,yr],[zr,Si],[Rr,xo],[ar,po],[ut,Kt],[kt,mo],[ir,so],[nr,Pt],[Jt,rr],[wt,xt],[qo,xr],[vr,Ni],[At,zo],[Bt,go],[Vo,Fi],[Jo,Ho],[br,or]].map(([r,n])=>new Dt(new l((a,s)=>s===r),new p(a=>new l(()=>e.getByPlayer(a.player()).completed(n))))),...[[ir,ar],[br,Rr],[wt,Jt],[At,Jt],[Bt,Jt],[vr,wt,At,Bt]].map(([r,...n])=>new Dt(new l((a,s)=>s===r),new p(a=>new l(()=>o.getByCity(a).some(s=>n.some(m=>s instanceof m)))))),...[[Or,ut],[wt,At,Bt],[At,Bt,wt],[Bt,wt,At]].map(([r,...n])=>new Dt(new l((a,s)=>s===r),new p(a=>new l(()=>o.getByCity(a).every(s=>!n.some(m=>s instanceof m))))))],"getRules"),uN=NV});var WV,yN,dN=i(()=>{fn();$p();WV=t(()=>[...[[Wr,120],[Yr,40],[Ko,120],[Lr,100],[Or,80],[zr,60],[Rr,80],[ar,80],[ut,200],[kt,40],[ir,120],[nr,160],[Jt,200],[wt,240],[qo,160],[vr,320],[At,160],[Bt,160],[Vo,200],[Jo,200],[br,160]].flatMap(([o,e])=>el(o,e))],"getRules"),yN=WV});var YV,gN,hN=i(()=>{Bo();vl();b();fn();Le();YV=t((o=ke,e=()=>Math.random())=>[new eo(new p(r=>{let n=o.getByCity(r).filter(s=>!(s instanceof Ae)),[a]=n.filter(s=>s instanceof ut);for(a&&(a.destroy(),n.splice(n.indexOf(a),1));n.length>0&&e()>.7;){let s=n[Math.floor(e()*n.length)];if(!s)break;s.destroy(),n.splice(n.indexOf(s),1)}}))],"getRules"),gN=YV});var _O=i(()=>{cd()});var LV,xN,ON=i(()=>{fn();pn();Bo();_e();_O();dp();U();b();LV=t((o=ke,e=H)=>[...[[Wr,de,2],[ir,de,3],[nr,de,3],[Ko,de,2],[Lr,de,2],[Or,de,1],[Jt,de,4],[zr,de,1],[wt,de,4],[Rr,de,1],[vr,de,6],[ar,de,1],[qo,de,4],[At,de,2],[ut,de,0],[Bt,de,4],[Vo,de,2],[Jo,de,4],[kt,de,1],[br,de,3]].map(([r,n,a])=>new Gt(new l(s=>o.getByCity(s).some(m=>m instanceof r)),new p(s=>{let[m]=o.getByCity(s).filter(f=>f instanceof r);return new n(a,m)}))),...[[Yr,de,0,null,tr],[Yr,de,1,tr,_t],[Yr,de,2,_t,null]].map(([r,n,a,s,m])=>new Gt(new l(f=>o.getByCity(f).some(u=>u instanceof r)),new l(f=>s===null||e.getByPlayer(f.player()).completed(s)),new l(f=>m===null||!e.getByPlayer(f.player()).completed(m)),new p(f=>{let[u]=o.getByCity(f).filter(y=>y instanceof r);return new n(a,u)})))],"getRules"),xN=LV});var zV,RN,vN=i(()=>{Bo();mt();A();By();U();b();fn();zV=t((o=Z,e=ke,r=c)=>[new Ga(new l(n=>o.getByPlayer(n.player()).length===0),new p(n=>e.register(new ut(n,r))))],"getRules"),RN=zV});var jV,bN,CN=i(()=>{Bo();U();bl();b();jV=t((o=ke)=>[new Uo(new l(e=>o.getByCity(e).length>0),new p(e=>o.getByCity(e).forEach(r=>r.destroy())))],"getRules"),bN=jV});var HV,TN,PN=i(()=>{fn();Bo();U();b();_O();Wy();HV=t((o=ke)=>[new ws(new l(e=>!o.getByCity(e.city()).some(r=>r instanceof Wr)),new l(e=>e.size()>10),new p(e=>e.shrink())),new ws(new l(e=>o.getByCity(e.city()).some(r=>r instanceof zr)),new p(e=>e.add(new Vi(e.cost().value()/2))))],"getRules"),TN=HV});var _V,IN,wN=i(()=>{Bo();ee();hb();b();_V=t((o=ke,e=P)=>[new su(new p(r=>o.register(r))),new su(new p((r,n)=>{e.emit("city-improvement:created",r,n)}))],"getRules"),IN=_V});var KV,AN,BN=i(()=>{fn();Bo();_O();U();b();fy();Uy();Un();KV=t((o=ke)=>[...[[ar,je,.5],[ar,ro,.5],[ir,je,.5],[ir,ro,.5],[Rr,ct,.5],[br,ct,.5],[Jt,$,.5],[Bt,$,.5],[wt,$,.5],[At,$,.5],[vr,$,.5],[Or,yi,.5]].map(([e,r,n])=>new Cl(new py,new l(a=>o.getByCity(a).some(s=>s instanceof e)),new p((a,s)=>new r(Math.floor(tt(s,r)*n),e.name))))],"getRules"),AN=KV});var qV,GN,MN=i(()=>{Bo();gm();fn();Id();U();b();$u();qV=t((o=ke,e=oo)=>[new pm(new l(r=>r.city()!==null),new l(r=>o.getByCity(r.city()).some(n=>n instanceof Yr)),new p(r=>e.register(new ss(r))))],"getRules"),GN=qV});var VV={};var UN=i(()=>{A();cN();dN();hN();ON();vN();CN();PN();wN();BN();MN();c.register(...uN(),...yN(),...gN(),...xN(),...RN(),...bN(),...TN(),...IN(),...AN(),...GN())});var EN=I(DN=>{"use strict";Object.defineProperty(DN,"__esModule",{value:!0});fN();UN()});var SN={};Jc(SN,{default:()=>JV,registerCityNames:()=>kN});var kN,JV,FN=i(()=>{Gr();Wt();kN=t((o=ae)=>{["Bergen","Cannae","Capua","Cordoba","Cremona","Crete","Cunaxa","Damascus","Dublin","Genoa","Ghent","Issus","Lisbon","Mecca","Melbourne","Milan","Naples","Pisa","Prague","Salamis","Salzburg","Seville","Sidon","Sydney","Tarsus","Toronto","Turin","Tyre","Utica","Venice","Verona"].forEach(e=>o.register(new ye(e,null)))},"registerCityNames"),JV=kN});var NN=i(()=>{Hl();Hl()});var WN=i(()=>{lf();lf()});var YN=i(()=>{ff();ff()});var LN=i(()=>{cf();cf()});var zN=i(()=>{df();df()});var jN=i(()=>{Kl();Kl()});var HN=i(()=>{hf();hf()});var _N=i(()=>{Vl();Vl()});var KN=i(()=>{Of();Of()});var qN=i(()=>{vf();vf()});var VN=i(()=>{Cf();Cf()});var JN=i(()=>{Pf();Pf()});var $N=i(()=>{$l();$l()});var ZN=i(()=>{wf();wf()});var QN=i(()=>{NN();WN();YN();LN();zN();jN();HN();_N();KN();qN();VN();JN();$N();ZN()});var ZT=i(()=>{QN()});var KO,qO,QT=i(()=>{Pn();Mr();KO=class extends st{constructor(){super(ve)}};t(KO,"CivilizationRegistry");qO=new KO});var e1={};Jc(e1,{default:()=>$V,registerCivilizations:()=>XN});var XN,$V,t1=i(()=>{ZT();QT();XN=t((o=qO)=>{o.register(Hn,_n,Kn,qn,Vn,Jn,$n,Zn,Qn,Xn,ea,ta,ra,oa)},"registerCivilizations"),$V=XN});var VO,pl,Dc=i(()=>{We();VO=class extends Y{#e;constructor(e,r){super(r),this.#e=e}leader(){return this.#e}};t(VO,"Trait");pl=VO});var JO,Ef,$O=i(()=>{he();Dc();JO=class extends F{constructor(){super(pl)}getByLeader(e){return this.getBy("leader",e)}getBySubclass(e){return this.filter(r=>r instanceof e)}};t(JO,"TraitRegistry");Ef=new JO});var ZO,Re,$t=i(()=>{$O();J();ZO=class extends k{#e=[];constructor(e=Ef){super();let r=e.getByLeader(this.sourceClass());this.#e.push(...r),this.addKey("name")}static civilization(){throw new TypeError("Must be implemented in extending class")}name(){throw new TypeError("Must be implemented in extending class")}traits(){return[...this.#e]}};t(ZO,"Leader");Re=ZO});var na,r1=i(()=>{$t();Hl();na=class extends Re{static civilization(){return jl}name(){return"Abraham Lincoln"}};t(na,"AbrahamLincoln")});var QO=i(()=>{$t();Hl()});var eP=i(()=>{r1();QO()});var o1=i(()=>{eP();eP()});var aa,i1=i(()=>{$t();Of();aa=class extends Re{static civilization(){return xf}name(){return"Alexander the Great"}};t(aa,"AlexanderTheGreat")});var tP=i(()=>{i1()});var n1=i(()=>{tP();tP()});var XO=i(()=>{$t();$l()});var a1=i(()=>{XO();XO()});var sa,s1=i(()=>{$t();Kl();sa=class extends Re{static civilization(){return _l}name(){return"Elizabeth I"}};t(sa,"ElizabethI")});var eR=i(()=>{$t();Kl()});var iP=i(()=>{s1();eR()});var m1=i(()=>{iP();iP()});var ma,l1=i(()=>{$t();Vl();ma=class extends Re{static civilization(){return ql}name(){return"Frederick the Great"}};t(ma,"FrederickTheGreat")});var tR=i(()=>{$t();Vl()});var aP=i(()=>{l1();tR()});var p1=i(()=>{aP();aP()});var la,f1=i(()=>{$t();Cf();la=class extends Re{static civilization(){return bf}name(){return"Genghis Khan"}};t(la,"GenghisKhan")});var sP=i(()=>{f1()});var u1=i(()=>{sP();sP()});var c1=i(()=>{QO();QO()});var pa,y1=i(()=>{$t();ff();pa=class extends Re{static civilization(){return pf}name(){return"Hammurabi"}};t(pa,"Hammurabi")});var mP=i(()=>{y1()});var d1=i(()=>{mP();mP()});var fa,g1=i(()=>{$t();$l();fa=class extends Re{static civilization(){return Jl}name(){return"Joseph Stalin"}};t(fa,"JosephStalin")});var lP=i(()=>{XO();g1()});var h1=i(()=>{lP();lP()});var ua,x1=i(()=>{$t();Pf();ua=class extends Re{static civilization(){return Tf}name(){return"Julius Caesar"}};t(ua,"JuliusCaesar")});var pP=i(()=>{x1()});var O1=i(()=>{pP();pP()});var ca,R1=i(()=>{$t();vf();ca=class extends Re{static civilization(){return Rf}name(){return"Mahatma Gandhi"}};t(ca,"MahatmaGandhi")});var fP=i(()=>{R1()});var v1=i(()=>{fP();fP()});var ya,b1=i(()=>{$t();cf();ya=class extends Re{static civilization(){return uf}name(){return"Mao Zedong"}};t(ya,"MaoZedong")});var uP=i(()=>{b1()});var C1=i(()=>{uP();uP()});var da,T1=i(()=>{$t();lf();da=class extends Re{static civilization(){return mf}name(){return"Moctezuma II"}};t(da,"MoctezumaII")});var cP=i(()=>{T1()});var P1=i(()=>{cP();cP()});var ga,I1=i(()=>{$t();hf();ga=class extends Re{static civilization(){return gf}name(){return"Napoleon I"}};t(ga,"NapoleonI")});var yP=i(()=>{I1()});var w1=i(()=>{yP();yP()});var A1=i(()=>{tR();tR()});var ha,B1=i(()=>{$t();df();ha=class extends Re{static civilization(){return yf}name(){return"Ramesses II"}};t(ha,"RamessesII")});var dP=i(()=>{B1()});var G1=i(()=>{dP();dP()});var xa,M1=i(()=>{$t();wf();xa=class extends Re{static civilization(){return If}name(){return"Shaka"}};t(xa,"Shaka")});var gP=i(()=>{M1()});var U1=i(()=>{gP();gP()});var D1=i(()=>{eR();eR()});var E1=i(()=>{o1();n1();a1();m1();p1();u1();c1();d1();h1();O1();v1();C1();P1();w1();A1();G1();U1();D1()});var hP=i(()=>{E1()});var rR,oR,xP=i(()=>{Pn();$t();rR=class extends st{constructor(){super(Re)}getByCivilization(e){return this.getBy("civilization",e)}};t(rR,"LeaderRegistry");oR=new rR});var S1={};Jc(S1,{default:()=>ZV,registerLeaders:()=>k1});var k1,ZV,F1=i(()=>{hP();xP();k1=t((o=oR)=>{o.register(na,da,pa,ya,ha,sa,ga,ma,aa,ca,la,ua,fa,xa)},"registerLeaders"),ZV=k1});var Ql,kf,Sf=i(()=>{Dc();Ql=class extends pl{};t(Ql,"Aggression");kf=Ql});var N1=i(()=>{Sf();Sf()});var un,OP=i(()=>{Sf();un=class extends kf{constructor(e){super(e,1)}};t(un,"Aggressive")});var W1=i(()=>{OP();OP()});var Xl,Ff,Nf=i(()=>{Dc();Xl=class extends pl{};t(Xl,"Militarism");Ff=Xl});var Go,RP=i(()=>{Nf();Go=class extends Ff{constructor(e){super(e,0)}};t(Go,"Civilized")});var Y1=i(()=>{RP();RP()});var ep,Wf,Yf=i(()=>{Dc();ep=class extends pl{};t(ep,"Development");Wf=ep});var L1=i(()=>{Yf();Yf()});var cn,vP=i(()=>{Yf();cn=class extends Wf{constructor(e){super(e,1)}};t(cn,"Expansionist")});var z1=i(()=>{vP();vP()});var ps,bP=i(()=>{Sf();ps=class extends kf{constructor(e){super(e,0)}};t(ps,"Friendly")});var j1=i(()=>{bP();bP()});var H1=i(()=>{Nf();Nf()});var fs,CP=i(()=>{Nf();fs=class extends Ff{constructor(e){super(e,1)}};t(fs,"Militaristic")});var _1=i(()=>{CP();CP()});var Yi,TP=i(()=>{Sf();Yi=class extends kf{constructor(e){super(e,.5)}};t(Yi,"Normal")});var K1=i(()=>{TP();TP()});var yn,PP=i(()=>{Yf();yn=class extends Wf{constructor(e){super(e,.5)}};t(yn,"Normal")});var q1=i(()=>{PP();PP()});var us,IP=i(()=>{Nf();us=class extends Ff{constructor(e){super(e,.5)}};t(us,"Normal")});var V1=i(()=>{IP();IP()});var Oa,wP=i(()=>{Yf();Oa=class extends Wf{constructor(e){super(e,0)}};t(Oa,"Perfectionist")});var J1=i(()=>{wP();wP()});var $1=i(()=>{N1();W1();Y1();L1();z1();j1();H1();_1();K1();q1();V1();J1()});var Z1=i(()=>{$1()});var X1={};Jc(X1,{default:()=>QV,registerTraits:()=>Q1});var Q1,QV,eW=i(()=>{hP();Z1();$O();Q1=t((o=Ef)=>{[[na,ps,yn,Go],[da,Yi,Oa,Go],[pa,ps,Oa,Go],[ya,Yi,yn,Go],[ha,Yi,yn,Go],[sa,Yi,cn,us],[ga,un,cn,Go],[ma,un,Oa,Go],[aa,Yi,cn,fs],[ca,ps,Oa,us],[la,un,cn,fs],[ua,Yi,cn,Go],[fa,un,yn,fs],[xa,un,yn,us]].forEach(([e,...r])=>r.forEach(n=>o.register(new n(e))))},"registerTraits"),QV=Q1});var rW=I(tW=>{"use strict";Object.defineProperty(tW,"__esModule",{value:!0});var XV=(FN(),R(SN)),e5=(t1(),R(e1)),t5=(F1(),R(S1)),r5=(eW(),R(X1));(0,XV.default)();(0,e5.default)();(0,t5.default)();(0,r5.default)()});var Pr,Cm,AP=i(()=>{es();Pr=class extends Ct{};t(Pr,"Fuel");Cm=Pr});var Ir,Ec,BP=i(()=>{es();Ir=class extends Ct{};t(Ir,"Habitation");Ec=Ir});var iR,tp,nR=i(()=>{M();iR=class extends x{};t(iR,"ChooseSlot");tp=iR});var aR,rp,GP=i(()=>{M();aR=class extends x{};t(aR,"Active");rp=aR});var oW,sR,mR,MP=i(()=>{J();A();nR();GP();oW=t((o,e,r)=>e<=o&&o<r,"isBetween"),sR=class extends k{#e=new Map;#t;#r;#o=[];#i;constructor(e,r,n,a=c){super(),this.addKey("activeSlots","height","inactiveSlots","slots","width"),this.#t=e,this.#r=a,this.#i=r,this.#o.push(...n)}activeSlots(){return this.#o.filter(e=>this.#r.process(rp,e,this).every(r=>r))}get(e,r){if(e<0||e>=this.#i||r<0||r>=this.#t)return null;let n=[e,r].toString();if(!this.#e.has(n)){let[a]=this.#o.filter(s=>oW(e,s.x(),s.x()+s.width())&&oW(r,s.y(),s.y()+s.height()));this.#e.set(n,a??null)}return this.#e.get(n)}getAdjacent(e){let r=new Set;for(let n=e.x(),a=e.x()+e.width()-1;n<=a;n++){let s=this.get(n,e.y()-1),m=this.get(n,e.y()+e.height());s&&r.add(s),m&&r.add(m)}for(let n=e.y(),a=e.y()+e.height()-1;n<=a;n++){let s=this.get(e.x()-1,n),m=this.get(e.x()+e.width(),n);s&&r.add(s),m&&r.add(m)}return[...r.values()].filter(n=>n!==e)}getFreeSlot(e){let[r]=this.#r.process(tp,e,this);return r??null}height(){return this.#t}inactiveSlots(){return this.#o.filter(e=>this.#r.process(rp,e,this).some(r=>!r))}slots(){return this.#o}width(){return this.#i}};t(sR,"Layout");mR=sR});var qr,kc,UP=i(()=>{es();qr=class extends Ct{};t(qr,"LifeSupport");kc=qr});var Mo,Sc,DP=i(()=>{es();Mo=class extends Ct{};t(Mo,"Power");Sc=Mo});var pr,Tm,EP=i(()=>{es();pr=class extends Ct{};t(pr,"Propulsion");Tm=pr});var lR,S,iW=i(()=>{J();lR=class extends k{#e=[];#t;#r=null;#o;#i;#n;constructor(e,r,n,a,s){super(),this.addKey("height","part","width","x","y"),this.#t=n,this.#o=a,this.#i=e,this.#n=r,this.#e.push(...s)}accepts(e){return this.#e.some(r=>e instanceof r)}empty(){return this.#r===null}fill(e){!this.accepts(e)||(this.#r=e)}height(){return this.#t}part(){return this.#r}width(){return this.#o}x(){return this.#i}y(){return this.#n}};t(lR,"Slot");S=lR});var Zt,ge,kP=i(()=>{es();Zt=class extends Ct{};t(Zt,"Structural");ge=Zt});var pR,nW,aW=i(()=>{A();AP();BP();MP();UP();DP();EP();iW();kP();pR=class extends mR{constructor(e=c){super(12,12,[new S(9,0,1,1,[Cm]),new S(10,0,1,2,[Tm]),new S(1,1,2,2,[Sc]),new S(5,1,2,2,[Sc]),new S(8,1,1,1,[ge]),new S(9,1,1,1,[ge]),new S(10,1,1,1,[ge]),new S(8,2,1,1,[ge]),new S(9,2,1,1,[Cm]),new S(10,2,1,2,[Tm]),new S(0,3,1,1,[ge]),new S(1,3,1,1,[ge]),new S(2,3,1,1,[ge]),new S(3,3,1,1,[ge]),new S(4,3,1,1,[ge]),new S(5,3,1,1,[ge]),new S(6,3,1,1,[ge]),new S(7,3,1,1,[ge]),new S(8,3,1,1,[ge]),new S(9,3,1,1,[Cm]),new S(10,3,1,2,[Tm]),new S(0,4,2,2,[kc]),new S(2,4,2,2,[Ec]),new S(4,4,2,2,[kc]),new S(6,4,2,2,[Ec]),new S(8,4,1,1,[ge]),new S(9,4,1,1,[ge]),new S(10,4,1,1,[ge]),new S(8,5,1,1,[ge]),new S(9,5,1,1,[Cm]),new S(10,5,1,2,[Tm]),new S(0,6,2,2,[Ec]),new S(2,6,2,2,[kc]),new S(4,6,2,2,[Ec]),new S(6,6,2,2,[kc]),new S(8,6,1,1,[ge]),new S(9,6,1,1,[Cm]),new S(10,6,1,2,[Tm]),new S(8,7,1,1,[ge]),new S(9,7,1,1,[ge]),new S(10,7,1,1,[ge]),new S(0,8,1,1,[ge]),new S(1,8,1,1,[ge]),new S(2,8,1,1,[ge]),new S(3,8,1,1,[ge]),new S(4,8,1,1,[ge]),new S(5,8,1,1,[ge]),new S(6,8,1,1,[ge]),new S(7,8,1,1,[ge]),new S(8,8,1,1,[ge]),new S(9,8,1,1,[Cm]),new S(10,8,1,2,[Tm]),new S(1,9,2,2,[Sc]),new S(5,9,2,2,[Sc]),new S(8,9,1,1,[ge]),new S(9,9,1,1,[Cm]),new S(10,9,1,2,[Tm]),new S(8,10,1,1,[ge]),new S(9,10,1,1,[ge]),new S(10,10,1,1,[ge]),new S(9,11,1,1,[Cm]),new S(10,11,1,2,[Tm])],e)}};t(pR,"Default");nW=pR});var fR,Lf,uR=i(()=>{Pn();MP();fR=class extends sA{constructor(){super(mR)}};t(fR,"LayoutRegistry");Lf=new fR});var o5={};var sW=i(()=>{aW();uR();Lf.register(nW)});var lW=I(mW=>{"use strict";Object.defineProperty(mW,"__esModule",{value:!0});sW()});var cR,yR,SP=i(()=>{M();cR=class extends x{};t(cR,"Expired");yR=cR});var i5,pW,fW=i(()=>{ee();b();SP();i5=t((o=P)=>[new yR(new p(e=>{o.emit("diplomacy:declaration-expired",e),e.players().forEach(r=>o.emit("player:declaration-expired",r,e))}))],"getRules"),pW=i5});var n5,uW,cW=i(()=>{vm();b();eC();n5=t((o=Ur)=>[new vg(new p(e=>o.register(e)))],"getRules"),uW=n5});var dR,cs,yW=i(()=>{Dl();dR=class extends Bn{};t(dR,"Acknowledge");cs=dR});var gR,hR,dW=i(()=>{A();Ip();gR=class extends Hm{#e;constructor(e,r,n,a=c){super(r,n,a),this.#e=e,this.addKey("tribute")}tribute(){return this.#e}};t(gR,"DemandTribute");hR=gR});var xR,wr,gW=i(()=>{Ip();A();xR=class extends Pp{#e;constructor(e,r,n,a=c){super(e,n,a),this.#e=r,this.addKey("key")}key(){return this.#e}};t(xR,"Dialogue");wr=xR});var OR,Fc,FP=i(()=>{J();Mt();OR=class extends k{#e;#t;constructor(e,r=te){super(),this.#e=e,this.#t=r,this.addKey("expired","expiry")}expired(){return this.#e<=this.#t.value()}expiry(){return this.#e}};t(OR,"Expiry");Fc=OR});var RR,vR,NP=i(()=>{FP();RR=class extends Fc{constructor(){super(1/0)}expired(){return!1}};t(RR,"Never");vR=RR});var bR,WP,YP=i(()=>{bp();Mt();SP();FP();NP();Do();A();bR=class extends Rn{#e=new vR;#t=te;constructor(...e){super(...e.filter(r=>r instanceof q||r instanceof SI)),this.addKey("expired","expiry"),e.forEach(r=>{r instanceof Fc&&(this.#e=r),r instanceof zm&&(this.#t=r)})}active(){return!this.expiry().expired()}expire(){this.#e=new Fc(this.#t.value()),this.ruleRegistry().process(yR,this)}expired(){return this.#e.expired()}expiry(){return this.#e}};t(bR,"Declaration");WP=bR});var Li,Nc,Wc=i(()=>{YP();Li=class extends WP{};t(Li,"Peace");Nc=Li});var a5,hW,xW=i(()=>{vm();_e();A();yx();yW();U();PO();dW();gW();b();gx();Gs();lu();RO();Wc();Dl();vd();Cg();a5=t((o=c,e=Ur,r=H)=>{let n=t((g,...h)=>h.includes(g.key().split(".")[0]),"dialogueNamespaceMatches"),a=t(g=>new l(h=>!e.getByPlayers(...h.players()).some(G=>G instanceof g&&G.negotiation()===h)),"onlyOncePerNegotiation"),s=t(g=>new l(h=>h.lastInteraction()instanceof Bn&&h.lastInteraction().proposal()instanceof g),"lastInteractionWasResolutionForAction"),m=t((...g)=>new l(h=>h.lastInteraction()instanceof cs&&h.lastInteraction().proposal()instanceof wr&&n(h.lastInteraction().proposal(),...g)),"lastInteractionWasAcknowledgeForDialogueWithNamespace"),f=t(g=>g.lastInteraction()===null?g.players()[0]:g.lastInteraction().for()[0],"getNextBy"),u=t(g=>new p(h=>new g(f(h),h,o)),"proposalAction"),y=t(g=>new p(h=>new g(f(h),h.lastInteraction(),o)),"resolutionAction"),O=t((g,h)=>new p(G=>new g(f(G),h,G,o)),"dialogueAction"),B=t(g=>new l(h=>{let G=h.lastInteraction();return G instanceof wr&&n(G,g)}),"lastInteractionWasDialogueWithNamespace"),N=t((...g)=>e.getByPlayers(...g).some(h=>h instanceof Nc&&h.active()),"hasPeaceTreaty"),W={standardTopics:[[new l(g=>!g.interactions().some(h=>h instanceof jn&&h.proposal()instanceof Hs)),new l(g=>{let[h,G]=g.players().map(Ft=>r.getByPlayer(Ft)),z=h.complete().filter(Ft=>!G.completed(Ft.sourceClass())),Qe=G.complete().filter(Ft=>!h.completed(Ft.sourceClass()));return z.length>0&&Qe.length>0}),new p(g=>{let h=g.lastInteraction(),[G,z]=h!==null?[h.by(),...h.for()]:g.players(),[Qe,Ft]=[G,z].map(Ce=>r.getByPlayer(Ce)),be=Ft.complete().filter(Ce=>!Qe.completed(Ce.sourceClass()));return new Hs(be,f(g),g,o)})],[a(Ks),new l(g=>!N(...g.players())),u(Ks)],[O(wr,"handover")]]},_=[[y(as)],[y(jn)]];return[...[[[null],[[u(vn)]]],[[vn],_],[[jn,s(vn)],[[u(Rm)]]],[[as,s(vn),new l(g=>!N(...g.players()))],[[O(wr,"welcome.no-peace")]]],[[as,s(vn),new l(g=>N(...g.players()))],[[O(wr,"welcome.peace")]]],[[wr,B("welcome")],[[y(cs)]]],[[Ks],_],[[jn,s(Ks)],[[O(wr,"decline-peace.neutral")]]],[[as,s(Ks)],[[O(wr,"accept-peace.neutral")]]],[[wr,B("decline-peace")],[[y(cs)]]],[[cs,m("decline-peace")],[[new p(g=>new Rm(f(g),g,o))]]],[[cs,m("decline-demand")],[[new p(g=>new Rm(f(g),g,o))]]],[[cs,new l(g=>g.lastInteraction()instanceof cs&&g.lastInteraction().proposal()instanceof wr&&!["decline-demand","decline-peace"].includes(g.lastInteraction().proposal().key()))],W.standardTopics],[[wr,B("accept-peace")],[[y(cs)]]],[[hR],[[y(jn)]]],[[jn,s(hR)],[[O(wr,"decline-demand.neutral")]]],[[wr,B("decline-demand")],[[y(cs)]]],[[wr,B("accept-demand")],[[y(cs)]]],[[Hs],_],[[jn,s(Hs)],W.standardTopics],[[as,s(Hs)],W.standardTopics],[[wr,B("handover")],[[new l(g=>N(...g.players())),O(wr,"welcome-peace")],[new l(g=>!N(...g.players())),O(wr,"grateful-discussion")],[new p(g=>new hR(new ci(50),f(g),g,o))]]]].flatMap(([[g,...h],G])=>G.map(([...z])=>new Cp(new l(Qe=>g===null?Qe.lastInteraction()===null:Qe.lastInteraction()instanceof g),...h,...z)))]},"getRules"),hW=a5});var s5,OW,RW=i(()=>{rs();A();vm();_e();yx();sp();U();PO();b();gx();lu();NP();RO();Wc();Cb();Cg();s5=t((o=c,e=Ur,r=H,n=Lt)=>[new Tp(new l((a,s)=>a instanceof jn&&s instanceof vn),new p(async(a,s)=>s.negotiation().proceed(new Rm(a.by(),s.negotiation(),o)))),new Tp(new l((a,s)=>a instanceof as&&s instanceof Ks),new p(async(a,s)=>e.register(new Nc(...s.players(),new vR,o)))),new Tp(new l((a,s)=>a instanceof as&&s instanceof Hs),new p(async(a,s)=>{let m=r.getByPlayer(a.by()),f=r.getByPlayer(a.for()[0]),u=m.complete().filter(_=>!f.completed(_.sourceClass())),y=f.complete().filter(_=>!m.completed(_.sourceClass())),O=n.getByPlayer(a.by()),B=await O.chooseFromList(new Um(y.map(_=>_.sourceClass()),"diplomacy.exchange-knowledge",a)),N=n.getByPlayer(a.for()[0]),W=await N.chooseFromList(new Um(u.map(_=>_.sourceClass()),"diplomacy.exchange-knowledge",a));m.addAdvance(B),f.addAdvance(W)}))],"getRules"),OW=s5});var zf,vW=i(()=>{bp();zf=class extends uw{constructor(...e){let r=e.map(n=>n.player());super(...r)}};t(zf,"Contact")});var bW=i(()=>{vW()});var m5,CW,TW=i(()=>{vm();He();bW();U();b();dt();m5=t((o=Ur,e=L)=>[new j(new l(r=>r.tile().getNeighbours().some(n=>e.getByTile(n).some(a=>a.player()!==r.player()))),new p(r=>r.tile().getNeighbours().forEach(n=>e.getByTile(n).filter(a=>a.player()!==r.player()).forEach(a=>o.register(new zf(r,a))))))],"getRules"),CW=m5});var l5={};var PW=i(()=>{A();fW();cW();xW();RW();TW();c.register(...pW(),...uW(),...hW(),...OW(),...CW())});var wW=I(IW=>{"use strict";Object.defineProperty(IW,"__esModule",{value:!0});PW()});var CR,TR,LP=i(()=>{CR=class{#e;#t;#r;constructor(e,r,n){this.#e=e,this.#t=r,this.#r=n}civilizationType(){return this.#e}mapGenerator(){return this.#t}startTile(){return this.#r}startTileForMap(e){let{x:r,y:n}=this.#r;return e.get(r,n)}};t(CR,"CivilizationStartTile");TR=CR});var p5,ys,zP=i(()=>{p5=t((o,e,r,n)=>{for(;r<0;)r+=e;for(;n<0;)n+=o;return r=r%e,n=n%o,n*e+r},"coordsToIndex"),ys=p5});var f5,op,PR=i(()=>{f5=t((o,e,r)=>{let n=o*e;for(;r<0;)r+=n;return r=r%n,[r%e,Math.floor(r/e)]},"indexToCoords"),op=f5});var u5,AW,BW=i(()=>{PR();u5=t((o,e,r,n)=>{let[a,s]=op(o,e,r),[m,f]=op(o,e,n),u=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[y]=u.map(([O,B])=>[O*e,B*o]).map(([O,B])=>[a-m+O,s-f+B]).map(O=>Math.hypot(...O)).sort((O,B)=>O-B);return y},"distanceFrom"),AW=u5});var c5,ip,jP=i(()=>{zP();PR();c5=t((o,e,r,n=!0)=>{let[a,s]=op(o,e,r),m=ys(o,e,a,s-1),f=ys(o,e,a+1,s-1),u=ys(o,e,a+1,s),y=ys(o,e,a+1,s),O=ys(o,e,a,s+1),B=ys(o,e,a-1,s+1),N=ys(o,e,a-1,s),W=ys(o,e,a-1,s-1);return n?[m,u,O,N]:[m,f,u,y,O,B,N,W]},"getNeighbours"),ip=c5});var jf,IR,wR=i(()=>{zP();BW();jP();PR();jf=class{#e;#t;#r;constructor(e,r,n={}){this.#e=e,this.#t=n,this.#r=r}coordsToIndex(e,r){return ys(this.#e,this.#r,e,r)}distanceFrom(e,r){return AW(this.#e,this.#r,e,r)}generate(){throw new Error(`Generator#generate(): Must be overridden in '${this.constructor.name}'.`)}getNeighbours(e,r=!0){return ip(this.#e,this.#r,e,r)}height(){return this.#e}indexToCoords(e){return op(this.#e,this.#r,e)}options(){return this.#t}width(){return this.#r}};t(jf,"Generator");IR=jf});var y5,AR,Hf,BR=i(()=>{Uh();Dh();Ru();wR();Gl();Eh();kh();Sh();Fh();Dp();_u();Wh();Yh();y5={A:aB,D:mB,F:dg,G:Jm,H:uB,J:yB,M:gB,O:xB,P:Up,R:Nh,S:bB,T:TB},AR=class extends IR{async generate(){return Array.from(`OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOAAAAAAAOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOAAOAOAAAOAAAAAAAAOOOOOOAOOOOOGGOOOOOTAGOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOTTTTAOOOOAAAAAAAAOOOOAAAAAATOOOOOAAOOOOOOOOOOOOOOOAAOOOOOTOOOOOOOOOOOOOOOOOO
OOOTTTTTTTTTAAOAOAAAAAOOOAAAAATOOOOOOOOOOOOOOOAOOOOOFFAAFFFFFOOFFFOOOOFFFOOOOOOO
OTPTGPPPPTTTTTOTAAAOOAOOOAAAATOOOOOOOOOOOOOOOAOOAAOFFGAFFFFFFFAFFFFFFFFFFOTOOOOO
OOOOOPGTPTOOTTAAAAAAAAOOAAGGOOOOOOOOOOGAAOOOOOOGOGFFFGFFFFFFFFAFFAFFFFFGFGGOOOOO
OOOOOGGFGPPTTAAOOOAOTOOOAGOOOOAOOOOOOAFGFPGFOAAFGTGFFFFFFFFFFFFFFFGFFGOGFFOOOOOO
OOOOPMGFPPPPTTOOOATAAOOOOOOOOOOOOOOOGFPGGFOFFFFFFGFFFFFFFFFFFFFFGFFFFGOOFOOOOOOO
OOOOPMGFGPPOTTTAATTTTOOOOOOOOOOHOOOPFGOGGGFFFGFGGGFFFFFFFFFFFFFFFFFFOOOOFGOOOOOO
OOOOPHFFGPGOPPPOPTTTTOOOOOOOOOGROOOOOPOGFGFFGFFFGFGFGGFGGFFFGFFFFFFFGOOOOPOOOOOO
OOOOGGHFGPPPPPPPPPTPPOOOOOOOOOOFOOOFOOOFFFRFFFFRGFPFFPFGPFGFFOFFFFFGPPGOOOOOOOOO
OOOGGGMGGGPPPOPPPPPOPOOOOOOOOOGGOOOGPPFFFGRRFRRRGGFGGGGGPGGFFFFDPPPPPPOOOOOOOOOO
OOOGGFMGRGRPGORRGOPOOOOOOOOOOOOOOGRGGGGFFGFRFRPGPGGGGGPPPPPPPPPPPPPPGPGOOOOOOOOO
OOGGGMMGRGRGGGGOOOOOOOOOOOOOOOOOGGRMMGGGGPGRPRRPPPPPPPPPPPPPPPPPPPPPGPGOPGOOOOOO
OOGGPPHGRRRGGGOOOOOOOOOOOOOOOOOOPGGGGFGRRGPRPDOOPPOPPPDPDDDPPPPPPDPPPGOOGOOOOOOO
OOGFPPFGGRGGGPOOOOOOOOOOOOOOOOPPPPOGHOOGRFOOOHPOGPPDPDPDDPPPPPPDDPPOPGOOMGOOOOOO
OOGPPDDGGRGGOOOOOOOOOOOOOOOOOOPPPOOOGHOOOGPPPPPOPPPPDPPHPDDDDDDPPPGOOOOOOPOOOOOO
OOPOGDDPOOOPOOOOOOOOOOOOOOOOOOOOOOOOOGOOOOOPPPPGPPPPPPHHMHHHHHHHHMHPGOOGOOOOOOOO
OOPOGDDOOOOPOOOOOOOOOOOOOOOOOOGPPDDOOOOOOOOPPRRHPPPDPPHPGHMMMMMHHHPPPGOOOOOOOOOO
OOOOGDGOOOOOOOOOOOOOOOOOOOOOOODPHHPPPGODPOPPPGRRPPPPPHHRDPGMHHMHHPPRRROOOOOOOOOO
OOOOGGPOPOOOGPOOOOOOOOOOOOOOOPPHDDDPPPPDDRGDPPDOPPPPHPRRDGGGHHHHHPGPPPOOOOOOOOOO
OOOOOGGPGOOOOGPOOOOOOOOOOOOOPPDDDDDPDDDDDRDOPDDOOOOHHRRDPGGRGGGHGPGGPOOOOOOOOOOO
OOOOOOOOGGOOOOOOOOOOOOOOOOOOPDDDDDDDDDDDSRSODDDDDDOOOOPPGGGRRPPGFGGGOOOGOOOOOOOO
OOOOOOOOOGOOOOOOOOOOOOOOOOOPDDDDDDPPPDDDDRDOOPDDDDPOOOOGGGGGOOGGGGGOOOOPGOOOOOOO
OOOOOOOOOPPOGPPGOOOOOOOOOOODDDDDDDPDDDDDDRDDOODDDDOOOOOOGGGOOOPPGGOOOOOGGOOOOOOO
OOOOOOOOOOPGFPPPGOOOOOOOOOODDDDDDDDPDPDPPDHHDOOPDOOOOOOOGGOOOOOGGGGOOOOOFGOOOOOO
OOOOOOOOOOOGHGGGGGGOOOOOOOOPPDPPPPDDDPPPPPPMDPOOGOOOOOOOPGOOOOOOOGGOOOOOOGOOOOOO
OOOOOOOOOOOHJJJGGGGROOOOOOOOPPDPPPPPPPPPPPPHMDPOOOOOOOOOOGOOOOOOOOOOOPOOOOOOOOOO
OOOOOOOOOOGHJRRJJRRRGOOOOOOOOPPPGOPPGPGGGGGGMDDPOOOOOOOOOOOOOOOOOOOGPPOOGPOOOOOO
OOOOOOOOOOPGJJRRRRJGFGGOOOOOOOOOOOOGGGGJJJGGODPPOOOOOOOOOOOOOOOGFGOOPGFGGGOGOOOO
OOOOOOOOOOOFGGJJGJJFGGGPOOOOOOOOOOOGGJJRRRGGHPPOOOOOOOOOOOOOOOOOGFOOGOPGOOOPGGOO
OOOOOOOOOOOGHGGGGGGGGGGOOOOOOOOOOOOGGRRRJJHOGGOOOOOOOOOOOOOOOOOOOGOOOOOOOOOOOGGO
OOOOOOOOOOOOGMFGGGGGGPOOOOOOOOOOOOOOGRJJJGHMGOOOOOOOOOOOOOOOOOOOOPPOOOOOGOOOOOOO
OOOOOOOOOOOOGFMGGFGPPPOOOOOOOOOOOOOORRGGGGGMPOOOOOOOOOOOOOOOOOOOOOGOOOOOOOPGOOOO
OOOOOOOOOOOOOOHMGGRPGGOOOOOOOOOOOOOOOGGGGGGHGOOOOOOOOOOOOOOOOOOOOOOOOOOGGPGPGGOO
OOOOOOOOOOOOOOGHGGRGGOOOOOOOOOOOOOOOODPPGGGGGGOOOOOOOOOOOOOOOOOOOOOOOOOGGPPPPGOO
OOOOOOOOOOOOOOGMGPRROOOOOOOOOOOOOOOOPPPPPPPGGGOPOOOOOOOOOOOOOOOOOOOOGGPPPDDDPPPO
OOOOOOOOOOOOOOGMGGGPOOOOOOOOOOOOOOOOHPDDPPGGOOOPOOOOOOOOOOOOOOOOOOOGGGPDDDDDDPFO
OOOOOOOOOOOOOOPMGGGOOOOOOOOOOOOOOOOOOPPDPPGGOOOGOOOOOOOOOOOOOOOOOOOGPDDDDDDDDPPO
OOOOOOOOOOOOOOOMGPOOOOOOOOOOOOOOOOOOOHPPPGGGOOGPOOOOOOOOOOOOOOOOOOOGDDDDDPDDDPGO
OOOOOOOOOOOOOOOGGOOOOOOOOOOOOOOOOOOOOHPPGHGOOOPOOOOOOOOOOOOOOOOOOOODDDDDDDPDDHFO
OOOOOOOOOOOOOOOPGOOOOOOOOOOOOOOOOOOOOODPGHGOOOOOOOOOOOOOOOOOOOOOOOODDDOOGDDDHGOO
OOOOOOOOOOOOOOOOGOOOOOOOOOOOOOOOOOOOOOPGGGOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOGHHHGOOO
OOOOOOOOOOOOOOOOFOOOOOOOOOOOOOOOOOOOOOGOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOPGOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
`.replace(/\n/g,"")).map(e=>new y5[e])}height(){return 50}width(){return 80}};t(AR,"Earth");Hf=AR});var GR,GW,MW=i(()=>{LP();BR();GR=class extends TR{constructor(e,r){super(e,Hf,r)}};t(GR,"EarthStartTile");GW=GR});var Yc,A8e,UW,DW=i(()=>{LP();he();Yc=class extends Bm{constructor(){super(TR)}getByCivilization(e){let[r]=this.getBy("civilizationType",e);if(!r)throw new TypeError(`${e.name} does not have a registered start tile.`);return r}getStartTileByCivilizationAndWorld(e,r){return this.getByCivilization(e).startTileForMap(r)}};t(Yc,"CivilizationStartTileRegistry");A8e=new Yc,UW=Yc});var MR,UR,HP=i(()=>{DW();BR();MR=class extends UW{entries(){return super.entries().filter(e=>e.mapGenerator()===Hf)}};t(MR,"EarthStartTileRegistry");UR=new MR});var d5={};var EW=i(()=>{ZT();MW();HP();UR.register(...[[Hn,{x:12,y:18}],[_n,{x:5,y:23}],[Kn,{x:45,y:22}],[qn,{x:66,y:19}],[Vn,{x:41,y:24}],[Jn,{x:31,y:14}],[$n,{x:33,y:16}],[Zn,{x:38,y:15}],[Qn,{x:39,y:18}],[Xn,{x:57,y:26}],[ea,{x:49,y:19}],[ta,{x:36,y:19}],[ra,{x:44,y:12}],[oa,{x:42,y:42}]].map(([o,e])=>new GW(o,e)))});var SW=I(kW=>{"use strict";Object.defineProperty(kW,"__esModule",{value:!0});EW()});var g5,FW,NW=i(()=>{U();b();gC();g5=t(()=>[new rl(new l(o=>o<252),new p(o=>o*20-4020)),new rl(new l(o=>o>251),new l(o=>o<302),new p(o=>(o-151)*10+1e3)),new rl(new l(o=>o>301),new l(o=>o<352),new p(o=>(o-201)*5+1500)),new rl(new l(o=>o>351),new l(o=>o<402),new p(o=>(o-251)*2+1750)),new rl(new l(o=>o>401),new p(o=>o-301+1850))],"getRules"),FW=g5});var h5={};var WW=i(()=>{A();NW();c.register(...FW())});var LW=I(YW=>{"use strict";Object.defineProperty(YW,"__esModule",{value:!0});WW()});var _f,Kf,Lc=i(()=>{_f=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}goodyHut(){return this.#e}perform(){}unit(){return this.#t}};t(_f,"Action");Kf=_f});var qf,zW=i(()=>{_e();Lc();qf=class extends Kf{#e;#t;constructor(e,r,n=H,a=()=>Math.random()){super(e,r),this.#e=n,this.#t=a}perform(){let e=this.#e.getByPlayer(this.unit().player()),r=e.available(),n=r[Math.floor(r.length*this.#t())];e.addAdvance(n)}};t(qf,"Advance")});var Vf,jW=i(()=>{mt();A();Lc();Is();Vf=class extends Kf{#e;constructor(e,r,n=Z){super(e,r),this.#e=n}perform(e=c){let r=this.unit().player(),n=new it(r,this.goodyHut().tile(),r.civilization().getCityName(!0),e);this.#e.register(n)}};t(Vf,"City")});var Jf,HW=i(()=>{Fl();Lc();Gs();Jf=class extends Kf{#e;constructor(e,r,n=tn){super(e,r),this.#e=n}perform(){this.#e.getByPlayerAndType(this.unit().player(),ci).add(new ci(50))}};t(Jf,"Gold")});var DR,ER,_P=i(()=>{M();DR=class extends x{};t(DR,"Unit");ER=DR});var $f,_W=i(()=>{Lc();A();_P();$f=class extends _f{#e;#t;constructor(e,r,n=()=>Math.random(),a=c){super(e,r),this.#e=n,this.#t=a}perform(){this.#t.process(ER,this.goodyHut(),this.unit())}};t($f,"Unit")});var KW=i(()=>{zW();jW();HW();_W()});var x5,qW,VW=i(()=>{KW();mt();En();_e();kC();U();b();Us();mm();Ms();x5=t((o=H,e=Z)=>[new Ll(new l((r,n)=>o.getByPlayer(n.player()).available().length>0),new p((r,n)=>new qf(r,n))),new Ll(new l(r=>[Oe,pe,me].some(n=>r.tile().terrain()instanceof n)),new l((r,n)=>r.tile().getSurroundingArea().score(null,[[Ua,8],[sm,3],[om,1]])>=150),new l(r=>r.tile().getSurroundingArea(4).every(n=>e.getByTile(n)===null)),new p((r,n)=>new Vf(r,n))),new Ll(new p((r,n)=>new Jf(r,n))),new Ll(new p((r,n)=>new $f(r,n)))],"getRules"),qW=x5});var O5,JW,$W=i(()=>{ee();SC();b();O5=t((o=P)=>[new ex(new p((e,r)=>{o.emit("goody-hut:action-performed",e,r)}))],"getRules"),JW=O5});var R5,ZW,QW=i(()=>{ee();ml();FC();b();R5=t((o=Ii,e=P,r=()=>Math.random())=>[new rf(new p(n=>o.unregister(n))),new rf(new p((n,a)=>{let s=n.actions(a),m=s[Math.floor(s.length*r())];n.action(m)})),new rf(new p((n,a)=>{e.emit("goody-hut:discovered",n,a)}))],"getRules"),ZW=R5});var kR,Zf,KP=i(()=>{M();kR=class extends x{};t(kR,"Distribution");Zf=kR});var v5,XW,eY=i(()=>{ml();U();KP();v5=t((o=Ii,e=()=>Math.random())=>[new Zf(new l(r=>r.isLand())),new Zf(new l(r=>r.getSurroundingArea(3).every(n=>o.getByTile(n)===null))),new Zf(new l(()=>e()<.05))],"getRules"),XW=v5});var b5,tY,rY=i(()=>{ml();zn();A();b();_P();b5=t((o=Ii,e=()=>Math.random(),r=c)=>[new ER(new p((n,a)=>{let s=[Cr,Tr],m=s[Math.floor(s.length*e())];return new m(null,a.player(),a.tile(),r)}))],"getRules"),tY=b5});var C5,oY,iY=i(()=>{ml();U();b();dt();C5=t((o=Ii)=>[new j(new l(e=>o.getByTile(e.tile())!==null),new p(e=>{o.getByTile(e.tile()).process(e)}))],"getRules"),oY=C5});var SR,fl,FR=i(()=>{M();SR=class extends x{};t(SR,"Built");fl=SR});var T5,nY,aY=i(()=>{ml();A();FR();b();NC();KP();T5=t((o=Ii,e=c)=>[new fl(new p(r=>{let n=e.get(Zf);r.forEach(a=>{n.every(s=>s.validate(a))&&o.register(new ox(a))})}))],"getRules"),nY=T5});var P5={};var sY=i(()=>{VW();$W();QW();eY();rY();A();iY();aY();c.register(...qW(),...JW(),...ZW(),...XW(),...tY(),...oY(),...nY())});var lY=I(mY=>{"use strict";Object.defineProperty(mY,"__esModule",{value:!0});sY()});var I5={};var pY=i(()=>{_s();sx();of.register(It,pt,Vt,ft,Ot)});var w5,fY,uY=i(()=>{ns();_s();U();b();sC();Sa();w5=t((o=Ht)=>[new yt(new l(e=>!o.getByPlayer(e).is(Oo)),new p(e=>[new ts(e,o.getByPlayer(e))]))],"getRules"),fY=w5});var A5,cY,yY=i(()=>{sx();ns();A();Il();_s();b();Ol();jC();A5=t((o=of,e=Ht,r=c)=>[new Ji(new Ts,new p(n=>{let a=new fx(n,o,r);a.set(new Vt),e.register(a)}))],"getRules"),cY=A5});var B5,dY,gY=i(()=>{xO();_s();_e();LC();U();B5=t((o=H)=>[new Vu(new l(e=>e===Vt)),...[[It,Tt],[pt,Yo],[ft,kr],[Ot,ho]].map(([e,r])=>new Vu(new l(n=>n===e),new l((n,a)=>o.getByPlayer(a).completed(r))))],"getRules"),dY=B5});var G5,hY,xY=i(()=>{ee();Oi();zC();U();b();G5=t((o=P,e=se)=>[new Ju(new p((r,n)=>{o.emit("player:government:changed",r,n)})),new Ju(new l(r=>{try{return e.getByPlayer(r),!0}catch(n){if(n instanceof TypeError&&n.message.match(/Wrong number of player worlds exist/))return!1;throw n}}),new p(r=>{e.getByPlayer(r).entries().forEach(a=>a.tile().clearYieldCache(r))}))],"getRules"),hY=G5});var M5={};var OY=i(()=>{A();uY();yY();gY();xY();c.register(...fY(),...cY(),...dY(),...hY())});var vY=I(RY=>{"use strict";Object.defineProperty(RY,"__esModule",{value:!0});pY();OY()});var NR,bY,CY=i(()=>{M();NR=class extends x{};t(NR,"TurnEnd");bY=NR});var U5,TY,PY=i(()=>{Kp();ee();A();CY();U5=t((o=os,e=c,r=P)=>[["player:turn-end",n=>{o.unregister(n),e.process(bY,n);let[a]=o.entries();if(!a){r.emit("turn:end");return}r.emit("player:turn-start",a)}]],"getEvents"),TY=U5});var D5,IY,wY=i(()=>{rs();ee();A();Af();D5=t((o=Lt,e=P,r=c)=>[["player:turn-start",n=>{try{r.process(ia,n)}catch(s){console.error(s)}o.getByPlayer(n).takeTurn().catch(s=>console.error(s)).finally(()=>{e.emit("player:turn-end",n)})}]],"getEvents"),IY=D5});var E5,AY,BY=i(()=>{Kp();ee();Qm();E5=t((o=Xi,e=os,r=P)=>[["turn:start",()=>{e.register(...o.entries());let[n]=e.entries();r.emit("player:turn-start",n)}]],"getEvents"),AY=E5});var k5={};var GY=i(()=>{ee();PY();wY();BY();[...TY(),...IY(),...AY()].forEach(([o,e])=>P.on(o,e))});var WR,ds,zc=i(()=>{M();WR=class extends x{};t(WR,"Defeated");ds=WR});var S5,MY,UY=i(()=>{mt();A();vl();U();zc();b();S5=t((o=Z,e=c)=>[new eo(new l((r,n,a)=>o.getByPlayer(a).filter(s=>s!==r).length===0),new p((r,n,a)=>{e.process(ds,a,n)}))],"getRules"),MY=S5});var F5,DY,EY=i(()=>{mt();A();U();zc();bl();b();F5=t((o=Z,e=c)=>[new Uo(new l((r,n)=>o.getByPlayer(r.player()).filter(a=>a!==r).length===0),new p((r,n)=>e.process(ds,r.player(),n)))],"getRules"),DY=F5});var qP,N5,kY,SY=i(()=>{Sa();U();b();Qy();km();qP=new yt(new pi(9001),new l(o=>{qP.disable();let e=o.mandatoryActions();return qP.enable(),e.length===0}),new p(o=>[new Zy(o,null)])),N5=t(()=>[qP],"getRules"),kY=N5});var W5,FY,NY=i(()=>{ee();Il();b();W5=t((o=P)=>[new Ji(new p(e=>{o.emit("player:added",e)}))],"getRules"),FY=W5});var Y5,WY,YY=i(()=>{Kp();ee();Qm();U();zc();b();He();Y5=t((o=os,e=Xi,r=L,n=P)=>[new ds(new l(a=>o.includes(a)),new p(a=>o.unregister(a))),new ds(new l(a=>e.includes(a)),new p(a=>e.unregister(a))),new ds(new p((a,s)=>r.getByPlayer(a).forEach(m=>m.destroy(s)))),new ds(new p((a,s)=>{n.emit("player:defeated",a,s)}))],"getRules"),WY=Y5});var YR,LR,VP=i(()=>{M();YR=class extends x{};t(YR,"Spawn");LR=YR});var L5,LY,zY=i(()=>{A();b();CO();VP();L5=t((o=c)=>[new LR(new p((e,r)=>{new oD(null,e,r,o)}))],"getRules"),LY=L5});var z5,jY,HY=i(()=>{mt();A();He();b();Us();Ol();Mf();mm();Ms();Af();Un();z5=t((o=c,e=Z,r=L)=>[new ia(new Ts,new p(n=>{e.getByPlayer(n).forEach(a=>{let s=a.yields();Nl(s,Ua,sm,om).reduce((m,f,u)=>(m[u].set(f,"Consolidated"),m),[new Ua(0,"Consolidated"),new sm(0,"Consolidated"),new om(0,"Consolidated")]).forEach(m=>o.process(ls,m,a,s))})})),new ia(new p(n=>r.getByPlayer(n).forEach(a=>{if(a.destroyed())return;a.moves().set(a.movement());let s=a.busy();if(!s){a.setActive(),a.setWaiting(!1);return}!s.validate()||s.process()})))],"getRules"),jY=z5});var j5,_Y,KY=i(()=>{ee();b();nC();j5=t((o=P)=>[new kg(new p((e,r)=>{o.emit("player:visibility-changed",e,r)}))],"getRules"),_Y=j5});var H5,qY,VY=i(()=>{Qm();Oi();Sd();b();H5=t((o=Xi,e=se)=>[new cm(new p(r=>{r.clearYieldCache(null),o.forEach(n=>{e.getByPlayer(n).getByTile(r)!==null&&r.clearYieldCache(n)})}))],"getRules"),qY=H5});var _5,JY,$Y=i(()=>{mt();A();U();zc();pu();b();_5=t((o=Z,e=c)=>[new Fa(new l((r,n)=>o.getByPlayer(r.player()).length===0),new p((r,n)=>e.process(ds,r.player(),n)))],"getRules"),JY=_5});var K5,ZY,QY=i(()=>{Oi();b();Bb();K5=t((o=se)=>[new Bd(new p((e,r)=>{e.clearYieldCache(r);let n=o.getByPlayer(r);n.register(e),n.getByTile(e).update()}))],"getRules"),ZY=K5});var zR,jR,JP=i(()=>{M();zR=class extends x{};t(zR,"PickStartTile");jR=zR});var q5,XY,eL=i(()=>{Br();Wt();QT();rs();ee();xP();Qm();Oi();A();$O();FR();sp();b();Us();Gl();JP();Dp();Fg();mm();_u();VP();Ms();q5=t((o=qO,e=Lt,r=P,n=Xi,a=se,s=c,m=oR,f=Te,u=ae,y=Ef)=>[new fl(new p(O=>n.entries().forEach(B=>a.register(new Ul(B,O))))),new fl(new p(O=>{let B=new Map,N=new Map,W=t((h,G=null)=>(B.has(h)||B.set(h,h.score(G,[[Ua,8],[sm,3],[om,1]])),B.get(h)),"tileScore"),_=t((h,G=null)=>(N.has(h)||N.set(h,h.getSurroundingArea().entries().reduce((z,Qe)=>z+W(Qe,G),0)),N.get(h)),"areaScore");r.emit("world:generate-start-tiles");let d=[],g=O.entries().filter(h=>[Jm,Up,Nh].some(G=>h.terrain()instanceof G)).map(h=>({tile:h,score:_(h)})).sort(({score:h},{score:G})=>G-h).map(({tile:h})=>h);r.emit("world:start-tiles",g),e.entries().reduce((h,G)=>h.then(async()=>{let z=G.player(),Qe=await G.chooseFromList(new Um(o.entries(),"choose-civilization")),Ft=new Qe(f,u);z.setCivilization(Ft);let be=await G.chooseFromList(new Um(m.getByCivilization(Ft.sourceClass()),"choose-leader")),Ce=new be(y);Ft.setLeader(Ce),o.unregister(Ft.sourceClass()),m.unregister(Ce.sourceClass());let[Be]=s.process(jR,O,z,d);if(!Be)throw new TypeError("Not enough `startingSquare`s.");d.push(Be),s.process(LR,z,Be)}),Promise.resolve()).then(()=>r.emit("game:start"))})),new fl(new p(O=>{r.emit("world:built",O)}))],"getRules"),XY=q5});var V5={};var tL=i(()=>{UY();EY();A();SY();NY();YY();zY();HY();KY();VY();$Y();QY();eL();c.register(...MY(),...DY(),...kY(),...FY(),...WY(),...LY(),...jY(),..._Y(),...qY(),...JY(),...ZY(),...XY())});var oL=I(rL=>{"use strict";Object.defineProperty(rL,"__esModule",{value:!0});GY();tL()});var J5={};var iL=i(()=>{pn();D();v.register(rn,So,ao,on,_t,so,Fo,No,mo,Ai,Sn,yr,Bi,Tt,lo,Fn,Dr,Wo,po,Yo,dr,xt,Gi,Mi,nn,an,Nn,Ui,tr,Wn,rr,gr,Di,Yn,hr,Er,Lo,Kt,xr,fo,uo,Ei,kr,qt,co,Sr,zo,Fr,yo,ki,Si,Nr,Fi,go,Pt,Ni,sn,jo,mn,ln,Ho,ho,Ln,_o,Wi,or,xo)});var nL=i(()=>{ab()});var $5,aL,sL=i(()=>{_e();Sa();nL();U();b();$5=t((o=H)=>[new yt(new l(e=>o.getByPlayer(e).researching()===null),new l(e=>o.getByPlayer(e).available().length>0),new p(e=>[new tm(e,o.getByPlayer(e))]))],"getRules"),aL=$5});var Z5,mL,lL=i(()=>{D();_e();A();Il();b();lh();Z5=t((o=v,e=H,r=c,n=()=>Math.random())=>[new Ji(new p(a=>e.register(new Vp(a,o,r)))),new Ji(new p(a=>{let s=e.getByPlayer(a);for(let m=0,f=Math.min(s.available().length,Math.floor(4*n()));m<f;m++){let u=s.available();s.addAdvance(u[Math.floor(n()*u.length)])}}))],"getRules"),mL=Z5});var Q5,pL,fL=i(()=>{rs();_e();vl();sp();U();b();Q5=t((o=H,e=()=>Math.random(),r=Lt)=>[new eo(new l((n,a,s)=>o.getByPlayer(s).complete().some(m=>!o.getByPlayer(a).completed(m.constructor))),new p(async(n,a,s)=>{let m=o.getByPlayer(a),f=o.getByPlayer(s).complete().map(O=>O.sourceClass()).filter(O=>!m.completed(O)),u=r.getByPlayer(a),y=await u.chooseFromList(new Um(f,"capture-city.steal-advance",n));m.addAdvance(y)}))],"getRules"),pL=Q5});var X5,uL,cL=i(()=>{ee();th();b();X5=t((o=P)=>[new Xm(new p((e,r)=>{o.emit("player:research-complete",e,r)}))],"getRules"),uL=X5});var e3,yL,dL=i(()=>{fC();b();e3=t(()=>[new oh(new p((o,e)=>(e.complete().length+1)*(6+2*0)))],"getRules"),yL=e3});var t3,gL,hL=i(()=>{_e();A();Gf();U();b();Mf();JT();t3=t((o=H,e=c)=>[new ls(new l(r=>r instanceof ct),new l((r,n,a)=>!e.process(Vs,n,a).some(s=>s)),new p((r,n)=>o.getByPlayer(n.player()).add(r)))],"getRules"),gL=t3});var r3,xL,OL=i(()=>{pn();U();b();uC();r3=t(()=>[...[[rn,an,dr],[ao,fo,qt],[on,_o,yo],[_t,Bi,ln],[so,ho,Wi],[Fo,Dr,Di],[Ai,or,uo],[Sn,nn,Wn],[yr,So],[Bi,go,Mi],[Tt,Fr,rr],[lo,xt,fo],[Fn,Mi,ho],[Dr,po,Kt],[Wo,so,rr],[po,No],[Yo,Fr,hr],[dr,Ei,Er],[xt,Gi,dr],[Gi,Dr,Ln],[Mi,tr,Ai],[nn,Kt,kr],[an,Bi,yo],[Nn,zo,Ho],[Ui,Wo,uo],[tr,gr,Di],[rr,Nr,so],[gr,Gi,hr],[Di,No],[Yn,xr,Tt],[hr,yr,xo],[Er,co,yo],[Lo,So],[xr,Wo,_t],[fo,So,Kt],[uo,Fr,Wi],[Ei,tr,or],[kr,yr,qt],[qt,mo],[co,ao,Lo],[Sr,xr,on],[zo,Sr,xt],[Fr,qt,hr],[yo,co,fo],[ki,go,jo],[Nr,Fo,mn],[Fi,Yo,xr],[go,Wo,Ai],[Pt,Fr,xo],[Ni,lo,ki],[sn,xt,rn],[jo,lo,sn],[mn,gr,yo],[ln,Ei,rr],[Ho,xr,ki],[ho,yr,hr],[_o,ao,or],[Wi,yr,po],[or,Fr,fo],[xo,So]].map(([o,...e])=>new nh(new l(r=>r===o),new p((r,n)=>e.every(a=>n.some(s=>s instanceof a)))))],"getRules"),xL=r3});var o3,RL,vL=i(()=>{ee();b();sh();o3=t((o=P)=>[new qp(new p((e,r)=>{o.emit("player:research",e,r)}))],"getRules"),RL=o3});var i3={};var bL=i(()=>{sL();lL();fL();cL();dL();A();hL();OL();vL();c.register(...aL(),...mL(),...pL(),...uL(),...yL(),...gL(),...xL(),...RL())});var TL=I(CL=>{"use strict";Object.defineProperty(CL,"__esModule",{value:!0});iL();bL()});var Pm=i(()=>{AP();BP();UP();DP();EP();kP()});var n3={};var PL=i(()=>{Pm();kl();Gn.register(Pr,Ir,qr,Mo,pr,Zt)});var HR,_R,$P=i(()=>{M();HR=class extends x{};t(HR,"Built");_R=HR});var KR,qR,ZP=i(()=>{M();KR=class extends x{};t(KR,"ChanceOfSuccess");qR=KR});var VR,JR,QP=i(()=>{M();VR=class extends x{};t(VR,"FlightTime");JR=VR});var $R,ZR,XP=i(()=>{M();$R=class extends x{};t($R,"Landed");ZR=$R});var QR,IL,wL=i(()=>{M();QR=class extends x{};t(QR,"Launch");IL=QR});var XR,jc,eI=i(()=>{M();XR=class extends x{};t(XR,"Lost");jc=XR});var ev,Qf,tv=i(()=>{J();A();Mt();Yu();$P();ZP();nR();QP();XP();wL();eI();ev=class extends k{#e=1/0;#t=!1;#r;#o;#i;#n;#a=null;#m;#s;constructor(e,r,n=c,a=te,s=Ws,m=()=>Math.random()){super(),this.#o=e,this.#r=r,this.#n=n,this.#m=a,this.#s=s,this.#i=m,this.addKey("activeParts","chanceOfSuccess","flightTime","inactiveParts","launched","layout","player","successful","yields")}activeParts(){return this.#r.activeSlots().filter(e=>!e.empty()).map(e=>e.part())}add(e){let[r]=this.#n.process(tp,e,this.#r);!r||(r.fill(e),this.#n.process(_R,e,this))}chanceOfSuccess(){return Math.max(...this.#n.process(qR,this),0)}check(){if(!(this.#a!==null||this.#t===!1||this.#m.value()<this.#e)){if(this.#a=this.chanceOfSuccess()>this.#i(),this.#a){this.#n.process(ZR,this);return}this.#n.process(jc,this)}}flightTime(){return Math.min(...this.#n.process(JR,this),1/0)}inactiveParts(){return this.#r.inactiveSlots().filter(e=>!e.empty()).map(e=>e.part())}launch(){this.#n.process(IL,this),this.#e=this.#t=this.#m.value();let e=this.flightTime(),r=this.#s.value()+e;for(;this.#s.value(this.#e)<r;)this.#e++}launched(){return this.#t}layout(){return this.#r}player(){return this.#o}successful(){return this.#a}yields(){return this.activeParts().flatMap(e=>e.yields())}};t(ev,"Spaceship");Qf=ev});var rv,Ra,np=i(()=>{he();tv();rv=class extends F{constructor(){super(Qf)}getActiveByPlayer(e){let[r]=this.getBy("player",e).filter(n=>n.launched()===!1||n.successful()===null);return r||null}};t(rv,"SpaceshipRegistry");Ra=new rv});var ov,St,gs=i(()=>{he();Le();ov=class extends F{constructor(){super(Ae)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.filter(r=>r.city().player()===e)}};t(ov,"WonderRegistry");St=new ov});var hs,iv,nv=i(()=>{Le();hs=class extends De{};t(hs,"ApolloProgram");iv=hs});var a3,AL,BL=i(()=>{Jp();Pm();_e();np();gs();nv();U();b();es();Tc();af();Ic();a3=t((o=St,e=H,r=Ra)=>[new Dt(new l((n,a)=>Object.prototype.isPrototypeOf.call(Ct,a)),new p(()=>new l(()=>o.some(n=>n instanceof iv)))),new Dt(new l((n,a)=>Object.prototype.isPrototypeOf.call(Ct,a)),new p(n=>new l(()=>{let a=r.getActiveByPlayer(n.player());return a===null?!1:a.launched()===!1}))),...[[Zt,mO],[Pr,Cc],[pr,Cc],[Ir,bm],[qr,bm],[Mo,bm]].map(([n,a])=>new Dt(new l((s,m)=>m===n),new p(s=>new l(()=>e.getByPlayer(s.player()).completed(a)))))],"getRules"),AL=a3});var s3,GL,ML=i(()=>{$p();Pm();s3=t(()=>[...[[Pr,160],[Ir,320],[qr,320],[Mo,320],[pr,160],[Zt,80]].flatMap(([o,e])=>el(o,e))],"getRules"),GL=s3});var m3,UL,DL=i(()=>{Kp();uR();A();np();Mt();Yu();nv();Zp();U();b();es();tv();m3=t((o=os,e=Ra,r=Lf,n=c,a=te,s=Ws,m=()=>Math.random())=>[new en(new l((f,u)=>u instanceof iv),new p(()=>{let[f]=r.entries(),u=new f(n);o.entries().forEach(y=>e.register(new Qf(y,u,n,a,s,m)))})),new en(new l((f,u)=>u instanceof Ct),new l((f,u)=>e.getActiveByPlayer(u.city().player())!==null),new p((f,u)=>{let y=u;e.getActiveByPlayer(y.city().player()).add(y)}))],"getRules"),UL=m3});var av,ul,tI=i(()=>{J();av=class extends fe{#e;#t;constructor(e,r){super(),this.addKey("resource","value"),this.#e=e,this.#t=r}resource(){return this.#e}value(){return this.#t}};t(av,"SpendCost");ul=av});var l3,EL,kL=i(()=>{U();b();Gs();es();Wu();tI();l3=t(()=>[new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(Ct,o.building().item())),new l(o=>o.progress().value()===0),new p(o=>new ul(ci,o.remaining()*8))),new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(Ct,o.building().item())),new l(o=>o.progress().value()>0),new p(o=>new ul(ci,o.remaining()*4)))],"getRules"),EL=l3});var p3,SL,FL=i(()=>{np();Sa();U();b();Tb();p3=t((o=Ra)=>[new yt(new l(e=>o.getActiveByPlayer(e)!==null),new p(e=>[new yw(e,o.getActiveByPlayer(e))]))],"getRules"),SL=p3});var rI,f3,NL,WL=i(()=>{Pm();GP();U();b();rI=new rp(new l(o=>o.part()instanceof pr),new p((o,e)=>{rI.disable();let r=e.activeSlots();return rI.enable(),e.getAdjacent(o).some(n=>n.part()instanceof Pr&&r.includes(n))})),f3=t(()=>[new rp(new p(o=>o.part()!==null)),new rp(new l(o=>[Pr,Ir,qr,Mo].some(e=>o.part()instanceof e)),new p((o,e)=>e.getAdjacent(o).some(r=>r.part()instanceof Zt))),rI],"getRules"),NL=f3});var u3,YL,LL=i(()=>{ee();$P();b();u3=t((o=P)=>[new _R(new p(e=>{o.emit("player:spaceship:part-built",e.city().player())}))],"getRules"),YL=u3});var xs,zL=i(()=>{We();xs=class extends Y{};t(xs,"Energy")});var Js,jL=i(()=>{We();Js=class extends Y{};t(Js,"LifeSupport")});var dn,HL=i(()=>{We();dn=class extends Y{};t(dn,"Mass")});var cl,_L=i(()=>{We();cl=class extends Y{};t(cl,"Population")});var sv=i(()=>{zL();jL();HL();_L()});var c3,KL,qL=i(()=>{sv();Pm();ZP();b();c3=t(()=>[new qR(new p(o=>{let[e,r,n,a,s]=o.yields().reduce(([B,N,W,_,d],g)=>(g instanceof xs&&g.value()>0&&(B+=g.value()),g instanceof xs&&g.value()<0&&(N+=Math.abs(g.value())),g instanceof Js&&g.value()>0&&(W+=g.value()),g instanceof Js&&g.value()<0&&(_+=Math.abs(g.value())),g instanceof cl&&(d+=g.value()),[B,N,W,_,d]),[0,0,0,0,0]),[m,f]=o.activeParts().reduce(([B,N],W)=>(W instanceof Pr&&B++,W instanceof pr&&N++,[B,N]),[0,0]);if([e,n,s,m,f].some(B=>B===0))return 0;let u=Math.min(m/f,1),y=Math.min(a/n,1),O=Math.min(r/e,1);return u*y*O}))],"getRules"),KL=c3});var y3,VL,JL=i(()=>{nR();U();b();Pm();y3=t(()=>[new tp(new l(o=>o instanceof Zt),new l((o,e)=>e.slots().filter(r=>r.accepts(o)&&r.empty()).length>0),new p((o,e)=>{let r=e.slots().filter(a=>a.accepts(o)&&a.empty()),[n]=r.sort((a,s)=>e.getAdjacent(s).filter(m=>m.part()instanceof Zt).length-e.getAdjacent(a).filter(m=>m.part()instanceof Zt).length||e.getAdjacent(s).filter(m=>!m.empty()).length-e.getAdjacent(a).filter(m=>!m.empty()).length||Math.abs(a.x()-8)-Math.abs(s.x()-8)||Math.abs(a.y()-6)-Math.abs(s.y()-6));return n})),new tp(new l(o=>!(o instanceof Zt)),new l((o,e)=>e.slots().filter(r=>r.accepts(o)&&r.empty()).length>0),new p((o,e)=>{let r=e.slots().filter(a=>a.accepts(o)&&a.empty()),[n]=r.sort((a,s)=>e.getAdjacent(s).filter(m=>!m.empty()).length-e.getAdjacent(a).filter(m=>!m.empty()).length||Math.abs(a.x()-8)-Math.abs(s.x()-8)||Math.abs(a.y()-6)-Math.abs(s.y()-6));return n}))],"getRules"),VL=y3});var d3,$L,ZL=i(()=>{b();QP();sv();Pm();Un();d3=t(()=>[new JR(new p(o=>{let e=tt(o.yields(),dn),r=o.activeParts().reduce((n,a)=>n+(a instanceof pr?1:0),0);return Math.trunc(e/20/(1+r*10)*10)/10}))],"getRules"),$L=d3});var g3,QL,XL=i(()=>{ee();b();XP();g3=t((o=P)=>[new ZR(new p(e=>{o.emit("player:spaceship:landed",e.player())}))],"getRules"),QL=g3});var h3,ez,tz=i(()=>{ee();uR();A();np();Mt();Yu();b();eI();tv();h3=t((o=Ra,e=Lf,r=c,n=te,a=Ws,s=P,m=()=>Math.random())=>[new jc(new p(f=>{s.emit("player:spaceship:lost",f.player())})),new jc(new p(f=>{let[u]=e.entries(),y=new u(r);o.register(new Qf(f.player(),y,r,n,a,m))}))],"getRules"),ez=h3});var x3,rz,oz=i(()=>{sv();Pm();U();b();oC();x3=t(()=>[...[[Pr,dn,400],[Ir,xs,-50],[Ir,Js,-100],[Ir,dn,1600],[Ir,cl,1e4],[qr,xs,-50],[qr,Js,100],[qr,dn,1600],[Mo,xs,100],[Mo,dn,400],[pr,dn,400],[Zt,dn,100]].map(([o,e,r])=>new Bg(new l(n=>n instanceof o),new p(n=>new e(r,n.id()))))],"getRules"),rz=x3});var mv,lv,oI=i(()=>{M();mv=class extends x{};t(mv,"Start");lv=mv});var O3,iz,nz=i(()=>{np();b();oI();O3=t((o=Ra)=>[new lv(new p(()=>{o.entries().forEach(e=>e.check())}))],"getRules"),iz=O3});var R3={};var az=i(()=>{BL();ML();DL();kL();A();FL();WL();LL();qL();JL();ZL();XL();tz();oz();nz();c.register(...AL(),...GL(),...UL(),...EL(),...SL(),...NL(),...YL(),...KL(),...VL(),...$L(),...QL(),...ez(),...rz(),...iz())});var mz=I(sz=>{"use strict";Object.defineProperty(sz,"__esModule",{value:!0});PL();az()});var pv,yl,Hc=i(()=>{We();pv=class extends Y{};t(pv,"TradeRate");yl=pv});var Im,lz=i(()=>{mu();Hc();Im=class extends yl{};t(Im,"Luxuries"),Im.tradeYield=VI});var wm,pz=i(()=>{vp();Hc();wm=class extends yl{};t(wm,"Research"),wm.tradeYield=ct});var Am,fz=i(()=>{Gs();Hc();Am=class extends yl{};t(Am,"Tax"),Am.tradeYield=ci});var iI=i(()=>{lz();pz();fz()});var fv,dl,_c=i(()=>{Pn();Hc();fv=class extends st{constructor(){super(yl)}};t(fv,"AvailableTradeRateRegistry");dl=new fv});var v3={};var uz=i(()=>{iI();_c();dl.register(Im,wm,Am)});var cz=i(()=>{id();Ms()});var uv,cv,nI=i(()=>{J();uv=class extends k{#e;#t=[];constructor(e,...r){super(),this.#e=e,this.#t=r,this.addKey("all")}all(){return[...this.#t]}balance(e){if(this.total()===100)return;let r=100-e.value(),n=this.#t.filter(s=>s!==e),a=n.reduce((s,m)=>s+m.value(),0);n.forEach(s=>s.set(s.value()/a*r)),this.total()<100&&n[Math.floor(n.length*Math.random())].add(100-this.total()),this.total()>100&&n[Math.floor(n.length*Math.random())].subtract(100-this.total())}get(e){let[r]=this.#t.filter(n=>n instanceof e);return r}player(){return this.#e}set(e,r){let n=this.get(e);n.set(r),this.balance(n)}setAll(e){if(e.reduce((r,[,n])=>r+n,0)!==100)throw new TypeError("Invalid rates provided, must sum to 100.");e.forEach(([r,n])=>this.get(r).set(n))}total(){return this.#t.reduce((e,r)=>e+r.value(),0)}};t(uv,"PlayerTradeRates");cv=uv});var yv,gl,Kc=i(()=>{he();nI();yv=class extends F{constructor(){super(cv)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTradeRates for player");return r[0]}};t(yv,"PlayerTradeRatesRegistry");gl=new yv});var b3,yz,dz=i(()=>{_c();cz();Kc();b();hp();Un();b3=t((o=dl,e=gl)=>[new gp(new p((r,n)=>{let a=e.getByPlayer(r.player()),s=Math.max(0,tt(n,oe)),m=s;return o.entries().map(f=>{let u=f.tradeYield,y=Math.min(Math.ceil(s*(a.get(f).value()/100)),m);return m-=y,new u(y,f.name)})}))],"getRules"),yz=b3});var C3,gz,hz=i(()=>{Kc();Sa();ob();b();C3=t((o=gl)=>[new yt(new p(e=>[new Em(e,o.getByPlayer(e))]))],"getRules"),gz=C3});var T3,xz,Oz=i(()=>{_c();Kc();iI();Il();b();nI();T3=t((o=dl,e=gl)=>[new Ji(new p(r=>{let n=[new Am(50),new wm(50),new Im(0)],a=o.entries(),s=new cv(r,...a.map(m=>{let[f]=n.filter(u=>u instanceof m);return new m(f||0)}));e.register(s)}))],"getRules"),xz=T3});var dv,P3,Rz,vz=i(()=>{_c();mt();A();b();Ol();Mf();Af();Un();dv=[],P3=t((o=c,e=Z,r=dl)=>[new ia(new Ts,new p(n=>{dv.length===0&&r.entries().forEach(a=>dv.push(a.tradeYield)),e.getByPlayer(n).forEach(a=>{let s=a.yields();Nl(s,...dv).reduce((m,f,u)=>(m[u].set(f,"Consolidated"),m),dv.map(m=>new m)).forEach(m=>o.process(ls,m,a,s))})}))],"getRules"),Rz=P3});var I3={};var bz=i(()=>{A();dz();hz();Oz();vz();c.register(...yz(),...gz(),...xz(),...Rz())});var Tz=I(Cz=>{"use strict";Object.defineProperty(Cz,"__esModule",{value:!0});uz();bz()});var gv=i(()=>{od();Gs()});var w3,Pz,Iz=i(()=>{Ve();U();b();gv();Wu();tI();ks();w3=t(()=>[new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(Fe,o.building().item())),new l(o=>o.progress().value()===0),new p(o=>{let e=o.remaining()/10;return new ul(je,Math.floor((e+4)*10*e))})),new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(Fe,o.building().item())),new l(o=>o.progress().value()>0),new p(o=>{let e=o.remaining()/10;return new ul(je,Math.floor(5*e**2+20*e))})),new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(K,o.building().item())),new l(o=>o.progress().value()===0),new p(o=>new ul(je,o.remaining()*4))),new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(K,o.building().item())),new l(o=>o.progress().value()>0),new p(o=>new ul(je,o.remaining()*2)))],"getRules"),Pz=w3});var A3,wz,Az=i(()=>{is();mt();Sa();xb();b();A3=t((o=Z,e=zt)=>[new yt(new p(r=>o.getByPlayer(r).map(n=>new Wm(r,e.getByCity(n)))))],"getRules"),wz=A3});var B3,Bz,Gz=i(()=>{is();Fl();A();Il();b();gv();dC();B3=t((o=tn,e=zt,r=c)=>[new Ji(new p(n=>o.register(new Ch(n,je,e,r))))],"getRules"),Bz=B3});var G3,Mz,Uz=i(()=>{gv();Bo();ee();Fl();A();yC();U();b();Mf();G3=t((o=tn,e=c,r=ke,n=P)=>[new ls(new l(a=>a instanceof je),new p((a,s,m)=>{let f=o.getByPlayerAndType(s.player(),je);m.forEach(u=>{if(u instanceof je&&(f.add(u),u instanceof de&&f.value()<0)){let y=u.cityImprovement(),O=new dh(y.constructor,s,e);r.unregister(y),f.add(O.cost().value()),n.emit("city:unsupported-improvement",s,y);return}})}))],"getRules"),Mz=G3});var hv,Dz,Ez=i(()=>{M();hv=class extends x{};t(hv,"Updated");Dz=hv});var M3,kz,Sz=i(()=>{ee();U();b();Ez();M3=t((o=P)=>[new Dz(new l(e=>e.value()<0),new p((e,r)=>{o.emit("player:treasury-exhausted",e.player(),e,r)}))],"getRules"),kz=M3});var U3={};var Fz=i(()=>{A();Iz();Az();Gz();Uz();Sz();c.register(...Pz(),...wz(),...Bz(),...Mz(),...kz())});var Wz=I(Nz=>{"use strict";Object.defineProperty(Nz,"__esModule",{value:!0});Fz()});var D3={};var Yz=i(()=>{zn();kl();Gn.register($o,Zo,jr,Ro,Qo,vo,bo,Co,Xo,ei,sr,Hr,Cr,To,Po,ti,Io,mr,ri,_r,qe,wo,Kr,Tr,oi,Ao,lr,ii)});var xv,Xf,aI=i(()=>{M();xv=class extends x{};t(xv,"Available");Xf=xv});var Lz=i(()=>{Wc();Wc()});var sI=i(()=>{YP()});var zz=i(()=>{sI();sI()});var mI=i(()=>{Lz();zz()});var Ov,jz,Rv,k3,Hz,_z=i(()=>{wb();zs();Ml();Wt();mt();zn();En();vm();js();Xr();Fp();A();hu();_a();xi();Yl();Mt();He();gm();fi();sy();aI();U();b();jO();bO();mI();Ov=new l((o,e,r=o.tile())=>o instanceof Ke),jz=new l((o,e,r=o.tile())=>o instanceof Ne),Rv=t((o,e)=>e.getByTile(o)!==null,"tileHasCity"),k3=t((o=ae,e=Z,r=c,n=Je,a=oo,s=L,m=Yt,f=kn,u=te,y=Ur,O=Se,B=Ns,N=$m)=>{let W=[Bp,di,new l((d,g)=>s.getByTile(g).some(h=>h.player()!==d.player())),new ni(new Cs(new l(d=>d instanceof ht),new ni(new l((d,g)=>!s.getByTile(g).every(h=>h instanceof ht)),new l((d,g)=>d instanceof sr))),new Cs(Ov,new ni(new l((d,g)=>Rv(g,e)),new l((d,g)=>s.getByTile(g).some(h=>h instanceof Ke)))),new Cs(jz,new ni(new l((d,g)=>!(d instanceof Kr)),new l((d,g)=>g.isWater()))))],_=[Bp,di,Ov,new l((d,g)=>Rv(g,e)),new l((d,g)=>s.getByTile(g).length===0),new l((d,g)=>e.getByTile(g).player()!==d.player())];return[new vt(Bp,di,new ni(new Cs(Ov,new l((d,g,h=d.tile())=>h.isLand()),new l((d,g)=>g.isLand()),new l((d,g)=>s.getByTile(g).every(h=>h.player()===d.player()))),new Cs(jz,new ni(new l((d,g,h=d.tile())=>h.isWater()),new l((d,g,h=d.tile())=>e.getByTile(h)?.player()===d.player())),new ni(new l((d,g)=>g.isWater()),new l((d,g)=>e.getByTile(g)?.player()===d.player()))),new l(d=>d instanceof ht)),new ni(new l((d,g)=>!(d instanceof Ke)),new l((d,g,h=d.tile())=>!(h.getNeighbours().some(G=>s.getByTile(G).some(z=>z instanceof Ke&&z.tile().terrain()instanceof Q&&z.player()!==d.player()))&&g.getNeighbours().some(G=>s.getByTile(G).some(z=>z instanceof Ke&&z.tile().terrain()instanceof Q&&z.player()!==d.player())))),new l((d,g)=>s.getByTile(g).filter(h=>h.player()===d.player()).length>0),new l((d,g)=>{let h=e.getByTile(g);return h===null?!1:h.player()===d.player()})),new l((d,g)=>{let h=e.getByTile(g);return h===null?!0:h.player()===d.player()}),new l((d,g)=>!s.getByTile(g).some(h=>h.player()!==d.player())),new p((d,g,h=d.tile())=>new nt(h,g,d,r))),new vt(...W,new l((d,g)=>s.getByTile(g).every(h=>y.getByPlayers(d.player(),h.player()).filter(G=>G instanceof Li).every(G=>G.expired()))),new p((d,g,h=d.tile())=>new Zi(h,g,d,r,s))),new vt(...W,new l((d,g)=>s.getByTile(g).every(h=>y.getByPlayers(d.player(),h.player()).some(G=>G instanceof Li&&G.active()))),new p((d,g,h=d.tile())=>{let G=Array.from(new Set(s.getByTile(g).filter(z=>y.getByPlayers(d.player(),z.player()).some(Qe=>Qe instanceof Li&&Qe.active())).map(z=>z.player())));return G.length>1&&(console.warn("Multiple targets for declaring war:"),console.warn(G),console.warn("core-unit/Rules/Unit/action.ts")),new Xa(h,g,d,G[0],r,s)})),new vt(..._,new l((d,g)=>{let h=e.getByTile(g);return y.getByPlayers(d.player(),h.player()).filter(G=>G instanceof Li).every(G=>G.expired())}),new p((d,g,h=d.tile())=>{let G=e.getByTile(g);return new Ha(h,g,d,G,r)})),new vt(..._,new l((d,g)=>{let h=e.getByTile(g);return y.getByPlayers(d.player(),h.player()).filter(G=>G instanceof Li).some(G=>G.active())}),new p((d,g,h=d.tile())=>{let G=e.getByTile(g);return new An(h,g,d,G,G.player(),r)})),new vt(di,Es,new l(d=>d instanceof V),new l((d,g)=>n.getByTile(g).filter(h=>[Ue,et,Xt,Ye].some(G=>h instanceof G)).length>0),new p((d,g,h=d.tile())=>new Za(h,g,d,r,n,u))),new vt(di,Es,new l(d=>d instanceof V),new l((d,g,h=d.tile())=>h.isLand()),new p((d,g,h=d.tile())=>new $a(h,g,d,r,u,a))),new vt(di,Es,new p((d,g,h=d.tile())=>new wn(h,g,d,r,u))),new vt(di,Es,new p((d,g,h=d.tile())=>new ym(h,g,d,r))),new vt(Es,new p((d,g,h=d.tile())=>new In(h,g,d,r))),new vt(di,Es,new l(d=>d instanceof qe),new l((d,g,h=d.tile())=>h.isLand()),new l((d,g,h=d.tile())=>!Rv(h,e)),new p((d,g,h=d.tile())=>new hm(h,g,d,o,r,O))),...[[Ue,Ya,new ni(new l((d,g,h=d.tile())=>h.terrain()instanceof me),new l((d,g,h=d.tile())=>h.getAdjacent().some(G=>G.terrain()instanceof me||G.terrain()instanceof Qr||n.getByTile(G).some(z=>z instanceof Ue)&&!Rv(G,e))))],[et,La],[Ye,ja],[Xt,za,new l((d,g)=>n.getByTile(g).some(h=>h instanceof Ye))]].map(([d,g,...h])=>new vt(new l(G=>G instanceof cr),di,new l((G,z,Qe=G.tile())=>r.get(Xf).some(Ft=>Ft.validate(Qe,d,G.player()))),Es,...h,new p((G,z,Qe=G.tile())=>new g(Qe,z,G,r,u)))),...[[rt,qa],[$e,Ka],[pe,Qa],[ot,Va]].map(([d,g])=>new vt(di,Es,new l(h=>h instanceof cr),new l((h,G,z=h.tile())=>z.terrain()instanceof d),new p((h,G,z=h.tile())=>new g(z,G,h,r,m,u)))),new vt(Bp,di,Ov,new l((d,g)=>g.terrain()instanceof Qr),new l((d,g)=>s.getByTile(g).every(h=>h.player()===d.player())),new l((d,g)=>s.getByTile(g).filter(h=>h instanceof jt).some(h=>h.hasCapacity()&&h.canStow(d))),new p((d,g,h=d.tile())=>{let[G]=s.getByTile(g).filter(z=>z instanceof jt).filter(z=>z.hasCapacity()&&z.canStow(d));return new dm(h,g,d,G,r)})),new vt(Bp,new l(d=>{try{return f.getByUnit(d),!0}catch{return!1}}),new ni(new l((d,g)=>!(d instanceof Ke)),new l((d,g)=>g.isLand())),new l((d,g,h=d.tile())=>f.getByUnit(d).transport().tile()===h),new p((d,g,h=d.tile())=>{let G=f.getByUnit(d).transport();return new Ja(h,g,d,G,r)})),new vt(di,Es,new l(d=>d instanceof jt),new l(d=>d.hasCargo()),new l((d,g)=>g.getNeighbours().some(h=>h.isLand())),new p((d,g,h=d.tile())=>new Om(h,g,d,r))),new vt(di,new l((d,g,h)=>g!==h&&!g.isNeighbourOf(h)),new l((d,g,h)=>{let[G]=B.entries();return G?new G(d,h,g).generate()instanceof ms:!1}),new p((d,g,h)=>new xm(h,g,d,r,B,N)))]},"getRules"),Hz=k3});var S3,Kz,qz=i(()=>{gm();Ab();U();b();$u();S3=t((o=oo)=>[new Gp(new l(e=>e.moves().value()>0),new p(e=>e.setActive())),new Gp(new l(e=>e.busy()!==null),new p(e=>e.setBusy())),...[Eo].map(e=>new Gp(new l(r=>o.getByUnit(r).some(n=>n instanceof e)),new p(r=>o.unregister(...o.getByUnit(r).filter(n=>n instanceof e)))))],"getRules"),Kz=S3});var F3,Vz,Jz=i(()=>{Jp();zn();_e();Qu();ec();tc();oc();nc();ac();U();b();sc();mc();lc();fc();uc();cc();dc();gc();hc();xc();Rc();zs();bc();af();Pc();wc();Ac();Bc();Gc();Mc();F3=t((o=H)=>[new Dt(new l((e,r)=>Object.prototype.isPrototypeOf.call(Ne,r)),new p(e=>new l(()=>e.tile().isCoast()))),...[[$o,bm],[Zo,pO],[jr,Zu],[Ro,Oc],[vo,Zu],[Qo,dO],[bo,Vx],[Co,cO],[Xo,ic],[ei,hO],[sr,Fx],[Hr,yc],[Cr,Yx],[To,lO],[Po,rc],[ti,jx],[Io,nf],[mr,sO],[ri,zl],[_r,vc],[wo,bx],[Kr,qx],[Tr,zx],[oi,Xu],[Ao,pc],[lr,_x]].map(([e,r])=>new Dt(new l((n,a)=>a===e),new p(n=>new l(()=>o.getByPlayer(n.player()).completed(r))))),...[[Ro,bm],[bo,Oc],[Co,rc],[Hr,pc],[Cr,zl],[To,ic],[Po,Xu],[Io,zl],[_r,yc],[wo,nf],[Tr,zl],[lr,vc],[ii,nf]].map(([e,r])=>new Dt(new l((n,a)=>a===e),new p(n=>new l(()=>!o.getByPlayer(n.player()).completed(r)))))],"getRules"),Vz=F3});var N3,$z,Zz=i(()=>{$p();zn();N3=t(()=>[...[[$o,80],[Zo,160],[jr,120],[Ro,40],[Qo,50],[vo,160],[bo,40],[Co,40],[Xo,80],[ei,30],[sr,60],[Hr,40],[Cr,20],[To,50],[Po,40],[ti,50],[Io,30],[mr,160],[ri,30],[_r,40],[qe,40],[wo,20],[Kr,50],[Tr,20],[oi,80],[Ao,50],[lr,40],[ii,10]].flatMap(([o,e])=>el(o,e))],"getRules"),$z=N3});var W3,Qz,Xz=i(()=>{er();Zp();U();b();zn();W3=t((o=ie)=>[new en(new l((e,r)=>r instanceof qe),new p(e=>o.getByCity(e.city()).shrink()))],"getRules"),Qz=W3});var Y3,ej,tj=i(()=>{ee();He();Id();b();Y3=t((o=L,e=P)=>[new pm(new p(r=>o.register(r))),new pm(new p(r=>r.applyVisibility())),new pm(new p(r=>r.moves().set(r.movement()))),new pm(new p(r=>{e.emit("unit:created",r)}))],"getRules"),ej=Y3});var L3,rj,oj=i(()=>{mt();ee();A();xi();He();U();cu();pu();b();L3=t((o=Z,e=c,r=Je,n=L,a=P)=>[new Na(new p((s,m)=>{a.emit("unit:defeated",s,m),e.process(Fa,s,m.player())})),new Na(new l(s=>o.getByTile(s.tile())===null),new l(s=>n.getByTile(s.tile()).filter(m=>m!==s&&m.player()===s.player()).length>0),new p((s,m)=>n.getByTile(s.tile()).forEach(f=>{f!==s&&f.player()===s.player()&&e.process(Fa,s,m.player())})))],"getRules"),rj=L3});var z3,ij,nj=i(()=>{ee();gm();He();pu();b();z3=t((o=L,e=oo,r=P)=>[new Fa(new p((n,a)=>{r.emit("unit:destroyed",n,a)})),new Fa(new p(n=>{n.setActive(!1),n.setDestroyed()})),new Fa(new p(n=>e.getByUnit(n).forEach(a=>e.unregister(a))))],"getRules"),ij=z3});var vv,eu,lI=i(()=>{M();vv=class extends x{};t(vv,"LostAtSea");eu=vv});var j3,aj,sj=i(()=>{ee();b();lI();j3=t((o=P)=>[new eu(new p(e=>{o.emit("unit:lost-at-sea",e)})),new eu(new p(e=>e.destroy(null)))],"getRules"),aj=j3});var bv,H3,mj,lj=i(()=>{zn();mt();Ml();ee();vm();A();Yl();Mt();sy();U();b();Ol();lI();dt();jO();zs();mI();bv=new Map,H3=t((o=kn,e=c,r=()=>Math.random(),n=P,a=Z,s=te,m=Ur)=>[new j(new p((f,u)=>{n.emit("unit:moved",f,u)})),new j(new p(f=>f.applyVisibility())),new j(new l(f=>f.moves().value()<.3),new p(f=>{f.moves().set(0),f.setActive(!1)})),new j(new l(f=>f instanceof jt),new l((f,u)=>u instanceof nt),new l(f=>f.hasCargo()),new p((f,u)=>f.cargo().forEach(y=>y.action(u.forUnit(y))))),new j(new l((f,u)=>u instanceof Ja),new p(f=>{let u=o.getByUnit(f);u.transport().unload(f),o.unregister(u)})),new j(new l(f=>f instanceof lr),new l(f=>f.moves().value()===0),new l(f=>!f.tile().isCoast()),new l(()=>r()<=.5),new p(f=>{e.process(eu,f)})),...[[jr,1],[sr,0],[mr,0]].flatMap(([f,u])=>[new j(new Ts,new l(y=>y instanceof f),new l(y=>y.moves().value()===0),new l(y=>!bv.has(y)),new p(y=>{bv.set(y,s.value())})),new j(new l(y=>y instanceof f),new l(y=>y.moves().value()===0),new ni(new l(y=>a.getByTile(y.tile())!==null),new l(y=>!!o.getByUnit(y))),new p(y=>{bv.delete(y)})),new j(new l(y=>y instanceof f),new l(y=>y.moves().value()===0),new Cs(new l(y=>a.getByTile(y.tile())===null),new l(y=>!o.getByUnit(y))),new l(y=>(bv.get(y)??s.value())+u<=s.value()),new p(y=>{e.process(eu,y)}))]),new j(new l((f,u)=>u instanceof Xa||u instanceof An),new p((f,u)=>{m.getByPlayers(f.player(),u.enemy()).filter(O=>O instanceof Li&&O.active()).forEach(O=>O.expire())}))],"getRules"),mj=H3});var pj,_3,fj,uj=i(()=>{En();zs();Ml();js();xi();Yl();U();b();gi();pj=[[Et,2],[Ie,1],[$e,2],[Oe,1],[Ee,2],[rt,2],[ze,3],[lt,1],[pe,1],[me,1],[ot,2],[gt,1]],_3=t((o=Je,e=kn)=>[...pj.map(([r,n])=>new we(new l((a,s)=>s instanceof nt),new l(a=>a instanceof Ke),new l((a,s)=>s.to().terrain()instanceof r),new p(()=>n))),new we(new l((r,n)=>n instanceof nt),new l(r=>r instanceof ht||r instanceof Ne),new p(()=>1)),new we(new l((r,n)=>n instanceof nt),new l(r=>r instanceof Ke),new l((r,n)=>o.getByTile(n.from()).some(a=>a instanceof Ye)),new l((r,n)=>o.getByTile(n.to()).some(a=>a instanceof Ye)),new p(()=>1/3)),new we(new l((r,n)=>n instanceof nt),new l(r=>r instanceof Ke),new l((r,n)=>o.getByTile(n.from()).some(a=>a instanceof Xt)),new l((r,n)=>o.getByTile(n.to()).some(a=>a instanceof Xt)),new p(()=>0)),new we(new l((r,n)=>n instanceof nt),new l(r=>r instanceof Ke),new l(r=>{try{return e.getByUnit(r),!0}catch{return!1}}),new l(r=>e.getByUnit(r).transport()instanceof jt),new p(()=>0)),...[[Ya,2],[La,3],[ja,1],[za,2],[Ka,2],[qa,3],[Va,3],[$a,1],[Za,1],[Qa,3],[wn,0]].flatMap(([r,n])=>pj.map(([a,s])=>new we(new l((m,f)=>f instanceof r),new l(m=>m.tile().terrain()instanceof a),new p(()=>n*s))))],"getRules"),fj=_3});var K3,cj,yj=i(()=>{tb();He();Sa();U();b();K3=t((o=L)=>[new yt(new l(e=>o.getByPlayer(e).some(r=>r.active()&&r.moves().value())),new p(e=>o.getByPlayer(e).filter(r=>r.active()&&r.moves().value()>0).sort((r,n)=>(r.waiting()?1:0)-(n.waiting()?1:0)).map(r=>new Aa(e,r)))),new yt(new l(e=>o.getByPlayer(e).some(r=>!r.active()||!r.moves().value())),new p(e=>o.getByPlayer(e).filter(r=>!r.active()||r.moves().value()===0).sort((r,n)=>(r.waiting()?1:0)-(n.waiting()?1:0)).map(r=>new Ba(e,r))))],"getRules"),cj=K3});var q3,dj,gj=i(()=>{b();Og();PC();q3=t(()=>[new Kh(new p(o=>o.action(new PA(o.tile(),o.tile(),o))))],"getRules"),dj=q3});var V3,hj,xj=i(()=>{Ap();zn();TC();$u();A();Yl();gm();Mp();Mp();U();b();V3=t((o=oo,e=c,r=kn)=>[...[[$o,12,2,2],[Zo,18,12,4,2],[jr,12,1,8,2],[Ro,8],[Qo,0],[vo,1,12,5,2],[bo,6],[Co,4,1,2],[Xo,6,6,6,2],[ei,0,0,2],[sr,4,2,10,2],[Hr,2,2,3],[Cr,2,1,2],[To,4,4,4],[Po,4,2,2],[ti,6,6,3],[Io,3,2],[mr,99,0,16],[ri,3,5],[_r,1,1,3],[qe,0],[wo,1,2],[Kr,8,2,3,2],[Tr,3],[oi,10,5,3],[Ao,0,3,4],[lr,1,0,3],[ii]].flatMap(([n,a=1,s=1,m=1,f=1])=>Rw(n,a,s,m,f)),...[[Eo,1,$i],[ss,.5,bn,$i]].flatMap(([n,a,...s])=>s.map(m=>new fm(new l((f,u)=>u instanceof m),new l(f=>o.getByUnit(f).some(u=>u instanceof n)),new p((f,u)=>{let y=new m;e.process(Km,f.constructor,y),u.add(y.value()*a,n.name)})))),...[[lr,2],[_r,3],[Hr,4],[Ao,8],[vo,8]].flatMap(([n,a])=>[new fm(new l((s,m)=>m instanceof nl),new l(s=>s instanceof n),new p((s,m)=>m.set(a))),new fm(new l((s,m)=>m instanceof al),new p((s,m)=>m.set(r.getByTransport(s).length)))])],"getRules"),hj=V3});var J3,Oj,Rj=i(()=>{ee();b();kO();J3=t((o=P)=>[new Zl(new p((e,r)=>{o.emit("unit:unsupported",e,r)}))],"getRules"),Oj=J3});var $3,vj,bj=i(()=>{U();b();kb();$3=t((o=()=>Math.random())=>[new yu(new l((e,r)=>e.moves().value()>=r),new p((e,r)=>(e.moves().subtract(r),!0))),new yu(new l((e,r)=>e.moves().value()<r),new p((e,r)=>{let n=e.moves().value();return e.moves().set(0),n>=r*.5*o()}))],"getRules"),vj=$3});var Z3={};var Cj=i(()=>{_z();qz();Jz();Zz();Xz();tj();oj();nj();A();sj();lj();uj();yj();gj();xj();Rj();bj();c.register(...Hz(),...Kz(),...Vz(),...$z(),...Qz(),...ej(),...rj(),...ij(),...aj(),...mj(),...fj(),...cj(),...dj(),...hj(),...Oj(),...vj())});var Pj=I(Tj=>{"use strict";Object.defineProperty(Tj,"__esModule",{value:!0});Yz();Cj()});var ai,Ij=i(()=>{Le();ai=class extends Ae{};t(ai,"Colossus")});var zi,wj=i(()=>{Le();zi=class extends Ae{};t(zi,"CopernicusObservatory")});var va,Aj=i(()=>{Le();va=class extends De{};t(va,"CureForCancer")});var ba,Bj=i(()=>{Le();ba=class extends De{};t(ba,"DarwinsVoyage")});var si,Gj=i(()=>{Le();si=class extends Ae{};t(si,"GreatLibrary")});var Ca,Mj=i(()=>{Le();Ca=class extends Ae{};t(Ca,"GreatWall")});var ji,Uj=i(()=>{Le();ji=class extends Ae{};t(ji,"HangingGardens")});var $s,Dj=i(()=>{Le();$s=class extends De{};t($s,"HooverDam")});var Ta,Ej=i(()=>{Le();Ta=class extends De{};t(Ta,"IsaacNewtonsCollege")});var gn,kj=i(()=>{Le();gn=class extends De{};t(gn,"JsBachsCathedral")});var Hi,Sj=i(()=>{Le();Hi=class extends De{};t(Hi,"Lighthouse")});var Pa,Fj=i(()=>{Le();Pa=class extends Ae{};t(Pa,"MagellansExpedition")});var Os,Nj=i(()=>{Le();Os=class extends De{};t(Os,"ManhattanProject")});var mi,Wj=i(()=>{Le();mi=class extends De{};t(mi,"MichelangelosChapel")});var Vr,Yj=i(()=>{Le();Vr=class extends Ae{};t(Vr,"Oracle")});var Ia,Lj=i(()=>{Le();Ia=class extends Ae{};t(Ia,"Pyramids")});var wa,zj=i(()=>{Le();wa=class extends De{};t(wa,"SetiProgram")});var li,jj=i(()=>{Le();li=class extends De{};t(li,"ShakespearesTheatre")});var Zs,Hj=i(()=>{Le();Zs=class extends De{};t(Zs,"UnitedNations")});var hn,_j=i(()=>{Le();hn=class extends De{};t(hn,"WomensSuffrage")});var Qs=i(()=>{nv();Ij();wj();Aj();Bj();Gj();Mj();Uj();Dj();Ej();kj();Sj();Fj();Nj();Wj();Yj();Lj();zj();jj();Hj();_j()});var Q3={};var Kj=i(()=>{Qs();kl();Gn.register(hs,ai,zi,va,ba,si,Ca,ji,$s,Ta,gn,Hi,Pa,Os,mi,Vr,Ia,wa,li,Zs,hn)});var X3,qj,Vj=i(()=>{Qs();pn();Jp();_e();gs();U();b();Le();zn();X3=t((o=H,e=St)=>[new Dt(new l((r,n)=>Object.isPrototypeOf.call(Ae,n)),new p((r,n)=>new l(()=>e.filter(a=>a instanceof n).length===0))),...[[ai,No],[zi,ao],[si,hr],[Ca,Kt],[ji,Si],[Hi,Lo],[Pa,co],[Vr,mo],[Ia,Kt],[hs,jo],[va,Ui],[ba,Nr],[$s,xt],[Ta,_o],[gn,Pt],[Os,Sr],[mi,Pt],[wa,lo],[li,uo],[Zs,Tt],[hn,rr]].map(([r,n])=>new Dt(new l((a,s)=>s===r),new p(a=>new l(()=>o.getByPlayer(a.player()).completed(n))))),...[[mr,Os]].map(([r,n])=>new Dt(new l((a,s)=>s===r),new p(()=>new l(()=>e.some(a=>a instanceof n)))))],"getRules"),qj=X3});var e4,Jj,$j=i(()=>{Qs();$p();e4=t(()=>[...[[hs,600],[ai,200],[zi,300],[va,600],[ba,300],[si,300],[Ca,300],[ji,300],[$s,600],[Ta,400],[gn,400],[Hi,200],[Pa,400],[Os,600],[mi,300],[Vr,300],[Ia,300],[wa,600],[li,400],[Zs,600],[hn,600]].flatMap(([o,e])=>el(o,e))],"getRules"),Jj=e4});var t4,Zj,Qj=i(()=>{is();ee();_e();A();gs();Zp();U();Qs();b();sh();Le();t4=t((o=zt,e=H,r=c,n=St,a=P)=>[new en(new l((s,m)=>m instanceof Ae),new p((s,m)=>{let f=m.constructor;n.register(m),o.filter(u=>u.building()?.item()===f).forEach(u=>u.revalidate())})),new en(new l((s,m)=>m instanceof Ae),new p((s,m)=>{a.emit("wonder:built",m,s.city())})),new en(new l((s,m)=>m instanceof ba),new p(s=>{let m=e.getByPlayer(s.city().player()),f=t(y=>{let O=new qp(new l(B=>B===m),new p(()=>{r.unregister(O),y()}));r.register(O)},"createOnStarted"),u=t(()=>{m.add(m.cost()),f(()=>m.add(m.cost()))},"completeResearch");if(m.researching()===null){f(()=>u());return}u()}))],"getRules"),Zj=t4});var tu,xn,qc=i(()=>{gs();U();tu=t((o,e=St)=>new l(r=>e.getByCity(r).some(n=>n instanceof o)),"cityHasWonder"),xn=t((o,e=St)=>new l(r=>e.getByPlayer(r.player()).some(n=>n instanceof o)),"playerHasWonder")});var Xj,Rs,Cv,Vc=i(()=>{_e();U();Xj=t((o,e=H)=>new l(r=>e.getByPlayer(r.player()).completed(o)),"discoveredByPlayer"),Rs=t((o,e=H)=>new l(()=>o===null||!e.some(r=>r.completed(o))),"notDiscoveredByAnyPlayer"),Cv=t((o,e=H)=>new l(r=>o===null||!e.getByPlayer(r.player()).completed(o)),"notDiscoveredByPlayer")});var Tv,eH=i(()=>{Bo();U();Tv=t((o,e=ke)=>new l(r=>e.getByCity(r).some(n=>n instanceof o)),"hasCityImprovement")});var r4,tH,rH=i(()=>{fn();Bo();pn();Qs();ns();_e();He();gs();qc();Vc();dp();U();b();em();LO();km();lm();eH();Un();r4=t((o=ke,e=Ht,r=H,n=L,a=St)=>[new Gt(new Rt,xn(Vr,a),Tv(kt,o),Cv(qt,r),Rs(Pt,r),new p((s,m)=>new Xe(-Math.min(1,tt(m,Xe)),Vr.name))),new Gt(new Rt,xn(Vr,a),Tv(kt,o),Xj(qt,r),Rs(Pt,r),new p((s,m)=>new Xe(-Math.min(2,tt(m,Xe)),Vr.name))),new Gt(new pi(4e3),tu(li,a),Rs(xt,r),new p((s,m)=>new Xe(-tt(m,Xe),li.name))),new Gt(new Rt,xn(gn,a),new p((s,m)=>new Xe(-Math.min(2,tt(m,Xe)),gn.name))),new Gt(new Rt,xn(mi,a),Tv(nr,o),Rs(Tt,r),new p((s,m)=>new Xe(-Math.min(4,tt(m,Xe)),mi.name))),new Gt(new Rt,xn(hn,a),new l((s,m)=>m.some(f=>f instanceof On)),new p((s,m)=>m.flatMap(f=>f instanceof On?new Xe(-1,hn.name):[])))],"getRules"),tH=r4});var o4,oH,iH=i(()=>{gs();bl();U();b();o4=t((o=St)=>[new Uo(new l(e=>o.getByCity(e).length>0),new p(e=>o.getByCity(e).forEach(r=>o.unregister(r))))],"getRules"),oH=o4});var i4,nH,aH=i(()=>{Qs();pn();lm();_e();gs();qc();hp();b();km();Vc();i4=t((o=H,e=St)=>[new Ma(new pi(500),tu(ai,e),Rs(dr,o),new p(r=>new oe(r.tilesWorked().filter(n=>n.yields().some(a=>a instanceof oe)).length,ai.name))),...[[ji,1,gr],[va,1,null]].map(([r,n,a])=>new Ma(xn(r,e),Rs(a,o),new p(()=>new Da(n,r.name))))],"getRules"),nH=i4});var n4,sH,mH=i(()=>{Qs();_e();gs();qc();pn();b();em();lm();Uy();Vc();Un();n4=t((o=H,e=St)=>[...[[zi,ct,1,_t]].map(([r,n,a,s])=>new Cl(new Rt,tu(r,e),Rs(s,o),new p((m,f)=>new n(tt(f,n)*a,r.name)))),...[[wa,ct,.5,null]].map(([r,n,a,s])=>new Cl(new Rt,xn(r,e),Rs(s,o),new p((m,f)=>new n(tt(f,n)*a,r.name))))],"getRules"),sH=n4});var Pv,Iv,pI=i(()=>{M();Pv=class extends x{};t(Pv,"Obsolete");Iv=Pv});var a4,lH,pH=i(()=>{pn();Qs();_e();A();gs();th();U();b();pI();a4=t((o=H,e=c,r=St)=>[new Xm(new l(()=>r.some(n=>n instanceof si)),new l((n,a)=>{let[s]=r.filter(f=>f instanceof si).map(f=>f.city().player());return!o.getByPlayer(s).completed(a.sourceClass())}),new l((n,a)=>o.filter(s=>s.completed(a.sourceClass())).length>=3),new p((n,a)=>{let[s]=r.filter(f=>f instanceof si).map(f=>f.city().player());return o.getByPlayer(s).addAdvance(a.sourceClass())})),...[[ai,dr],[zi,_t],[si,or],[Ca,tr],[ji,gr],[Ta,Sr],[Hi,Er],[mi,Tt],[Vr,Pt],[Ia,Tt],[li,xt]].map(([n,a])=>new Xm(new l(()=>r.entries().some(s=>s instanceof n)),new l((s,m)=>m instanceof a),new p(()=>{let[s]=r.filter(m=>m instanceof n);e.process(Iv,s,s.city())})))],"getRules"),lH=a4});var s4,fH,uH=i(()=>{Qs();_e();gs();U();b();em();pn();Ap();zs();Mp();Vc();qc();s4=t((o=St,e=H)=>[new fu(new Rt,new l((r,n)=>n instanceof Cn),new l(r=>r instanceof Ne),xn(Hi,o),Cv(Er,e),new p((r,n)=>n.add(1))),new fu(new Rt,new l((r,n)=>n instanceof Cn),new l(r=>r instanceof Ne),xn(Pa,o),new p((r,n)=>n.add(1)))],"getRules"),fH=s4});var m4,cH,yH=i(()=>{ee();b();pI();m4=t((o=P)=>[new Iv(new p((e,r)=>{o.emit("wonder:obsolete",e,r)}))],"getRules"),cH=m4});var l4={};var dH=i(()=>{Vj();$j();Qj();rH();iH();aH();mH();A();pH();uH();yH();c.register(...qj(),...Jj(),...Zj(),...tH(),...oH(),...nH(),...sH(),...lH(),...fH(),...cH())});var hH=I(gH=>{"use strict";Object.defineProperty(gH,"__esModule",{value:!0});Kj();dH()});var p4,xH,OH=i(()=>{En();js();_e();xO();xi();aI();U();p4=t((o=H,e=Je)=>[...[[Ue,Ie,Oe,Ee,pe,me],[et,Ie,Ee,ze],[Ye,Et,Ie,$e,Oe,Ee,rt,ze,pe,ot,gt]].map(([r,...n])=>new Xf(new l((a,s)=>s===r),new l(a=>n.some(s=>a.terrain()instanceof s)),new l((a,s)=>!e.getByTile(a).some(m=>m instanceof s)))),...[[Ye,Fo,me]].map(([r,n,...a])=>new Xf(new l((s,m)=>m===r),new l(s=>a.some(m=>s.terrain()instanceof m)),new l((s,m)=>!e.getByTile(s).some(f=>f instanceof m)),new l((s,m,f)=>o.getByPlayer(f).completed(n)))),...[[Xt,Nr,Ye,Et,Ie,$e,Oe,Ee,rt,ze,pe,me,ot,gt]].map(([r,n,a,...s])=>new Xf(new l((m,f)=>f===r),new l(m=>s.some(f=>m.terrain()instanceof f)),new l((m,f)=>!e.getByTile(m).some(u=>u instanceof f)),new l(m=>e.getByTile(m).some(f=>f instanceof a)),new l((m,f,u)=>o.getByPlayer(u).completed(n))))],"getRules"),xH=p4});var f4,RH,vH=i(()=>{ee();js();xi();Sd();U();b();f4=t((o=Je,e=P)=>[new cm(new l((r,n)=>o.getByTile(r).every(a=>n.constructor!==a.constructor)),new p((r,n)=>o.register(n))),new cm(new p(r=>r.clearYieldCache(null))),new cm(new p((r,n)=>{e.emit("tile-improvement:built",r,n)})),...[[et,Ue],[Ue,et]].map(([r,n])=>new cm(new l((a,s)=>s instanceof r),new l(a=>o.getByTile(a).some(s=>s instanceof n)),new p(a=>o.unregister(...o.getByTile(a).filter(s=>s instanceof n)))))],"getRules"),RH=f4});var wv,Av,fI=i(()=>{Pn();Qi();wv=class extends st{constructor(){super(at)}};t(wv,"AvailableTerrainFeatureRegistry");Av=new wv});var u4,bH,CH=i(()=>{fI();A();mb();b();Ep();u4=t((o=c,e=Av)=>[new gy(new p(r=>{let n=o.get(Vm);e.entries().forEach(a=>n.filter(s=>s.validate(a,r)).forEach(s=>s.process(a,r)))}))],"getRules"),bH=u4});var Ar,uI=i(()=>{M();Ar=class extends x{};t(Ar,"Distribution")});var c4,TH,PH=i(()=>{En();uI();Xr();U();b();c4=t(()=>[new Ar(new l(o=>o===Et),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:0,to:.01,fill:!0},{from:.01,to:.02},{from:.98,to:.99},{from:.99,to:1,fill:!0}])),new Ar(new l(o=>o===Ie),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.4,to:.45},{from:.45,to:.55,coverage:.025,cluster:!0,clusterChance:.1},{from:.55,to:.6}])),new Ar(new l(o=>o===$e),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.05,to:.2},{from:.2,to:.4,cluster:!0,clusterChance:.1,coverage:.1},{from:.4,to:.6},{from:.6,to:.8,cluster:!0,clusterChance:.1,coverage:.1},{from:.8,to:.95}])),new Ar(new l(o=>o===Oe),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{fill:!0}])),new Ar(new l(o=>o===Ee),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.1,to:.9,path:!0,pathChance:.1,coverage:.06}])),new Ar(new l(o=>o===rt),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.3,to:.45,cluster:!0,clusterChance:.2,coverage:.08},{from:.55,to:.7,cluster:!0,clusterChance:.2,coverage:.08}])),new Ar(new l(o=>o===ze),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.01,to:.1,coverage:.3,path:!0},{from:.1,to:.9,path:!0},{from:.9,to:.99,coverage:.3,path:!0}])),new Ar(new l(o=>o===lt),new l((o,e)=>e.some(r=>r.constructor===Qr)),new p(()=>[{fill:!0}])),new Ar(new l(o=>o===pe),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.01,to:.2,coverage:.3},{from:.2,to:.4},{from:.1,to:.4,cluster:!0},{from:.4,to:.6},{from:.6,to:.8},{from:.6,to:.9,cluster:!0},{from:.8,to:.99,coverage:.3}])),new Ar(new l(o=>o===me),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.1,to:.9,coverage:.1,path:!0,pathChance:.5}])),new Ar(new l(o=>o===ot),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.2,to:.4,cluster:!0},{from:.6,to:.8,cluster:!0}])),new Ar(new l(o=>o===gt),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.01,to:.15,cluster:!0,coverage:.15},{from:.85,to:.99,cluster:!0,coverage:.15}]))],"getRules"),TH=c4});var Bv,Gv,cI=i(()=>{M();Bv=class extends x{};t(Bv,"DistributionGroups");Gv=Bv});var y4,IH,wH=i(()=>{En();b();cI();y4=t(()=>[new Gv(new p(()=>[lt,Oe,ot,ze,rt,Ee,$e,Ie,pe,gt,Et,me]))],"getRules"),IH=y4});var d4,AH,BH=i(()=>{En();qu();_a();Ep();d4=t((o=Yt)=>[...[[Ri,.2,Ee],[vi,.2,lt],[io,.2,$e,gt],[bi,.2,rt],[Ci,.2,ze],[ko,.2,pe],[no,.2,Ie],[Ti,.2,ot],[Pi,.2,Et],[hi,.5,Oe,me]].flatMap(([r,n,...a])=>a.flatMap(s=>Hw(s,r,n,o)))],"getRules"),AH=d4});var Mv,Uv,GH=i(()=>{M();Mv=class extends x{};t(Mv,"Pillaged");Uv=Mv});var g4,MH,UH=i(()=>{ee();xi();GH();U();b();g4=t((o=Je,e=P)=>[new Uv(new l((r,n)=>o.getByTile(r).includes(n)),new p((r,n)=>o.unregister(n))),new Uv(new p(r=>r.clearYieldCache(null))),new Uv(new p((r,n)=>{e.emit("tile-improvement:pillaged",r,n)}))],"getRules"),MH=g4});var yI,dI,gI,h4,x4,O4,R4,DH,EH=i(()=>{HP();ee();Xp();En();b();JP();yI=new Map,dI=new Map,gI=new Map,h4=t((o,e=null)=>(dI.has(o)||dI.set(o,o.score(e,[[X,8],[$,3],[oe,1]])),dI.get(o)),"tileScore"),x4=t((o,e=null)=>(gI.has(o)||gI.set(o,o.getSurroundingArea().entries().reduce((r,n)=>r+h4(n,e),0)),gI.get(o)),"areaScore"),O4=t((o,e=P)=>{if(!yI.has(o)){e.emit("world:generate-start-tiles");let r=o.entries().filter(n=>[Oe,pe,me].some(a=>n.terrain()instanceof a)).map(n=>({tile:n,score:x4(n)})).sort(({score:n},{score:a})=>a-n).map(({tile:n})=>n);yI.set(o,r),e.emit("world:start-tiles",r)}return yI.get(o)},"pickStartTiles"),R4=t((o=UR,e=P,r=()=>Math.random())=>[new jR(new p((n,a,s)=>{if(e.option("earth",!1))try{return o.getStartTileByCivilizationAndWorld(a.civilization().sourceClass(),n)}catch{s.push(...o.entries().map(u=>u.startTileForMap(n)))}let m=O4(n,e);return m.forEach(f=>{s.some(u=>u.distanceFrom(f)<=4)&&m.splice(m.indexOf(f),1)}),m[Math.floor(m.length*r())]}))],"getRules"),DH=R4});var Dv,ru,Ev=i(()=>{wR();Pn();Dv=class extends st{constructor(){super(IR)}};t(Dv,"GeneratorRegistry");ru=new Dv});var kv,Sv,hI=i(()=>{M();kv=class extends x{};t(kv,"PickGenerator");Sv=kv});var Fv,Nv,xI=i(()=>{M();Fv=class extends x{};t(Fv,"Start");Nv=Fv});var Wv,Yv,OI=i(()=>{J();Wv=class extends fe{#e=[];constructor(e){super(),e.forEach(r=>this.#e.push(r))}hasTile(e){return this.#e.includes(e)}tiles(){return this.#e}};t(Wv,"LandMass");Yv=Wv});var Lv,kH,SH=i(()=>{he();OI();Lv=class extends F{constructor(){super(Yv)}getByTile(e){let[r]=this.entries().filter(n=>n.hasTile(e));return r??null}};t(Lv,"LandMassRegistry");kH=new Lv});var zv,FH,NH=i(()=>{J();SH();A();FR();he();qi();OI();zv=class extends k{#e;#t;#r;#o;#i=new Bm(xe);#n;constructor(e,r=c,n=kH){super(),this.#e=e,this.#t=e.height(),this.#r=n,this.#n=e.width(),this.#o=r,this.addKey("height","tiles","width")}async build(){let e=await this.#e.generate(),r=[];for(e.forEach((n,a)=>{let s=new xe(a%this.#n,Math.floor(a/this.#n),n,this,this.#o);this.#i.register(s),s.isLand()&&r.push(s)});r.length;){let n=r.slice(0,1),a=[];for(;n.length;){let s=n.shift();!r.includes(s)||(r.splice(r.indexOf(s),1),a.push(s),s.getNeighbours().forEach(m=>{!r.includes(m)||!m.isLand()||n.push(m)}))}this.#r.register(new Yv(a))}return this.#o.process(fl,this),this}entries(){return this.#i.entries()}filter(e){return this.entries().filter(e)}forEach(e){return this.#i.forEach(e)}get(e,r){return this.entries()[this.#e.coordsToIndex(e,r)]}height(){return this.#t}includes(e){return this.#i.includes(e)}landMasses(){return this.#r.entries()}map(e){return this.#i.map(e)}register(...e){this.#i.register(...e)}tiles(){return this.entries()}width(){return this.#n}};t(zv,"World");FH=zv});var v4,WH,YH=i(()=>{Ev();A();ee();b();hI();xI();NH();v4=t((o=c,e=ru,r=P)=>[new Nv(new p(()=>{let[n]=o.process(Sv),a=new n(parseInt(r.option("height",100),10),parseInt(r.option("width",160),10),{landCoverage:parseFloat(r.option("landCoverage",.4)),landSize:parseFloat(r.option("landSize",.2)),maxIterations:parseInt(r.option("maxIterations",20),10)});new FH(a,o).build()}))],"getRules"),WH=v4});var b4,LH,zH=i(()=>{qu();En();Xp();js();ZC();ns();_a();xi();U();b();fb();b4=t((o=Je,e=Yt,r=Ht)=>[...[[X,$e,1],[X,Oe,2],[X,Ee,1],[X,rt,1],[X,lt,1],[X,pe,1],[X,me,2],[X,ot,1],[X,gt,1],[$,Ie,1],[$,$e,2],[$,ze,1],[$,pe,1]].map(([n,a,s])=>new Ki(new l(m=>m.terrain()instanceof a),new p(()=>new n(s,a.name)))),...[[$,Ri,2],[X,vi,1],[X,io,1],[oe,bi,2],[oe,Ci,3],[$,ko,1],[X,no,2],[$,Ti,3],[X,Pi,2],[$,hi,1]].map(([n,a,s])=>new Ki(new l(m=>e.getByTerrain(m.terrain()).some(f=>f instanceof a)),new p(()=>new n(s,a.name)))),...[[$,Ri,1],[X,vi,1],[X,io,1],[oe,bi,2],[oe,Ci,2],[$,ko,1],[X,no,1],[$,Ti,1],[X,Pi,1]].map(([n,a,s])=>new Ki(new l((m,f)=>{if(!f)return!1;try{return r.getByPlayer(f).is(It,pt,ft,Ot)}catch{return!1}}),new l(m=>e.getByTerrain(m.terrain()).some(f=>f instanceof a)),new p(()=>new n(s,a.name)))),new Ki(new l(n=>n.terrain()instanceof lt),new p(()=>new oe(2,lt.name))),new Ki(new l(n=>n.terrain()instanceof me),new p(()=>new oe(1))),new Ki(new l((n,a)=>{if(!a)return!1;try{return r.getByPlayer(a).is(pt,Ot)}catch{return!1}}),new l(n=>n.terrain()instanceof me||n.terrain()instanceof lt),new p(()=>new oe(1,lt.name))),...[[Ie,X,Ue,1],[Ie,$,et,1],[Ee,X,Ue,1],[Ee,$,et,2],[ze,$,et,1],[pe,X,Ue,1]].map(([n,a,s,m])=>new Ki(new l(f=>f.terrain()instanceof n),new l(f=>o.getByTile(f).some(u=>u instanceof s)),new p(()=>new a(m,s.name)))),...[[Ie,$,et,1],[Oe,X,Ue,1],[Ee,$,et,1],[ze,$,et,1],[me,X,Ue,1]].map(([n,a,s,m])=>new Ki(new l((f,u)=>{if(!u)return!1;try{return r.getByPlayer(u).is(It,pt,ft,Ot)}catch{return!1}}),new l(f=>f.terrain()instanceof n),new l(f=>o.getByTile(f).some(u=>u instanceof s)),new p(()=>new a(m,s.name)))),...[Ie,Oe,pe].map(n=>new Ki(new l(a=>a.terrain()instanceof n),new l(a=>o.getByTile(a).some(s=>s instanceof Ye)),new p(()=>new oe(1,Ye.name)))),...[Ie,Oe,pe].map(n=>new Ki(new l((a,s)=>{if(!s)return!1;try{return r.getByPlayer(s).is(pt,Ot)}catch{return!1}}),new l(a=>a.terrain()instanceof n),new l(a=>o.getByTile(a).some(s=>s instanceof Ye)),new p(()=>new oe(1,Ye.name))))],"getRules"),LH=b4});var C4,jH,HH=i(()=>{Xp();xi();U();b();em();js();pb();C4=t((o=Je)=>[...[[X,.5],[$,.5],[oe,.5]].map(([e,r])=>new Oy(new Xs,new l((n,a,s)=>s.some(m=>m instanceof e)),new l(n=>o.getByTile(n).some(a=>a instanceof Xt)),new p((n,a,s)=>{let m=s.filter(f=>f instanceof e).reduce((f,u)=>f+u.value(),0);s.push(new e(Math.floor(m*r),Xt.name))})))],"getRules"),jH=C4});var T4,_H,KH=i(()=>{ee();Ev();BR();b();hI();T4=t((o=ru,e=P,r=()=>Math.random())=>[new Sv(new p(()=>{if(e.option("earth",!1))return Hf;let n=o.entries();if(n.length===0)throw new TypeError("No available `World` generators.");return n[Math.floor(n.length*r())]}))],"getRules"),_H=T4});var P4={};var qH=i(()=>{OH();vH();CH();PH();wH();BH();A();UH();EH();YH();zH();HH();KH();c.register(...xH(),...RH(),...bH(),...TH(),...IH(),...AH(),...MH(),...DH(),...WH(),...LH(),...jH(),..._H())});var jv,Hv,RI=i(()=>{Pn();fp();jv=class extends st{constructor(){super(Ps)}};t(jv,"TerrainRegistry");Hv=new jv});var I4={};var VH=i(()=>{En();RI();Hv.register(Et,Ie,$e,Oe,Ee,rt,ze,lt,pe,me,ot,gt)});var w4={};var JH=i(()=>{qu();fI();Av.register(Ri,vi,io,bi,Ci,ko,no,Ti,Pi,hi)});var ZH=I($H=>{"use strict";Object.defineProperty($H,"__esModule",{value:!0});qH();VH();JH()});var A4,QH,XH=i(()=>{mt();Nt();Do();qi();A4=t((o=Z)=>[new re(q,"cities",e=>o.getByPlayer(e)),new re(xe,"city",e=>o.getByTile(e))],"getAdditionalData"),QH=A4});var B4,e_,t_=i(()=>{fi();Nt();qi();B4=t((o=Se)=>[new re(xe,"workedBy",e=>o.getByTile(e)?.city()??null)],"getAdditionalData"),e_=B4});var G4={};var r_=i(()=>{XH();Qt();t_();le.register(...QH(),...e_())});var i_=I(o_=>{"use strict";Object.defineProperty(o_,"__esModule",{value:!0});r_()});var M4,n_,a_=i(()=>{is();Nt();Is();M4=t((o=zt)=>[new re(it,"build",e=>o.getByCity(e))],"getAdditionalData"),n_=M4});var U4={};var s_=i(()=>{a_();Qt();le.register(...n_())});var l_=I(m_=>{"use strict";Object.defineProperty(m_,"__esModule",{value:!0});s_()});var D4,p_,f_=i(()=>{er();Nt();Is();D4=t((o=ie)=>[new re(it,"growth",e=>o.getByCity(e))],"getAdditionalData"),p_=D4});var E4={};var u_=i(()=>{Qt();f_();le.register(...p_())});var y_=I(c_=>{"use strict";Object.defineProperty(c_,"__esModule",{value:!0});u_()});var k4,d_,g_=i(()=>{A();Nt();YO();Is();Gf();k4=t((o=c)=>[new re(it,"civilDisorder",e=>o.process(Vs,e,e.yields()).some(r=>r)),new re(it,"celebrateLeader",e=>o.process(Uf,e,e.yields()).some(r=>r))],"getAdditionalData"),d_=k4});var S4={};var h_=i(()=>{g_();Qt();le.register(...d_())});var O_=I(x_=>{"use strict";Object.defineProperty(x_,"__esModule",{value:!0});h_()});var F4,R_,v_=i(()=>{Bo();Nt();Is();F4=t((o=ke)=>[new re(it,"improvements",e=>o.getByCity(e))],"getAdditionalData"),R_=F4});var N4={};var b_=i(()=>{Qt();v_();le.register(...R_())});var T_=I(C_=>{"use strict";Object.defineProperty(C_,"__esModule",{value:!0});b_()});var W4,P_,I_=i(()=>{ml();Nt();qi();W4=t((o=Ii)=>[new re(xe,"goodyHut",e=>o.getByTile(e))],"getAdditionalData"),P_=W4});var Y4={};var w_=i(()=>{Qt();I_();le.register(...P_())});var B_=I(A_=>{"use strict";Object.defineProperty(A_,"__esModule",{value:!0});w_()});var L4,G_,M_=i(()=>{ns();Nt();Do();L4=t((o=Ht)=>[new re(q,"government",e=>o.getByPlayer(e))],"getAdditionalData"),G_=L4});var z4={};var U_=i(()=>{M_();Qt();le.register(...G_())});var E_=I(D_=>{"use strict";Object.defineProperty(D_,"__esModule",{value:!0});U_()});var j4,k_,S_=i(()=>{Oi();Nt();Do();j4=t((o=se)=>[new re(q,"world",e=>o.getByPlayer(e))],"getAdditionalData"),k_=j4});var H4={};var F_=i(()=>{Qt();S_();le.register(...k_())});var W_=I(N_=>{"use strict";Object.defineProperty(N_,"__esModule",{value:!0});F_()});var _4,Y_,L_=i(()=>{_e();Nt();Do();_4=t((o=H)=>[new re(q,"research",e=>o.getByPlayer(e))],"getAdditionalData"),Y_=_4});var K4={};var z_=i(()=>{Qt();L_();le.register(...Y_())});var H_=I(j_=>{"use strict";Object.defineProperty(j_,"__esModule",{value:!0});z_()});var q4,__,K_=i(()=>{np();Nt();Do();q4=t((o=Ra)=>[new re(q,"spaceship",e=>o.getActiveByPlayer(e))],"getAdditionalData"),__=q4});var V4={};var q_=i(()=>{Qt();K_();le.register(...__())});var J_=I(V_=>{"use strict";Object.defineProperty(V_,"__esModule",{value:!0});q_()});var J4,$_,Z_=i(()=>{_a();Nt();fp();J4=t((o=Yt)=>[new re(Ps,"features",e=>o.getByTerrain(e))],"getAdditionalData"),$_=J4});var $4={};var Q_=i(()=>{Qt();Z_();le.register(...$_())});var eK=I(X_=>{"use strict";Object.defineProperty(X_,"__esModule",{value:!0});Q_()});var Z4,tK,rK=i(()=>{xi();Nt();qi();Z4=t((o=Je)=>[new re(xe,"improvements",e=>o.getByTile(e))],"getAdditionalData"),tK=Z4});var Q4={};var oK=i(()=>{Qt();rK();le.register(...tK())});var nK=I(iK=>{"use strict";Object.defineProperty(iK,"__esModule",{value:!0});oK()});var X4,aK,sK=i(()=>{Kc();Nt();Do();X4=t((o=gl)=>[new re(q,"rates",e=>o.getByPlayer(e))],"getAdditionalData"),aK=X4});var eJ={};var mK=i(()=>{Qt();sK();le.register(...aK())});var pK=I(lK=>{"use strict";Object.defineProperty(lK,"__esModule",{value:!0});mK()});var tJ,fK,uK=i(()=>{A();Nt();Nu();Wu();tJ=t((o=c)=>[new re(tl,"spendCost",e=>o.process(Mn,e))],"getAdditionalData"),fK=tJ});var rJ,cK,yK=i(()=>{Fl();Nt();Do();rJ=t((o=tn)=>[new re(q,"treasuries",e=>o.getByPlayer(e))],"getAdditionalData"),cK=rJ});var oJ={};var dK=i(()=>{Qt();uK();yK();le.register(...fK(),...cK())});var hK=I(gK=>{"use strict";Object.defineProperty(gK,"__esModule",{value:!0});dK()});var _v,xK,OK=i(()=>{M();_v=class extends x{};t(_v,"End");xK=_v});var iJ,RK,vK=i(()=>{ee();A();Mt();OK();xI();oI();iJ=t((o=c,e=P,r=te)=>[["engine:start",()=>{o.process(Nv)}],...["game:start","turn:end"].map(n=>[n,()=>{e.emit("turn:start",r.increment())}]),["turn:end",()=>{o.process(xK,r)}],["turn:start",()=>{o.process(lv,r)}]],"getEvents"),RK=iJ});var nJ={};var bK=i(()=>{ee();vK();[...RK()].forEach(([o,e])=>{P.on(o,e)})});var TK=I(CK=>{"use strict";Object.defineProperty(CK,"__esModule",{value:!0});bK()});var aJ,PK,IK=i(()=>{He();Nt();Is();Do();qi();aJ=t((o=L)=>[new re(it,"units",e=>o.getByCity(e)),new re(q,"units",e=>o.getByPlayer(e,!0)),new re(xe,"units",e=>o.getByTile(e))],"getAdditionalData"),PK=aJ});var sJ={};var wK=i(()=>{Qt();IK();le.register(...PK())});var BK=I(AK=>{"use strict";Object.defineProperty(AK,"__esModule",{value:!0});wK()});var mJ,GK,MK=i(()=>{gm();Nt();ks();mJ=t((o=oo)=>[new re(Fe,"improvements",e=>o.getByUnit(e))],"getAdditionalData"),GK=mJ});var lJ={};var UK=i(()=>{Qt();MK();le.register(...GK())});var EK=I(DK=>{"use strict";Object.defineProperty(DK,"__esModule",{value:!0});UK()});var Kv,kK,SK=i(()=>{Pn();oy();Kv=class extends st{constructor(){super(xl)}};t(Kv,"AIClientRegistry");kK=new Kv});var pJ={};var FK=i(()=>{SK();sf();kK.register(qs)});var fJ,NK,WK=i(()=>{rs();He();vl();U();b();sf();fJ=t((o=L,e=Lt)=>[new eo(new l((r,n)=>e.getByPlayer(n)instanceof qs),new p((r,n,a)=>e.getByPlayer(n).cityLost(r,a,!1)))],"getRules"),NK=fJ});var uJ,YK,LK=i(()=>{rs();He();U();bl();b();sf();uJ=t((o=L,e=Lt)=>[new Uo(new l(r=>e.getByPlayer(r.player())instanceof qs),new p((r,n)=>e.getByPlayer(r.player()).cityLost(r,n,!0)))],"getRules"),YK=uJ});var cJ,zK,jK=i(()=>{rs();He();U();cu();b();sf();cJ=t((o=L,e=Lt)=>[new Na(new l(r=>e.getByPlayer(r.player())instanceof qs),new p((r,n)=>e.getByPlayer(r.player()).unitDestroyed(r,n&&n.player())))],"getRules"),zK=cJ});var yJ={};var HK=i(()=>{A();WK();LK();jK();c.register(...NK(),...zK(),...YK())});var KK=I(_K=>{"use strict";Object.defineProperty(_K,"__esModule",{value:!0});FK();HK()});var qv,qK,VK=i(()=>{uI();wR();Xr();A();RI();cI();jP();qv=class extends jf{#e;#t;#r;#o;#i;#n;#a;#m;#s;#l;constructor(e=100,r=160,n={},a=c,s=Hv,m=()=>Math.random()){super(e,r);let{landCoverage:f=.4,landSize:u=.2,maxIterations:y=10,clusterChance:O=.05,coverage:B=.25,pathChance:N=.05}=n;this.#e=f,this.#t=u,this.#r=y,this.#o=O,this.#i=B,this.#n=N,this.#s=a,this.#l=s,this.#m=m,this.#a=new Array(this.height()*this.width()).fill(0).map(()=>new Qr)}async generateIslands(){let e=this.height(),r=this.width(),n=this.#t+this.#m()*.2,a=this.#e,s=this.#r,m=Math.ceil(e*r/100*n),f=new Array(e*r).fill(0);for(;f.length===0||f.filter(u=>u===1).length/f.length<a;){let u={},y=[],O=[],B=Math.floor(e*r*Math.random()),N=t(W=>{W in u||(u[W]=0),u[W]++},"flagAsSeen");for(f[B]=1,y.push(B),N(B),O.push(...ip(e,r,B));O.length;){let W=O.shift();if((u[W]||0)<=s&&(Math.random()>.3?(f[W]=1,y.push(W),ip(e,r,W).filter(_=>O.indexOf(_)===-1).forEach(_=>O.push(_))):ip(e,r,W).forEach(_=>{let d=O.indexOf(_);d>-1&&O.splice(d,1)}),N(W)),y.length>m||f.filter(_=>_===1).length/f.length>=a)break}if(f.filter(W=>W===1).length/f.length>=a)break}this.#a=f.map(u=>u===1?new Q:new Qr)}generate(){return this.generateIslands().then(()=>this.populateTerrain().then(()=>this.#a))}getNeighbours(e,r=!0){return ip(this.height(),this.width(),e,r)}populateTerrain(){return new Promise(e=>{let r=this.#s.get(Ar);this.#s.get(Gv).filter(n=>n.validate()).map(n=>{let a=n.process();if(!a)throw new TypeError("Unexpected data from DistributionGroups.");return a}).forEach(n=>n.forEach(a=>r.filter(s=>s.validate(a,this.#a)).map(s=>{let m=s.process(a,this.#a);if(!m)throw new TypeError("Unexpected data from Distribution.");return m}).forEach(s=>s.forEach(({cluster:m=!1,clusterChance:f=this.#o,coverage:u=this.#i,fill:y=!1,from:O=0,path:B=!1,pathChance:N=this.#n,to:W=1})=>{let _=Object.keys(this.#a).map(g=>parseInt(g,10)).filter(g=>this.#a[g]instanceof a.__proto__).filter(g=>g>=O*this.height()*this.width()&&g<=W*this.height()*this.width());if(y){_.forEach(g=>{this.#a[g]=new a});return}let d=_.length*u;for(;d>0;){let g=_[Math.floor(this.#m()*_.length)];if(this.#a[g]=new a,d--,m){let h=this.getNeighbours(g).filter(G=>!(this.#a[G]instanceof a));for(;h.length&&d>0;){let G=h.shift();f>=this.#m()/this.distanceFrom(g,G)&&(this.#a[G]=new a,d--,h.push(...this.getNeighbours(G).filter(z=>!(this.#a[z]instanceof a)).filter(z=>this.#a[z]instanceof a.__proto__).filter(z=>!h.includes(z))))}}if(B){let h=g;for(;N>=this.#m();){let G=this.getNeighbours(h).filter(z=>this.#a[z]instanceof a.__proto__&&!(this.#a[z]instanceof a));h=G[Math.floor(this.#m()*G.length)],this.#a[h]=new a,d--}}}})))),e()})}};t(qv,"BaseGenerator");qK=qv});var dJ={};var JK=i(()=>{VK();Ev();ru.register(qK)});var ZK=I($K=>{"use strict";Object.defineProperty($K,"__esModule",{value:!0});JK()});var Vv,QK,XK=i(()=>{IC();Kb();A();vu();gi();bO();Vv=class extends Sp{#e=[];#t=[this.createNode(this.start())];#r;#o=[this.start()];constructor(e,r,n,a=c){super(e,r,n),this.#r=a}canMoveTo(e){return this.unit()instanceof ht?!0:this.unit()instanceof Ke?e.isLand():this.unit()instanceof Ne?e.isWater():!1}createNode(e,r=null,n=0){return{tile:e,parent:r,cost:n}}createPath(e){let r=[],n=0;for(;e.parent;)r.unshift(e.tile),n+=e.cost,e=e.parent;r.unshift(e.tile);let a=new ms(...r);return a.setMovementCost(n),a}generate(){for(;this.#t.length;){let r=this.#t.shift(),{tile:n}=r;n.getNeighbours().sort((a,s)=>a.distanceFrom(n)-s.distanceFrom(n)).forEach(a=>{if(this.canMoveTo(a)){let[s]=this.#r.process(we,this.unit(),new nt(n,a,this.unit(),this.#r)).sort((f,u)=>f-u),m=this.createNode(a,r,1);if(a===this.end()){this.#e.push(this.createPath(m)),this.#e[this.#e.length-1].length<this.start().distanceFrom(this.end())*1.1&&this.#t.splice(0,this.#t.length);return}!this.#t.some(f=>f.tile===a)&&!this.#o.includes(a)&&(this.#t.push(m),this.#o.push(a))}})}let[e]=this.#e.sort((r,n)=>r.movementCost()-n.movementCost());return e}};t(Vv,"BasePathFinder");QK=Vv});var gJ={};var eq=i(()=>{XK();Fp();Ns.register(QK)});var rq=I(tq=>{"use strict";Object.defineProperty(tq,"__esModule",{value:!0});eq()});var hJ={};var vbt,bbt,Cbt,Tbt,Pbt,Ibt,wbt,Abt,Bbt,Gbt,Mbt,Ubt,Dbt,Ebt,kbt,Sbt,Fbt,Nbt,Wbt,Ybt,Lbt,zbt,jbt,Hbt,_bt,Kbt,qbt,Vbt,Jbt,$bt,Zbt,Qbt,Xbt,eCt,tCt,rCt,oCt,iCt,nCt,aCt,sCt,mCt,lCt,pCt,fCt,uCt,cCt,yCt,dCt,gCt,hCt,xCt,OCt,RCt,vCt,bCt,CCt,TCt,PCt,ICt,wCt,ACt,BCt,GCt,MCt,UCt,DCt,ECt,kCt,SCt,FCt,NCt,WCt,YCt,LCt,zCt,jCt,HCt,_Ct,KCt,qCt,VCt,JCt,$Ct,ZCt,QCt,XCt,eTt,tTt,rTt,oTt,iTt,nTt,aTt,sTt,mTt,lTt,pTt,fTt,uTt,cTt,yTt,dTt,gTt,hTt,xTt,OTt,RTt,vTt,bTt,CTt,TTt,PTt,ITt,wTt,ATt,BTt,GTt,MTt,UTt,oq=i(()=>{"use strict";vbt=w(hD()),bbt=w(vD()),Cbt=w(PD()),Tbt=w(BD()),Pbt=w(DD()),Ibt=w(FD()),wbt=w(LD()),Abt=w(_D()),Bbt=w(JD()),Gbt=w(XD()),Mbt=w(oE()),Ubt=w(sE()),Dbt=w(fE()),Ebt=w(dE()),kbt=w(xE()),Sbt=w(vE()),Fbt=w(TE()),Nbt=w(wE()),Wbt=w(GE()),Ybt=w(DE()),Lbt=w(SE()),zbt=w(WE()),jbt=w(zE()),Hbt=w(_E()),_bt=w(VE()),Kbt=w(ZE()),qbt=w(ek()),Vbt=w(ok()),Jbt=w(ak()),$bt=w(lk()),Zbt=w(uk()),Qbt=w(dk()),Xbt=w(xk()),eCt=w(vk()),tCt=w(Tk()),rCt=w(wk()),oCt=w(Gk()),iCt=w(Dk()),nCt=w(Sk()),aCt=w(Wk()),sCt=w(zk()),mCt=w(_k()),lCt=w(Vk()),pCt=w(Zk()),fCt=w(eS()),uCt=w(oS()),cCt=w(aS()),yCt=w(lS()),dCt=w(uS()),gCt=w(dS()),hCt=w(xS()),xCt=w(vS()),OCt=w(TS()),RCt=w(wS()),vCt=w(GS()),bCt=w(DS()),CCt=w(SS()),TCt=w(WS()),PCt=w(zS()),ICt=w(_S()),wCt=w(VS()),ACt=w(ZS()),BCt=w(eF()),GCt=w(oF()),MCt=w(aF()),UCt=w(lF()),DCt=w(uF()),ECt=w(dF()),kCt=w(xF()),SCt=w(vF()),FCt=w(TF()),NCt=w(wF()),WCt=w(GF()),YCt=w(DF()),LCt=w(SF()),zCt=w(WF()),jCt=w(zF()),HCt=w(_F()),_Ct=w(VF()),KCt=w(ZF()),qCt=w(e0()),VCt=w(n0()),JCt=w(K0()),$Ct=w(pN()),ZCt=w(EN()),QCt=w(rW()),XCt=w(lW()),eTt=w(wW()),tTt=w(SW()),rTt=w(LW()),oTt=w(lY()),iTt=w(vY()),nTt=w(oL()),aTt=w(TL()),sTt=w(mz()),mTt=w(Tz()),lTt=w(Wz()),pTt=w(Pj()),fTt=w(hH()),uTt=w(ZH()),cTt=w(i_()),yTt=w(l_()),dTt=w(y_()),gTt=w(O_()),hTt=w(T_()),xTt=w(B_()),OTt=w(E_()),RTt=w(W_()),vTt=w(H_()),bTt=w(J_()),CTt=w(eK()),TTt=w(nK()),PTt=w(pK()),ITt=w(hK()),wTt=w(TK()),ATt=w(BK()),BTt=w(EK()),GTt=w(KK()),MTt=w(ZK()),UTt=w(rq())});tb();rb();sp();ty();oy();ob();Zr();ab();Is();zy();Ve();Mr();xb();J();var Ym,$y=class{constructor(){ne(this,Ym,[])}add(e,r,n=null){T(this,Ym).push({[e]:{type:"add",index:n,value:r}})}clear(){T(this,Ym).splice(0)}remove(e,r=null){T(this,Ym).push({[e]:{type:"remove",index:r}})}transferData(){return T(this,Ym).slice(0).map(e=>{let r={};return Object.entries(e).forEach(([n,{type:a,index:s,value:m}])=>{r[n]={type:a,index:s,value:typeof m=="function"?m():m}}),r})}update(e,r,n=null){T(this,Ym).push({[e]:{type:"update",index:n,value:r}})}};t($y,"DataQueue"),Ym=new WeakMap;var YI=$y;Qy();Ob();lm();lu();Tb();hl();Ml();rC();J();var bu,Cu,wg=class extends fe{constructor(r,n){super();ne(this,bu,void 0);ne(this,Cu,void 0);ce(this,bu,n),ce(this,Cu,r),this.addKey("data","key")}data(){return T(this,bu)}key(){return T(this,Cu)}};t(wg,"Notification"),bu=new WeakMap,Cu=new WeakMap;var Ut=wg;es();Do();iC();Fg();var Ng=class extends Error{constructor(e,r,n){super(e)}};t(Ng,"RetryFailed");var FA=Ng;var Tu,Pu,Yp,Iu,Lp,wu,Au,Wg=class{constructor(e,r=5,n=100){ne(this,Tu,0);ne(this,Pu,void 0);ne(this,Yp,void 0);ne(this,Iu,void 0);ne(this,Lp,void 0);ne(this,wu,void 0);ne(this,Au,void 0);ce(this,Yp,e),ce(this,Iu,r),ce(this,Lp,setInterval(()=>this.run(),n)),ce(this,Pu,new Promise((a,s)=>{ce(this,Au,a),ce(this,wu,s)}))}run(){if(++CI(this,Tu)._>T(this,Iu)){clearInterval(T(this,Lp)),T(this,wu).call(this,new FA("Retry failed.",T(this,Yp),T(this,Tu)));return}T(this,Yp).call(this)&&(clearInterval(T(this,Lp)),T(this,Au).call(this))}then(){return T(this,Pu)}};t(Wg,"Retryable"),Tu=new WeakMap,Pu=new WeakMap,Yp=new WeakMap,Iu=new WeakMap,Lp=new WeakMap,wu=new WeakMap,Au=new WeakMap;var NA=Wg;Dl();sC();J();var Bu,Gu,Mu,Lg=class extends fe{constructor(r,n,a){super();ne(this,Bu,void 0);ne(this,Gu,void 0);ne(this,Mu,void 0);ce(this,Bu,r),ce(this,Gu,n),ce(this,Mu,a),this.addKey("player","turn","year")}player(){return T(this,Bu)}turn(){return T(this,Gu)}year(){return T(this,Mu)}};t(Lg,"TransferObject"),Bu=new WeakMap,Gu=new WeakMap,Mu=new WeakMap;var LA=Lg;qi();var zg=class extends Error{};t(zg,"Timeout");var zA=zg;ks();J();er();var zp,jp,Hp,Uu,mC=class extends fe{constructor(r,n,a,s){super();ne(this,zp,void 0);ne(this,jp,void 0);ne(this,Hp,{size:0});ne(this,Uu,void 0);ce(this,zp,r),ce(this,jp,a),T(this,Hp).size=s,ce(this,Uu,n),this.addKey("_","growth","name","player","tile")}static fromCity(r){let n=ie.getByCity(r);return new mC(r.name(),r.tile(),r.player(),n.size())}_(){return"City"}name(){return T(this,zp)}player(){return T(this,jp)}growth(){return T(this,Hp)}tile(){return T(this,Uu)}update(r){let n=ie.getByCity(r);ce(this,zp,r.name()),ce(this,jp,r.player()),T(this,Hp).size=n.size()}},Hg=mC;t(Hg,"City"),zp=new WeakMap,jp=new WeakMap,Hp=new WeakMap,Uu=new WeakMap;var jA=Hg;J();var Du,lC=class extends fe{constructor(r){super();ne(this,Du,void 0);ce(this,Du,r),this.addKey("_","civilization")}static fromPlayer(r){return new lC(r.civilization())}_(){return"Player"}civilization(){return T(this,Du)}},_g=lC;t(_g,"Player"),Du=new WeakMap;var HA=_g;J();var Eu,ku,Su,pC=class extends fe{constructor(r,n,a){super();ne(this,Eu,void 0);ne(this,ku,void 0);ne(this,Su,void 0);ce(this,Eu,r),ce(this,ku,n),ce(this,Su,a),this.addKey("_","tile","player")}static fromUnit(r){return new pC(r.constructor.name,r.tile(),r.player())}_(){return T(this,Eu)}player(){return T(this,Su)}tile(){return T(this,ku)}},Kg=pC;t(Kg,"Unit"),Eu=new WeakMap,ku=new WeakMap,Su=new WeakMap;var _A=Kg;Le();D();mt();rs();Kp();ee();vm();Qm();_e();Fl();Oi();A();Mt();He();Yu();ol();var hq=t((o,e)=>new Promise((r,n)=>setTimeout(()=>e===void 0?r():n(e),o)),"awaitTimeout"),iB=t(o=>o instanceof fe?{"#ref":o.id()}:o,"referenceObject"),Ze=t((...o)=>e=>o.some(r=>e instanceof r)?iB(e):e,"filterToReference"),oB=t((...o)=>e=>o.some(r=>e instanceof r)?e:iB(e),"filterToReferenceAllExcept"),xq=15,vC=new Map,bC=new Map,ju=new Map,Pe,ue,Wl,Gh,Mh,Hu,Dn,Bh=class extends Dm{constructor(r,n,a,s){super(r);ne(this,Pe,t((r=n=>n)=>n=>n instanceof q&&n!==this.player()?(vC.has(n)||vC.set(n,HA.fromPlayer(n)),vC.get(n)):n instanceof Fe&&n.player()!==this.player()?(bC.has(n)||bC.set(n,_A.fromUnit(n)),bC.get(n)):n instanceof it&&n.player()!==this.player()?(ju.has(n)||ju.set(n,jA.fromCity(n)),ju.get(n)):n instanceof xe?se.getByPlayer(this.player()).get(n.x(),n.y()):n instanceof Ge?{_:n.constructor.name}:r(n),"#dataFilter"));ne(this,ue,new YI);ne(this,Wl,void 0);ne(this,Gh,void 0);ne(this,Mh,void 0);ne(this,Hu,!1);ne(this,Dn,void 0);ce(this,Wl,new ed),ce(this,Dn,n),ce(this,Mh,a),ce(this,Gh,s),T(this,Dn).receive("action",(...m)=>T(this,Wl).emit("action",...m)),T(this,Dn).receive("cheat",({name:m,value:f})=>{if(m==="RevealMap"){let u=se.getByPlayer(this.player()),[y]=u.entries();y.tile().map().entries().forEach(O=>{if(u.includes(O))return;u.register(O);let B=u.getByTile(O);T(this,ue).add(u.id(),()=>O.toPlainObject(T(this,Pe).call(this)),`entries[${u.entries().indexOf(B)}]`)})}if(m==="GrantAdvance"){let[u]=v.filter(O=>O.name===f),y=H.getByPlayer(this.player());if(!u||y.completed(u))return;y.addAdvance(u),T(this,ue).add(y.id(),y.toPlainObject(T(this,Pe).call(this,Ze(q))))}if(m==="GrantGold"){let u=tn.getByPlayerAndType(this.player(),je);u.add(f),T(this,ue).add(u.id(),u.toPlainObject(T(this,Pe).call(this,Ze(q))))}if(m==="ModifyUnit"){let{unitId:u,properties:y}=f,[O]=L.getBy("id",u);if(!O)return;["attack","defence","moves","movement","visibility"].forEach(B=>{B in y&&O[B]().set(y[B])}),T(this,ue).add(O.id(),O.toPlainObject(T(this,Pe).call(this,Ze(q))))}this.sendPatchData()}),P.on("engine:plugins:load:failed",(m,f)=>{console.log(m+" failed to load"),console.error(f)}),P.on("player:visibility-changed",(m,f)=>{if(f!==this.player())return;let u=se.getByPlayer(this.player()),y=u.getByTile(m);if(y===null){new NA(()=>{let O=u.getByTile(m);return O===null?!1:(T(this,ue).add(u.id(),()=>m.toPlainObject(T(this,Pe).call(this,Ze(q))),`tiles[${u.entries().indexOf(O)}]`),!0)},2,20);return}T(this,ue).add(u.id(),()=>y.toPlainObject(T(this,Pe).call(this,Ze(q))),`tiles[${u.entries().indexOf(y)}]`)}),["unit:created","unit:defeated"].forEach(m=>{P.on(m,f=>{let u=se.getByPlayer(this.player()),y=u.getByTile(f.tile());if(!!y&&(T(this,ue).update(y.id(),()=>y.toPlainObject(T(this,Pe).call(this,Ze(q)))),f.player()===this.player())){if(m==="unit:created"){let O=L.getByPlayer(this.player()),B=O.indexOf(f),N=L.getByCity(f.city()),W=N.indexOf(f),_=L.getByTile(f.tile()),d=_.indexOf(f);T(this,ue).add(r.id(),()=>f.toPlainObject(T(this,Pe).call(this,Ze(xe,q,Zm,it))),`units[${B}]`),T(this,ue).add(y.id(),()=>f.toPlainObject(T(this,Pe).call(this,Ze(Fe))),`units[${d}]`),f.city()!==null&&T(this,ue).add(f.city().id(),()=>f.toPlainObject(T(this,Pe).call(this,Ze(Fe))),`units[${W}]`);return}T(this,ue).update(this.player().id(),()=>this.player().toPlainObject(T(this,Pe).call(this,oB(q,Fe,ve))))}})}),["unit:destroyed"].forEach(m=>{P.on(m,(f,u)=>{f.player()===this.player()&&f.city()!==null&&T(this,ue).update(f.city().id(),()=>f.city().toPlainObject(T(this,Pe).call(this,Ze(bs,Tl,K,q,Zm,xe,Fe))))})}),["unit:moved"].forEach(m=>{P.on(m,(f,u)=>{let y=se.getByPlayer(this.player()),O=y.getByTile(u.from()),B=y.getByTile(u.to());!O&&!B||(O&&T(this,ue).update(O.id(),()=>O.toPlainObject(T(this,Pe).call(this,Ze(q,it)))),B&&T(this,ue).update(B.id(),()=>B.toPlainObject(T(this,Pe).call(this,Ze(q,it)))),f.player()===this.player()&&f.city()!==null&&T(this,ue).update(f.city().id(),()=>f.city().toPlainObject(T(this,Pe).call(this,Ze(bs,Tl,K,q,Zm,xe,Fe)))),this.sendPatchData())})}),["tile-improvement:built","tile-improvement:pillaged"].forEach(m=>{P.on(m,f=>{let u=se.getByPlayer(this.player()),y=u.getByTile(f);y&&T(this,ue).update(y.id(),()=>y.toPlainObject(T(this,Pe).call(this,Ze(q,it))))})}),P.on("city:captured",(m,f,u)=>{if(u===this.player()){Z.getByPlayer(this.player()).indexOf(m)!==-1&&T(this,ue).update(this.player().id(),()=>this.player().toPlainObject(T(this,Pe).call(this,oB(q,ve)))),this.sendNotification(new Ut("City.captured-from-us",{city:m,capturingPlayer:f,originalPlayer:u}));return}if(f===this.player()){this.sendNotification(new Ut("City.captured-by-us",{city:m,capturingPlayer:f,originalPlayer:u}));return}}),["city:created","city:captured","city:destroyed","city:grow","city:shrink"].forEach(m=>{P.on(m,f=>{let u=se.getByPlayer(this.player()),y=u.getByTile(f.tile());if(!!y){if(ju.has(f)){let O=ju.get(f);O.update(f),T(this,ue).update(O.id(),()=>O.toPlainObject(T(this,Pe).call(this,Ze(xe,Fe,q))))}T(this,ue).update(y.id(),()=>y.toPlainObject(T(this,Pe).call(this,Ze(q))))}})}),P.on("city:shrink",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.shrink",{city:m}))}),P.on("unit:unsupported",(m,f)=>{m.player()===this.player()&&this.sendNotification(new Ut("City.unit-unsupported",{city:m,unit:f}))}),P.on("city:unsupported-improvement",(m,f)=>{m.player()===this.player()&&this.sendNotification(new Ut("City.improvement-unsupported",{city:m,cityImprovement:f}))}),P.on("city:food-storage-exhausted",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.food-storage-exhausted",{city:m}))}),P.on("city:building-complete",(m,f)=>{let u=se.getByPlayer(this.player());if(m.city().player()!==this.player()&&f instanceof Ae){this.sendNotification(new Ut(u.getByTile(m.city().tile())?"Wonder.building-complete.other-player.known":"Wonder.building-complete.other-player.unknown",{cityBuild:m,build:f}));return}if(m.city().player()!==this.player())return;T(this,ue).update(m.id(),()=>m.toPlainObject(T(this,Pe).call(this,Ze(xe,Fe,q))));let y=f instanceof Fe?"unit":f instanceof Ae?"wonder":f instanceof K?"city-improvement":f instanceof Ct?"spaceship-part":"other";this.sendNotification(new Ut("City.building-complete."+y,{cityBuild:m,build:f}))}),P.on("player:research-complete",(m,f)=>{m.player()===this.player()&&(T(this,ue).update(m.id(),()=>m.toPlainObject(T(this,Pe).call(this,Ze(q)))),this.sendNotification(new Ut("Player.research-complete",{playerResearch:m,advance:f})))}),P.on("goody-hut:action-performed",(m,f)=>{let u=m.tile();!L.getByTile(u).some(O=>O.player()===this.player())||this.sendNotification(new Ut(`GoodyHut.action-performed.${f.constructor.name}`,{goodyHut:m,action:f}))}),P.on("player:defeated",(m,f)=>{if(m===this.player()){this.sendNotification(new Ut("Player.defeated.local",{defeatedPlayer:m,player:f})),Xi.unregister(...Xi.entries()),os.unregister(...os.entries()),T(this,Dn).send("restart",null);return}this.sendNotification(new Ut(f===null?"Player.defeated.unknown":"Player.defeated.by",{defeatedPlayer:m,player:f}))}),P.on("city:civil-disorder",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.civil-disorder",{city:m}))}),P.on("city:order-restored",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.order-restored",{city:m}))}),P.on("city:leader-celebration",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.leader-celebration",{city:m}))}),P.on("city:leader-celebration-ended",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.leader-celebration-ended",{city:m}))}),P.on("player:spaceship:part-built",m=>{this.player()!==m&&this.sendNotification(new Ut("Spaceship.part-built",{player:m}))}),P.on("player:spaceship:lost",m=>{this.player()===m&&this.sendNotification(new Ut("Player.spaceship-lost",{player:m}))}),P.on("player:spaceship:landed",m=>{this.player()===m&&this.sendNotification(new Ut("Player.spaceship-landed",{player:m}))}),P.on("player:declaration-expired",(m,f)=>{m===this.player()&&this.sendNotification(new Ut("Player.declaration-expired",{player:m,declaration:f,enemy:f.players().filter(u=>u!==m)[0]}))})}async chooseFromList(r){return new Promise(n=>{if(r.choices().length===1&&r.key()!=="negotiation.next-step"){let[a]=r.choices();n(a.value());return}T(this,Dn).send("chooseFromList",r),T(this,Dn).receiveOnce("chooseFromList",async a=>{let[s]=r.choices().filter(m=>m.id()===a);if(!s){console.warn(`No choice found for '${a}' against '${r.id()}', using super.`),n(await super.chooseFromList(r));return}n(s.value())})})}async handleAction(...r){let[n]=r,a=this.player(),s=a.actions(),m=s.filter(O=>O instanceof _i),{name:f,id:u}=n;if(f==="ReassignWorkers"){let[O]=Z.getBy("id",n.city);return O&&(Lu(O),T(this,ue).update(O.id(),O.toPlainObject(T(this,Pe).call(this,Ze(q,xe))))),!1}if(f==="EndTurn")return m.length===1&&m.every(O=>O instanceof Pl);if(!f)return console.log("action not specified: ",n),!1;let[y]=s.filter(O=>O.constructor.name===f&&u===(O.value()?O.value().id():void 0));if(!y)return console.log("action not specified"),!1;if(y instanceof Aa){let{unitAction:O,target:B}=n,N=y.value(),[W]=se.getByPlayer(this.player()).filter(h=>h.id()===B);if(!W)return console.log(`tile not found: ${B}`),!1;let _=N.actions(W.tile()),d=_.filter(h=>h.sourceClass().name===O);if(d.length===0)return console.log(`action not found: ${O}`),!1;let[g]=d;return g.perform(),g instanceof nt&&await this.canNegotiate(N),!1}if(y instanceof Ba){let O=y.value();return O.moves().value()>0&&T(this,ue).update(O.id(),O.toPlainObject(T(this,Pe).call(this,Ze(q,xe)))),O.activate(),!1}if(y instanceof bs||y instanceof Gm){let O=y.value(),{chosen:B}=n;if(!B)return console.warn("no build item specified"),!1;let[N]=O.available().filter(W=>W.item().name===B);return N?(O.build(N.item()),!1):(console.log(`build item not available: ${B}`),!1)}if(y instanceof kI){let O=y.value(),{chosen:B}=n;if(!B)return console.warn("no advance specified"),!1;let[N]=O.available().filter(W=>W.name===B);return N?(O.research(N),!1):(console.log(`build item not available: ${B}`),!1)}if(y instanceof Wm){let O=y.value(),[B]=tn.getBy("id",n.treasury);return B?(B.buy(O.city()),T(this,ue).update(B.id(),B.toPlainObject(T(this,Pe).call(this,Ze(q)))),!1):(console.warn(`No playerTreasury found for id: ${n.treasury}.`),!1)}if(y instanceof ts){let O=y.value(),{chosen:B}=n,[N]=O.available().filter(_=>_.name===B);if(!N)return console.error(`Government type: '${B}' not found.`),!1;O.set(new N);let W=se.getByPlayer(this.player());return T(this,ue).update(W.id(),W.toPlainObject(T(this,Pe).call(this,Ze(q)))),Z.getByPlayer(this.player()).forEach(_=>T(this,ue).update(_.id(),_.toPlainObject(T(this,Pe).call(this,Ze(q,xe,Fe))))),!1}if(y instanceof Em){let O=y.value(),{value:B}=n;return O.setAll(B.map(([N,W])=>{let[_]=O.all().filter(d=>d.constructor.name===N);return[_.constructor,W]})),Z.getByPlayer(this.player()).forEach(N=>T(this,ue).update(N.id(),N.toPlainObject(T(this,Pe).call(this,Ze(q,xe,Fe))))),!1}return y instanceof wl?(y.value().launch(),!1):(console.log(`unhandled action: ${JSON.stringify(n)}`),!1)}sendInitialData(){T(this,Dn).send("gameData",new LA(this.player(),te,Ws)),ce(this,Hu,!0)}sendPatchData(){T(this,Dn).send("gameDataPatch",T(this,ue).transferData()),T(this,ue).clear()}sendNotification(r){T(this,Dn).send("gameNotification",r)}takeTurn(){return new Promise((r,n)=>{T(this,Hu)||this.sendInitialData(),setTimeout(()=>{T(this,ue).update(te.id(),()=>te.toPlainObject()),T(this,ue).update(Ws.id(),()=>Ws.toPlainObject()),T(this,ue).add(this.player().id(),()=>this.player().toPlainObject(T(this,Pe).call(this,Ze(Ul,Zm,xe)))),this.sendPatchData()},1);let a=t(async(...s)=>{try{if(await this.handleAction(...s)){T(this,Wl).off("action",a),this.sendPatchData(),setTimeout(()=>r(),10);return}T(this,ue).update(this.player().id(),()=>this.player().toPlainObject(T(this,Pe).call(this,Ze(Ul,Zm,xe,it)))),this.sendPatchData()}catch(m){n(m)}},"listener");T(this,Wl).on("action",a)})}async canNegotiate(r){let n=Array.from(new Set(r.tile().getNeighbours().flatMap(a=>L.getByTile(a).map(s=>s.player()).filter(s=>s!==this.player()))));n.length!==0&&await n.filter(a=>Ur.getByPlayer(a).filter(s=>s instanceof Wp&&s.isBetween(a,this.player())).every(s=>te.value()-s.when()>xq)).reduce((a,s)=>a.then(()=>this.handleNegotiation(s)),Promise.resolve())}async handleNegotiation(r){let n=new Wp(r,this.player(),c);for(n.proceed(new vn(r,n,c));!n.terminated();){let a=n.lastInteraction();if(await(a!==null?a.for():n.players().slice(1)).reduce((m,f)=>m.then(async()=>{let u=Lt.getByPlayer(f),y=n.nextSteps(),B=await Promise.race([u.chooseFromList(new Mm(y,"negotiation.next-step",n)),u instanceof xl?hq(500,new zA(`Timeout waiting for ${u.player().id()} (${u.player().civilization().sourceClass().name}) - sent ${y.length} options`)):new Promise(()=>{})]);!B||(n.proceed(B),B instanceof Bn&&await B.proposal().resolve(B))}).catch(u=>console.error(u)),Promise.resolve()),n.terminated())break}return Ur.register(n),n}};t(Bh,"DataTransferClient"),Pe=new WeakMap,ue=new WeakMap,Wl=new WeakMap,Gh=new WeakMap,Mh=new WeakMap,Hu=new WeakMap,Dn=new WeakMap;var nB=Bh;Do();sf();rs();ee();Qm();var fr,Jv=class{constructor(e){ne(this,fr,void 0);ce(this,fr,e),e.receive("start",()=>{this.bindEvents(),this.start()}),e.receive("setOption",({name:r,value:n})=>{T(this,fr).send("notification",`setting ${r} to ${n}`),P.setOption(r,n)}),e.receive("getOptions",r=>e.send("getOptions",r.reduce((n,a)=>(n[a]=P.option(a),n),{}))),e.receive("setOptions",r=>{Object.entries(r).forEach(([n,a])=>P.setOption(n,a)),e.send("setOptions",null)})}bindEvents(){T(this,fr).send("notification","binding events"),P.on("engine:initialise",()=>T(this,fr).send("notification","initialising...")),P.on("engine:plugins:load:success",e=>T(this,fr).send("notification",`loaded plugin: ${e}`)),P.on("engine:plugins-loaded",()=>T(this,fr).send("notification","plugins loaded")),P.on("engine:start",()=>T(this,fr).send("notification","starting...")),P.on("world:generate-start-tiles",()=>T(this,fr).send("notification","generating start tiles...")),P.on("world:built",()=>T(this,fr).send("notification","world built")),P.on("game:start",()=>T(this,fr).send("notification","game start")),P.on("turn:start",e=>T(this,fr).send("notification",`turn start ${e}`)),P.on("player:turn-start",e=>T(this,fr).send("notification",`player turn-start: ${e.civilization().constructor.name}`))}start(){P.on("engine:start",()=>{new Array(parseInt(P.option("players"),10)).fill(0).forEach((e,r)=>{let n=new q,a=r===0?new nB(n,T(this,fr),(s,m)=>T(this,fr).send(s,m),(s,m)=>T(this,fr).receive(s,m)):new qs(n);Xi.register(n),Lt.register(a),T(this,fr).send("notification","generating world...")})}),P.start(),Promise.resolve().then(()=>(oq(),hJ)).then(()=>P.emit("plugins:load:end"))}};t(Jv,"Game"),fr=new WeakMap;var iq=Jv;var $v=class{async request(e){return new Promise(r=>{this.send(e.channel(),e.args()[0]),this.receiveOnce(e.channel(),n=>r(n))})}};t($v,"AbstractTransport");var nq=$v;J();var Zv=class extends nq{receive(e,r){addEventListener("message",({data:{channel:n,data:a}})=>{e===n&&r(a)})}receiveOnce(e,r){let n=t(({data:{channel:a,data:s}})=>{e===a&&(r(s),removeEventListener("message",n))},"fullHandler");addEventListener("message",n)}send(e,r){r instanceof fe&&(r=r.toPlainObject()),postMessage({channel:e,data:r})}};t(Zv,"ParentTransport");var aq=Zv;var KTt=new iq(new aq);})();
//# sourceMappingURL=backend.js.map
