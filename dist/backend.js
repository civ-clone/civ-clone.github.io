"use strict";(()=>{var rS=Object.create;var rp=Object.defineProperty;var iS=Object.getOwnPropertyDescriptor;var oS=Object.getOwnPropertyNames;var nS=Object.getPrototypeOf,aS=Object.prototype.hasOwnProperty;var t=(i,e)=>rp(i,"name",{value:e,configurable:!0});var n=(i,e)=>()=>(i&&(e=i(i=0)),e);var b=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),nu=(i,e)=>{for(var r in e)rp(i,r,{get:e[r],enumerable:!0})},FR=(i,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of oS(e))!aS.call(i,s)&&s!==r&&rp(i,s,{get:()=>e[s],enumerable:!(o=iS(e,s))||o.enumerable});return i};var C=(i,e,r)=>(r=i!=null?rS(nS(i)):{},FR(e||!i||!i.__esModule?rp(r,"default",{value:i,enumerable:!0}):r,i)),R=i=>FR(rp({},"__esModule",{value:!0}),i);var kR=(i,e,r)=>{if(!e.has(i))throw TypeError("Cannot "+r)};var v=(i,e,r)=>(kR(i,e,"read from private field"),r?r.call(i):e.get(i)),ge=(i,e,r)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,r)},Ee=(i,e,r,o)=>(kR(i,e,"write to private field"),o?o.call(i,r):e.set(i,r),r),SR=(i,e,r,o)=>({set _(s){Ee(i,e,s,r)},get _(){return v(i,e,o)}});var F,Al,he=n(()=>{F=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return this.#e.some(r=>e instanceof r)}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(o=>{let s=o[e];return s instanceof Function?s.bind(o)()===r:o[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let o=this.#t.indexOf(r);o>-1&&this.#t.splice(o,1)})}};t(F,"EntityRegistry");Al=F});var au,oe,Vt=n(()=>{au=class{#e;#t;#r;constructor(e,r,o){this.#e=r,this.#t=o,this.#r=e}data(...e){return this.#t(...e)}key(){return this.#e}type(){return this.#r}};t(au,"AdditionalData");oe=au});var su,ne,Et=n(()=>{he();Vt();su=class extends F{constructor(){super(oe)}getByType(e){return this.filter(r=>r.type()===e||Object.prototype.isPrototypeOf.call(r.type(),e)||Object.prototype.isPrototypeOf.call(r.type().prototype,e))}};t(su,"AdditionalDataRegistry");ne=new su});var lu,sS,ip,S,Ye,Z=n(()=>{Et();he();lu={},sS=t(i=>{let e=i.sourceClass().name,r=lu[e];return r||(lu[e]=0),r===Number.MAX_SAFE_INTEGER&&(lu[e]=BigInt(r)),e+"-"+(++lu[e]).toString(36)},"idProvider"),ip=t((i,e,r=s=>s,o=ne)=>{if(i=r(i),i instanceof Al&&(i=i.entries()),Array.isArray(i))return i.map(s=>ip(s,e,r,o));if(i instanceof S){let s=i.id();if(!(s in e)){let a={_:i.sourceClass().name};e[s]=a,i.keys().forEach(m=>{let u=i[m]instanceof Function?i[m]():i[m];a[m]=ip(u,e,r,o)}),o.getByType(i.sourceClass()).forEach(m=>{a[m.key()]=ip(m.data(i),e,r,o)})}return{"#ref":s}}return i instanceof Function?{_:i.name}:i&&i instanceof Object?Object.entries(i).reduce((s,[a,m])=>(s[a]=ip(m,e,r,o),s),{}):i},"toPlainObject"),S=class{#e;#t=["id"];constructor(){this.#e=sS(this)}addKey(...e){this.#t.push(...e)}id(){return this.#e}keys(){return this.#t}sourceClass(){return this.constructor}toPlainObject(e=o=>o,r=ne){let o={};return{hierarchy:ip(this,o,e,r),objects:o}}};t(S,"DataObject");Ye=S});var mu,Er,qa=n(()=>{Z();mu=class extends S{#e;#t;constructor(e,r){super(),this.#e=e,this.#t=r,this.addKey("value")}player(){return this.#e}value(){return this.#t}};t(mu,"PlayerAction");Er=mu});var pu,si,qs=n(()=>{qa();pu=class extends Er{};t(pu,"MandatoryPlayerAction");si=pu});var Va,YR=n(()=>{qs();Va=class extends si{};t(Va,"ActiveUnit")});var Ja,zR=n(()=>{qa();Ja=class extends Er{};t(Ja,"InactiveUnit")});var Rg=n(()=>{YR();zR()});var uu,x,M=n(()=>{Z();uu=class extends Ye{};t(uu,"Advance");x=uu});var He,Ho=n(()=>{He=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return typeof e=="function"&&this.#e.some(r=>Object.prototype.isPrototypeOf.call(r,e)||Object.prototype.isPrototypeOf.call(r.prototype,e))}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(o=>{let s=o[e];return s instanceof Function?s.bind(o)()===r:o[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let o=this.#t.indexOf(r);o>-1&&this.#t.splice(o,1)})}};t(He,"ConstructorRegistry")});var cu,O,G=n(()=>{M();Ho();cu=class extends He{constructor(){super(x)}};t(cu,"AdvanceRegistry");O=new cu});var Bl,l,w=n(()=>{Bl=class{#e=null;constructor(e){e&&(this.#e=e)}validate(...e){return this.#e===null?!0:this.#e(...e)}};t(Bl,"Criterion");l=Bl});var yu,fu,xg=n(()=>{w();yu=class extends l{#e=[];constructor(...e){super(),e.forEach(r=>{this.#e.push(r)})}criteria(){return this.#e}validate(...e){return this.#e.every(r=>r.validate(...e))}};t(yu,"Criteria");fu=yu});var du,$a,vg=n(()=>{xg();du=class extends fu{};t(du,"And");$a=du});var gu,p,T=n(()=>{gu=class{#e;constructor(e){this.#e=e}apply(...e){return this.#e(...e)}};t(gu,"Effect");p=gu});var hu,Fr,Za=n(()=>{hu=class{#e;constructor(e=2e3){this.#e=e}value(){return this.#e}};t(hu,"Priority");Fr=hu});var Jn,Qa,Gl=n(()=>{Za();Jn=class extends Fr{constructor(){super(1e3)}};t(Jn,"High");Qa=Jn});var tt,NR,bg=n(()=>{Za();tt=class extends Fr{constructor(){super(3e3)}};t(tt,"Low");NR=tt});var Ul,LR=n(()=>{Za();Ul=class extends Fr{constructor(){super(2e3)}};t(Ul,"Normal")});var $n=n(()=>{Gl();bg();LR()});var Ou,h,B=n(()=>{vg();w();T();$n();Ou=class{#e;#t=!0;#r;#i=new Ul;constructor(...e){let r=[];e.forEach(o=>{if(o instanceof p){if(this.#r)throw new TypeError("Rule: effect already specified, but another was provided.");this.#r=o;return}if(o instanceof l){r.push(o);return}this.#i=o}),r.length&&(this.#e=new $a(...r))}disable(){this.#t=!1}enable(){this.#t=!0}enabled(){return this.#t}priority(){return this.#i}process(...e){if(!!this.#t&&this.#r instanceof p)return this.#r.apply(...e)}validate(...e){return this.#t?this.#e instanceof l?this.#e.validate(...e):!0:!1}};t(Ou,"Rule");h=Ou});var Ru,d,I=n(()=>{he();B();Ru=class extends F{#e=new Map;constructor(){super(h)}entries(){return super.entries().sort((e,r)=>e.priority().value()-r.priority().value())}get(e){return this.#e.has(e)||this.#e.set(e,this.filter(r=>r.enabled()&&r instanceof e)),this.#e.get(e)||[]}invalidateCache(e){this.#e.delete(e instanceof h?e.constructor:e)}process(e,...r){return this.get(e).filter(o=>o.validate(...r)).map(o=>o.process(...r))}register(...e){super.register(...e),e.forEach(r=>this.invalidateCache(r))}unregister(...e){super.unregister(...e),e.forEach(r=>this.invalidateCache(r))}};t(Ru,"RuleRegistry");d=new Ru});var xu,Xa,vu=n(()=>{B();xu=class extends h{};t(xu,"Complete");Xa=xu});var bu,Cu,Cg=n(()=>{B();bu=class extends h{};t(bu,"Cost");Cu=bu});var Tu,Pu,Tg=n(()=>{B();Tu=class extends h{};t(Tu,"Requirements");Pu=Tu});var es,W,Ve=n(()=>{Z();es=class extends S{#e=[];#t=null;constructor(e=0,r="initial"){super(),this.addKey("value","values"),this.add(e,r)}add(e,r=""){if(e instanceof es)return this.add(e.value(),r);this.#e.push([e,r]),this.#t=null}clone(){return new this.constructor(this)}set(e,r=""){if(this.#e.splice(0),e instanceof es)return this.set(e.value(),r);this.#e.push([e,r]),this.#t=e}subtract(e,r=""){if(e instanceof es)return this.subtract(e.value(),r);this.#e.push([-e,r]),this.#t=null}value(){return this.#t===null&&(this.#t=this.#e.reduce((e,[r])=>e+r,0)),this.#t}values(){return this.#e}};t(es,"Yield");W=es});var Vs,WR=n(()=>{Ve();Vs=class extends W{};t(Vs,"Research")});var jR=n(()=>{WR()});var Iu,Ml,wu=n(()=>{B();Iu=class extends h{};t(Iu,"Started");Ml=Iu});var Au,Dl,Bu=n(()=>{G();Z();I();vu();Cg();Tg();jR();wu();Au=class extends S{#e;#t=[];#r=null;#i;#o=new Vs(1/0);#a=new Vs(0);#n;constructor(e,r=O,o=d){super(),this.#e=r,this.#i=e,this.#n=o,this.addKey("available","complete","cost","progress","researching")}add(e){this.#a.add(e),this.check()}addAdvance(e){if(this.#t.some(o=>o instanceof e))return;this.#r===e&&(this.#r=null);let r=new e;this.#t.push(r),this.#n.process(Xa,this,r)}available(){let e=this.#n.get(Pu);return this.#e.filter(r=>e.filter(o=>o.validate(r,this.#t)).every(o=>o.process(r,this.#t)===!0)&&!this.#t.some(o=>o instanceof r))}check(){if(this.#r!==null&&this.#a.value()>=this.#o.value()){let e=new this.#r;this.#t.push(e),this.#r=null,this.#a.subtract(this.#o),this.#o.set(1/0),this.#n.process(Xa,this,e)}}complete(){return this.#t}completed(e){return this.#t.some(r=>r instanceof e)}cost(){return this.#o}player(){return this.#i}progress(){return this.#a}research(e){let[r]=this.#n.process(Cu,e,this);this.#o.set(r),this.#r=e,this.#n.process(Ml,this,e)}researching(){return this.#r}};t(Au,"PlayerResearch");Dl=Au});var Gu,z,ze=n(()=>{he();Bu();Gu=class extends F{constructor(){super(Dl)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of results for player.");return r[0]}};t(Gu,"PlayerResearchRegistry");z=new Gu});var El,Fl,op=n(()=>{El=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}goodyHut(){return this.#e}perform(){}unit(){return this.#t}};t(El,"Action");Fl=El});var ts,HR=n(()=>{ze();op();ts=class extends Fl{#e;#t;constructor(e,r,o=z,s=()=>Math.random()){super(e,r),this.#e=o,this.#t=s}perform(){let e=this.#e.getByPlayer(this.unit().player()),r=e.available(),o=r[Math.floor(r.length*this.#t())];e.addAdvance(o)}};t(ts,"Advance")});var Uu,yr,Js=n(()=>{B();Uu=class extends h{};t(Uu,"Captured");yr=Uu});var Mu,rt,kl=n(()=>{B();Mu=class extends h{};t(Mu,"Cost");rt=Mu});var Du,_o,Eu=n(()=>{B();Du=class extends h{};t(Du,"Created");_o=Du});var Fu,kr,$s=n(()=>{B();Fu=class extends h{};t(Fu,"Destroyed");kr=Fu});var ku,Su,Pg=n(()=>{B();ku=class extends h{};t(ku,"Created");Su=ku});var Yu,Cn,Sl=n(()=>{Z();I();Pg();Yu=class extends S{#e;constructor(e=d){super(),this.#e=e,this.#e.process(Su,this)}clone(){return new this.constructor(this.#e)}};t(Yu,"Terrain");Cn=Yu});var j,_R=n(()=>{Sl();j=class extends Cn{};t(j,"Land")});var Jt,Ig=n(()=>{Sl();Jt=class extends Cn{};t(Jt,"Water")});var $t=n(()=>{_R();Ig()});var zu,Nu,wg=n(()=>{B();zu=class extends h{};t(zu,"YieldModifier");Nu=zu});var Lu,li,Ag=n(()=>{B();Lu=class extends h{};t(Lu,"Yield");li=Lu});var Yl,ce,Vi=n(()=>{Z();$t();I();ju();Ve();wg();Ag();Yl=class extends S{#e;#t=[];#r;#i;#o;#a;#n=new Map;constructor(e,r,o,s,a=d){super(),this.#o=e,this.#a=r,this.#i=o,this.#e=s,this.#r=a,this.addKey("terrain","isCoast","isLand","isWater","x","y","yields")}clearYieldCache(e=null){this.#n.delete(e)}getAdjacent(){return this.getAdjacentDirections().map(e=>this.getNeighbour(e))}getAdjacentDirections(){return["n","e","s","w"]}getNeighbour(e){return e==="n"?this.#e.get(this.#o,this.#a-1):e==="ne"?this.#e.get(this.#o+1,this.#a-1):e==="e"?this.#e.get(this.#o+1,this.#a):e==="se"?this.#e.get(this.#o+1,this.#a+1):e==="s"?this.#e.get(this.#o,this.#a+1):e==="sw"?this.#e.get(this.#o-1,this.#a+1):e==="w"?this.#e.get(this.#o-1,this.#a):this.#e.get(this.#o-1,this.#a-1)}getNeighbouringDirections(){return["n","ne","e","se","s","sw","w","nw"]}getNeighbours(){return this.#t.length||(this.#t=this.getNeighbouringDirections().map(e=>this.getNeighbour(e))),this.#t}getSurroundingArea(e=2){return Wu.fromSurrounding(this,e)}distanceFrom(e){let r=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[o]=r.map(([s,a])=>Math.hypot(this.#o-e.x()+s*this.#e.width(),this.#a-e.y()+a*this.#e.height())).sort((s,a)=>s-a);return o}isCoast(){let e=this;return e.isWater()&&e.getNeighbours().some(r=>r.isLand())||e.isLand()&&e.getNeighbours().some(r=>r.isWater())}isLand(){return this.#i instanceof j}isNeighbourOf(e){return this.getNeighbours().includes(e)}isWater(){return this.#i instanceof Jt}map(){return this.#e}score(e=null,r=[[W,3]]){return this.yields(e).map(s=>{let[a]=r.filter(([u])=>s instanceof u),m=a?a[1]||1:0;return s.value()*m}).reduce((s,a)=>s+a,0)}terrain(){return this.#i}setTerrain(e){this.#i=e}x(){return this.#o}y(){return this.#a}yields(e=null){if(!this.#n.has(e)){let r=this.#r.process(li,this,e).flat();this.#r.process(Nu,this,e,r).flat(),this.#n.set(e,r)}return this.#n.get(e)}};t(Yl,"Tile");ce=Yl});var zl,Wu,ju=n(()=>{he();Vi();zl=class extends F{static from(...e){return new this(...e)}static fromSurrounding(e,r=2){let o=t(s=>{let a=[];for(let m=e.x()-s;m<=e.x()+s;m++)for(let u=e.y()-s;u<=e.y()+s;u++)a.push([m,u]);return a},"gen");return this.from(...o(r).map(([s,a])=>e.map().get(s,a)))}constructor(...e){super(Yl),this.register(...e)}push(...e){this.register(...e)}shift(){let[e]=this.entries();return this.unregister(e),e}score(e=null,r=[]){return this.entries().reduce((o,s)=>o+s.score(e,r),0)}yields(e=null){return this.entries().flatMap(r=>r.yields(e))}};t(zl,"Tileset");Wu=zl});var Nl,Ko,Ll=n(()=>{B();Nl=class extends h{};t(Nl,"Yield");Ko=Nl});var Hu,Zs,_u=n(()=>{B();Hu=class extends h{};t(Hu,"YieldModifier");Zs=Hu});var Ku,it,Zn=n(()=>{Z();I();Js();kl();Eu();$s();ju();Ve();Ll();_u();Ku=class extends S{#e=!1;#t;#r;#i;#o;#a;#n;#s=new Wu;constructor(e,r,o,s=d){super(),this.#t=o,this.#r=e,this.#i=e,this.#a=r,this.#n=this.#a.getSurroundingArea(),this.#s.push(r),this.#o=s,this.#o.process(_o,this),this.addKey("destroyed","name","originalPlayer","player","tile","tiles","tilesWorked","yields")}capture(e){let r=this.#i;this.#i=e,this.#o.process(yr,this,e,r)}destroy(e=null){this.#e=!0,this.#o.process(kr,this,e)}destroyed(){return this.#e}name(){return this.#t}setName(e){this.#t=e}originalPlayer(){return this.#r}player(){return this.#i}tile(){return this.#a}tiles(){return this.#n}tilesWorked(){return this.#s}yields(){let e=[];return[this.#o.get(Ko),this.#o.get(Zs),this.#o.get(rt)].flat().forEach(r=>{if(!r.validate(this,e))return;let o=r.process(this,e);if(!!o){if(o instanceof W){e.push(o);return}o.forEach(s=>e.push(s))}}),e}};t(Ku,"City");it=Ku});var qu,L,Je=n(()=>{he();Zn();qu=class extends F{constructor(){super(it)}getByPlayer(e,r=!1){return r?this.getBy("player",e):this.filter(o=>o.player()===e&&!o.destroyed())}getByTile(e){let[r]=this.filter(o=>o.tile()===e&&!o.destroyed());return r??null}};t(qu,"CityRegistry");L=new qu});var rs,KR=n(()=>{Je();I();op();Zn();rs=class extends Fl{#e;constructor(e,r,o=L){super(e,r),this.#e=o}perform(e=d){let r=this.unit().player(),o=new it(r,this.goodyHut().tile(),r.civilization().getCityName(!0),e);this.#e.register(o)}};t(rs,"City")});var Vu,Tn,Wl=n(()=>{he();Vu=class extends F{constructor(){super(Function)}accepts(e){return"build"in e}};t(Vu,"AvailableCityBuildItemsRegistry");Tn=new Vu});var Zt,qR,np=n(()=>{w();B();Zt=class extends h{process(e,r){let o=super.process(e,r);if(!(o instanceof Bl))throw new TypeError("Invalid build rule.");return o}};t(Zt,"Build");qR=Zt});var Ju,$u,Bg=n(()=>{Z();Ju=class extends Ye{#e;constructor(e){super(),this.addKey("value"),this.#e=e}value(){return this.#e}};t(Ju,"BuildCost");$u=Ju});var ap,VR,jl,lS,sp=n(()=>{Bg();w();T();B();ap=class extends h{};t(ap,"BuildCost");VR=ap,jl=t((i,e)=>lS([[i,e]]),"buildCost"),lS=t(i=>i.map(([e,r])=>new ap(new l(o=>o.item()===e),new p(()=>new $u(r)))),"buildCosts")});var Zu,Qu,Gg=n(()=>{I();Bg();sp();Z();Zu=class extends Ye{#e;#t=new $u(1/0);#r;#i;constructor(e,r=null,o=d){super(),this.#r=e,this.#e=r,this.#i=o,this.addKey("cost","item")}cost(){if(!Number.isFinite(this.#t.value())){let[e]=this.#i.process(VR,this,this.#e);e&&(this.#t=e)}return this.#t}item(){return this.#r}};t(Zu,"BuildItem");Qu=Zu});var Qs,JR=n(()=>{Ve();Qs=class extends W{};t(Qs,"BuildProgress")});var $R=n(()=>{JR()});var Xu,ZR,QR=n(()=>{B();Xu=class extends h{};t(Xu,"BuildingCancelled");ZR=Xu});var ec,Pn,lp=n(()=>{B();ec=class extends h{};t(ec,"BuildingComplete");Pn=ec});var tc,Hl,rc=n(()=>{Wl();Z();I();np();Gg();$R();QR();lp();tc=class extends S{#e;#t=null;#r;#i=new Qs(1/0);#o=new Qs;#a;constructor(e,r=Tn,o=d){super(),this.#e=r,this.#r=e,this.#a=o,this.addKey("available","building","city","cost","progress","remaining")}add(e){this.#o.add(e)}available(){let e=this.#a.get(qR);return this.#e.filter(r=>e.filter(o=>o.validate(this.city(),r)).every(o=>o.process(this.city(),r).validate())).map(r=>new Qu(r,this.city(),this.#a))}build(e){let r=this.getAvailable(e);if(!r)throw new TypeError(`Cannot build ${e.name}, it's not available.`);this.#t=r,this.#i.set(this.#t.cost().value())}building(){return this.#t}check(){if(this.#o.value()>=this.#i.value()&&this.#t){let e=this.#t.item().build(this.#r,this.#a);return this.#o.set(0),this.#t=null,this.#i.set(1/0),this.#a.process(Pn,this,e),e}return null}city(){return this.#r}cost(){return this.#i}getAvailable(e){return this.available().filter(r=>r.item()===e)[0]}progress(){return this.#o}remaining(){return this.#i.value()-this.#o.value()}revalidate(){this.#t&&!this.getAvailable(this.#t.item())&&(this.#t=null,this.#i.set(1/0),this.#a.process(ZR,this))}};t(tc,"CityBuild");Hl=tc});var ic,Qt,Qn=n(()=>{he();rc();ic=class extends F{constructor(){super(Hl)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of entities returned.");return r[0]}};t(ic,"CityBuildRegistry");Qt=new ic});var oc,Xs,Ug=n(()=>{B();oc=class extends h{};t(oc,"Spend");Xs=oc});var nc,ac,Mg=n(()=>{Qn();I();Ug();Ve();nc=class extends W{#e;#t;#r;constructor(e,r=Qt,o=d){super(),this.#e=e,this.#t=o,this.#r=r}buy(e){let r=this.#r.getByCity(e),o=this.cost(e);e.player()!==this.#e||this.value()<o.value()||(r.add(new W(r.remaining())),this.subtract(o.value()))}cost(e){let r=this.#r.getByCity(e),o=new W;return this.#t.process(Xs,r,o).reduce((s,a)=>(s.add(a),s))}player(){return this.#e}};t(nc,"PlayerTreasury");ac=nc});var sc,mi,el=n(()=>{he();Mg();sc=class extends F{constructor(){super(ac)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTreasuries for player.");return r[0]}};t(sc,"PlayerTreasuryRegistry");mi=new sc});var Xt,lc,_l=n(()=>{Ve();Xt=class extends W{};t(Xt,"Gold");lc=Xt});var is,XR=n(()=>{el();op();_l();is=class extends Fl{#e;constructor(e,r,o=mi){super(e,r),this.#e=o}perform(){this.#e.getByPlayer(this.unit().player()).add(new Xt(50))}};t(is,"Gold")});var mc,pc,Dg=n(()=>{B();mc=class extends h{};t(mc,"Unit");pc=mc});var os,ex=n(()=>{op();I();Dg();os=class extends El{#e;#t;constructor(e,r,o=()=>Math.random(),s=d){super(e,r),this.#e=o,this.#t=s}perform(){this.#t.process(pc,this.goodyHut(),this.unit())}};t(os,"Unit")});var Eg=n(()=>{HR();KR();XR();ex()});var ns,tx=n(()=>{qa();ns=class extends Er{};t(ns,"ChangeProduction")});var In,rx=n(()=>{qs();In=class extends si{};t(In,"CityBuild")});var Fg=n(()=>{tx();rx()});var as,ix,uc=n(()=>{as=class{#e;constructor(e){this.#e=e}player(){return this.#e}takeTurn(){return new Promise((e,r)=>r(new TypeError("Client#takeTurn must be implemented.")))}};t(as,"Client");ix=as});var cc,ss,mp=n(()=>{Ve();cc=class extends W{#e;constructor(e,r){super(r),this.#e=e}leader(){return this.#e}};t(cc,"Trait");ss=cc});var yc,fc,kg=n(()=>{he();mp();yc=class extends F{constructor(){super(ss)}getByLeader(e){return this.getBy("leader",e)}getBySubclass(e){return this.filter(r=>r instanceof e)}};t(yc,"TraitRegistry");fc=new yc});var dc,te,st=n(()=>{kg();Z();dc=class extends S{#e=[];constructor(e=fc){super();let r=e.getByLeader(this.sourceClass());this.#e.push(...r),this.addKey("name")}static civilization(){throw new TypeError("Must be implemented in extending class")}name(){throw new TypeError("Must be implemented in extending class")}traits(){return[...this.#e]}};t(dc,"Leader");te=dc});var gc,wn,Kl=n(()=>{Ho();st();gc=class extends He{constructor(){super(te)}getByCivilization(e){return this.getBy("civilization",e)}};t(gc,"LeaderRegistry");wn=new gc});var ls,ox=n(()=>{qa();ls=class extends Er{};t(ls,"AdjustTradeRates")});var Sg=n(()=>{ox()});var hc,Te,fr=n(()=>{B();hc=class extends h{};t(hc,"Busy");Te=hc});var tl,nx,Yg=n(()=>{qs();tl=class extends si{};t(tl,"ChooseResearch");nx=tl});var Oc,Rc,zg=n(()=>{B();Oc=class extends h{};t(Oc,"Cost");Rc=Oc});var An,Ng,xc=n(()=>{Ve();An=class extends W{};t(An,"FoodStorage");Ng=An});var vc,up,Lg=n(()=>{B();vc=class extends h{};t(vc,"FoodStorage");up=vc});var bc,Bn,Cc=n(()=>{B();bc=class extends h{};t(bc,"Grow");Bn=bc});var Tc,rl,Wg=n(()=>{B();Tc=class extends h{};t(Tc,"Shrink");rl=Tc});var Pc,il,Ic=n(()=>{Z();I();zg();xc();Lg();Cc();Wg();Pc=class extends S{#e;#t=new Ng(1/0);#r=new Ng;#i;#o=1;constructor(e,r=d){super(),this.#e=e,this.#i=r,this.setCost(),this.addKey("cost","progress","size")}add(e){this.#r.add(e)}check(){this.#i.process(up,this)}city(){return this.#e}cost(){return this.#t}setCost(){let e=this.#i.process(Rc,this);e.length>0&&this.#t.set(e[0],"setCost")}empty(){this.#r.subtract(this.#r.value())}grow(){this.#o++,this.#i.process(Bn,this)}progress(){return this.#r}shrink(){this.#o--,this.#i.process(rl,this)}size(){return this.#o}};t(Pc,"CityGrowth");il=Pc});var ol,jg=n(()=>{Z();I();ol=class extends S{static build(e,r=d){throw new TypeError("createFromObject: Must be overridden in extending class")}};t(ol,"Buildable")});var wc,cp,Hg=n(()=>{B();wc=class extends h{};t(wc,"Created");cp=wc});var Ac,k,Be=n(()=>{jg();I();Hg();Ac=class extends ol{#e;#t=!1;#r;constructor(e,r=d){super(),this.addKey("destroyed"),this.#e=e,this.#r=r,this.#r.process(cp,this,e)}static build(e,r=d){return new this(e,r)}city(){return this.#e}destroy(){this.#t=!0}destroyed(){return this.#t}};t(Ac,"CityImprovement");k=Ac});var Bc,Oe,er=n(()=>{Z();Bc=class extends S{#e;#t;#r;constructor(e,r,o){super(),this.#e=e,this.#t=r,this.#r=o,this.addKey("name","value")}civilization(){return this.#e}name(){return this.#t}value(){return this.#r}};t(Bc,"Attribute");Oe=Bc});var ql,Re,tr=n(()=>{he();er();ql=class extends F{constructor(){super(Oe)}getByCivilization(e){return this.getBy("civilization",e)}getByName(e){return this.getBy("name",e)}};t(ql,"AttributeRegistry");Re=new ql});var Gc,Q,Ft=n(()=>{Gc=class{#e;#t;#r=!1;constructor(e,r,o=!1){this.#e=e,this.#t=r,this.#r=o}name(){return this.#e}civilization(){return this.#t}capital(){return this.#r}};t(Gc,"CityName");Q=Gc});var Uc,$,gt=n(()=>{he();Ft();Uc=class extends F{#e=1;#t;constructor(e=()=>Math.random()){super(Q),this.#t=e}takeByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1);return r instanceof Q?(this.unregister(r),r.name()):this.takeUnassociated()}takeCapitalByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1).filter(o=>o.capital());return r instanceof Q?(this.unregister(r),r.name()):this.takeByCivilization(e)}takeUnassociated(){let[e]=this.getBy("civilization",null).sort(()=>Math.floor(this.#t()*3)-1);return e instanceof Q?(this.unregister(e),e.name()):`City #${this.#e++}`}};t(Uc,"CityNameRegistry");$=new Uc});var Mc,me,kt=n(()=>{tr();gt();Z();Mc=class extends S{#e=null;#t;#r=new ql;constructor(e=Re,r=$){super(),this.#t=r,this.#r.register(...e.getByCivilization(this.sourceClass())),this.addKey("name","leader","attributes")}attributes(){return this.#r.entries()}name(){return this.constructor.name}leader(){return this.#e}setLeader(e){this.#e=e}getCityName(e=!1){let r=this.sourceClass();return e?this.#t.takeCapitalByCivilization(r):this.#t.takeByCivilization(r)}};t(Mc,"Civilization");me=Mc});var ms,ax=n(()=>{qa();ms=class extends Er{value(){return super.value()}};t(ms,"CompleteProduction")});var _g=n(()=>{ax()});var nl,Ec,Fc=n(()=>{qs();nl=class extends si{};t(nl,"EndTurn");Ec=nl});var kc,ht,Xn=n(()=>{B();kc=class extends h{};t(kc,"Action");ht=kc});var Sc,pi,al=n(()=>{B();Sc=class extends h{};t(Sc,"Added");pi=Sc});var Yc,Kg,lx=n(()=>{qa();Yc=class extends Er{};t(Yc,"HiddenPlayerAction");Kg=Yc});var zc,_,qo=n(()=>{Z();I();Xn();al();lx();qs();zc=class extends S{#e=null;#t;constructor(e=d){super(),this.#t=e,this.#t.process(pi,this),this.addKey("actions","civilization","mandatoryActions")}action(){let[e]=this.actions();return e}actions(){return this.#t.process(ht,this).flat().filter(e=>!(e instanceof Kg))}civilization(){if(this.#e===null)throw new TypeError("Player#civilization is unset.");return this.#e}hasActions(){return!!this.action()}hasMandatoryActions(){return this.actions().some(e=>e instanceof si)}hiddenActions(){return this.#t.process(ht,this).flat().filter(e=>e instanceof Kg)}mandatoryAction(){let[e]=this.mandatoryActions();return e}mandatoryActions(){return this.actions().filter(e=>e instanceof si)}setCivilization(e){this.#e=e}};t(zc,"Player");_=zc});var Nc,Vl,qg=n(()=>{Et();Z();Vi();Nc=class extends S{#e={};#t;#r;#i;constructor(e,r,o=ne){super(),this.#t=o,this.#r=r,this.#i=e,this.addKey("isCoast","isLand","isWater","terrain","x","y","yields"),this.setAdditionalData()}addKey(...e){super.addKey(...e)}isCoast(){return this.#i.isCoast()}isLand(){return this.#i.isLand()}isWater(){return this.#i.isWater()}player(){return this.#r}setAdditionalData(){this.#t.getByType(ce).forEach(e=>{this.#e[e.key()]=e.data(this.#i),Object.defineProperty(this,e.key(),{configurable:!0,value:()=>e.data(this.#i)}),this.addKey(e.key())})}terrain(){return this.#i.terrain()}tile(){return this.#i}update(){this.#i.clearYieldCache(this.#r),this.setAdditionalData()}x(){return this.#i.x()}y(){return this.#i.y()}yields(){return this.#i.yields(this.#r)}};t(Nc,"PlayerTile");Vl=Nc});var Lc,mx,px=n(()=>{Sl();Lc=class extends Cn{};t(Lc,"Unknown");mx=Lc});var Wc,ux,cx=n(()=>{Vi();px();Wc=class extends ce{constructor(e,r,o){super(e,r,new mx,o)}};t(Wc,"UndiscoveredTile");ux=Wc});var jc,Hc,Vg=n(()=>{B();jc=class extends h{};t(jc,"VisibilityChanged");Hc=jc});var _c,Jl,Kc=n(()=>{Z();I();qg();Vi();cx();Vg();_c=class extends S{#e;#t;#r=[];#i;constructor(e,r,o=d){super(),this.#e=e,this.#i=r,this.#t=o,this.addKey("height","tiles","width")}entries(){return this.#r}filter(e){return this.entries().filter(e)}forEach(e){return this.#r.forEach(e)}get(e,r){let[o]=this.entries().filter(s=>s.x()===e&&s.y()===r);return o||new ux(e,r,this.#i)}getByTile(e){let[r]=this.filter(o=>o.tile()===e);return r??null}height(){return this.#i.height()}includes(e){return e instanceof ce?!!this.getByTile(e):this.#r.includes(e)}map(e){return this.#r.map(e)}player(){return this.#e}register(...e){e.forEach(r=>{this.includes(r)||(this.#r.push(new Vl(r,this.#e)),this.#t.process(Hc,r,this.player()))})}tiles(){return this.entries()}width(){return this.#i.width()}};t(_c,"PlayerWorld");Jl=_c});var us,dx=n(()=>{qa();us=class extends Er{};t(us,"Revolution")});var Jg=n(()=>{dx()});var Ji,gx=n(()=>{Ve();Ji=class extends W{};t(Ji,"Attack")});var ui,hx=n(()=>{Ve();ui=class extends W{};t(ui,"Defence")});var $i,Ox,$g=n(()=>{Ve();$i=class extends W{};t($i,"Movement");Ox=$i});var Ql,Rx=n(()=>{$g();Ql=class extends Ox{};t(Ql,"Moves")});var cs,xx=n(()=>{Ve();cs=class extends W{};t(cs,"Visibility")});var Xl=n(()=>{gx();hx();$g();Rx();xx()});var Ot,Zg,ci,Gn,em,Qg=n(()=>{w();T();B();Ot=class extends h{};t(Ot,"Action");Zg=Ot,ci=new l(i=>i.moves().value()>=.1),Gn=new l((i,e,r=i.tile())=>r===e),em=new l((i,e,r=i.tile())=>e.isNeighbourOf(r))});var Zc,tm,Xg=n(()=>{B();Zc=class extends h{};t(Zc,"Activate");tm=Zc});var Qc,ea,Xc=n(()=>{B();Qc=class extends h{};t(Qc,"Created");ea=Qc});var ey,Vo,Op=n(()=>{B();ey=class extends h{};t(ey,"Destroyed");Vo=ey});var ty,ry,eh=n(()=>{B();ty=class extends h{};t(ty,"Visibility");ry=ty});var ys,sl,Rp,vx,rm=n(()=>{Xl();w();T();B();ys=class extends h{};t(ys,"BaseYield");sl=class extends h{};t(sl,"Yield");Rp=sl,vx=t((i,e=1,r=1,o=1,s=1)=>[...[[Ji,e],[ui,r],[$i,o],[cs,s]].flatMap(([a,m])=>[new sl(new l(u=>u instanceof i),new l((u,y)=>y instanceof a),new p((u,y)=>y.set(m))),new ys(new l(u=>u===i),new l((u,y)=>y instanceof a),new p((u,y)=>y.set(m)))])],"unitYield")});var iy,Ie,ta=n(()=>{Xl();jg();I();Qg();Xg();Xc();Op();eh();rm();iy=class extends ol{#e=!0;#t=null;#r;#i=!1;#o=new Ql;#a;#n;#s=null;#l;#m=!1;constructor(e,r,o,s=d){super(),this.#r=e,this.#a=r,this.#l=o,this.#n=s,this.addKey("actions","actionsForNeighbours","active","attack","busy","city","defence","destroyed","movement","moves","player","status","tile","visibility","waiting"),this.#n.process(ea,this)}static build(e,r=d){return new this(e,e.player(),e.tile(),r)}action(e,...r){return e.perform(...r)}actions(e=this.#l,r=this.#l){return typeof e=="string"&&(e=r.getNeighbour(e)),this.#n.process(Zg,this,e,r)}actionsForNeighbours(e=this.#l){return e.getNeighbouringDirections().reduce((r,o)=>({...r,[o]:this.#n.process(Zg,this,e.getNeighbour(o),e)}),{})}activate(){this.#n.process(tm,this)}active(){return this.#e}setActive(e=!0){this.#e=e}applyVisibility(){this.#l.getSurroundingArea(this.visibility().value()).forEach(e=>{this.#n.process(ry,e,this.#a)})}attack(){let[e]=this.yield(new Ji);return e}busy(){return this.#t}setBusy(e=null){this.#t=e}city(){return this.#r}defence(){let[e]=this.yield(new ui);return e}destroy(e=null){this.#n.process(Vo,this,e)}destroyed(){return this.#i}setDestroyed(){this.#i=!0}movement(){let[e]=this.yield(new $i);return e}moves(){return this.#o}player(){return this.#a}status(){return this.#s}setStatus(e){this.#s=e}tile(){return this.#l}setTile(e){this.#l=e}visibility(){let[e]=this.yield(new cs);return e}waiting(){return this.#m}setWaiting(e=!0){this.#m=e}yield(...e){let r=this.#n.get(Rp);return e.forEach(o=>r.filter(s=>s.validate(this,o)).forEach(s=>s.process(this,o))),e}};t(iy,"Unit");Ie=iy});var oy,ye,rr=n(()=>{he();Ic();oy=class extends F{constructor(){super(il)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of CityGrowths returned.");return r[0]}};t(oy,"CityGrowthRegistry");ye=new oy});var xe,fe,Pe=n(()=>{Be();xe=class extends k{};t(xe,"Wonder");fe=xe});var im,yi,fs=n(()=>{he();qo();im=class extends F{constructor(){super(_)}};t(im,"PlayerRegistry");yi=new im});var ly,ra,Ap=n(()=>{fs();ly=class extends im{};t(ly,"CurrentPlayerRegistry");ra=new ly});var my,py,oh=n(()=>{my=class{#e={};on(e,r){e in this.#e||(this.#e[e]=[]),this.#e[e].push(r)}once(e,r){let o=t((...s)=>{r(...s),this.off(e,o)},"onceHandler");this.on(e,o)}off(e,r){if(!(e in this.#e))return;let o=this.#e[e].indexOf(r);o!==-1&&this.#e[e].splice(o,1)}emit(e,...r){e in this.#e&&this.#e[e].forEach(o=>o(...r))}};t(my,"EventEmitter");py=my});var uy,P,K=n(()=>{oh();uy=class extends py{#e={};#t=!1;debug(e){if(!!this.option("debug"))return e()}emit(e,...r){return this.debug(()=>console.log(`Engine#emit: ${String(e)}: ${r}`)),super.emit(e,...r)}loadPlugins(){return this.emit("plugins:load:start"),new Promise((e,r)=>{this.once("plugins:load:end",()=>e())})}option(e,r=null){return this.#e[e]||r}setOption(e,r){this.#e[e]!==r&&(this.#e[e]=r,this.emit("option:changed",e,r))}start(){this.#t||(this.#t=!0,this.emit("engine:initialise"),this.loadPlugins().then(()=>{this.emit("engine:start")}))}};t(uy,"Engine");P=new uy});var cy,ae,Zi=n(()=>{he();Kc();cy=class extends F{constructor(){super(Jl)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError(`Wrong number of player worlds exist for player: ${e.id()}`);return r[0]}};t(cy,"PlayerWorldRegistry");ae=new cy});var yy,Ge,fi=n(()=>{Z();yy=class extends S{#e=0;constructor(){super(),this.addKey("value")}increment(){return this.#e++,this.#e}value(){return this.#e}};t(yy,"Turn");Ge=new yy});var fy,N,_e=n(()=>{he();ta();fy=class extends F{constructor(){super(Ie)}getByCity(e){return this.filter(r=>r.city()===e&&!r.destroyed())}getByPlayer(e,r=!1){return r?this.getBy("player",e):this.filter(o=>o.player()===e&&!o.destroyed())}getByTile(e){return this.filter(r=>r.tile()===e&&!r.destroyed())}};t(fy,"UnitRegistry");N=new fy});var dy,ds,nh=n(()=>{B();dy=class extends h{};t(dy,"Year");ds=dy});var J,Jo,ll=n(()=>{Ve();J=class extends W{};t(J,"Food");Jo=J});var H,ia,om=n(()=>{Ve();H=class extends W{};t(H,"Production");ia=H});var re,oa,na=n(()=>{Ve();re=class extends W{};t(re,"Trade");oa=re});var aa=n(()=>{ll();om();na()});var sa,Ke,Qi=n(()=>{sa=t((i,...e)=>i.reduce((r,o)=>{let s=e.findIndex(a=>o instanceof a);return s===-1||(r[s]+=o.value()),r},e.map(()=>0)),"reduceYields"),Ke=t((i,e)=>sa(i,e).shift()??0,"reduceYield")});var mS,pS,Px,Ix,gs,nm=n(()=>{rr();aa();Zi();Qi();mS=t((i,e=[[J,8],[H,3*(Ke(i.tilesWorked().yields(i.player()),H)===0?3:1)],[re,1*(Ke(i.tilesWorked().yields(i.player()),re)===0?3:1)]])=>i.tiles().entries().sort((r,o)=>o.score(i.player(),e)-r.score(i.player(),e)),"getHighestValueCityTiles"),pS=t((i,e=ae)=>mS(i).filter(r=>e.getByPlayer(i.player()).includes(r)&&!i.tilesWorked().includes(r)&&i.tile()!==r),"getHighestValueAvailableCityTiles"),Px=t((i,e=ae,r=ye)=>{i.tilesWorked().unregister(...i.tilesWorked().entries()),i.tilesWorked().register(i.tile()),Ix(i,e,r)},"reassignWorkers"),Ix=t((i,e=ae,r=ye)=>{let o=r.getByCity(i);pS(i,e).some(s=>i.tilesWorked().length>=o.size()+1?!0:(i.tilesWorked().register(s),!1))},"assignWorkers"),gs=Ix});var Mn,Os,Rs=n(()=>{I();Z();Mn=class extends S{#e;#t;#r;#i;constructor(e,r,o,s=d){super(),this.#e=e,this.#t=s,this.#r=r,this.#i=o,this.addKey("from","to")}forUnit(e){return new this.constructor(this.#e,this.#r,e,this.#t)}from(){return this.#e}perform(...e){}ruleRegistry(){return this.#t}to(){return this.#r}unit(){return this.#i}};t(Mn,"Action");Os=Mn});var Ry,$o,Gp=n(()=>{B();Ry=class extends h{};t(Ry,"Defeated");$o=Ry});var xs,Gx=n(()=>{I();_e();Rs();Gp();xs=class extends Os{#e;#t;constructor(e,r,o,s=d,a=N,m=()=>Math.random()){super(e,r,o,s),this.#t=a,this.#e=m}perform(){let[e]=this.#t.getByTile(this.to()).sort((o,s)=>s.defence().value()-o.defence().value()),r=Math.min(1,this.unit().moves().value());if(this.unit().attack().value()*r*this.#e()>=e.defence().value()*this.#e()){this.ruleRegistry().process($o,e,this.unit(),this),this.unit().moves().subtract(r,this.constructor.name);return}this.ruleRegistry().process($o,this.unit(),e,this)}};t(xs,"Attack")});var xy,Ux,Mx=n(()=>{fr();xy=class extends Te{};t(xy,"BuildingIrrigation");Ux=xy});var vy,q,At=n(()=>{B();vy=class extends h{};t(vy,"Moved");q=vy});var by,$e,Xi=n(()=>{Rs();I();fi();fr();w();T();At();by=class extends Mn{#e;constructor(e,r,o,s=d,a=Ge){super(e,r,o,s),this.#e=a}perform(e,r=()=>{},o=Te){let s=this.#e.value()+e;this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new o(new l(()=>this.#e.value()===s),new p((...a)=>{let m=this.unit();m.setActive(),m.setBusy(),r(...a),this.ruleRegistry().process(q,this.unit(),this)})))}};t(by,"DelayedAction");$e=by});var Cy,la,Ty=n(()=>{B();Cy=class extends h{};t(Cy,"Built");la=Cy});var Py,Zo,pl=n(()=>{Z();I();Ty();Py=class extends S{#e;constructor(e,r=d){super(),this.#e=e,r.process(la,e,this)}tile(){return this.#e}};t(Py,"TileImprovement");Zo=Py});var we,Dx,mh=n(()=>{pl();we=class extends Zo{};t(we,"Irrigation");Dx=we});var Iy,be,di=n(()=>{B();Iy=class extends h{};t(Iy,"MovementCost");be=Iy});var vs,Ex=n(()=>{Mx();Xi();mh();At();di();vs=class extends $e{perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Dx(this.unit().tile())},Ux),this.ruleRegistry().process(q,this.unit(),this)}};t(vs,"BuildIrrigation")});var wy,Fx,kx=n(()=>{fr();wy=class extends Te{};t(wy,"BuildingMine");Fx=wy});var Ze,Sx,ph=n(()=>{pl();Ze=class extends Zo{};t(Ze,"Mine");Sx=Ze});var bs,Yx=n(()=>{kx();Xi();ph();At();di();bs=class extends $e{perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Sx(this.unit().tile())},Fx),this.ruleRegistry().process(q,this.unit(),this)}};t(bs,"BuildMine")});var Ay,zx,Nx=n(()=>{fr();Ay=class extends Te{};t(Ay,"BuildingRoad");zx=Ay});var ke,Lx,uh=n(()=>{pl();ke=class extends Zo{};t(ke,"Road");Lx=ke});var Cs,Wx=n(()=>{Nx();Xi();At();di();uh();Cs=class extends $e{perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Lx(this.unit().tile())},zx),this.ruleRegistry().process(q,this.unit(),this)}};t(Cs,"BuildRoad")});var By,jx,Hx=n(()=>{fr();By=class extends Te{};t(By,"BuildingRailroad");jx=By});var ir,_x,ch=n(()=>{pl();ir=class extends Zo{};t(ir,"Railroad");_x=ir});var Ts,Kx=n(()=>{Hx();Xi();At();di();ch();Ts=class extends $e{perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new _x(this.unit().tile())},jx),this.ruleRegistry().process(q,this.unit(),this)}};t(Ts,"BuildRailroad")});var Gy,Up,yh=n(()=>{B();Gy=class extends h{};t(Gy,"ValidateMove");Up=Gy});var St,am,Mp=n(()=>{Rs();At();di();yh();St=class extends Mn{perform(){return this.validate()?(this.unit().setTile(this.to()),this.ruleRegistry().process(q,this.unit(),this),!0):!1}movementCost(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>r-o);return e}validate(){let[e]=this.ruleRegistry().process(Up,this.unit(),this.movementCost());return e}};t(St,"Move");am=St});var sm,qx=n(()=>{I();Mp();sm=class extends am{#e;constructor(e,r,o,s,a=d){super(e,r,o,a),this.#e=s}perform(){return super.perform()?(this.#e.capture(this.unit().player()),!0):!1}};t(sm,"CaptureCity")});var Uy,Ne,gi=n(()=>{Z();Uy=class extends Ye{#e;constructor(e){super(),this.#e=e}clone(e=this.terrain()){return new this.constructor(e)}terrain(){return this.#e}};t(Uy,"TerrainFeature");Ne=Uy});var fh,My,lt,Qo=n(()=>{he();gi();fh=new Map,My=class extends F{constructor(){super(Ne)}getByTerrain(e){return fh.has(e)||fh.set(e,this.getBy("terrain",e)),fh.get(e)}};t(My,"TerrainFeatureRegistry");lt=new My});var Dy,Vx,Jx=n(()=>{fr();Dy=class extends Te{};t(Dy,"ClearingForest");Vx=Dy});var ie,lm,Dp=n(()=>{$t();ie=class extends j{};t(ie,"Plains");lm=ie});var Ps,$x=n(()=>{I();Qo();fi();Jx();Xi();At();di();Dp();Ps=class extends $e{#e;constructor(e,r,o,s=d,a=lt,m=Ge){super(e,r,o,s,m),this.#e=a}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new lm,o=this.#e.getByTerrain(this.from().terrain());this.#e.register(...o.map(s=>s.clone(r))),this.#e.unregister(...o),this.from().setTerrain(r)},Vx),this.ruleRegistry().process(q,this.unit(),this)}};t(Ps,"ClearForest")});var Ey,Zx,Qx=n(()=>{fr();Ey=class extends Te{};t(Ey,"ClearingJungle");Zx=Ey});var Ep,Is,Xx,mm=n(()=>{Qo();w();T();B();Ep=class extends h{};t(Ep,"Feature");Is=Ep,Xx=t((i,e,r=.2,o=lt,s=()=>Math.random())=>[new Ep(new l(a=>a===e),new l((a,m)=>m instanceof i),new l(()=>s()<=r),new p((a,m)=>o.register(new a(m))))],"feature")});var de,ws,pm=n(()=>{$t();de=class extends j{};t(de,"Grassland");ws=de});var Xo,Fy,ky=n(()=>{gi();Xo=class extends Ne{};t(Xo,"Shield");Fy=Xo});var As,ev=n(()=>{I();Qo();fi();Qx();Xi();mm();pm();At();di();ky();As=class extends $e{#e;constructor(e,r,o,s=d,a=lt,m=Ge){super(e,r,o,s,m),this.#e=a}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new ws,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(Is,Fy,r),this.#e.unregister(...o),this.from().setTerrain(r)},Zx),this.ruleRegistry().process(q,this.unit(),this)}};t(As,"ClearJungle")});var Sy,tv,rv=n(()=>{fr();Sy=class extends Te{};t(Sy,"ClearingSwamp");tv=Sy});var Bs,iv=n(()=>{I();Qo();fi();rv();Xi();mm();pm();At();di();ky();Bs=class extends $e{#e;constructor(e,r,o,s=d,a=lt,m=Ge){super(e,r,o,s,m),this.#e=a}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new ws,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(Is,Fy,r),this.#e.unregister(...o),this.from().setTerrain(r)},tv),this.ruleRegistry().process(q,this.unit(),this)}};t(Bs,"ClearSwamp")});var um,ov=n(()=>{Rs();um=class extends Os{perform(){this.unit().destroy()}};t(um,"Disband")});var Gs,nv=n(()=>{I();Mp();Gs=class extends am{#e;constructor(e,r,o,s,a=d){super(e,r,o,a),this.#e=s}perform(){return super.perform()?(this.unit().moves().set(0),this.#e.unload(this.unit()),!0):!1}};t(Gs,"Disembark")});var cm,av=n(()=>{I();fr();w();Mp();At();cm=class extends am{#e;constructor(e,r,o,s,a=d){super(e,r,o,a),this.#e=s}perform(){return super.perform()?(this.#e.stow(this.unit()),this.unit().setBusy(new Te(new l(()=>!1))),this.unit().setActive(!1),this.ruleRegistry().process(q,this.unit(),this),!0):!1}};t(cm,"Embark")});var Yy,ym,zy=n(()=>{Z();Yy=class extends Ye{#e;constructor(e){super(),this.#e=e}unit(){return this.#e}};t(Yy,"UnitImprovement");ym=Yy});var Ny,or,ma=n(()=>{he();zy();Ny=class extends F{constructor(){super(ym)}getByUnit(e){return this.getBy("unit",e)}};t(Ny,"UnitImprovementRegistry");or=new Ny});var Ly,sv,lv=n(()=>{fr();Ly=class extends Te{};t(Ly,"Fortified");sv=Ly});var hi,mv,dh=n(()=>{zy();hi=class extends ym{};t(hi,"Fortified");mv=hi});var Wy,pv,uv=n(()=>{fr();Wy=class extends Te{};t(Wy,"Fortifying");pv=Wy});var Us,cv=n(()=>{I();fi();ma();lv();w();Xi();dh();uv();At();di();Us=class extends $e{#e;constructor(e,r,o,s=d,a=Ge,m=or){super(e,r,o,s,a),this.#e=m}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{this.unit().moves().set(0),this.unit().setActive(!1),this.unit().setBusy(new sv(new l(()=>!1))),this.#e.register(new mv(this.unit()))},pv),this.ruleRegistry().process(q,this.unit(),this)}};t(Us,"Fortify")});var fm,yv=n(()=>{gt();I();Rs();Zn();At();fm=class extends Os{#e;constructor(e,r,o,s=$,a=d){super(e,r,o,a),this.#e=s}perform(){new it(this.unit().player(),this.unit().tile(),this.#e.takeCapitalByCivilization(this.unit().player().civilization().constructor),this.ruleRegistry()),this.unit().destroy(),this.ruleRegistry().process(q,this.unit(),this)}};t(fm,"FoundCity")});var eo,fv=n(()=>{Rs();eo=class extends Mn{perform(){this.unit().moves().subtract(this.unit().moves())}};t(eo,"NoOrders")});var jy,Ue,Sr=n(()=>{he();pl();jy=class extends F{constructor(){super(Zo)}getByTile(e){return this.getBy("tile",e)}};t(jy,"TileImprovementRegistry");Ue=new jy});var Ms,dv=n(()=>{I();Sr();fi();Xi();At();di();Ms=class extends $e{#e;constructor(e,r,o,s=d,a=Ue,m=Ge){super(e,r,o,s,m),this.#e=a}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let[r]=this.#e.getByTile(this.from());this.#e.unregister(r)}),this.ruleRegistry().process(q,this.unit(),this)}};t(Ms,"Pillage")});var qe,Hy,_y=n(()=>{$t();qe=class extends j{};t(qe,"Forest");Hy=qe});var to,gv,gh=n(()=>{gi();to=class extends Ne{};t(to,"Horse");gv=to});var Ky,hv,Ov=n(()=>{fr();Ky=class extends Te{};t(Ky,"PlantingForest");hv=Ky});var Ds,Rv=n(()=>{I();Qo();fi();Xi();mm();_y();gh();At();di();Ov();Ds=class extends $e{#e;constructor(e,r,o,s=d,a=lt,m=Ge){super(e,r,o,s,m),this.#e=a}perform(){let[e]=this.ruleRegistry().process(be,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new Hy,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(Is,gv,r),this.#e.unregister(...o),this.from().setTerrain(r)},hv),this.ruleRegistry().process(q,this.unit(),this)}};t(Ds,"PlantForest")});var qy,xv,vv=n(()=>{fr();qy=class extends Te{};t(qy,"Sleeping");xv=qy});var pa,bv,hh=n(()=>{I();fi();_e();w();Xi();T();vv();pa=class extends $e{#e;constructor(e,r,o,s=d,a=Ge,m=N){super(e,r,o,s,a),this.#e=m}perform(){this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new xv(new l(()=>this.from().getSurroundingArea(this.unit().visibility().value()).some(e=>this.#e.getByTile(e).some(r=>r.player()!==this.unit().player()))),new p(()=>{this.unit().setActive(),this.unit().setBusy()})))}};t(pa,"Sleep");bv=pa});var dm,Cv=n(()=>{Rs();dm=class extends Os{perform(){this.unit().setWaiting(),this.unit().cargo().forEach(e=>{e.moves().set(e.movement()),e.activate()})}};t(dm,"Unload")});var gm=n(()=>{Gx();Ex();Yx();Wx();Kx();qx();$x();ev();iv();ov();nv();av();cv();yv();Mp();fv();dv();Rv();hh();Cv()});var Bt,Tv,Oh=n(()=>{$t();Bt=class extends j{};t(Bt,"Arctic");Tv=Bt});var Ce,Pv,Rh=n(()=>{$t();Ce=class extends j{};t(Ce,"Desert");Pv=Ce});var Ae,Iv,xh=n(()=>{$t();Ae=class extends j{};t(Ae,"Hills");Iv=Ae});var Qe,wv,vh=n(()=>{$t();Qe=class extends j{};t(Qe,"Jungle");wv=Qe});var Se,Av,bh=n(()=>{$t();Se=class extends j{};t(Se,"Mountains");Av=Se});var ot,Bv,Ch=n(()=>{Ig();ot=class extends Jt{};t(ot,"Ocean");Bv=ot});var ee,Vy,Jy=n(()=>{$t();ee=class extends j{};t(ee,"River");Vy=ee});var Xe,Gv,Th=n(()=>{$t();Xe=class extends j{};t(Xe,"Swamp");Gv=Xe});var mt,Uv,Ph=n(()=>{$t();mt=class extends j{};t(mt,"Tundra");Uv=mt});var ro=n(()=>{Oh();Rh();_y();pm();xh();vh();bh();Ch();Dp();Jy();Th();Ph()});var Gt,Es,hm=n(()=>{ta();Gt=class extends Ie{};t(Gt,"Air");Es=Gt});var et,$y,Zy=n(()=>{ta();et=class extends Ie{};t(et,"Land");$y=et});var Y,Yt=n(()=>{Zy();Y=class extends $y{};t(Y,"Fortifiable")});var Le,Dn,ul=n(()=>{ta();Le=class extends Ie{};t(Le,"Naval");Dn=Le});var Qy,Xy,Ih=n(()=>{Qy=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}transport(){return this.#e}unit(){return this.#t}};t(Qy,"TransportManifest");Xy=Qy});var ef,En,Om=n(()=>{he();Ih();ef=class extends F{constructor(){super(Xy)}getByTransport(e){return this.getBy("transport",e)}getByUnit(e){let r=this.getBy("unit",e);if(r.length!==1)throw new TypeError("Wrong number of results.");return r[0]}};t(ef,"TransportRegistry");En=new ef});var tf,rf,wh=n(()=>{B();tf=class extends h{};t(tf,"Stowed");rf=tf});var of,Mv,Dv=n(()=>{B();of=class extends h{};t(of,"Unloaded");Mv=of});var uS,Ev,Fv=n(()=>{I();Om();wh();Ih();Dv();uS=t(i=>t(class extends i{#e=d;#t=En;canStow(r){return!this.cargo().includes(r)&&this.hasCapacity()}capacity(){return 0}cargo(){return this.#t.getByTransport(this).map(r=>r.unit())}hasCapacity(){return this.#t.getByTransport(this).length<this.capacity()}hasCargo(){return this.#t.getByTransport(this).length>0}setRuleRegistry(r){this.#e=r}setTransportRegistry(r){this.#t=r}stow(r){return!this.hasCapacity()||!this.canStow(r)?!1:(this.#t.register(new Xy(this,r)),this.#e.process(rf,r,this),!0)}unload(r){try{let o=this.#t.getByUnit(r);return this.#t.unregister(o),this.#e.process(Mv,r,this),!0}catch{return!1}}},"Transport"),"Transport"),Ev=uS});var zt,Fn,cl=n(()=>{I();Om();ul();Fv();zt=class extends Ev(Dn){constructor(e,r,o,s=d,a=En){super(e,r,o,s),this.setRuleRegistry(s),this.setTransportRegistry(a)}};t(zt,"NavalTransport");Fn=zt});var dr,Ah=n(()=>{Zy();dr=class extends $y{};t(dr,"Worker")});var kn=n(()=>{hm();Yt();Zy();ul();cl();Ah()});var en,kv=n(()=>{gi();en=class extends Ne{};t(en,"Coal")});var tn,Sv=n(()=>{gi();tn=class extends Ne{};t(tn,"Fish")});var Oi,Yv=n(()=>{gi();Oi=class extends Ne{};t(Oi,"Game")});var rn,zv=n(()=>{gi();rn=class extends Ne{};t(rn,"Gems")});var on,Nv=n(()=>{gi();on=class extends Ne{};t(on,"Gold")});var Ri,Lv=n(()=>{gi();Ri=class extends Ne{};t(Ri,"Oasis")});var nn,Wv=n(()=>{gi();nn=class extends Ne{};t(nn,"Oil")});var an,jv=n(()=>{gi();an=class extends Ne{};t(an,"Seal")});var Fp=n(()=>{kv();Sv();Yv();zv();Nv();gh();Lv();Wv();jv();ky()});var nf,yl,Bh=n(()=>{B();nf=class extends h{};t(nf,"Action");yl=nf});var af,sf,Gh=n(()=>{B();af=class extends h{};t(af,"ActionPerformed");sf=af});var lf,Rm,Uh=n(()=>{B();lf=class extends h{};t(lf,"Discovered");Rm=lf});var mf,pf,Mh=n(()=>{Z();I();Bh();Gh();Uh();mf=class extends S{#e;#t;constructor(e,r=d){super(),this.#e=r,this.#t=e,this.addKey("tile")}action(e){e.perform(),this.#e.process(sf,this,e)}actions(e){return this.#e.process(yl,this,e)}process(e){this.#e.process(Rm,this,e)}tile(){return this.#t}};t(mf,"GoodyHut");pf=mf});var uf,Yr,Fs=n(()=>{Mh();he();uf=class extends F{constructor(){super(pf)}getByTile(e){let r=this.filter(o=>o.tile()===e);return r.length===0?null:r[0]}};t(uf,"GoodyHutRegistry");Yr=new uf});var Hv=n(()=>{pl()});var Sn=n(()=>{mh();ph();Hv();uh();ch()});var cf,_v,Kv=n(()=>{cf=class{#e;#t;#r;constructor(e,r,o){this.#e=o,this.#t=r,this.#r=e}end(){return this.#e}generate(){throw new Error(`PathFinder#generate: Must be overridden in '${this.constructor.name}'.`)}start(){return this.#t}unit(){return this.#r}};t(cf,"PathFinder");_v=cf});var yf,ff,Dh=n(()=>{Ho();Kv();yf=class extends He{constructor(){super(_v)}};t(yf,"PathFinderRegistry");ff=new yf});var df,zr,ks=n(()=>{Z();df=class extends Ye{};t(df,"Government");zr=df});var gf,xm,hf=n(()=>{Ho();ks();gf=class extends He{constructor(){super(zr)}};t(gf,"AvailableGovernmentRegistry");xm=new gf});var Of,kp,Eh=n(()=>{B();Of=class extends h{};t(Of,"Availability");kp=Of});var Rf,Sp,Fh=n(()=>{B();Rf=class extends h{};t(Rf,"Changed");Sp=Rf});var xf,vf,kh=n(()=>{hf();Z();I();Eh();Fh();xf=class extends S{#e;#t=null;#r;#i;constructor(e,r=xm,o=d){super(),this.#r=e,this.#e=r,this.#i=o,this.addKey("available","current")}available(){return this.#e.filter(e=>this.#i.get(kp).some(r=>r.validate(e,this.#r)))}current(){return this.#t}is(...e){return e.some(r=>this.#t instanceof r)}player(){return this.#r}set(e){this.#t=e,this.#i.process(Sp,this.#r,e)}};t(xf,"PlayerGovernment");vf=xf});var bf,pt,sn=n(()=>{he();kh();bf=class extends F{constructor(){super(vf)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerGovernments for player.");return r[0]}};t(bf,"PlayerGovernmentRegistry");pt=new bf});var Cf,Tf,Sh=n(()=>{uc();Kl();Cf=class extends as{#e;#t;constructor(e,r=wn,o=()=>Math.random()){super(e),this.#e=r,this.#t=o}chooseCivilization(e){let r=e[Math.floor(e.length*this.#t())],o=this.player(),s=new r;o.setCivilization(s),this.chooseLeader(s)}chooseLeader(e){let r=this.#e.getByCivilization(e.constructor),o=r[Math.floor(this.#t()*r.length)];e.setLeader(new o)}};t(Cf,"AIClient");Tf=Cf});var qv=n(()=>{dh()});var ua,Vv=n(()=>{zy();ua=class extends ym{};t(ua,"Veteran")});var Jv=n(()=>{Vv()});var Yp=n(()=>{qv();Jv()});var xi,$v,Yh=n(()=>{M();xi=class extends x{};t(xi,"AdvancedFlight");$v=xi});var io,Zv,zh=n(()=>{M();io=class extends x{};t(io,"Alphabet");Zv=io});var vi,Qv,Nh=n(()=>{M();vi=class extends x{};t(vi,"Astronomy");Qv=vi});var Yn,Xv,Lh=n(()=>{M();Yn=class extends x{};t(Yn,"AtomicTheory");Xv=Yn});var ut,eb,Wh=n(()=>{M();ut=class extends x{};t(ut,"Automobile");eb=ut});var bi,tb,jh=n(()=>{M();bi=class extends x{};t(bi,"Banking");tb=bi});var oo,rb,Hh=n(()=>{M();oo=class extends x{};t(oo,"BridgeBuilding");rb=oo});var Nr,ib,_h=n(()=>{M();Nr=class extends x{};t(Nr,"BronzeWorking");ib=Nr});var Ci,ob,Kh=n(()=>{M();Ci=class extends x{};t(Ci,"CeremonialBurial");ob=Ci});var ln,nb,qh=n(()=>{M();ln=class extends x{};t(ln,"Chemistry");nb=ln});var no,ab,Vh=n(()=>{M();no=class extends x{};t(no,"Chivalry");ab=no});var gr,sb,Jh=n(()=>{M();gr=class extends x{};t(gr,"CodeOfLaws");sb=gr});var Lr,lb,$h=n(()=>{M();Lr=class extends x{};t(Lr,"Combustion");lb=Lr});var Rt,mb,Zh=n(()=>{M();Rt=class extends x{};t(Rt,"Communism");mb=Rt});var Ti,pb,Qh=n(()=>{M();Ti=class extends x{};t(Ti,"Computers");pb=Ti});var Wr,ub,Xh=n(()=>{M();Wr=class extends x{};t(Wr,"Conscription");ub=Wr});var jr,cb,eO=n(()=>{M();jr=class extends x{};t(jr,"Construction");cb=jr});var ao,yb,tO=n(()=>{M();ao=class extends x{};t(ao,"Corporation");yb=ao});var Pi,fb,rO=n(()=>{M();Pi=class extends x{};t(Pi,"Currency");fb=Pi});var so,db,iO=n(()=>{M();so=class extends x{};t(so,"Democracy");db=so});var hr,gb,oO=n(()=>{M();hr=class extends x{};t(hr,"Electricity");gb=hr});var ct,hb,nO=n(()=>{M();ct=class extends x{};t(ct,"Electronics");hb=ct});var mn,Ob,aO=n(()=>{M();mn=class extends x{};t(mn,"Engineering");Ob=mn});var pn,Rb,sO=n(()=>{M();pn=class extends x{};t(pn,"Explosives");Rb=pn});var zn,xb,lO=n(()=>{M();zn=class extends x{};t(zn,"Feudalism");xb=zn});var lo,vb,mO=n(()=>{M();lo=class extends x{};t(lo,"Flight");vb=lo});var ca,bb,pO=n(()=>{M();ca=class extends x{};t(ca,"FusionPower");bb=ca});var un,Cb,uO=n(()=>{M();un=class extends x{};t(un,"GeneticEngineering");Cb=un});var yt,Tb,cO=n(()=>{M();yt=class extends x{};t(yt,"Gunpowder");Tb=yt});var cn,Pb,yO=n(()=>{M();cn=class extends x{};t(cn,"HorsebackRiding");Pb=cn});var xt,Ib,fO=n(()=>{M();xt=class extends x{};t(xt,"Industrialization");Ib=xt});var Or,wb,dO=n(()=>{M();Or=class extends x{};t(Or,"Invention");wb=Or});var Ii,Ab,gO=n(()=>{M();Ii=class extends x{};t(Ii,"IronWorking");Ab=Ii});var yn,Bb,hO=n(()=>{M();yn=class extends x{};t(yn,"LaborUnion");Bb=yn});var Rr,Gb,OO=n(()=>{M();Rr=class extends x{};t(Rr,"Literacy");Gb=Rr});var Nt,Ub,RO=n(()=>{M();Nt=class extends x{};t(Nt,"Magnetism");Ub=Nt});var Hr,Mb,xO=n(()=>{M();Hr=class extends x{};t(Hr,"MapMaking");Mb=Hr});var Lt,Db,vO=n(()=>{M();Lt=class extends x{};t(Lt,"Masonry");Db=Lt});var Wt,Eb,bO=n(()=>{M();Wt=class extends x{};t(Wt,"MassProduction");Eb=Wt});var xr,Fb,CO=n(()=>{M();xr=class extends x{};t(xr,"Mathematics");Fb=xr});var wi,kb,TO=n(()=>{M();wi=class extends x{};t(wi,"Medicine");kb=wi});var _r,Sb,PO=n(()=>{M();_r=class extends x{};t(_r,"Metallurgy");Sb=_r});var Kr,Yb,IO=n(()=>{M();Kr=class extends x{};t(Kr,"Monarchy");Yb=Kr});var jt,zb,wO=n(()=>{M();jt=class extends x{};t(jt,"Mysticism");zb=jt});var nr,Nb,AO=n(()=>{M();nr=class extends x{};t(nr,"Navigation");Nb=nr});var qr,Lb,BO=n(()=>{M();qr=class extends x{};t(qr,"NuclearFission");Lb=qr});var mo,Wb,GO=n(()=>{M();mo=class extends x{};t(mo,"NuclearPower");Wb=mo});var Vr,jb,UO=n(()=>{M();Vr=class extends x{};t(Vr,"Philosophy");jb=Vr});var Ai,Hb,MO=n(()=>{M();Ai=class extends x{};t(Ai,"Physics");Hb=Ai});var fn,_b,DO=n(()=>{M();fn=class extends x{};t(fn,"Plastics");_b=fn});var dn,Kb,EO=n(()=>{M();dn=class extends x{};t(dn,"Pottery");Kb=dn});var Jr,qb,FO=n(()=>{M();Jr=class extends x{};t(Jr,"Railroad");qb=Jr});var gn,Vb,kO=n(()=>{M();gn=class extends x{};t(gn,"Recycling");Vb=gn});var Bi,Jb,SO=n(()=>{M();Bi=class extends x{};t(Bi,"Refining");Jb=Bi});var vt,$b,YO=n(()=>{M();vt=class extends x{};t(vt,"Religion");$b=vt});var $r,Zb,zO=n(()=>{M();$r=class extends x{};t($r,"Robotics");Zb=$r});var po,Qb,NO=n(()=>{M();po=class extends x{};t(po,"Rocketry");Qb=po});var uo,Xb,LO=n(()=>{M();uo=class extends x{};t(uo,"SpaceFlight");Xb=uo});var co,eC,WO=n(()=>{M();co=class extends x{};t(co,"SteamEngine");eC=co});var yo,tC,jO=n(()=>{M();yo=class extends x{};t(yo,"Steel");tC=yo});var fo,rC,HO=n(()=>{M();fo=class extends x{};t(fo,"Superconductor");rC=fo});var Gi,iC,_O=n(()=>{M();Gi=class extends x{};t(Gi,"TheRepublic");iC=Gi});var hn,oC,KO=n(()=>{M();hn=class extends x{};t(hn,"TheWheel");oC=hn});var go,nC,qO=n(()=>{M();go=class extends x{};t(go,"TheoryOfGravity");nC=go});var Ui,aC,VO=n(()=>{M();Ui=class extends x{};t(Ui,"Trade");aC=Ui});var ar,sC,JO=n(()=>{M();ar=class extends x{};t(ar,"University");sC=ar});var vr,lC,$O=n(()=>{M();vr=class extends x{};t(vr,"Writing");lC=vr});var sr=n(()=>{Yh();zh();Nh();Lh();Wh();jh();Hh();_h();Kh();qh();Vh();Jh();$h();Zh();Qh();Xh();eO();tO();rO();iO();oO();nO();aO();sO();lO();mO();pO();uO();cO();yO();fO();dO();gO();hO();OO();RO();xO();vO();bO();CO();TO();PO();IO();wO();AO();BO();GO();UO();MO();DO();EO();FO();kO();SO();YO();zO();NO();LO();WO();jO();HO();_O();KO();qO();VO();JO();$O()});var Mi,mC=n(()=>{ks();Mi=class extends zr{};t(Mi,"Anarchy")});var bt,pC=n(()=>{ks();bt=class extends zr{};t(bt,"Communism")});var nt,uC=n(()=>{ks();nt=class extends zr{};t(nt,"Democracy")});var Ht,cC=n(()=>{ks();Ht=class extends zr{};t(Ht,"Despotism")});var at,yC=n(()=>{ks();at=class extends zr{};t(at,"Monarchy")});var ft,fC=n(()=>{ks();ft=class extends zr{};t(ft,"Republic")});var On=n(()=>{mC();pC();uC();cC();yC();fC()});var Zr,dC=n(()=>{Be();Zr=class extends k{};t(Zr,"Aqueduct")});var lr,gC=n(()=>{Be();lr=class extends k{};t(lr,"Bank")});var Qr,hC=n(()=>{Be();Qr=class extends k{};t(Qr,"Barracks")});var mr,OC=n(()=>{Be();mr=class extends k{};t(mr,"Cathedral")});var ho,RC=n(()=>{Be();ho=class extends k{};t(ho,"CityWalls")});var Xr,xC=n(()=>{Be();Xr=class extends k{};t(Xr,"Colosseum")});var br,vC=n(()=>{Be();br=class extends k{};t(br,"Courthouse")});var _t,bC=n(()=>{Be();_t=class extends k{};t(_t,"Factory")});var ei,CC=n(()=>{Be();ei=class extends k{};t(ei,"Granary")});var Ct,TC=n(()=>{Be();Ct=class extends k{};t(Ct,"HydroPlant")});var Cr,PC=n(()=>{Be();Cr=class extends k{};t(Cr,"Library")});var Tr,IC=n(()=>{Be();Tr=class extends k{};t(Tr,"ManufacturingPlant")});var pr,wC=n(()=>{Be();pr=class extends k{};t(pr,"Marketplace")});var Oo,AC=n(()=>{Be();Oo=class extends k{};t(Oo,"MassTransit")});var Tt,BC=n(()=>{Be();Tt=class extends k{};t(Tt,"NuclearPlant")});var dt,GC,ZO=n(()=>{Be();dt=class extends k{};t(dt,"Palace");GC=dt});var Pt,UC=n(()=>{Be();Pt=class extends k{};t(Pt,"PowerPlant")});var Ro,MC=n(()=>{Be();Ro=class extends k{};t(Ro,"RecyclingCenter")});var xo,DC=n(()=>{Be();xo=class extends k{};t(xo,"SdiDefence")});var Ut,EC=n(()=>{Be();Ut=class extends k{};t(Ut,"Temple")});var Pr,FC=n(()=>{Be();Pr=class extends k{};t(Pr,"University")});var Di=n(()=>{dC();gC();hC();OC();RC();xC();vC();bC();CC();TC();PC();IC();wC();AC();BC();ZO();UC();MC();DC();EC();FC()});var Pf,Ss,kC=n(()=>{Dh();ju();Pf=class extends zl{#e=1/0;end(){return this.entries()[this.length-1]}static for(e,r,o,s=ff){let[a]=s.entries().map(m=>new m(e,r,o)).map(m=>m.generate()).sort((m,u)=>m.movementCost()-u.movementCost());return a&&(a.shift(),a)}movementCost(){return this.#e}setMovementCost(e){this.#e=e}push(...e){e.forEach(r=>{let o=this.end();if(this.length>0&&!r.isNeighbourOf(o))throw new TypeError(`Tile#push: Invalid element passed, ${r.x()},${r.y()} is not a neighbour of ${o.x()},${o.y()}.`);super.push(r)})}start(){return this.entries()[0]}};t(Pf,"Path");Ss=Pf});var vo,SC=n(()=>{Yt();vo=class extends Y{};t(vo,"Artillery")});var bo,YC=n(()=>{ul();bo=class extends Dn{};t(bo,"Battleship")});var Co,zC=n(()=>{hm();Co=class extends Es{};t(Co,"Bomber")});var Ei,NC=n(()=>{Yt();Ei=class extends Y{};t(Ei,"Cannon")});var To,LC=n(()=>{Yt();To=class extends Y{};t(To,"Caravan")});var Po,WC=n(()=>{hm();cl();Po=class extends Fn{canStow(e){return e instanceof Es&&super.canStow(e)}capacity(){return 8}};t(Po,"Carrier")});var Fi,jC=n(()=>{Yt();Fi=class extends Y{};t(Fi,"Catapult")});var ki,HC=n(()=>{Yt();ki=class extends Y{};t(ki,"Chariot")});var Io,_C=n(()=>{ul();Io=class extends Dn{};t(Io,"Cruiser")});var wo,KC=n(()=>{Yt();wo=class extends Y{};t(wo,"Diplomat")});var ur,qC=n(()=>{hm();ur=class extends Es{};t(ur,"Fighter")});var Si,VC=n(()=>{cl();Si=class extends Fn{capacity(){return 4}};t(Si,"Frigate")});var Ir,JC=n(()=>{Yt();Ir=class extends Y{};t(Ir,"Horseman")});var Yi,$C=n(()=>{ul();Yi=class extends Dn{};t(Yi,"Ironclad")});var zi,ZC=n(()=>{Yt();zi=class extends Y{};t(zi,"Knight")});var Ao,QC=n(()=>{Yt();Ao=class extends Y{};t(Ao,"MechanizedInfantry")});var Ni,XC=n(()=>{Yt();Ni=class extends Y{};t(Ni,"Musketman")});var Bo,eT=n(()=>{hm();Bo=class extends Es{};t(Bo,"Nuclear")});var Go,tT=n(()=>{Yt();Go=class extends Y{};t(Go,"Rifleman")});var Li,rT=n(()=>{cl();Li=class extends Fn{capacity(){return 3}};t(Li,"Sail")});var We,iT,QO=n(()=>{Ah();We=class extends dr{};t(We,"Settlers");iT=We});var Wi,oT=n(()=>{Yt();Wi=class extends Y{};t(Wi,"Spearman")});var ti,nT=n(()=>{ul();ti=class extends Dn{};t(ti,"Submarine")});var wr,aT=n(()=>{Yt();wr=class extends Y{};t(wr,"Swordman")});var Uo,sT=n(()=>{Yt();Uo=class extends Y{};t(Uo,"Tank")});var Mo,lT=n(()=>{cl();Mo=class extends Fn{capacity(){return 8}};t(Mo,"Transport")});var Ar,mT=n(()=>{cl();Ar=class extends Fn{capacity(){return 2}};t(Ar,"Trireme")});var Do,pT=n(()=>{Yt();Do=class extends Y{};t(Do,"Warrior")});var Rn=n(()=>{SC();YC();zC();NC();LC();WC();jC();HC();_C();KC();qC();VC();JC();$C();ZC();QC();XC();eT();tT();rT();QO();oT();nT();aT();sT();lT();mT();pT()});var If,wf,Nn,vm=n(()=>{Xl();gm();Qn();rr();Je();ro();K();aa();kn();Fp();Fs();Sn();Kl();Dh();sn();ze();el();Zi();I();Qo();Sr();ma();_e();Sh();rm();rc();Fc();Yp();sr();On();Di();kC();Bu();Rn();Vi();ta();Pe();nm();If=t((i,e,r=L)=>{let o=r.getByTile(i);return o===null?!1:o.player()===e},"hasPlayerCity"),wf=class extends Tf{#e=e=>{let r=this.#A.option("earth",!1),o=this.#p.getByPlayer(this.player()).length===0;if(r&&o)return!0;let s=this.#w.getByTerrain(e.terrain());return(e.terrain()instanceof de||e.terrain()instanceof ee||e.terrain()instanceof ie||s.some(a=>a instanceof Ri)||s.some(a=>a instanceof Oi))&&e.getSurroundingArea().score(this.player(),[[J,4],[H,2],[re,1]])>=160&&!e.getSurroundingArea(4).filter(a=>this.#p.getByTile(a)!==null).length};#t=e=>[Ce,ie,de,ee].some(r=>e.terrain()instanceof r)&&!this.#O.getByTile(e).some(r=>r instanceof we)&&e.getSurroundingArea().some(r=>If(r,this.player(),this.#p))&&[...e.getAdjacent(),e].some(r=>r.terrain()instanceof ee||r.isCoast()||this.#O.getByTile(r).some(o=>o instanceof we)&&this.#p.getByTile(r)===null);#r=e=>[Ae,Se].some(r=>e.terrain()instanceof r)&&!this.#O.getByTile(e).some(r=>r instanceof Ze)&&e.getSurroundingArea().some(r=>If(r,this.player(),this.#p));#i=e=>!this.#O.getByTile(e).some(r=>r instanceof ke)&&e.getSurroundingArea().some(r=>If(r,this.player(),this.#p));#o=new Map;#a=new Map;#n=new Map;#s=[];#l=[];#m=[];#g=[];#y=[];#f=[];#u=[];#p;#v;#R;#b;#d;#C;#T;#P;#h;#I;#w;#O;#x;#c;#A;constructor(e,r=L,o=Qt,s=ye,a=Yr,m=wn,u=ff,y=pt,c=z,f=mi,g=ae,U=d,D=lt,A=Ue,E=or,V=N,se=P){super(e,m),this.#p=r,this.#v=o,this.#R=s,this.#b=a,this.#d=u,this.#C=y,this.#T=c,this.#P=f,this.#h=g,this.#I=U,this.#w=D,this.#x=E,this.#O=A,this.#c=V,this.#A=se}scoreUnitMove(e,r){let o=e.actions(r),{attack:s,buildIrrigation:a,buildMine:m,buildRoad:u,captureCity:y,disembark:c,embark:f,fortify:g,foundCity:U,noOrders:D}=o.reduce((le,je)=>({...le,[je.constructor.name.replace(/^./,ai=>ai.toLowerCase())]:je}),{});if(!o.length||o.length===1&&D||e instanceof Y&&o.length===2&&g&&D)return-1;let A=0;this.#b.getByTile(r)!==null&&(A+=60),(U&&this.#e(r)||m&&this.#r(r)||a&&this.#t(r)||u&&this.#i(r))&&(A+=24);let V=this.#c.getByTile(r).sort((le,je)=>je.defence().value()-le.defence().value()),[se]=V,wt=V.some(le=>le.player()===this.player());e instanceof zt&&e.hasCapacity()&&V.length&&wt&&(A+=10),e instanceof zt&&e.hasCargo()&&r.isCoast()&&r.isWater()&&(A+=16),f&&(A+=16),c&&(A+=16),y&&(A+=100),s&&e.attack()>se.defence()&&(A+=24*(e.attack().value()-se.defence().value())),s&&e.attack().value()>=se.defence().value()&&(A+=16),s&&e.attack().value()>=se.defence().value()*(2/3)&&(A+=8);let Dr=this.#h.getByPlayer(this.player()),Il=r.getNeighbours().filter(le=>!Dr.includes(le)).length;Il>0&&(A+=Il*3);let wl=this.#n.get(e);return wl instanceof ce&&r.distanceFrom(wl)<e.tile().distanceFrom(wl)&&(A+=14),(this.#o.get(e)||[]).includes(r)||(A*=4),A}moveUnit(e){let r=0;for(;e.active()&&e.moves().value()>=.1;){if(r++>1e3){console.log("SimpleAIClient#moveUnit: loopCheck: aborting"),console.log(`${e.player().civilization().name()} ${e.constructor.name}`),console.log(e.actions()),console.log(e.actionsForNeighbours()),e.action(new eo(e.tile(),e.tile(),e));return}let o=this.#a.get(e);if(o){let c=o.shift(),[f]=e.actions(c).filter(g=>g instanceof St);if(f){e.action(f),o.length===0&&this.#a.delete(e);return}if(o.length>0){let g=Ss.for(e,e.tile(),o.end());if(g){this.#a.set(e,g);continue}}this.#a.delete(e)}let[s]=e.tile().getNeighbours().map(c=>[c,this.scoreUnitMove(e,c)]).filter(([,c])=>c>-1).sort(([,c],[,f])=>f-c||Math.floor(Math.random()*3)-1).map(([c])=>c);if(!s){e.action(new eo(e.tile(),e.tile(),e));return}let a=e.actions(s),[m]=a,u=this.#o.get(e)||[],y=this.#n.get(e);if(!m){e.action(new eo(e.tile(),e.tile(),e));return}y===s&&this.#n.delete(e),u.push(s),this.#o.set(e,u.slice(-50)),e.action(m)}e.moves().value()>0&&e.action(new eo(e.tile(),e.tile(),e))}preProcessTurn(){this.#s.splice(0),this.#l.splice(0),this.#m.splice(0),this.#g.splice(0),this.#y.splice(0),this.#f.splice(0),this.#u.splice(0);let e=this.#h.getByPlayer(this.player());e.entries().forEach(r=>{let o=r.tile(),s=this.#p.getByTile(o),a=this.#c.getBy("tile",o),m=this.#u.includes(o)&&![...this.#n.values(),...[...this.#a.values()].map(u=>u.end())].includes(o);s&&s.player()===this.player()&&!a.length&&!this.#u.includes(o)&&!m?this.#u.push(o):s&&s.player()!==this.player()&&s.originalPlayer()===this.player()?this.#s.push(o):s&&s.player()!==this.player()&&!this.#l.includes(o)?this.#l.push(o):a.length&&a.some(u=>u.player()!==this.player())&&this.#m.includes(o)?this.#m.push(o):o.isLand()&&o.getNeighbours().some(u=>!e.includes(u))&&!this.#y.includes(o)&&!m?this.#y.push(o):o.isWater()&&o.getNeighbours().some(u=>!e.includes(u))&&this.#f.includes(o)&&!m&&this.#f.push(o),this.#e(o)&&this.#g.includes(o)&&!m&&this.#g.push(o)}),this.#p.getByPlayer(this.player()).forEach(r=>{let o=this.#c.getByTile(r.tile());gs(r,this.#h,this.#R),!o.length&&!this.#u.includes(r.tile())&&this.#u.push(r.tile())})}takeTurn(){return new Promise((e,r)=>{try{let o=0;this.preProcessTurn();let[s]=this.#C.filter(m=>m.player()===this.player()),[a]=this.#T.filter(m=>m.player()===this.player());for(a.completed(Kr)&&!s.is(at)&&s.set(new at);this.player().hasMandatoryActions();){let m=this.player().mandatoryAction(),u=m.value();if(o++>1e3){console.log(""),console.log(""),console.log(u),u instanceof Ie&&(console.log(u.actions()),u.tile().getNeighbours().forEach(y=>console.log(u.actions(y))),console.log(u.active()),console.log(u.busy()),console.log(u.moves().value()),console.log(this.#x.getByUnit(u))),u.action(new eo(u.tile(),u.tile(),u)),console.error("SimpleAIClient: Couldn't pick an action to do.");break}if(u instanceof Ie){let y=u,c=y.tile(),f=this.#n.get(y),g=y.actions(),{buildIrrigation:U,buildMine:D,buildRoad:A,fortify:E,foundCity:V,unload:se}=g.reduce((De,le)=>({...De,[le.constructor.name.replace(/^./,je=>je.toLowerCase())]:le}),{}),wt=this.#c.getByTile(c);if(this.#o.get(y)||this.#o.set(y,[y.tile()]),y instanceof zt&&se&&c.isCoast()&&y.cargo().some(De=>!c.getNeighbours().some(le=>(this.#o.get(De)||[]).includes(le)))){y.action(se),y.setWaiting();continue}if(y instanceof dr){V&&this.#e(c)?y.action(V):U&&this.#t(c)?y.action(U):D&&this.#r(c)?y.action(D):A&&this.#i(c)?y.action(A):!f&&this.#g.length&&this.#n.set(y,this.#g.shift()),this.moveUnit(y);continue}let[Il]=wt.filter(De=>this.#x.getByUnit(De).some(le=>le instanceof hi)&&y.defence()>De.defence()),wl=this.#p.getByTile(c);if(E&&wl&&(Il||wt.length<=Math.ceil(this.#R.getByCity(wl).size()/5))){y.action(E),Il&&Il.activate();continue}if(!f){if(y instanceof Y&&y.defence().value()>0&&this.#u.length>0){let[De]=this.#u.sort((je,ai)=>je.distanceFrom(y.tile())-ai.distanceFrom(y.tile())),le=Ss.for(y,y.tile(),De,this.#d);le&&(this.#u.splice(this.#u.indexOf(De),1),this.#a.set(y,le))}else if(y.attack().value()>0&&this.#s.length>0){let[De]=this.#s.filter(je=>y instanceof et&&je.isLand()).sort((je,ai)=>je.distanceFrom(y.tile())-ai.distanceFrom(y.tile())),le=Ss.for(y,y.tile(),De,this.#d);le&&(this.#s.splice(this.#s.indexOf(De),1),this.#a.set(y,le))}else if(y.attack().value()>0&&this.#m.length>0){let[De]=this.#m.filter(je=>y instanceof et&&je.isLand()||y instanceof Le&&je.isWater()).sort((je,ai)=>je.distanceFrom(y.tile())-ai.distanceFrom(y.tile())),le=Ss.for(y,y.tile(),De,this.#d);le&&(this.#m.splice(this.#m.indexOf(De),1),this.#a.set(y,le))}else if(y instanceof et&&y.attack().value()>0&&this.#l.length>0){let[De]=this.#l.sort((je,ai)=>je.distanceFrom(y.tile())-ai.distanceFrom(y.tile())),le=Ss.for(y,y.tile(),De,this.#d);le&&(this.#l.splice(this.#l.indexOf(De),1),this.#a.set(y,le))}else if(y instanceof et&&this.#y.length>0){let[De]=this.#y.sort((je,ai)=>je.distanceFrom(y.tile())-ai.distanceFrom(y.tile())),le=Ss.for(y,y.tile(),De,this.#d);le&&(this.#y.splice(this.#y.indexOf(De),1),this.#a.set(y,le))}else if(y instanceof Le&&this.#f.length>0){let[De]=this.#f.sort((je,ai)=>je.distanceFrom(y.tile())-ai.distanceFrom(y.tile())),le=Ss.for(y,y.tile(),De,this.#d);le&&(this.#f.splice(this.#f.indexOf(De),1),this.#a.set(y,le))}}this.moveUnit(y);continue}if(u instanceof Hl){this.buildItemInCity(u.city());continue}if(u instanceof Dl){let y=u.available();y.length&&u.research(y[Math.floor(y.length*Math.random())]);continue}if(m instanceof Ec)break;console.log(`Can't process: '${u.constructor.name}'`);break}e()}catch(o){if(typeof o=="string"){r(new Error(o));return}if(o instanceof Error){r(o);return}r(new Error(`An unknown error occurred: ${o}`))}})}buildItemInCity(e){let r=e.tile(),o=this.#v.getByCity(e),s=this.#c.getByTile(r),a=o.available(),m=[dt,We],u=a.filter(E=>!m.includes(E.item())&&!Object.prototype.isPrototypeOf.call(fe,E.item())),y=a.filter(E=>Object.prototype.isPrototypeOf.call(fe,E.item())),c=u.filter(E=>Object.prototype.isPrototypeOf.call(Ie,E.item())),f=u[Math.floor(u.length*Math.random())].item(),g=t(E=>{let[[V]]=c.map(se=>{let wt=se.item(),Dr=new E;return this.#I.process(ys,wt,Dr),[wt,Dr]}).sort(([,se],[,wt])=>wt.value()-se.value());return V},"getUnitByYield"),U=(E=>()=>E||(E=g(ui)))(),D=(E=>()=>E||(E=g(Ji)))();if(this.#c.getByTile(r).length<2&&U()){o.build(U());return}let A=this.#R.getByCity(o.city());if(a.some(E=>E.item()===We)&&!this.#c.getByCity(o.city()).some(E=>E instanceof We)&&this.#c.getByPlayer(this.player()).filter(E=>E instanceof We).length<3&&A.size()>1){o.build(We);return}if(this.#s.length>0||this.#l.length>0||this.#m.length>4){o.build(D());return}if(s.filter(E=>this.#x.getByUnit(E).filter(V=>V instanceof hi)).length<2||this.#u.length){o.build(U());return}if(o.city().yields().filter(E=>E instanceof H).some(E=>E.value()>4)){let E=y.map(V=>V.item());o.build(E[Math.floor(Math.random()*E.length)])}f&&o.build(f)}cityLost(e,r,o){if(!r)return;let s=this.#h.getByPlayer(this.player());if(o){this.#l.push(...s.entries().filter(a=>If(a.tile(),this.player(),this.#p)).map(a=>a.tile())),this.#m.push(...s.entries().filter(a=>this.#c.getByTile(a.tile()).some(m=>m.player()===r)).map(a=>a.tile()));return}this.#s.push(e.tile())}unitDestroyed(e,r){let o=this.#p.getByTile(e.tile()),s=this.#c.getByTile(e.tile());o&&o.player()===this.player()&&s.length<2&&(this.buildItemInCity(o),this.#P.getByPlayer(this.player()).buy(o))}};t(wf,"SimpleAIClient");Nn=wf});var Af,Eo,fl=n(()=>{he();uc();Af=class extends F{constructor(){super(ix)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of Clients for Player.");return r[0]}};t(Af,"ClientRegistry");Eo=new Af});var ya,dl,bm=n(()=>{kt();ya=class extends me{};t(ya,"American");dl=ya});var cS={};var uT=n(()=>{bm();er();tr();Object.entries({people:"American",nation:"America",colors:["#0055A4","#FFF"]}).forEach(([i,e])=>Re.register(new Oe(dl,i,e)))});var yS={};var cT=n(()=>{bm();Ft();gt();["Washington","New York","Los Angeles","Chicago","Houston","Phoenix","Philadelphia","San Antonio","San Diego","Dallas","San Jose","Austin","Jacksonville","Fort Worth","Columbus","San Francisco","Charlotte","Indianapolis","Seattle","Denver","Boston","El Paso","Detroit","Nashville","Portland","Memphis","Oklahoma City","Las Vegas","Louisville","Baltimore","Milwaukee","Albuquerque","Tucson","Fresno","Mesa","Sacramento","Atlanta","Kansas City","Colorado Springs","Miami","Raleigh","Omaha","Long Beach","Virginia Beach","Oakland","Minneapolis","Tulsa","Arlington","Tampa","New Orleans","Wichita","Cleveland","Bakersfield","Aurora","Anaheim","Honolulu","Santa Ana","Riverside","Corpus Christi","Lexington","Stockton","Henderson","Saint Paul","St. Louis","Cincinnati","Pittsburgh","Greensboro","Anchorage","Plano","Lincoln","Orlando","Irvine","Newark","Toledo","Durham","Chula Vista","Fort Wayne","Jersey City","St. Petersburg","Laredo","Madison","Chandler","Buffalo","Lubbock","Scottsdale","Reno","Glendale","Gilbert","Winston\u2013Salem","North Las Vegas","Norfolk","Chesapeake","Garland","Irving","Hialeah","Fremont","Boise","Richmond","Baton Rouge","Spokane","Des Moines","Tacoma","San Bernardino","Modesto","Fontana","Santa Clarita","Birmingham","Oxnard","Fayetteville","Moreno Valley","Rochester","Glendale","Huntington Beach","Salt Lake City","Grand Rapids","Amarillo","Yonkers","Aurora","Montgomery","Akron","Little Rock","Huntsville","Augusta","Port St. Lucie","Grand Prairie","Columbus","Tallahassee","Overland Park","Tempe","McKinney","Mobile","Cape Coral","Shreveport","Frisco","Knoxville","Worcester","Brownsville","Vancouver","Fort Lauderdale","Sioux Falls","Ontario","Chattanooga","Providence","Newport News","Rancho Cucamonga","Santa Rosa","Oceanside","Salem","Elk Grove","Garden Grove","Pembroke Pines","Peoria","Eugene","Corona","Cary","Springfield","Fort Collins","Jackson","Alexandria","Hayward","Lancaster","Lakewood","Clarksville","Palmdale","Salinas","Springfield","Hollywood","Pasadena","Sunnyvale","Macon","Kansas City","Pomona","Escondido","Killeen","Naperville","Joliet","Bellevue","Rockford","Savannah","Paterson","Torrance","Bridgeport","McAllen","Mesquite","Syracuse","Midland","Pasadena","Murfreesboro","Miramar","Dayton","Fullerton","Olathe","Orange","Thornton","Roseville","Denton","Waco","Surprise","Carrollton","West Valley City","Charleston","Warren","Hampton","Gainesville","Visalia","Coral Springs","Columbia","Cedar Rapids","Sterling Heights","New Haven","Stamford","Concord","Kent","Santa Clara","Elizabeth","Round Rock","Thousand Oaks","Lafayette","Athens","Topeka","Simi Valley","Fargo","Norman","Columbia","Abilene","Wilmington","Hartford","Victorville","Pearland","Vallejo","Ann Arbor","Berkeley","Allentown","Richardson","Odessa","Arvada","Cambridge","Sugar Land","Beaumont","Lansing","Evansville","Rochester","Independence","Fairfield","Provo","Clearwater","College Station","West Jordan","Carlsbad","El Monte","Murrieta","Temecula","Springfield","Palm Bay","Costa Mesa","Westminster","North Charleston","Miami Gardens","Manchester","High Point","Downey","Clovis","Pompano Beach","Pueblo","Elgin","Lowell","Antioch","West Palm Beach","Peoria","Everett","Ventura","Centennial","Lakeland","Gresham","Richmond","Billings","Inglewood","Broken Arrow","Sandy Springs","Jurupa Valley","Hillsboro","Waterbury","Santa Maria","Boulder","Greeley","Daly City","Meridian","Lewisville","Davie","West Covina","League City","Tyler","Norwalk","San Mateo","Green Bay","Wichita Falls","Sparks","Lakewood","Burbank","Rialto","Allen","El Cajon","Las Cruces","Renton","Davenport","South Bend","Vista","Tuscaloosa","Clinton","Edison","Woodbridge","San Angelo","Kenosha","Vacaville"].forEach((i,e)=>$.register(new Q(i,dl,e===0)))});var fT=b(yT=>{"use strict";Object.defineProperty(yT,"__esModule",{value:!0});uT();cT()});var fa,Cm,zp=n(()=>{kt();fa=class extends me{};t(fa,"Aztec");Cm=fa});var fS={};var dT=n(()=>{zp();er();tr();Object.entries({people:"Aztec",nation:"Aztec",colors:["#A1DAB5","#EA6B76"]}).forEach(([i,e])=>Re.register(new Oe(Cm,i,e)))});var dS={};var gT=n(()=>{zp();Ft();gt();["Tenochtitlan","Teotihuacan","Tlatelolco","Texcoco","Tlaxcala","Calixtlahuaca","Xochicalco","Tlacopan","Atzcapotzalco","Tzintzuntzan","Malinalco","Tula","Tamuin","Teayo","Cempoala","Chalco","Tlalmanalco","Ixtapaluca","Huexotla","Tepexpan","Tepetlaoxtoc","Chiconautla","Zitlaltepec","Coyotepec","Tequixquiac","Jilotzingo","Tlapanaloya","Tultitan","Ecatepec","Coatepec","Chalchiuites","Chiauhita","Chapultepec","Itzapalapa","Ayotzinco","Iztapam"].forEach((i,e)=>$.register(new Q(i,Cm,e===0)))});var OT=b(hT=>{"use strict";Object.defineProperty(hT,"__esModule",{value:!0});dT();gT()});var da,Tm,Np=n(()=>{kt();da=class extends me{};t(da,"Babylonian");Tm=da});var gS={};var RT=n(()=>{Np();er();tr();Object.entries({people:"Babylonian",nation:"Babylon",colors:["#D0B8A6","#2f7b00"]}).forEach(([i,e])=>Re.register(new Oe(Tm,i,e)))});var hS={};var xT=n(()=>{Np();Ft();gt();["Babilim","Eshnunna","Diniktum","Tutub","Der","Sippar","Kutha","Jemdet Nasr","Kish","Borsippa","Mashkan-shapir","Dilbat","Nippur","Marad","Adab","Isin","Kisurra","Shuruppak","Bad-tibira","Zabalam","Umma","Girsu","Lagash","Urum","Uruk","Larsa","Ur","Kuara","Eridu","Akshak","Akkad"].forEach((i,e)=>$.register(new Q(i,Tm,e===0)))});var bT=b(vT=>{"use strict";Object.defineProperty(vT,"__esModule",{value:!0});RT();xT()});var ga,Pm,Lp=n(()=>{kt();ga=class extends me{};t(ga,"Chinese");Pm=ga});var OS={};var CT=n(()=>{Lp();er();tr();Object.entries({people:"Chinese",nation:"China",colors:["#ee1c25","#ff0"]}).forEach(([i,e])=>Re.register(new Oe(Pm,i,e)))});var RS={};var TT=n(()=>{Lp();Ft();gt();["Beijing","Shanghai","Chongqing","Tianjin","Guangzhou","Shenzhen\u2020","Chengdu","Nanjing","Wuhan","Xi'an","Hangzhou","Dongguan","Foshan","Shenyang","Harbin","Qingdao","Dalian","Jinan","Zhengzhou","Changsha","Kunming","Changchun","\xDCr\xFCmqi","Shantou","Hefei","Shijiazhuang","Ningbo","Taiyuan","Nanning","Xiamen\u2020","Fuzhou","Changzhou","Wenzhou","Nanchang","Tangshan","Guiyang","Wuxi","Lanzhou","Zhongshan","Handan","Huai'an","Weifang","Zibo","Shaoxing","Yantai","Huizhou","Luoyang","Nantong","Baotou","Liuzhou"].forEach((i,e)=>$.register(new Q(i,Pm,e===0)))});var IT=b(PT=>{"use strict";Object.defineProperty(PT,"__esModule",{value:!0});CT();TT()});var ha,Im,Wp=n(()=>{kt();ha=class extends me{};t(ha,"Egyptian");Im=ha});var xS={};var wT=n(()=>{Wp();er();tr();Object.entries({people:"Egyptian",nation:"Egypt",colors:["#CE1126","#FFF"]}).forEach(([i,e])=>Re.register(new Oe(Im,i,e)))});var vS={};var AT=n(()=>{Wp();Ft();gt();["Cairo","Alexandria","Gizeh","Shubra El-Kheima","Port Said","Suez","Luxor","al-Mansura","El-Mahalla El-Kubra","Tanta","Asyut","Ismailia","Fayyum","Zagazig","Aswan","Damietta","Damanhur","al-Minya","Beni Suef","Qena","Sohag","Hurghada","6th of October City","Shibin El Kom","Banha","Kafr el-Sheikh","Arish","Mallawi","10th of Ramadan City","Bilbais","Marsa Matruh","Idfu","Mit Ghamr","Al-Hamidiyya","Desouk","Qalyub","Abu Kabir","Kafr el-Dawwar","Girga","Akhmim","Matarey"].forEach((i,e)=>$.register(new Q(i,Im,e===0)))});var GT=b(BT=>{"use strict";Object.defineProperty(BT,"__esModule",{value:!0});wT();AT()});var Oa,gl,wm=n(()=>{kt();Oa=class extends me{};t(Oa,"English");gl=Oa});var bS={};var UT=n(()=>{wm();er();tr();Object.entries({people:"English",nation:"England",colors:["#FFF","#C8102E"]}).forEach(([i,e])=>Re.register(new Oe(gl,i,e)))});var CS={};var MT=n(()=>{wm();Ft();gt();["London","Birmingham","Liverpool","Leeds","Sheffield","Bristol","Manchester","Leicester","Coventry","Kingston upon Hull","Stoke-on-Trent","Wolverhampton","Nottingham","Plymouth","Southampton","Reading","Derby","Dudley","Newcastle upon Tyne","Northampton","Portsmouth","Luton","Preston","Sunderland","Norwich","Walsall","Bournemouth","Southend-on-Sea","Swindon","Huddersfield","Poole","Oxford","Middlesbrough","Blackpool","Oldbury","Boldon","Ipswich","York","West Bromwich","Peterborough","Stockport","Brighton","Slough","Gloucester","Rotherham","Cambridge","Exeter","Eastbourne","Sutton Coldfield","Blackburn","Colchester","Oldham","St Helens","Woking","Chesterfield","Crawley"].forEach((i,e)=>$.register(new Q(i,gl,e===0)))});var ET=b(DT=>{"use strict";Object.defineProperty(DT,"__esModule",{value:!0});UT();MT()});var Ra,Am,jp=n(()=>{kt();Ra=class extends me{};t(Ra,"French");Am=Ra});var TS={};var FT=n(()=>{jp();er();tr();Object.entries({people:"French",nation:"France",colors:["#FFF","#0055A4"]}).forEach(([i,e])=>Re.register(new Oe(Am,i,e)))});var PS={};var kT=n(()=>{jp();Ft();gt();["Paris","Marseille","Lyon","Toulouse","Nice","Nantes","Strasbourg","Montpellier","Bordeaux","Lille","Rennes","Reims","Le Havre","Saint-\xC9tienne","Toulon","Grenoble","Dijon","N\xEEmes","Angers","Villeurbanne","Le Mans","Saint-Denis","Aix-en-Provence","Clermont-Ferrand","Brest","Limoges","Tours","Amiens","Perpignan","Metz","Besan\xE7on","Boulogne-Billancourt","Orl\xE9ans","Mulhouse","Rouen","Saint-Denis","Caen","Argenteuil","Saint-Paul","Montreuil","Nancy","Roubaix","Tourcoing","Nanterre","Avignon","Vitry-sur-Seine","Cr\xE9teil","Dunkirk","Poitiers","Asni\xE8res-sur-Seine","Courbevoie","Versailles","Colombes","Fort-de-France","Aulnay-sous-Bois","Saint-Pierre","Rueil-Malmaison","Pau","Aubervilliers","Le Tampon","Champigny-sur-Marne","Antibes","B\xE9ziers","La Rochelle","Saint-Maur-des-Foss\xE9s","Cannes","Calais","Saint-Nazaire","M\xE9rignac","Drancy","Colmar","Ajaccio","Bourges","Issy-les-Moulineaux","Levallois-Perret","La Seyne-sur-Mer","Quimper","Noisy-le-Grand","Villeneuve-d'Ascq","Neuilly-sur-Seine","Valence","Antony","Cergy","V\xE9nissieux","Pessac","Troyes","Clichy","Ivry-sur-Seine","Chamb\xE9ry","Lorient","Les Abymes","Montauban","Sarcelles","Niort","Villejuif","Saint-Andr\xE9","Hy\xE8res","Saint-Quentin","Beauvais","\xC9pinay-sur-Seine","Cayenne","Maisons-Alfort","Cholet","Meaux","Chelles","Pantin","\xC9vry","Fontenay-sous-Bois","Fr\xE9jus","Vannes","Bondy","Le Blanc-Mesnil","La Roche-sur-Yon","Saint-Louis","Arles","Clamart","Narbonne","Annecy","Sartrouville","Grasse","Laval","Belfort","Bobigny","\xC9vreux","Vincennes","Montrouge","Sevran","Albi","Charleville-M\xE9zi\xE8res","Suresnes","Martigues","Corbeil-Essonnes","Saint-Ouen","Bayonne","Cagnes-sur-Mer","Brive-la-Gaillarde","Carcassonne","Massy","Blois","Aubagne","Saint-Brieuc","Ch\xE2teauroux","Chalon-sur-Sa\xF4ne","Mantes-la-Jolie","Meudon","Saint-Malo","Ch\xE2lons-en-Champagne","Alfortville","S\xE8te","Salon-de-Provence","Vaulx-en-Velin","Puteaux","Rosny-sous-Bois","Saint-Herblain","Gennevilliers","Le Cannet","Livry-Gargan","Saint-Priest","Istres","Valenciennes","Choisy-le-Roi","Caluire-et-Cuire","Boulogne-sur-Mer","Bastia","Angoul\xEAme","Garges-l\xE8s-Gonesse","Castres","Thionville","Wattrelos","Talence","Saint-Laurent-du-Maroni","Douai","Noisy-le-Sec","Tarbes","Arras","Al\xE8s","La Courneuve","Bourg-en-Bresse","Compi\xE8gne","Gap","Melun","Le Lamentin","Rez\xE9","Saint-Germain-en-Laye","Marcq-en-Bar\u0153ul","Gagny","Anglet","Draguignan","Chartres","Bron","Bagneux","Colomiers","Saint-Martin-d'H\xE8res","Pontault-Combault","Montlu\xE7on","Jou\xE9-l\xE8s-Tours","Saint-Joseph","Poissy","Savigny-sur-Orge","Cherbourg-Octeville","Mont\xE9limar","Villefranche-sur-Sa\xF4ne","Stains","Saint-Beno\xEEt","Bagnolet","Ch\xE2tillon","Le Port","Sainte-Genevi\xE8ve-des-Bois","\xC9chirolles","Roanne","Villepinte","Saint-Chamond","Conflans-Sainte-Honorine","Auxerre","Nevers","Neuilly-sur-Marne","La Ciotat","Tremblay-en-France","Thonon-les-Bains","Vitrolles","Haguenau","Six-Fours-les-Plages","Agen","Creil","Annemasse","Saint-Rapha\xEBl","Marignane","Romans-sur-Is\xE8re","Montigny-le-Bretonneux","Le Perreux-sur-Marne","Franconville","M\xE2con","Saint-Leu","Cambrai","Ch\xE2tenay-Malabry","Sainte-Marie","Villeneuve-Saint-Georges","Houilles","\xC9pinal","Lens","Li\xE9vin","Les Mureaux","Schiltigheim","La Possession","Meyzieu","Dreux","Nogent-sur-Marne","Plaisir","Mont-de-Marsan","Palaiseau","Ch\xE2tellerault","Goussainville","L'Ha\xFF-les-Roses","Viry-Ch\xE2tillon","Vigneux-sur-Seine","Chatou","Trappes","Clichy-sous-Bois","Rillieux-la-Pape","Villenave-'Ornon","Maubeuge","Charenton-le-Pont","Malakoff","Matoury","Dieppe","Athis-Mons","Savigny-le-Temple","P\xE9rigueux","Baie-Mahault","Vandoeuvre-l\xE8s-Nancy","Pontoise","Aix-les-Bains","Cachan","Vienne","Thiais","Orange","Saint-M\xE9dard-en-Jalles","Villemomble","Saint-Cloud","Saint-Laurent-du-Var","Yerres","Saint-\xC9tienne-du-Rouvray","Sotteville-l\xE8s-Rouen","Draveil","Le Chesnay","Bois-Colombes","Le Plessis-Robinson","La Garenne-Colombes","Lambersart","Soissons","Pierrefitte-sur-Seine","Carpentras","Villiers-sur-Marne","Vanves","Menton","Bergerac","Ermont","Bezons","Grigny","Guyancourt","Saumur","Herblay","Ris-Orangis","Villiers-le-Bel","Bourgoin-Jallieu","Vierzon","Le Gosier","D\xE9cines-Charpieu","H\xE9nin-Beaumont","Fresnes","Aurillac","Sannois","Vallauris","Illkirch-Graffenstaden","Alen\xE7on","\xC9lancourt","Tournefeuille","B\xE8gles","Gonesse","Oullins","Brunoy","Taverny","Armenti\xE8res","Montfermeil","Rambouillet","Villeparisis","Le Kremlin-Bic\xEAtre","Sucy-en-Brie","Kourou","Montb\xE9liard","Romainville","Cavaillon","Saint-Dizier","Br\xE9tigny-sur-Orge","Saint-S\xE9bastien-sur-Loire","Saintes","La Teste-de-Buch","Villeneuve-la-Garenne","B\xE9thune","Bussy-Saint-Georges","Vichy","La Garde","Agde","Laon","Sens","Lunel","Miramas","Biarritz","Le Grand-Quevilly","Orvault","Les Ulis","Champs-sur-Marne","Rochefort","Muret","Sainte-Anne","Eaubonne","\xC9tampes","Gradignan","Vernon","Petit-Bourg","Libourne","Abbeville","Rodez","Saint-Ouen-l'Aum\xF4ne","Torcy","Maisons-Laffitte","Montgeron","Villeneuve-sur-Lot","Cormeilles-en-Parisis","\xC9pernay","S\xE8vres","Dole","Le Robert","Le Bouscat","Blagnac","Frontignan","Cenon","Mandelieu-la-Napoule","Vertou","Les Lilas","Bruay-la-Buissi\xE8re","Les Pavillons-sous-Bois","Chaumont","Roissy-en-Brie","Le Moule","Le Petit-Quevilly","Manosque","Saint-Mand\xE9","Fontenay-aux-Roses","Orly","Le Creusot","Oyonnax","La Madeleine","Sainte-Suzanne","Millau","Combs-la-Ville","Fontaine","Deuil-la-Barre","Coudekerque-Branche","Auch","Lanester","Beaune","Montigny-l\xE8s-Metz","Hazebrouck","Longjumeau","Sainte-Foy-l\xE8s-Lyon","Forbach","Sarreguemines","Mons-en-Bar\u0153ul","La Valette-du-Var","H\xE9rouville-Saint-Clair","Morsang-sur-Orge","Grande-Synthe","La Celle-Saint-Cloud","Lisieux","Croix","Dammarie-les-Lys","V\xE9lizy-Villacoublay","Wasquehal","Saint-Gratien","Halluin","Neuilly-Plaisance","Montmorency","Dax","Lagny-sur-Marne","Le M\xE9e-sur-Seine","Saint-Genis-Laval","Fleury-les-Aubrais","Loos","Gif-sur-Yvette","Denain","Saint-Di\xE9-des-Vosges","Sainte-Rose","Saint-Michel-sur-Orge"].forEach((i,e)=>$.register(new Q(i,Am,e===0)))});var YT=b(ST=>{"use strict";Object.defineProperty(ST,"__esModule",{value:!0});FT();kT()});var xa,hl,Bm=n(()=>{kt();xa=class extends me{};t(xa,"German");hl=xa});var IS={};var zT=n(()=>{Bm();er();tr();Object.entries({people:"German",nation:"Germany",colors:["#000","#FC0"]}).forEach(([i,e])=>Re.register(new Oe(hl,i,e)))});var wS={};var NT=n(()=>{Bm();Ft();gt();["Berlin","Hamburg","Munich","Cologne","Frankfurt","Stuttgart","D\xFCsseldorf","Dortmund","Essen","Leipzig","Bremen","Dresden","Hanover","Nuremberg","Duisburg","Bochum","Wuppertal","Bielefeld","Bonn","M\xFCnster","Karlsruhe","Mannheim","Augsburg","Wiesbaden","Gelsenkirchen","M\xF6nchengladbach","Braunschweig","Chemnitz","Kiel","Aachen","Halle","Magdeburg","Freiburg","Krefeld","L\xFCbeck","Oberhausen","Erfurt","Mainz","Rostock","Kassel","Hagen","Hamm","Saarbr\xFCcken","M\xFClheim an der Ruhr","Potsdam","Ludwigshafen am Rhein","Oldenburg","Leverkusen","Osnabr\xFCck","Solingen"].forEach((i,e)=>$.register(new Q(i,hl,e===0)))});var WT=b(LT=>{"use strict";Object.defineProperty(LT,"__esModule",{value:!0});zT();NT()});var va,Gm,Hp=n(()=>{kt();va=class extends me{};t(va,"Greek");Gm=va});var AS={};var jT=n(()=>{Hp();er();tr();Object.entries({people:"Greek",nation:"Greece",colors:["#2175D8","#FFF"]}).forEach(([i,e])=>Re.register(new Oe(Gm,i,e)))});var BS={};var HT=n(()=>{Hp();Ft();gt();["Athens","Thessaloniki","Patras","Piraeus","Larissa","Heraklion","Peristeri","Kallithea","Acharnes","Kalamaria","Nikaia","Glyfada","Volos","Ilio","Ilioupoli","Keratsini","Evosmos","Chalandri","Nea Smyrni","Marousi","Agios Dimitrios","Zografou","Egaleo","Nea Ionia","Ioannina","Palaio Faliro","Korydallos","Trikala","Vyronas","Agia Paraskevi","Galatsi","Agrinio","Chalcis","Petroupoli","Serres","Alexandroupoli","Xanthi","Katerini","Kalamata","Kavala","Chania","Lamia","Komotini","Irakleio","Rhodes","Kifissia","Stavroupoli","Chaidari","Drama","Veria","Alimos","Kozani","Polichni","Karditsa","Sykies","Ampelokipoi","Pylaia","Agioi Anargyroi","Argyroupoli","Ano Liosia","Nea Ionia","Rethymno","Ptolemaida","Tripoli","Cholargos","Vrilissia","Aspropyrgos","Corinth","Gerakas","Metamorfosi","Giannitsa","Voula","Kamatero","Mytilene","Neapoli","Eleftherio-Kordelio","Chios","Agia Varvara","Kaisariani","Nea Filadelfeia","Moschato","Perama","Salamina","Eleusis","Corfu","Pyrgos","Megara","Kilkis","Dafni","Thebes","Melissia","Argos","Arta","Artemida","Livadeia","Pefki","Oraiokastro","Aigio","Kos","Koropi","Preveza","Naousa","Orestiada","Peraia","Edessa","Florina","Panorama","Nea Erythraia1","Elliniko1","Amaliada","Pallini","Sparta","Agios Ioannis Rentis","Thermi","Vari","Nea Makri","Tavros","Alexandreia","Menemeni","Paiania","Kalyvia Thorikou","Nafplio","Drapetsona","Efkarpia","Papagou","Nafpaktos","Kastoria","Grevena","Pefka","Nea Alikarnassos","Missolonghi","Gazi","Ierapetra","Kalymnos","Rafina","Loutraki","Agios Nikolaos","Ermoupoli","Ialysos","Mandra","Tyrnavos","Glyka Nera","Ymittos","Neo Psychiko"].forEach((i,e)=>$.register(new Q(i,Gm,e===0)))});var KT=b(_T=>{"use strict";Object.defineProperty(_T,"__esModule",{value:!0});jT();HT()});var ba,Um,_p=n(()=>{kt();ba=class extends me{};t(ba,"Indian");Um=ba});var GS={};var qT=n(()=>{_p();er();tr();Object.entries({people:"Indian",nation:"India",colors:["#138808","#FF9933"]}).forEach(([i,e])=>Re.register(new Oe(Um,i,e)))});var US={};var VT=n(()=>{_p();Ft();gt();["Delhi","Mumbai","Bangalore","Hyderabad","Ahmedabad","Chennai","Kolkata","Surat","Pune","Jaipur","Lucknow","Kanpur","Nagpur","Indore","Thane","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara","Ghaziabad","Ludhiana","Agra","Nashik","Faridabad","Meerut","Rajkot","Kalyan-Dombivli","Vasai-Virar","Varanasi","Srinagar","Aurangabad","Dhanbad","Amritsar","Navi Mumbai","Allahabad","Howrah","Ranchi","Gwalior","Jabalpur","Coimbatore","Vijayawada","Jodhpur","Madurai","Raipur","Kota","Chandigarh","Guwahati","Solapur","Hubli\u2013Dharwad","Tiruchirappalli","Bareilly","Moradabad","Mysore","Tiruppur","Gurgaon","Aligarh","Jalandhar","Bhubaneswar","Salem","Mira-Bhayandar","Warangal","Jalgaon","Guntur","Bhiwandi","Saharanpur","Gorakhpur","Bikaner","Amravati","Noida","Jamshedpur","Bhilai","Cuttack","Firozabad","Kochi","Nellore","Bhavnagar","Dehradun","Durgapur","Asansol","Rourkela","Nanded","Kolhapur","Ajmer","Akola","Gulbarga","Jamnagar","Ujjain","Loni","Siliguri","Jhansi","Ulhasnagar","Jammu","Sangli-Miraj & Kupwad","Mangalore","Erode","Belgaum","Ambattur","Tirunelveli","Malegaon","Gaya","Thiruvananthapuram","Udaipur","Maheshtala","Davanagere","Kozhikode","Kurnool","Rajpur Sonarpur","Rajahmundry","Bokaro","South Dumdum","Bellary","Patiala","Gopalpur","Agartala","Bhagalpur","Muzaffarnagar","Bhatpara","Panihati","Latur","Dhule","Tirupati","Rohtak","Korba","Bhilwara","Berhampur","Muzaffarpur","Ahmednagar","Mathura","Kollam","Avadi","Kadapa","Kamarhati","Sambalpur","Bilaspur","Shahjahanpur","Satara","Bijapur","Kakinada","Rampur","Shimoga","Chandrapur","Junagadh","Thrissur","Alwar","Bardhaman","Kulti","Nizamabad","Parbhani","Tumkur","Khammam","Ozhukarai","Bihar Sharif","Panipat","Darbhanga","Bally","Aizawl","Dewas","Ichalkaranji","Karnal","Bathinda","Jalna","Eluru","Barasat","Kirari Suleman Nagar","Purnia","Satna","Mau","Sonipat","Farrukhabad","Sagar","Durg","Imphal","Ratlam","Hapur","Arrah","Anantapur","Karimnagar","Etawah","Ambarnath","North Dumdum","Bharatpur","Begusarai","New Delhi","Gandhidham","Baranagar","Tiruvottiyur","Pondicherry","Sikar","Thoothukudi","Rewa","Mirzapur","Raichur","Pali","Ramagundam","Haridwar","Vijayanagaram","Katihar","Nagercoil","Sri Ganganagar","Karawal Nagar","Mango","Thanjavur","Bulandshahr","Uluberia","Katni","Sambhal","Singrauli","Nadiad","Secunderabad","Naihati","Yamunanagar","Bidhannagar","Pallavaram","Bidar","Munger","Panchkula","Burhanpur","Raurkela Industrial Township","Kharagpur","Dindigul","Gandhinagar","Hospet","Nangloi Jat","Malda","Ongole","Deoghar","Chapra","Haldia","Khandwa","Nandyal","Morena","Amroha","Anand","Bhind","Bhalswa Jahangir Pur","Madhyamgram","Bhiwani","Berhampore","Ambala","Morbi","Fatehpur","Raebareli","Mahaboobnagar","Chittoor","Bhusawal","Orai","Bahraich","Vellore","Mehsana","Raiganj","Sirsa","Danapur","Serampore","Sultan Pur Majra","Guna","Jaunpur","Panvel","Shivpuri","Surendranagar Dudhrej","Unnao","Chinsurah","Alappuzha","Kottayam","Machilipatnam","Shimla","Adoni","Udupi","Tenali","Proddatur","Saharsa","Hindupur","Sasaram","Hajipur","Bhimavaram","Kumbakonam","Dehri","Madanapalle","Siwan","Bettiah","Guntakal","Srikakulam","Motihari","Dharmavaram","Gudivada","Phagwara","Narasaraopet","Suryapet","Miryalaguda","Tadipatri","Karaikudi","Kishanganj","Jamalpur","Ballia","Kavali","Tadepalligudem","Amaravati","Buxar","Jehanabad","Aurangabad","Gangtok"].forEach((i,e)=>$.register(new Q(i,Um,e===0)))});var $T=b(JT=>{"use strict";Object.defineProperty(JT,"__esModule",{value:!0});qT();VT()});var Ca,Mm,Kp=n(()=>{kt();Ca=class extends me{};t(Ca,"Mongol");Mm=Ca});var MS={};var ZT=n(()=>{Kp();er();tr();Object.entries({people:"Mongol",nation:"Mongolia",colors:["#DA2032","#0066B3"]}).forEach(([i,e])=>Re.register(new Oe(Mm,i,e)))});var DS={};var QT=n(()=>{Kp();Ft();gt();["Ulaanbaatar","Erdenet","Darkhan","Choibalsan","M\xF6r\xF6n","Nalaikh","Bayankhongor","\xD6lgii","Khovd","Arvaikheer","Ulaangom","Baganuur","Sainshand","Tsetserleg","S\xFCkhbaatar","\xD6nd\xF6rkhaan","Dalanzadgad","Z\xFC\xFCnkharaa","Uliastai","Altai","Baruun-Urt","Mandalgovi","Zuunmod","Zamyn-\xDC\xFCd","Bulgan","Kharkhorin","Choir","Bor-\xD6nd\xF6r","Sharyngo"].forEach((i,e)=>$.register(new Q(i,Mm,e===0)))});var eP=b(XT=>{"use strict";Object.defineProperty(XT,"__esModule",{value:!0});ZT();QT()});var Ta,Dm,qp=n(()=>{kt();Ta=class extends me{};t(Ta,"Roman");Dm=Ta});var ES={};var tP=n(()=>{qp();er();tr();Object.entries({people:"Roman",nation:"Rome",colors:["#A20101","#D1B24F"]}).forEach(([i,e])=>Re.register(new Oe(Dm,i,e)))});var FS={};var rP=n(()=>{qp();Ft();gt();["Roma","Ariminum","Belum","Placentia","Tarraco","Italica","Mod","Salernum","Bononia","Forum Livii","Regium Lepidi","Aquileia","Ascrivium","Valentia Edetanorum","Scalabis","Villa Euracini","Palma","Colonia Narbo Martius","Massa","Pistoria","Segovia","Gerunda","Pompaelo","Naissus","Brigantium","Florentia","Vesontio","Lutetia Parisiorum","Atuatuca Tungrorum","Iulia Romula Hispalis","Augusta Raurica","Noviodunum","Lugdunum","Siscia","Marsonia","Augusta Treverorum","Castra Legionis","Augusta Taurinorum","Augusta Praetoria Salassorum","Emerita Augusta","Norba Caesarina","Lucus Augusta","Caesarea","Bracara Augusta","Novaesium","Castra Vetera","Pons Drusi","Ovilava","Iuvavum","Augusta Vindelicorum","Turicum","Asturica Augusta","Borbetomagus","Caesaraugusta","Sirmium","Sorviodurum","Mogontiacum","Argentoratum","Bonna","Noviomagus","Castellum apud Confluentes","Divodurum","Caesaromagus","Ambianum","Faventia Paterna Barcino","Abila","Lousonna","Ulpia Noviomagus Batavorum","Rigomagus","Aquae Mattiacorum","Mursa","Emona","Vindonissa","Aventicum","Praetorium Agrippinae","Lugdunum Batavorum","Aequum","Londinium","Albanianis","Lauri","Durovernum Cantiacorum","Regulbium","Rutupiae","Viminacium","Camulodunum","Traiectum","Matilo","Forum Hadriani","Nigrum Pullum","Lindum Colonia","Ratae Corieltauvorum","Durocobrivis","Colonia Agrippina","Durocornovium","Verulamium","Letocetum","Dubris","Danum","Mediolanum","Isca Dumnoniorum","Blestium","Viroconium Cornoviorum","Aquae Sulis","Durnovaria","Lindinis","Ad Flexum","Clausentum","Venta Belgarum","Calleva Atrebatum","Duroliponte","Concangis","Condate","Corinium Dobunnorum","Eboracum","Luguvalium","Arae Flaviae","Isca Augusta","Lagentium","Lopodunum","Moridunum","Venta Silurum","Deva Victrix","Mamucium","Olicana","Vinovia","Bonames","Coria","Gerulata","Vindobona","Biriciana","Cannstatt Castrum","Colonia Nervia Glevensium","Sumelocenna","Lopodunum","Traiectum ad Nicrem","Castra Batavar","Nida","Lactodurum","Bovium","Burgodunum","Lentia","Aquae Granni","Complutum","Aeminium","Traiectum ad Mosam","Coriovallum","Portus Lemanis","Andautonia","Salona","Cibalae","Aquae Helveticae","Aquincum","Apulum","Pons Aelius","Durovigutum","Aelia Capitolina","Ala","Castra Regina","Theranda","Pomaria","Partiscum","Gesoriacum","Aurelia Aquensis","Urbs Aurelianorum","Venetiae","Ragusium"].forEach((i,e)=>$.register(new Q(i,Dm,e===0)))});var oP=b(iP=>{"use strict";Object.defineProperty(iP,"__esModule",{value:!0});tP();rP()});var Pa,Ol,Em=n(()=>{kt();Pa=class extends me{};t(Pa,"Russian");Ol=Pa});var kS={};var nP=n(()=>{Em();er();tr();Object.entries({people:"Russian",nation:"Russia",colors:["#0032A0","#DA291C"]}).forEach(([i,e])=>Re.register(new Oe(Ol,i,e)))});var SS={};var aP=n(()=>{Em();Ft();gt();["Moscow","Saint Petersburg","Novosibirsk","Yekaterinburg","Nizhny Novgorod","Kazan","Chelyabinsk","Omsk","Samara","Ufa","Rostov-on-Don","Krasnoyarsk","Voronezh","Perm","Volgograd","Krasnodar","Saratov","Tyumen","Makhachkala","Tolyatti","Barnaul","Ulyanovsk","Izhevsk","Vladivostok","Irkutsk","Khabarovsk","Yaroslavl","Tomsk","Orenburg","Kemerovo","Novokuznetsk","Tula","Ryazan","Kirov","Astrakhan","Naberezhnye Chelny","Sochi","Penza","Lipetsk","Cheboksary","Balashikha","Kaliningrad","Kursk","Stavropol","Ulan-Ude","Bryansk","Tver","Magnitogorsk","Ivanovo","Belgorod","Surgut","Vladimir","Arkhangelsk","Nizhny Tagil","Kaluga","Chita","Saransk","Yakutsk","Smolensk","Podolsk","Volzhsky","Vladikavkaz","Vologda","Cherepovets","Kurgan","Oryol","Grozny","Murmansk","Tambov","Petrozavodsk","Sterlitamak","Kostroma","Nizhnevartovsk","Novorossiysk","Yoshkar-Ola","Taganrog","Komsomolsk-on-Amur","Khimki","Syktyvkar","Nalchik","Nizhnekamsk","Shakhty","Dzerzhinsk","Bratsk","Orsk","Angarsk","Engels","Blagoveshchensk","Stary Oskol","Veliky Novgorod","Korolyov","Pskov","Mytishchi","Biysk","Lyubertsy","Prokopyevsk","Yuzhno-Sakhalinsk","Balakovo","Armavir","Rybinsk","Severodvinsk","Abakan","Petropavlovsk-Kamchatsky","Norilsk","Syzran","Volgodonsk","Ussuriysk","Kamensk-Uralsky","Novocherkassk","Zlatoust","Elektrostal","Almetyevsk","Krasnogorsk","Salavat","Miass","Nakhodka","Kopeysk","Pyatigorsk","Rubtsovsk","Berezniki","Kolomna","Maykop","Odintsovo","Khasavyurt","Kovrov","Kislovodsk","Neftekamsk","Nefteyugansk","Novocheboksarsk","Serpukhov","Shchyolkovo","Novomoskovsk","Bataysk","Pervouralsk","Domodedovo","Derbent","Cherkessk","Orekhovo-Zuyevo","Nevinnomyssk","Dimitrovgrad","Nazran","Kyzyl","Oktyabrsky","Obninsk","Kaspiysk","Novy Urengoy","Ramenskoye","Kamyshin","Murom","Zhukovsky"].forEach((i,e)=>$.register(new Q(i,Ol,e===0)))});var lP=b(sP=>{"use strict";Object.defineProperty(sP,"__esModule",{value:!0});nP();aP()});var Ia,Fm,Vp=n(()=>{kt();Ia=class extends me{};t(Ia,"Zulu");Fm=Ia});var YS={};var mP=n(()=>{Vp();er();tr();Object.entries({people:"Zulu",nation:"Zulus",colors:["#FFFD1E","#000"]}).forEach(([i,e])=>Re.register(new Oe(Fm,i,e)))});var zS={};var pP=n(()=>{Vp();Ft();gt();["uMgungundlovu","Nobamba","Bulawayo","KwaDukuza","Nongoma","oNdini","Nodwengu","Ndondakusuka","Babanango","Khangela","Kwahlomendlini","Hlobane","eThekwini","Mlambongwenya","Eziqwaqweni","Isiphezi","Masotsheni","Mtunzini","Nyakamubi","Hlatikulu","Mthonjaneni","Empangeni","Pongola","Tungela","Kwamashu","Ingwavuma","Hluhluwe","Mtubatuba","Mhlahlandlela","Mthatha","Maseru","Lobamba","Qunu"].forEach((i,e)=>$.register(new Q(i,Fm,e===0)))});var cP=b(uP=>{"use strict";Object.defineProperty(uP,"__esModule",{value:!0});mP();pP()});var NS={};var yP=n(()=>{G();Yh();O.register($v)});var dP=b(fP=>{"use strict";Object.defineProperty(fP,"__esModule",{value:!0});yP()});var LS={};var gP=n(()=>{G();zh();O.register(Zv)});var OP=b(hP=>{"use strict";Object.defineProperty(hP,"__esModule",{value:!0});gP()});var WS={};var RP=n(()=>{G();Nh();O.register(Qv)});var vP=b(xP=>{"use strict";Object.defineProperty(xP,"__esModule",{value:!0});RP()});var jS={};var bP=n(()=>{G();Lh();O.register(Xv)});var TP=b(CP=>{"use strict";Object.defineProperty(CP,"__esModule",{value:!0});bP()});var HS={};var PP=n(()=>{G();Wh();O.register(eb)});var wP=b(IP=>{"use strict";Object.defineProperty(IP,"__esModule",{value:!0});PP()});var _S={};var AP=n(()=>{G();jh();O.register(tb)});var GP=b(BP=>{"use strict";Object.defineProperty(BP,"__esModule",{value:!0});AP()});var KS={};var UP=n(()=>{G();Hh();O.register(rb)});var DP=b(MP=>{"use strict";Object.defineProperty(MP,"__esModule",{value:!0});UP()});var qS={};var EP=n(()=>{G();_h();O.register(ib)});var kP=b(FP=>{"use strict";Object.defineProperty(FP,"__esModule",{value:!0});EP()});var VS={};var SP=n(()=>{G();Kh();O.register(ob)});var zP=b(YP=>{"use strict";Object.defineProperty(YP,"__esModule",{value:!0});SP()});var JS={};var NP=n(()=>{G();qh();O.register(nb)});var WP=b(LP=>{"use strict";Object.defineProperty(LP,"__esModule",{value:!0});NP()});var $S={};var jP=n(()=>{G();Vh();O.register(ab)});var _P=b(HP=>{"use strict";Object.defineProperty(HP,"__esModule",{value:!0});jP()});var ZS={};var KP=n(()=>{G();Jh();O.register(sb)});var VP=b(qP=>{"use strict";Object.defineProperty(qP,"__esModule",{value:!0});KP()});var QS={};var JP=n(()=>{G();$h();O.register(lb)});var ZP=b($P=>{"use strict";Object.defineProperty($P,"__esModule",{value:!0});JP()});var XS={};var QP=n(()=>{G();Zh();O.register(mb)});var eI=b(XP=>{"use strict";Object.defineProperty(XP,"__esModule",{value:!0});QP()});var eY={};var tI=n(()=>{G();Qh();O.register(pb)});var iI=b(rI=>{"use strict";Object.defineProperty(rI,"__esModule",{value:!0});tI()});var tY={};var oI=n(()=>{G();Xh();O.register(ub)});var aI=b(nI=>{"use strict";Object.defineProperty(nI,"__esModule",{value:!0});oI()});var rY={};var sI=n(()=>{G();eO();O.register(cb)});var mI=b(lI=>{"use strict";Object.defineProperty(lI,"__esModule",{value:!0});sI()});var iY={};var pI=n(()=>{G();tO();O.register(yb)});var cI=b(uI=>{"use strict";Object.defineProperty(uI,"__esModule",{value:!0});pI()});var oY={};var yI=n(()=>{G();rO();O.register(fb)});var dI=b(fI=>{"use strict";Object.defineProperty(fI,"__esModule",{value:!0});yI()});var nY={};var gI=n(()=>{G();iO();O.register(db)});var OI=b(hI=>{"use strict";Object.defineProperty(hI,"__esModule",{value:!0});gI()});var aY={};var RI=n(()=>{G();oO();O.register(gb)});var vI=b(xI=>{"use strict";Object.defineProperty(xI,"__esModule",{value:!0});RI()});var sY={};var bI=n(()=>{G();nO();O.register(hb)});var TI=b(CI=>{"use strict";Object.defineProperty(CI,"__esModule",{value:!0});bI()});var lY={};var PI=n(()=>{G();aO();O.register(Ob)});var wI=b(II=>{"use strict";Object.defineProperty(II,"__esModule",{value:!0});PI()});var mY={};var AI=n(()=>{G();sO();O.register(Rb)});var GI=b(BI=>{"use strict";Object.defineProperty(BI,"__esModule",{value:!0});AI()});var pY={};var UI=n(()=>{G();lO();O.register(xb)});var DI=b(MI=>{"use strict";Object.defineProperty(MI,"__esModule",{value:!0});UI()});var uY={};var EI=n(()=>{G();mO();O.register(vb)});var kI=b(FI=>{"use strict";Object.defineProperty(FI,"__esModule",{value:!0});EI()});var cY={};var SI=n(()=>{G();pO();O.register(bb)});var zI=b(YI=>{"use strict";Object.defineProperty(YI,"__esModule",{value:!0});SI()});var yY={};var NI=n(()=>{G();uO();O.register(Cb)});var WI=b(LI=>{"use strict";Object.defineProperty(LI,"__esModule",{value:!0});NI()});var fY={};var jI=n(()=>{G();cO();O.register(Tb)});var _I=b(HI=>{"use strict";Object.defineProperty(HI,"__esModule",{value:!0});jI()});var dY={};var KI=n(()=>{G();yO();O.register(Pb)});var VI=b(qI=>{"use strict";Object.defineProperty(qI,"__esModule",{value:!0});KI()});var gY={};var JI=n(()=>{G();fO();O.register(Ib)});var ZI=b($I=>{"use strict";Object.defineProperty($I,"__esModule",{value:!0});JI()});var hY={};var QI=n(()=>{G();dO();O.register(wb)});var ew=b(XI=>{"use strict";Object.defineProperty(XI,"__esModule",{value:!0});QI()});var OY={};var tw=n(()=>{G();gO();O.register(Ab)});var iw=b(rw=>{"use strict";Object.defineProperty(rw,"__esModule",{value:!0});tw()});var RY={};var ow=n(()=>{G();hO();O.register(Bb)});var aw=b(nw=>{"use strict";Object.defineProperty(nw,"__esModule",{value:!0});ow()});var xY={};var sw=n(()=>{G();OO();O.register(Gb)});var mw=b(lw=>{"use strict";Object.defineProperty(lw,"__esModule",{value:!0});sw()});var vY={};var pw=n(()=>{G();RO();O.register(Ub)});var cw=b(uw=>{"use strict";Object.defineProperty(uw,"__esModule",{value:!0});pw()});var bY={};var yw=n(()=>{G();xO();O.register(Mb)});var dw=b(fw=>{"use strict";Object.defineProperty(fw,"__esModule",{value:!0});yw()});var CY={};var gw=n(()=>{G();vO();O.register(Db)});var Ow=b(hw=>{"use strict";Object.defineProperty(hw,"__esModule",{value:!0});gw()});var TY={};var Rw=n(()=>{G();bO();O.register(Eb)});var vw=b(xw=>{"use strict";Object.defineProperty(xw,"__esModule",{value:!0});Rw()});var PY={};var bw=n(()=>{G();CO();O.register(Fb)});var Tw=b(Cw=>{"use strict";Object.defineProperty(Cw,"__esModule",{value:!0});bw()});var IY={};var Pw=n(()=>{G();TO();O.register(kb)});var ww=b(Iw=>{"use strict";Object.defineProperty(Iw,"__esModule",{value:!0});Pw()});var wY={};var Aw=n(()=>{G();PO();O.register(Sb)});var Gw=b(Bw=>{"use strict";Object.defineProperty(Bw,"__esModule",{value:!0});Aw()});var AY={};var Uw=n(()=>{G();IO();O.register(Yb)});var Dw=b(Mw=>{"use strict";Object.defineProperty(Mw,"__esModule",{value:!0});Uw()});var BY={};var Ew=n(()=>{G();wO();O.register(zb)});var kw=b(Fw=>{"use strict";Object.defineProperty(Fw,"__esModule",{value:!0});Ew()});var GY={};var Sw=n(()=>{G();AO();O.register(Nb)});var zw=b(Yw=>{"use strict";Object.defineProperty(Yw,"__esModule",{value:!0});Sw()});var UY={};var Nw=n(()=>{G();BO();O.register(Lb)});var Ww=b(Lw=>{"use strict";Object.defineProperty(Lw,"__esModule",{value:!0});Nw()});var MY={};var jw=n(()=>{G();GO();O.register(Wb)});var _w=b(Hw=>{"use strict";Object.defineProperty(Hw,"__esModule",{value:!0});jw()});var DY={};var Kw=n(()=>{G();UO();O.register(jb)});var Vw=b(qw=>{"use strict";Object.defineProperty(qw,"__esModule",{value:!0});Kw()});var EY={};var Jw=n(()=>{G();MO();O.register(Hb)});var Zw=b($w=>{"use strict";Object.defineProperty($w,"__esModule",{value:!0});Jw()});var FY={};var Qw=n(()=>{G();DO();O.register(_b)});var eA=b(Xw=>{"use strict";Object.defineProperty(Xw,"__esModule",{value:!0});Qw()});var kY={};var tA=n(()=>{G();EO();O.register(Kb)});var iA=b(rA=>{"use strict";Object.defineProperty(rA,"__esModule",{value:!0});tA()});var SY={};var oA=n(()=>{G();FO();O.register(qb)});var aA=b(nA=>{"use strict";Object.defineProperty(nA,"__esModule",{value:!0});oA()});var YY={};var sA=n(()=>{G();kO();O.register(Vb)});var mA=b(lA=>{"use strict";Object.defineProperty(lA,"__esModule",{value:!0});sA()});var zY={};var pA=n(()=>{G();SO();O.register(Jb)});var cA=b(uA=>{"use strict";Object.defineProperty(uA,"__esModule",{value:!0});pA()});var NY={};var yA=n(()=>{G();YO();O.register($b)});var dA=b(fA=>{"use strict";Object.defineProperty(fA,"__esModule",{value:!0});yA()});var LY={};var gA=n(()=>{G();zO();O.register(Zb)});var OA=b(hA=>{"use strict";Object.defineProperty(hA,"__esModule",{value:!0});gA()});var WY={};var RA=n(()=>{G();NO();O.register(Qb)});var vA=b(xA=>{"use strict";Object.defineProperty(xA,"__esModule",{value:!0});RA()});var jY={};var bA=n(()=>{G();LO();O.register(Xb)});var TA=b(CA=>{"use strict";Object.defineProperty(CA,"__esModule",{value:!0});bA()});var HY={};var PA=n(()=>{G();WO();O.register(eC)});var wA=b(IA=>{"use strict";Object.defineProperty(IA,"__esModule",{value:!0});PA()});var _Y={};var AA=n(()=>{G();jO();O.register(tC)});var GA=b(BA=>{"use strict";Object.defineProperty(BA,"__esModule",{value:!0});AA()});var KY={};var UA=n(()=>{G();HO();O.register(rC)});var DA=b(MA=>{"use strict";Object.defineProperty(MA,"__esModule",{value:!0});UA()});var qY={};var EA=n(()=>{G();qO();O.register(nC)});var kA=b(FA=>{"use strict";Object.defineProperty(FA,"__esModule",{value:!0});EA()});var VY={};var SA=n(()=>{G();_O();O.register(iC)});var zA=b(YA=>{"use strict";Object.defineProperty(YA,"__esModule",{value:!0});SA()});var JY={};var NA=n(()=>{G();KO();O.register(oC)});var WA=b(LA=>{"use strict";Object.defineProperty(LA,"__esModule",{value:!0});NA()});var $Y={};var jA=n(()=>{G();VO();O.register(aC)});var _A=b(HA=>{"use strict";Object.defineProperty(HA,"__esModule",{value:!0});jA()});var ZY={};var KA=n(()=>{G();JO();O.register(sC)});var VA=b(qA=>{"use strict";Object.defineProperty(qA,"__esModule",{value:!0});KA()});var QY={};var JA=n(()=>{G();$O();O.register(lC)});var ZA=b($A=>{"use strict";Object.defineProperty($A,"__esModule",{value:!0});JA()});var XY,QA,XA=n(()=>{lp();T();K();XY=t((i=P)=>[new Pn(new p((e,r)=>{i.emit("city:building-complete",e,r)}))],"getRules"),QA=XY});var ez,eB,tB=n(()=>{Je();rr();Qn();_e();K();Js();T();ez=t((i=L,e=N,r=ye,o=Qt,s=P)=>[new yr(new p(a=>o.getByCity(a).progress().set(0))),new yr(new p(a=>r.getByCity(a).shrink())),new yr(new p((a,m,u)=>{s.emit("city:captured",a,m,u)})),new yr(new p(a=>e.getByCity(a).forEach(m=>m.destroy())))],"getRules"),eB=ez});var XO,Bf,ri,Ys=n(()=>{Ve();XO=t(i=>i instanceof W?-i.value():-i,"negate"),Bf=class extends W{add(e,r=""){super.add(XO(e),r)}set(e,r=""){super.set(XO(e),r)}subtract(e,r=""){super.subtract(XO(e),r)}};t(Bf,"NegativeYield");ri=t(i=>{["add","set","subtract"].forEach(e=>Object.defineProperty(i.prototype,e,Object.getOwnPropertyDescriptor(Bf.prototype,e)||Object.create(null)))},"makeNegative")});var km,rB,eR=n(()=>{ll();Ys();km=class extends Jo{};t(km,"PopulationSupportFood");ri(km);rB=km});var zs,iB,tR=n(()=>{ll();Ys();zs=class extends Jo{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(zs,"UnitSupportFood");ri(zs);iB=zs});var Ns,rR,iR=n(()=>{om();Ys();Ns=class extends ia{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ns,"UnitSupportProduction");ri(Ns);rR=Ns});var tz,oB,nB=n(()=>{kn();On();rr();sn();_e();kl();w();T();eR();Rn();tR();iR();tz=t((i=ye,e=pt,r=N)=>[new rt(new p(o=>new rB(i.getByCity(o).size()*2))),...[[We,1,Mi,Ht],[We,2,bt,nt,at,ft]].map(([o,s,...a])=>new rt(new l(m=>r.getByCity(m).some(u=>u instanceof o)),new l(m=>e.getByPlayer(m.player()).is(...a)),new p(m=>r.getByCity(m).filter(u=>u instanceof o).map(u=>new iB(s,u))))),new rt(new l(o=>e.getByPlayer(o.player()).is(Mi,Ht)),new l(o=>{let s=i.getByCity(o);return r.getByCity(o).filter(a=>[Gt,Y,Le,dr].some(m=>a instanceof m)).length>s.size()}),new p(o=>{let s=i.getByCity(o);return r.getByCity(o).filter(a=>[Gt,Y,Le,dr].some(m=>a instanceof m)).slice(s.size()).map(a=>new rR(1,a))})),new rt(new l(o=>e.getByPlayer(o.player()).is(bt,nt,at,ft)),new p(o=>r.getByCity(o).filter(s=>[Gt,Y,Le,dr].some(a=>s instanceof a)).map(s=>new rR(1,s))))],"getRules"),oB=tz});var rz,aB,sB=n(()=>{Wl();Qn();rr();Je();K();Sn();Zi();I();Sr();rc();Ic();Eu();T();nm();w();rz=t((i=Ue,e=Qt,r=ye,o=L,s=ae,a=d,m=Tn,u=P)=>[...[we,ke].map(y=>new _o(new l(c=>i.getByTile(c.tile()).every(f=>!(f instanceof y))),new p(c=>i.register(new y(c.tile()))))),new _o(new p(y=>e.register(new Hl(y,m,a)))),new _o(new p(y=>r.register(new il(y,a)))),new _o(new p(y=>o.register(y))),new _o(new p(y=>{u.emit("city:created",y)})),new _o(new p(y=>gs(y,s,r)))],"getRules"),aB=rz});var iz,lB,mB=n(()=>{Je();K();Sr();_e();$s();T();Sn();iz=t((i=Ue,e=L,r=P,o=N)=>[new kr(new p(s=>i.getByTile(s.tile()).filter(a=>a instanceof we).forEach(a=>i.unregister(a)))),new kr(new p((s,a)=>{r.emit("city:destroyed",s,a)})),new kr(new p(s=>o.getByCity(s).forEach(a=>a.destroy())))],"getRules"),lB=iz});var Gf,Uf,oR=n(()=>{B();Gf=class extends h{};t(Gf,"FoodExhausted");Uf=Gf});var oz,pB,uB=n(()=>{T();oR();oz=t(()=>[new Uf(new p(i=>i.shrink()))],"getRules"),pB=oz});var nz,cB,yB=n(()=>{I();w();T();Lg();oR();nz=t((i=d)=>[new up(new l(e=>e.progress().value()>=e.cost().value()),new p(e=>e.grow())),new up(new l(e=>e.progress().value()<0),new p(e=>{i.process(Uf,e)}))],"getRules"),cB=nz});var az,fB,dB=n(()=>{rr();Zi();w();T();Cc();nm();az=t((i=ye,e=ae)=>[new Bn(new p(r=>r.empty())),new Bn(new p(r=>r.cost().set((r.size()+1)*10,"city-grow"))),new Bn(new l(r=>r.city().tilesWorked().length<r.size()+1),new p(r=>gs(r.city(),e,i))),new Bn(new l(r=>r.city().tilesWorked().length>r.size()+1),new p(r=>r.city().tilesWorked().entries().slice(r.size()+1).forEach(o=>r.city().tilesWorked().unregister(o))))],"getRules"),fB=az});var sz,gB,hB=n(()=>{zg();T();sz=t(()=>[new Rc(new p(i=>10*(i.size()+1)))],"getRules"),gB=sz});var xn,Mf=n(()=>{na();Ys();xn=class extends oa{};t(xn,"Corruption");ri(xn)});var Fo,OB,Df=n(()=>{Ve();Fo=class extends W{};t(Fo,"Happiness");OB=Fo});var ji,RB,Jp=n(()=>{Ve();ji=class extends W{};t(ji,"Luxuries");RB=ji});var Kt,Ef=n(()=>{Ve();Kt=class extends W{};t(Kt,"Research")});var Me,Ls,Rl=n(()=>{Ve();Me=class extends W{};t(Me,"Unhappiness");Ls=Me});var Ws=n(()=>{aa();Mf();xc();_l();Df();Jp();eR();Ef();na();Rl();tR();iR()});var Ff,Ln,Sm=n(()=>{B();Ff=class extends h{};t(Ff,"CivilDisorder");Ln=Ff});var kf,ko,Ym=n(()=>{B();kf=class extends h{};t(kf,"ProcessYield");ko=kf});var Sf,xl,Yf=n(()=>{B();Sf=class extends h{};t(Sf,"Unsupported");xl=Sf});var lz,xB,vB=n(()=>{Qn();rr();aa();Ws();I();_e();Sm();w();T();Ym();Yf();lz=t((i=Qt,e=ye,r=N,o=d)=>[new ko(new l(s=>s instanceof J),new p((s,a,m)=>{let u=e.getByCity(a),y=new An(s);m.forEach(c=>{if(!(c instanceof zs)||y.value()>=0)return;let f=c.unit();f!==null&&(o.process(xl,a,f,c),y.subtract(c))}),u.add(y),u.check()})),new ko(new l(s=>s instanceof H),new p((s,a,m)=>{let u=i.getByCity(a),y=s.clone();m.filter(f=>f instanceof Ns).sort((f,g)=>(f.unit()?.tile().distanceFrom(a.tile())??0)-(g.unit()?.tile().distanceFrom(a.tile())??0)).forEach(f=>{if(y.value()>=0)return;let g=f.unit();g!==null&&(o.process(xl,a,g,f),y.subtract(f))});let c=a.yields();o.get(Ln).some(f=>f.validate(a,c))||u.add(y),u.check()}))],"getRules"),xB=lz});var mz,bB,CB=n(()=>{rr();Zi();w();T();Wg();nm();mz=t((i=ye,e=ae)=>[new rl(new l(r=>r.size()>0),new p(r=>r.cost().set((r.size()+1)*10,"city-shrink"))),new rl(new l(r=>r.size()>0),new l(r=>r.city().tilesWorked().length>r.size()+1),new p(r=>r.city().tilesWorked().entries().slice(r.size()+1).forEach(o=>r.city().tilesWorked().unregister(o)))),new rl(new l(r=>r.size()>0),new l(r=>r.city().tilesWorked().length<r.size()+1),new p(r=>gs(r.city(),e,i))),new rl(new l(r=>r.size()<=0),new p(r=>r.city().destroy()))],"getRules"),bB=mz});var zf,ve,cr=n(()=>{Be();he();zf=class extends F{constructor(){super(k)}getByCity(e,r=!1){return this.filter(o=>o.city()===e&&!o.destroyed())}};t(zf,"CityImprovementRegistry");ve=new zf});var pz,TB,PB=n(()=>{On();cr();Ws();sn();T();$n();ZO();Za();Ll();Qi();pz=t((i=ve,e=pt)=>[new Ko(new Jn,new p((r,o)=>{let s=e.getByPlayer(r.player()),[a]=i.filter(c=>c instanceof GC&&r.player()===c.city().player()).map(c=>c.city()),m=Ke(o,re),u=s.is(bt)?10:s.is(nt)?0:a?a.tile().distanceFrom(r.tile()):32,[y]=[[Mi,8],[bt,20],[nt,0],[Ht,12],[at,16],[ft,24]].filter(([c])=>s.is(c)).map(([,c])=>c);return new xn(y?Math.min(Math.floor(m*u*3/(10*y)),m):0,u.toFixed(2))})),new Ko(new Fr(0),new p(r=>r.tilesWorked().entries().flatMap(o=>o.yields(r.player()).flatMap(s=>new s.constructor(s.value(),o.id()+": "+s.values().map(([,a])=>a).join("-"))))))],"getRules"),TB=pz});var uz,IB,wB=n(()=>{Fg();Qn();Je();Xn();w();T();uz=t((i=Qt,e=L)=>[new ht(new l(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).some(o=>!o.building())),new p(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).filter(o=>!o.building()).map(o=>new In(r,o)))),new ht(new l(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).some(o=>!!o.building())),new p(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).filter(o=>!!o.building()).map(o=>new ns(r,o))))],"getRules"),IB=uz});var cz,AB,BB=n(()=>{rr();Je();K();gm();w();Gp();T();cz=t((i=L,e=ye,r=P)=>[new $o(new l((o,s,a)=>a instanceof xs&&a.to()===o.tile()&&i.getByTile(a.to())!==null),new p(o=>{let s=i.getByTile(o.tile());e.getByCity(s).shrink()})),new $o(new p((o,s,a)=>r.emit("unit:defeated",o,s,a)))],"getRules"),AB=cz});var yz,GB,UB=n(()=>{T();Yf();yz=t(()=>[new xl(new p((i,e)=>e.destroy()))],"getRules"),GB=yz});var fz={};var MB=n(()=>{XA();tB();nB();sB();mB();uB();yB();dB();hB();vB();CB();PB();I();wB();BB();UB();d.register(...QA(),...eB(),...oB(),...aB(),...lB(),...pB(),...cB(),...fB(),...gB(),...xB(),...bB(),...TB(),...IB(),...AB(),...GB())});var EB=b(DB=>{"use strict";Object.defineProperty(DB,"__esModule",{value:!0});MB()});var vl,FB=n(()=>{Rl();Ys();vl=class extends Ls{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("cityImprovement")}cityImprovement(){return this.#e}};t(vl,"CityImprovementContent");ri(vl)});var zm,kB=n(()=>{Df();zm=class extends OB{};t(zm,"LuxuryHappiness")});var bl,SB=n(()=>{Rl();Ys();bl=class extends Ls{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(bl,"MartialLaw");ri(bl)});var wa,YB=n(()=>{Rl();wa=class extends Ls{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(wa,"MilitaryUnhappiness")});var Nm,zB=n(()=>{Rl();Nm=class extends Ls{};t(Nm,"PopulationUnhappiness")});var Nf=n(()=>{Ef()});var Lm=n(()=>{FB();Ws();Df();Jp();kB();SB();YB();zB();aa();Nf();Rl()});var Lf,Wf,nR=n(()=>{B();Lf=class extends h{};t(Lf,"CelebrateLeader");Wf=Lf});var dz,NB,LB=n(()=>{rr();Lm();nR();w();Qi();dz=t((i=ye)=>[new Wf(new l(e=>i.getByCity(e).size()>2),new l((e,r=e.yields())=>{let[o,s]=sa(r,Fo,Me);return s===0&&Math.floor(o)>=i.getByCity(e).size()/2}))],"getRules"),NB=dz});var gz,WB,jB=n(()=>{kn();rr();On();Lm();sn();_e();Ll();w();T();gz=t((i=ye,e=pt,r=N)=>[new Ko(new p(o=>new Nm(Math.max(i.getByCity(o).size()-5,0)))),...[[ft,1],[nt,2]].map(([o,s])=>new Ko(new l(a=>{try{return e.getByPlayer(a.player()).is(o)}catch{return!1}}),new l(a=>r.getByCity(a).filter(m=>[Gt,Y,Le].some(u=>m instanceof u)&&m.tile()!==a.tile()).length>0),new p(a=>r.getByCity(a).filter(m=>[Gt,Y,Le].some(u=>m instanceof u)&&m.tile()!==a.tile()).map(m=>new wa(s,m)))))],"getRules"),WB=gz});var hz,HB,_B=n(()=>{Lm();Sm();w();Qi();hz=t(()=>[new Ln(new l((i,e=i.yields())=>{let[r,o]=sa(e,Fo,Me);return o>r}))],"getRules"),HB=hz});var jf,Hi,aR=n(()=>{xg();jf=class extends fu{validate(...e){return!this.criteria().length||this.criteria().some(r=>r.validate(...e))}};t(jf,"Or");Hi=jf});var Oz,KB,qB=n(()=>{On();Di();rr();Lm();cr();sn();ze();I();_e();kl();w();T();kn();Gl();$n();sr();aR();Qi();Oz=t((i=d,e=ye,r=ve,o=pt,s=z,a=N)=>[new rt(new l(m=>o.getByPlayer(m.player()).is(Mi,bt,Ht,at)),new p((m,u)=>a.getByTile(m.tile()).filter(y=>y instanceof Y).slice(0,Math.min(4,Ke(u,Me))).map(y=>new bl(1,y)))),...[[Ut,1],[Ut,1,jt],[Xr,3],[mr,4]].map(([m,u,...y])=>new rt(new tt,new l(c=>r.getByCity(c).some(f=>f instanceof m)),new Hi(new l(c=>y.length===0),new l(c=>y.every(f=>s.getByPlayer(c.player()).completed(f)))),new l((c,f)=>Ke(f,Me)>0),new p((c,f)=>new vl(Math.min(u,Ke(f,Me)),r.getByCity(c).filter(g=>g instanceof m)[0])))),new rt(new Qa,new p((m,u)=>new zm(Math.floor(Ke(u,ji)/2),ji.name)))],"getRules"),KB=Oz});var Hf,Aa,$p=n(()=>{B();Hf=class extends h{};t(Hf,"TurnStart");Aa=Hf});var Rz,VB,JB=n(()=>{Je();K();I();nR();Sm();T();$n();$p();Rz=t((i=L,e=d,r=P)=>[new Aa(new tt,new p(o=>i.getByPlayer(o).forEach(s=>{e.get(Ln).some(a=>a.validate(s,s.yields()))&&r.emit("city:civil-disorder",s),e.get(Wf).some(a=>a.validate(s,s.yields()))&&r.emit("city:leader-celebration",s)})))],"getRules"),VB=Rz});var xz={};var $B=n(()=>{I();LB();jB();_B();qB();JB();d.register(...NB(),...WB(),...HB(),...KB(),...VB())});var QB=b(ZB=>{"use strict";Object.defineProperty(ZB,"__esModule",{value:!0});$B()});var vz={};var XB=n(()=>{Di();Wl();Tn.register(Zr,lr,Qr,mr,ho,Xr,br,_t,ei,Ct,Cr,Tr,pr,Oo,Tt,dt,Pt,Ro,xo,Ut,Pr)});var bz,eG,tG=n(()=>{Di();sr();np();cr();ze();w();T();bz=t((i=ve,e=z)=>[new Zt(new p((r,o)=>new l(()=>!i.getByCity(r).some(s=>s instanceof o)))),...[[Zr,jr],[ho,Lt],[Xr,jr],[br,gr],[ei,dn],[Cr,vr],[pr,Pi],[dt,Lt],[Ut,Ci],[lr,bi],[mr,vt],[_t,xt],[Ct,ct],[Oo,Wt],[Tr,$r],[Tt,mo],[Pt,Bi],[Ro,gn],[xo,fo],[Pr,ar]].map(([r,o])=>new Zt(new l((s,a)=>a===r),new p(s=>new l(()=>e.getByPlayer(s.player()).completed(o))))),...[[lr,pr],[Pr,Cr],[Ct,_t],[Tt,_t],[Pt,_t],[Tr,Ct,Tt,Pt]].map(([r,...o])=>new Zt(new l((s,a)=>a===r),new p(s=>new l(()=>i.getByCity(s).some(a=>o.some(m=>a instanceof m)))))),...[[br,dt],[Ct,Tt,Pt],[Tt,Pt,Ct],[Pt,Ct,Tt]].map(([r,...o])=>new Zt(new l((s,a)=>a===r),new p(s=>new l(()=>i.getByCity(s).every(a=>!o.some(m=>a instanceof m))))))],"getRules"),eG=bz});var Cz,rG,iG=n(()=>{Di();sp();Cz=t(()=>[...[[Zr,120],[Qr,40],[ho,120],[Xr,100],[br,80],[ei,60],[Cr,80],[pr,80],[dt,200],[Ut,40],[lr,120],[mr,160],[_t,200],[Ct,240],[Oo,160],[Tr,320],[Tt,160],[Pt,160],[Ro,200],[xo,200],[Pr,160]].flatMap(([i,e])=>jl(i,e))],"getRules"),rG=Cz});var Tz,oG,nG=n(()=>{cr();Js();T();Di();Pe();Tz=t((i=ve,e=()=>Math.random())=>[new yr(new p(r=>{let o=i.getByCity(r).filter(a=>!(a instanceof fe)),[s]=o.filter(a=>a instanceof dt);for(s&&(s.destroy(),o.splice(o.indexOf(s),1));o.length>0&&e()>.7;){let a=o[Math.floor(e()*o.length)];if(!a)break;a.destroy(),o.splice(o.indexOf(a),1)}}))],"getRules"),oG=Tz});var ue,sR=n(()=>{_l();Ys();ue=class extends lc{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("cityImprovement")}cityImprovement(){return this.#e}};t(ue,"CityImprovementMaintenanceGold");ri(ue)});var _f=n(()=>{Ws();sR();Mf();xc();Jp();Nf();na()});var Pz,aG,sG=n(()=>{Di();sr();cr();ze();_f();kl();w();T();Pz=t((i=ve,e=z)=>[...[[Zr,ue,2],[lr,ue,3],[mr,ue,3],[ho,ue,2],[Xr,ue,2],[br,ue,1],[_t,ue,4],[ei,ue,1],[Ct,ue,4],[Cr,ue,1],[Tr,ue,6],[pr,ue,1],[Oo,ue,4],[Tt,ue,2],[dt,ue,0],[Pt,ue,4],[Ro,ue,2],[xo,ue,4],[Ut,ue,1],[Pr,ue,3]].map(([r,o,s])=>new rt(new l(a=>i.getByCity(a).some(m=>m instanceof r)),new p(a=>{let[m]=i.getByCity(a).filter(u=>u instanceof r);return new o(s,m)}))),...[[Qr,ue,0,null,yt],[Qr,ue,1,yt,ut],[Qr,ue,2,ut,null]].map(([r,o,s,a,m])=>new rt(new l(u=>i.getByCity(u).some(y=>y instanceof r)),new l(u=>a===null||e.getByPlayer(u.player()).completed(a)),new l(u=>m===null||!e.getByPlayer(u.player()).completed(m)),new p(u=>{let[y]=i.getByCity(u).filter(c=>c instanceof r);return new o(s,y)})))],"getRules"),aG=Pz});var Iz,lG,mG=n(()=>{cr();Je();I();Eu();w();T();Di();Iz=t((i=L,e=ve,r=d)=>[new _o(new l(o=>i.getByPlayer(o.player()).length===0),new p(o=>e.register(new dt(o,r))))],"getRules"),lG=Iz});var wz,pG,uG=n(()=>{cr();w();$s();T();wz=t((i=ve)=>[new kr(new l(e=>i.getByCity(e).length>0),new p(e=>i.getByCity(e).forEach(r=>r.destroy())))],"getRules"),pG=wz});var Az,cG,yG=n(()=>{Di();cr();w();T();_f();Cc();Az=t((i=ve)=>[new Bn(new l(e=>!i.getByCity(e.city()).some(r=>r instanceof Zr)),new l(e=>e.size()>10),new p(e=>e.shrink())),new Bn(new l(e=>i.getByCity(e.city()).some(r=>r instanceof ei)),new p(e=>e.add(new An(e.cost().value()/2))))],"getRules"),cG=Az});var Bz,fG,dG=n(()=>{cr();K();Hg();T();Bz=t((i=ve,e=P)=>[new cp(new p(r=>i.register(r))),new cp(new p((r,o)=>{e.emit("city-improvement:created",r,o)}))],"getRules"),fG=Bz});var Gz,gG,hG=n(()=>{Di();cr();_f();w();T();bg();_u();Qi();Gz=t((i=ve)=>[...[[pr,Xt,.5],[pr,ji,.5],[lr,Xt,.5],[lr,ji,.5],[Cr,Kt,.5],[Pr,Kt,.5],[_t,H,.5],[Pt,H,.5],[Ct,H,.5],[Tt,H,.5],[Tr,H,.5],[br,xn,.5]].map(([e,r,o])=>new Zs(new NR,new l(s=>i.getByCity(s).some(a=>a instanceof e)),new p((s,a)=>new r(Math.floor(Ke(a,r)*o),e.name))))],"getRules"),gG=Gz});var Uz,OG,RG=n(()=>{cr();ma();Di();Xc();w();T();Yp();Uz=t((i=ve,e=or)=>[new ea(new l(r=>r.city()!==null),new l(r=>i.getByCity(r.city()).some(o=>o instanceof Qr)),new p(r=>e.register(new ua(r))))],"getRules"),OG=Uz});var Mz={};var xG=n(()=>{I();tG();iG();nG();sG();mG();uG();yG();dG();hG();RG();d.register(...eG(),...rG(),...oG(),...aG(),...lG(),...pG(),...cG(),...fG(),...gG(),...OG())});var bG=b(vG=>{"use strict";Object.defineProperty(vG,"__esModule",{value:!0});XB();xG()});var TG={};nu(TG,{default:()=>Dz,registerCityNames:()=>CG});var CG,Dz,PG=n(()=>{Ft();gt();CG=t((i=$)=>{["Bergen","Cannae","Capua","Cordoba","Cremona","Crete","Cunaxa","Damascus","Dublin","Genoa","Ghent","Issus","Lisbon","Mecca","Melbourne","Milan","Naples","Pisa","Prague","Salamis","Salzburg","Seville","Sidon","Sydney","Tarsus","Toronto","Turin","Tyre","Utica","Venice","Verona"].forEach(e=>i.register(new Q(e,null)))},"registerCityNames"),Dz=CG});var lR=n(()=>{bm();zp();Np();Lp();Wp();wm();jp();Bm();Hp();_p();Kp();qp();Em();Vp()});var Kf,qf,mR=n(()=>{Ho();kt();Kf=class extends He{constructor(){super(me)}};t(Kf,"CivilizationRegistry");qf=new Kf});var wG={};nu(wG,{default:()=>Ez,registerCivilizations:()=>IG});var IG,Ez,AG=n(()=>{lR();mR();IG=t((i=qf)=>{i.register(ya,fa,da,ga,ha,Oa,Ra,xa,va,ba,Ca,Ta,Pa,Ia)},"registerCivilizations"),Ez=IG});var Ba,BG=n(()=>{st();bm();Ba=class extends te{static civilization(){return dl}name(){return"Abraham Lincoln"}};t(Ba,"AbrahamLincoln")});var GG=n(()=>{st();bm()});var UG=n(()=>{BG();GG()});var Ga,MG=n(()=>{st();zp();Ga=class extends te{static civilization(){return Cm}name(){return"Moctezuma II"}};t(Ga,"MoctezumaII")});var DG=n(()=>{MG()});var Ua,EG=n(()=>{st();Np();Ua=class extends te{static civilization(){return Tm}name(){return"Hammurabi"}};t(Ua,"Hammurabi")});var FG=n(()=>{EG()});var Ma,kG=n(()=>{st();Lp();Ma=class extends te{static civilization(){return Pm}name(){return"Mao Zedong"}};t(Ma,"MaoZedong")});var SG=n(()=>{kG()});var Da,YG=n(()=>{st();Wp();Da=class extends te{static civilization(){return Im}name(){return"Ramesses II"}};t(Da,"RamessesII")});var zG=n(()=>{YG()});var Ea,NG=n(()=>{st();wm();Ea=class extends te{static civilization(){return gl}name(){return"Elizabeth I"}};t(Ea,"ElizabethI")});var LG=n(()=>{st();wm()});var WG=n(()=>{NG();LG()});var Fa,jG=n(()=>{st();jp();Fa=class extends te{static civilization(){return Am}name(){return"Napoleon I"}};t(Fa,"NapoleonI")});var HG=n(()=>{jG()});var ka,_G=n(()=>{st();Bm();ka=class extends te{static civilization(){return hl}name(){return"Frederick the Great"}};t(ka,"FrederickTheGreat")});var KG=n(()=>{st();Bm()});var qG=n(()=>{_G();KG()});var Sa,VG=n(()=>{st();Hp();Sa=class extends te{static civilization(){return Gm}name(){return"Alexander the Great"}};t(Sa,"AlexanderTheGreat")});var JG=n(()=>{VG()});var Ya,$G=n(()=>{st();_p();Ya=class extends te{static civilization(){return Um}name(){return"Mahatma Gandhi"}};t(Ya,"MahatmaGandhi")});var ZG=n(()=>{$G()});var za,QG=n(()=>{st();Kp();za=class extends te{static civilization(){return Mm}name(){return"Genghis Khan"}};t(za,"GenghisKhan")});var XG=n(()=>{QG()});var Na,eU=n(()=>{st();qp();Na=class extends te{static civilization(){return Dm}name(){return"Julius Caesar"}};t(Na,"JuliusCaesar")});var tU=n(()=>{eU()});var rU=n(()=>{st();Em()});var La,iU=n(()=>{st();Em();La=class extends te{static civilization(){return Ol}name(){return"Joseph Stalin"}};t(La,"JosephStalin")});var oU=n(()=>{rU();iU()});var Wa,nU=n(()=>{st();Vp();Wa=class extends te{static civilization(){return Fm}name(){return"Shaka"}};t(Wa,"Shaka")});var aU=n(()=>{nU()});var pR=n(()=>{UG();DG();FG();SG();zG();WG();HG();qG();JG();ZG();XG();tU();oU();aU()});var lU={};nu(lU,{default:()=>Fz,registerLeaders:()=>sU});var sU,Fz,mU=n(()=>{pR();Kl();sU=t((i=wn)=>{i.register(Ba,Ga,Ua,Ma,Da,Ea,Fa,ka,Sa,Ya,za,Na,La,Wa)},"registerLeaders"),Fz=sU});var Vf,Wm,Jf=n(()=>{mp();Vf=class extends ss{};t(Vf,"Aggression");Wm=Vf});var $f,jm,pU=n(()=>{Jf();$f=class extends Wm{constructor(e){super(e,1)}};t($f,"Aggressive");jm=$f});var Zf,Hm,Qf=n(()=>{mp();Zf=class extends ss{};t(Zf,"Militarism");Hm=Zf});var Xf,ja,uU=n(()=>{Qf();Xf=class extends Hm{constructor(e){super(e,0)}};t(Xf,"Civilized");ja=Xf});var ed,_m,td=n(()=>{mp();ed=class extends ss{};t(ed,"Development");_m=ed});var rd,Km,cU=n(()=>{td();rd=class extends _m{constructor(e){super(e,1)}};t(rd,"Expansionist");Km=rd});var id,od,yU=n(()=>{Jf();id=class extends Wm{constructor(e){super(e,0)}};t(id,"Friendly");od=id});var nd,ad,fU=n(()=>{Qf();nd=class extends Hm{constructor(e){super(e,1)}};t(nd,"Militaristic");ad=nd});var sd,Cl,dU=n(()=>{Jf();sd=class extends Wm{constructor(e){super(e,.5)}};t(sd,"Normal");Cl=sd});var ld,qm,gU=n(()=>{td();ld=class extends _m{constructor(e){super(e,.5)}};t(ld,"Normal");qm=ld});var md,pd,hU=n(()=>{Qf();md=class extends Hm{constructor(e){super(e,.5)}};t(md,"Normal");pd=md});var ud,Zp,OU=n(()=>{td();ud=class extends _m{constructor(e){super(e,0)}};t(ud,"Perfectionist");Zp=ud});var xU={};nu(xU,{default:()=>kz,registerTraits:()=>RU});var RU,kz,vU=n(()=>{pR();kg();pU();uU();cU();yU();fU();dU();gU();hU();OU();RU=t((i=fc)=>{[[Ba,od,qm,ja],[Ga,Cl,Zp,ja],[Ua,od,Zp,ja],[Ma,Cl,qm,ja],[Da,Cl,qm,ja],[Ea,Cl,Km,pd],[Fa,jm,Km,ja],[ka,jm,Zp,ja],[Sa,Cl,Km,ad],[Ya,od,Zp,pd],[za,jm,Km,ad],[Na,Cl,Km,ja],[La,jm,qm,ad],[Wa,jm,qm,pd]].forEach(([e,...r])=>r.forEach(o=>i.register(new o(e))))},"registerTraits"),kz=RU});var CU=b(bU=>{"use strict";Object.defineProperty(bU,"__esModule",{value:!0});var Sz=(PG(),R(TG)),Yz=(AG(),R(wG)),zz=(mU(),R(lU)),Nz=(vU(),R(xU));(0,Sz.default)();(0,Yz.default)();(0,zz.default)();(0,Nz.default)()});var cd,yd,uR=n(()=>{cd=class{#e=[];constructor(...e){this.#e.push(...e)}isBetween(...e){return e.every(r=>this.#e.includes(r))&&e.length===this.#e.length}players(){return this.#e}};t(cd,"Interaction");yd=cd});var fd,TU,PU=n(()=>{he();uR();fd=class extends F{constructor(){super(yd)}getByPlayer(e){return this.entries().filter(r=>r.players().includes(e))}getByPlayers(...e){return this.entries().filter(r=>r.isBetween(...e))}};t(fd,"InteractionRegistry");TU=new fd});var Vm,IU=n(()=>{uR();Vm=class extends yd{constructor(...e){let r=e.map(o=>o.player());super(...r)}};t(Vm,"Contact")});var wU=n(()=>{IU()});var Lz,AU,BU=n(()=>{PU();_e();wU();w();T();At();Lz=t((i=TU,e=N)=>[new q(new l(r=>r.tile().getNeighbours().some(o=>e.getByTile(o).some(s=>s.player()!==r.player()))),new p(r=>r.tile().getNeighbours().forEach(o=>e.getByTile(o).filter(s=>s.player()!==r.player()).forEach(s=>i.register(new Vm(r,s))))))],"getRules"),AU=Lz});var Wz={};var GU=n(()=>{I();BU();d.register(...AU())});var MU=b(UU=>{"use strict";Object.defineProperty(UU,"__esModule",{value:!0});GU()});var dd,gd,cR=n(()=>{dd=class{#e;#t;#r;constructor(e,r,o){this.#e=e,this.#t=r,this.#r=o}civilizationType(){return this.#e}mapGenerator(){return this.#t}startTile(){return this.#r}startTileForMap(e){let{x:r,y:o}=this.#r;return e.get(r,o)}};t(dd,"CivilizationStartTile");gd=dd});var jz,vn,yR=n(()=>{jz=t((i,e,r,o)=>{for(;r<0;)r+=e;for(;o<0;)o+=i;return r=r%e,o=o%i,o*e+r},"coordsToIndex"),vn=jz});var Hz,Tl,hd=n(()=>{Hz=t((i,e,r)=>{let o=i*e;for(;r<0;)r+=o;return r=r%o,[r%e,Math.floor(r/e)]},"indexToCoords"),Tl=Hz});var _z,DU,EU=n(()=>{hd();_z=t((i,e,r,o)=>{let[s,a]=Tl(i,e,r),[m,u]=Tl(i,e,o),y=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[c]=y.map(([f,g])=>[f*e,g*i]).map(([f,g])=>[s-m+f,a-u+g]).map(f=>Math.hypot(...f)).sort((f,g)=>f-g);return c},"distanceFrom"),DU=_z});var Kz,Pl,fR=n(()=>{yR();hd();Kz=t((i,e,r,o=!0)=>{let[s,a]=Tl(i,e,r),m=vn(i,e,s,a-1),u=vn(i,e,s+1,a-1),y=vn(i,e,s+1,a),c=vn(i,e,s+1,a),f=vn(i,e,s,a+1),g=vn(i,e,s-1,a+1),U=vn(i,e,s-1,a),D=vn(i,e,s-1,a-1);return o?[m,y,f,U]:[m,u,y,c,f,g,U,D]},"getNeighbours"),Pl=Kz});var Jm,Od,Rd=n(()=>{yR();EU();fR();hd();Jm=class{#e;#t;#r;constructor(e,r,o={}){this.#e=e,this.#t=o,this.#r=r}coordsToIndex(e,r){return vn(this.#e,this.#r,e,r)}distanceFrom(e,r){return DU(this.#e,this.#r,e,r)}generate(){throw new Error(`Generator#generate(): Must be overridden in '${this.constructor.name}'.`)}getNeighbours(e,r=!0){return Pl(this.#e,this.#r,e,r)}height(){return this.#e}indexToCoords(e){return Tl(this.#e,this.#r,e)}options(){return this.#t}width(){return this.#r}};t(Jm,"Generator");Od=Jm});var qz,xd,$m,vd=n(()=>{Oh();Rh();_y();Rd();pm();xh();vh();bh();Ch();Dp();Jy();Th();Ph();qz={A:Tv,D:Pv,F:Hy,G:ws,H:Iv,J:wv,M:Av,O:Bv,P:lm,R:Vy,S:Gv,T:Uv},xd=class extends Od{async generate(){return Array.from(`OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOAAAAAAAOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOAAOAOAAAOAAAAAAAAOOOOOOAOOOOOGGOOOOOTAGOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOTTTTAOOOOAAAAAAAAOOOOAAAAAATOOOOOAAOOOOOOOOOOOOOOOAAOOOOOTOOOOOOOOOOOOOOOOOO
OOOTTTTTTTTTAAOAOAAAAAOOOAAAAATOOOOOOOOOOOOOOOAOOOOOFFAAFFFFFOOFFFOOOOFFFOOOOOOO
OTPTGPPPPTTTTTOTAAAOOAOOOAAAATOOOOOOOOOOOOOOOAOOAAOFFGAFFFFFFFAFFFFFFFFFFOTOOOOO
OOOOOPGTPTOOTTAAAAAAAAOOAAGGOOOOOOOOOOGAAOOOOOOGOGFFFGFFFFFFFFAFFAFFFFFGFGGOOOOO
OOOOOGGFGPPTTAAOOOAOTOOOAGOOOOAOOOOOOAFGFPGFOAAFGTGFFFFFFFFFFFFFFFGFFGOGFFOOOOOO
OOOOPMGFPPPPTTOOOATAAOOOOOOOOOOOOOOOGFPGGFOFFFFFFGFFFFFFFFFFFFFFGFFFFGOOFOOOOOOO
OOOOPMGFGPPOTTTAATTTTOOOOOOOOOOHOOOPFGOGGGFFFGFGGGFFFFFFFFFFFFFFFFFFOOOOFGOOOOOO
OOOOPHFFGPGOPPPOPTTTTOOOOOOOOOGROOOOOPOGFGFFGFFFGFGFGGFGGFFFGFFFFFFFGOOOOPOOOOOO
OOOOGGHFGPPPPPPPPPTPPOOOOOOOOOOFOOOFOOOFFFRFFFFRGFPFFPFGPFGFFOFFFFFGPPGOOOOOOOOO
OOOGGGMGGGPPPOPPPPPOPOOOOOOOOOGGOOOGPPFFFGRRFRRRGGFGGGGGPGGFFFFDPPPPPPOOOOOOOOOO
OOOGGFMGRGRPGORRGOPOOOOOOOOOOOOOOGRGGGGFFGFRFRPGPGGGGGPPPPPPPPPPPPPPGPGOOOOOOOOO
OOGGGMMGRGRGGGGOOOOOOOOOOOOOOOOOGGRMMGGGGPGRPRRPPPPPPPPPPPPPPPPPPPPPGPGOPGOOOOOO
OOGGPPHGRRRGGGOOOOOOOOOOOOOOOOOOPGGGGFGRRGPRPDOOPPOPPPDPDDDPPPPPPDPPPGOOGOOOOOOO
OOGFPPFGGRGGGPOOOOOOOOOOOOOOOOPPPPOGHOOGRFOOOHPOGPPDPDPDDPPPPPPDDPPOPGOOMGOOOOOO
OOGPPDDGGRGGOOOOOOOOOOOOOOOOOOPPPOOOGHOOOGPPPPPOPPPPDPPHPDDDDDDPPPGOOOOOOPOOOOOO
OOPOGDDPOOOPOOOOOOOOOOOOOOOOOOOOOOOOOGOOOOOPPPPGPPPPPPHHMHHHHHHHHMHPGOOGOOOOOOOO
OOPOGDDOOOOPOOOOOOOOOOOOOOOOOOGPPDDOOOOOOOOPPRRHPPPDPPHPGHMMMMMHHHPPPGOOOOOOOOOO
OOOOGDGOOOOOOOOOOOOOOOOOOOOOOODPHHPPPGODPOPPPGRRPPPPPHHRDPGMHHMHHPPRRROOOOOOOOOO
OOOOGGPOPOOOGPOOOOOOOOOOOOOOOPPHDDDPPPPDDRGDPPDOPPPPHPRRDGGGHHHHHPGPPPOOOOOOOOOO
OOOOOGGPGOOOOGPOOOOOOOOOOOOOPPDDDDDPDDDDDRDOPDDOOOOHHRRDPGGRGGGHGPGGPOOOOOOOOOOO
OOOOOOOOGGOOOOOOOOOOOOOOOOOOPDDDDDDDDDDDSRSODDDDDDOOOOPPGGGRRPPGFGGGOOOGOOOOOOOO
OOOOOOOOOGOOOOOOOOOOOOOOOOOPDDDDDDPPPDDDDRDOOPDDDDPOOOOGGGGGOOGGGGGOOOOPGOOOOOOO
OOOOOOOOOPPOGPPGOOOOOOOOOOODDDDDDDPDDDDDDRDDOODDDDOOOOOOGGGOOOPPGGOOOOOGGOOOOOOO
OOOOOOOOOOPGFPPPGOOOOOOOOOODDDDDDDDPDPDPPDHHDOOPDOOOOOOOGGOOOOOGGGGOOOOOFGOOOOOO
OOOOOOOOOOOGHGGGGGGOOOOOOOOPPDPPPPDDDPPPPPPMDPOOGOOOOOOOPGOOOOOOOGGOOOOOOGOOOOOO
OOOOOOOOOOOHJJJGGGGROOOOOOOOPPDPPPPPPPPPPPPHMDPOOOOOOOOOOGOOOOOOOOOOOPOOOOOOOOOO
OOOOOOOOOOGHJRRJJRRRGOOOOOOOOPPPGOPPGPGGGGGGMDDPOOOOOOOOOOOOOOOOOOOGPPOOGPOOOOOO
OOOOOOOOOOPGJJRRRRJGFGGOOOOOOOOOOOOGGGGJJJGGODPPOOOOOOOOOOOOOOOGFGOOPGFGGGOGOOOO
OOOOOOOOOOOFGGJJGJJFGGGPOOOOOOOOOOOGGJJRRRGGHPPOOOOOOOOOOOOOOOOOGFOOGOPGOOOPGGOO
OOOOOOOOOOOGHGGGGGGGGGGOOOOOOOOOOOOGGRRRJJHOGGOOOOOOOOOOOOOOOOOOOGOOOOOOOOOOOGGO
OOOOOOOOOOOOGMFGGGGGGPOOOOOOOOOOOOOOGRJJJGHMGOOOOOOOOOOOOOOOOOOOOPPOOOOOGOOOOOOO
OOOOOOOOOOOOGFMGGFGPPPOOOOOOOOOOOOOORRGGGGGMPOOOOOOOOOOOOOOOOOOOOOGOOOOOOOPGOOOO
OOOOOOOOOOOOOOHMGGRPGGOOOOOOOOOOOOOOOGGGGGGHGOOOOOOOOOOOOOOOOOOOOOOOOOOGGPGPGGOO
OOOOOOOOOOOOOOGHGGRGGOOOOOOOOOOOOOOOODPPGGGGGGOOOOOOOOOOOOOOOOOOOOOOOOOGGPPPPGOO
OOOOOOOOOOOOOOGMGPRROOOOOOOOOOOOOOOOPPPPPPPGGGOPOOOOOOOOOOOOOOOOOOOOGGPPPDDDPPPO
OOOOOOOOOOOOOOGMGGGPOOOOOOOOOOOOOOOOHPDDPPGGOOOPOOOOOOOOOOOOOOOOOOOGGGPDDDDDDPFO
OOOOOOOOOOOOOOPMGGGOOOOOOOOOOOOOOOOOOPPDPPGGOOOGOOOOOOOOOOOOOOOOOOOGPDDDDDDDDPPO
OOOOOOOOOOOOOOOMGPOOOOOOOOOOOOOOOOOOOHPPPGGGOOGPOOOOOOOOOOOOOOOOOOOGDDDDDPDDDPGO
OOOOOOOOOOOOOOOGGOOOOOOOOOOOOOOOOOOOOHPPGHGOOOPOOOOOOOOOOOOOOOOOOOODDDDDDDPDDHFO
OOOOOOOOOOOOOOOPGOOOOOOOOOOOOOOOOOOOOODPGHGOOOOOOOOOOOOOOOOOOOOOOOODDDOOGDDDHGOO
OOOOOOOOOOOOOOOOGOOOOOOOOOOOOOOOOOOOOOPGGGOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOGHHHGOOO
OOOOOOOOOOOOOOOOFOOOOOOOOOOOOOOOOOOOOOGOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOPGOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
`.replace(/\n/g,"")).map(e=>new qz[e])}height(){return 50}width(){return 80}};t(xd,"Earth");$m=xd});var bd,FU,kU=n(()=>{cR();vd();bd=class extends gd{constructor(e,r){super(e,$m,r)}};t(bd,"EarthStartTile");FU=bd});var Qp,rTe,SU,YU=n(()=>{cR();he();Qp=class extends Al{constructor(){super(gd)}getByCivilization(e){let[r]=this.getBy("civilizationType",e);if(!r)throw new TypeError(`${e.name} does not have a registered start tile.`);return r}getStartTileByCivilizationAndWorld(e,r){return this.getByCivilization(e).startTileForMap(r)}};t(Qp,"CivilizationStartTileRegistry");rTe=new Qp,SU=Qp});var Cd,Td,dR=n(()=>{YU();vd();Cd=class extends SU{entries(){return super.entries().filter(e=>e.mapGenerator()===$m)}};t(Cd,"EarthStartTileRegistry");Td=new Cd});var Vz={};var zU=n(()=>{lR();kU();dR();Td.register(...[[ya,{x:12,y:18}],[fa,{x:5,y:23}],[da,{x:45,y:22}],[ga,{x:66,y:19}],[ha,{x:41,y:24}],[Oa,{x:31,y:14}],[Ra,{x:33,y:16}],[xa,{x:38,y:15}],[va,{x:39,y:18}],[ba,{x:57,y:26}],[Ca,{x:49,y:19}],[Ta,{x:36,y:19}],[Pa,{x:44,y:12}],[Ia,{x:42,y:42}]].map(([i,e])=>new FU(i,e)))});var LU=b(NU=>{"use strict";Object.defineProperty(NU,"__esModule",{value:!0});zU()});var Jz,WU,jU=n(()=>{w();T();nh();Jz=t(()=>[new ds(new l(i=>i<252),new p(i=>i*20-4020)),new ds(new l(i=>i>251),new l(i=>i<302),new p(i=>(i-151)*10+1e3)),new ds(new l(i=>i>301),new l(i=>i<352),new p(i=>(i-201)*5+1500)),new ds(new l(i=>i>351),new l(i=>i<402),new p(i=>(i-251)*2+1750)),new ds(new l(i=>i>401),new p(i=>i-301+1850))],"getRules"),WU=Jz});var $z={};var HU=n(()=>{I();jU();d.register(...WU())});var KU=b(_U=>{"use strict";Object.defineProperty(_U,"__esModule",{value:!0});HU()});var Zz,qU,VU=n(()=>{Eg();Je();ro();ze();Bh();w();T();ll();om();na();Zz=t((i=z,e=L)=>[new yl(new l((r,o)=>i.getByPlayer(o.player()).available().length>0),new p((r,o)=>new ts(r,o))),new yl(new l(r=>[de,ie,ee].some(o=>r.tile().terrain()instanceof o)),new l((r,o)=>r.tile().getSurroundingArea().score(null,[[Jo,8],[ia,3],[oa,1]])>=150),new l(r=>r.tile().getSurroundingArea(4).every(o=>e.getByTile(o)===null)),new p((r,o)=>new rs(r,o))),new yl(new p((r,o)=>new is(r,o))),new yl(new p((r,o)=>new os(r,o)))],"getRules"),qU=Zz});var Qz,JU,$U=n(()=>{K();Gh();T();Qz=t((i=P)=>[new sf(new p((e,r)=>{i.emit("goody-hut:action-performed",e,r)}))],"getRules"),JU=Qz});var Xz,ZU,QU=n(()=>{K();Fs();Uh();T();Xz=t((i=Yr,e=P,r=()=>Math.random())=>[new Rm(new p(o=>i.unregister(o))),new Rm(new p((o,s)=>{let a=o.actions(s),m=a[Math.floor(a.length*r())];o.action(m)})),new Rm(new p((o,s)=>{e.emit("goody-hut:discovered",o,s)}))],"getRules"),ZU=Xz});var Pd,Zm,gR=n(()=>{B();Pd=class extends h{};t(Pd,"Distribution");Zm=Pd});var eN,XU,eM=n(()=>{Fs();w();gR();eN=t((i=Yr,e=()=>Math.random())=>[new Zm(new l(r=>r.isLand())),new Zm(new l(r=>r.getSurroundingArea(3).every(o=>i.getByTile(o)===null))),new Zm(new l(()=>e()<.05))],"getRules"),XU=eN});var tN,tM,rM=n(()=>{Fs();Rn();I();T();Dg();tN=t((i=Yr,e=()=>Math.random(),r=d)=>[new pc(new p((o,s)=>{let a=[Ir,wr],m=a[Math.floor(a.length*e())];return new m(null,s.player(),s.tile(),r)}))],"getRules"),tM=tN});var rN,iM,oM=n(()=>{Fs();w();T();At();rN=t((i=Yr)=>[new q(new l(e=>i.getByTile(e.tile())!==null),new p(e=>{i.getByTile(e.tile()).process(e)}))],"getRules"),iM=rN});var Id,js,wd=n(()=>{B();Id=class extends h{};t(Id,"Built");js=Id});var iN,nM,aM=n(()=>{Fs();I();wd();T();Mh();gR();iN=t((i=Yr,e=d)=>[new js(new p(r=>{let o=e.get(Zm);r.forEach(s=>{o.every(a=>a.validate(s))&&i.register(new pf(s))})}))],"getRules"),nM=iN});var oN={};var sM=n(()=>{VU();$U();QU();eM();rM();I();oM();aM();d.register(...qU(),...JU(),...ZU(),...XU(),...tM(),...iM(),...nM())});var mM=b(lM=>{"use strict";Object.defineProperty(lM,"__esModule",{value:!0});sM()});var nN={};var pM=n(()=>{On();hf();xm.register(bt,nt,Ht,at,ft)});var aN,uM,cM=n(()=>{sn();On();w();T();Jg();Xn();aN=t((i=pt)=>[new ht(new l(e=>!i.getByPlayer(e).is(Mi)),new p(e=>[new us(e,i.getByPlayer(e))]))],"getRules"),uM=aN});var sN,yM,fM=n(()=>{hf();sn();I();al();On();T();Gl();kh();sN=t((i=xm,e=pt,r=d)=>[new pi(new Qa,new p(o=>{let s=new vf(o,i,r);s.set(new Ht),e.register(s)}))],"getRules"),yM=sN});var lN,dM,gM=n(()=>{sr();On();ze();Eh();w();lN=t((i=z)=>[new kp(new l(e=>e===Ht)),...[[bt,Rt],[nt,so],[at,Kr],[ft,Gi]].map(([e,r])=>new kp(new l(o=>o===e),new l((o,s)=>i.getByPlayer(s).completed(r))))],"getRules"),dM=lN});var mN,hM,OM=n(()=>{K();Zi();Fh();w();T();mN=t((i=P,e=ae)=>[new Sp(new p((r,o)=>{i.emit("player:government:changed",r,o)})),new Sp(new l(r=>{try{return e.getByPlayer(r),!0}catch(o){if(o instanceof TypeError&&o.message.match(/Wrong number of player worlds exist/))return!1;throw o}}),new p(r=>{e.getByPlayer(r).entries().forEach(s=>s.tile().clearYieldCache(r))}))],"getRules"),hM=mN});var pN={};var RM=n(()=>{I();cM();fM();gM();OM();d.register(...uM(),...yM(),...dM(),...hM())});var vM=b(xM=>{"use strict";Object.defineProperty(xM,"__esModule",{value:!0});pM();RM()});var Ad,bM,CM=n(()=>{B();Ad=class extends h{};t(Ad,"TurnEnd");bM=Ad});var uN,TM,PM=n(()=>{Ap();K();I();CM();uN=t((i=ra,e=d,r=P)=>[["player:turn-end",o=>{i.unregister(o),e.process(bM,o);let[s]=i.entries();if(!s){r.emit("turn:end");return}r.emit("player:turn-start",s)}]],"getEvents"),TM=uN});var cN,IM,wM=n(()=>{fl();K();I();$p();cN=t((i=Eo,e=P,r=d)=>[["player:turn-start",o=>{r.process(Aa,o),i.getByPlayer(o).takeTurn().catch(a=>console.error(a)).finally(()=>{e.emit("player:turn-end",o)})}]],"getEvents"),IM=cN});var yN,AM,BM=n(()=>{Ap();K();fs();yN=t((i=yi,e=ra,r=P)=>[["turn:start",()=>{e.register(...i.entries());let[o]=e.entries();r.emit("player:turn-start",o)}]],"getEvents"),AM=yN});var fN={};var GM=n(()=>{K();PM();wM();BM();[...TM(),...IM(),...AM()].forEach(([i,e])=>P.on(i,e))});var Bd,Wn,Xp=n(()=>{B();Bd=class extends h{};t(Bd,"Defeated");Wn=Bd});var dN,UM,MM=n(()=>{Je();I();Js();w();Xp();T();dN=t((i=L,e=d)=>[new yr(new l((r,o,s)=>i.getByPlayer(s).filter(a=>a!==r).length===0),new p((r,o,s)=>{e.process(Wn,s,o)}))],"getRules"),UM=dN});var gN,DM,EM=n(()=>{Je();I();w();Xp();$s();T();gN=t((i=L,e=d)=>[new kr(new l((r,o)=>i.getByPlayer(r.player()).filter(s=>s!==r).length===0),new p((r,o)=>e.process(Wn,r.player(),o)))],"getRules"),DM=gN});var hR,hN,FM,kM=n(()=>{Xn();w();T();Fc();Za();hR=new ht(new Fr(9001),new l(i=>{hR.disable();let e=i.mandatoryActions();return hR.enable(),e.length===0}),new p(i=>[new Ec(i,null)])),hN=t(()=>[hR],"getRules"),FM=hN});var ON,SM,YM=n(()=>{K();al();T();ON=t((i=P)=>[new pi(new p(e=>{i.emit("player:added",e)}))],"getRules"),SM=ON});var RN,zM,NM=n(()=>{Ap();K();fs();w();Xp();T();RN=t((i=ra,e=yi,r=P)=>[new Wn(new l(o=>i.includes(o)),new p(o=>i.unregister(o))),new Wn(new l(o=>e.includes(o)),new p(o=>e.unregister(o))),new Wn(new p((o,s)=>{r.emit("player:defeated",o,s)}))],"getRules"),zM=RN});var Gd,Ud,OR=n(()=>{B();Gd=class extends h{};t(Gd,"Spawn");Ud=Gd});var xN,LM,WM=n(()=>{I();T();QO();OR();xN=t((i=d)=>[new Ud(new p((e,r)=>{new iT(null,e,r,i)}))],"getRules"),LM=xN});var vN,jM,HM=n(()=>{Je();I();_e();T();ll();Gl();Ym();om();na();$p();Qi();vN=t((i=d,e=L,r=N)=>[new Aa(new Qa,new p(o=>{e.getByPlayer(o).forEach(s=>{let a=s.yields();sa(a,Jo,ia,oa).reduce((m,u,y)=>(m[y].set(u,"Consolidated"),m),[new Jo(0,"Consolidated"),new ia(0,"Consolidated"),new oa(0,"Consolidated")]).forEach(m=>i.process(ko,m,s,a))})})),new Aa(new p(o=>r.getByPlayer(o).forEach(s=>{if(s.destroyed())return;s.moves().set(s.movement());let a=s.busy();if(!a){s.setActive(),s.setWaiting(!1);return}!a.validate()||a.process()})))],"getRules"),jM=vN});var bN,_M,KM=n(()=>{K();T();Vg();bN=t((i=P)=>[new Hc(new p((e,r)=>{i.emit("player:visibility-changed",e,r)}))],"getRules"),_M=bN});var CN,qM,VM=n(()=>{fs();Zi();Ty();T();CN=t((i=yi,e=ae)=>[new la(new p(r=>{r.clearYieldCache(null),i.forEach(o=>{e.getByPlayer(o).getByTile(r)!==null&&r.clearYieldCache(o)})}))],"getRules"),qM=CN});var TN,JM,$M=n(()=>{Je();I();w();Xp();Op();T();TN=t((i=L,e=d)=>[new Vo(new l((r,o)=>i.getByPlayer(r.player()).length===0),new p((r,o)=>e.process(Wn,r.player(),o)))],"getRules"),JM=TN});var PN,ZM,QM=n(()=>{Zi();T();eh();PN=t((i=ae)=>[new ry(new p((e,r)=>{e.clearYieldCache(r);let o=i.getByPlayer(r);o.register(e),o.getByTile(e).update()}))],"getRules"),ZM=PN});var Md,Dd,RR=n(()=>{B();Md=class extends h{};t(Md,"PickStartTile");Dd=Md});var IN,XM,eD=n(()=>{mR();fl();K();fs();Zi();I();wd();T();ll();pm();RR();Dp();Kc();om();Jy();na();OR();IN=t((i=qf,e=Eo,r=P,o=yi,s=ae,a=d,m=()=>Math.random())=>[new js(new p(u=>o.entries().forEach(y=>s.register(new Jl(y,u))))),new js(new p(u=>{let y=new Map,c=new Map,f=t((A,E=null)=>(y.has(A)||y.set(A,A.score(E,[[Jo,8],[ia,3],[oa,1]])),y.get(A)),"tileScore"),g=t((A,E=null)=>(c.has(A)||c.set(A,A.getSurroundingArea().entries().reduce((V,se)=>V+f(se,E),0)),c.get(A)),"areaScore");r.emit("world:generate-start-tiles");let U=[],D=u.entries().filter(A=>[ws,lm,Vy].some(E=>A.terrain()instanceof E)).map(A=>({tile:A,score:g(A)})).sort(({score:A},{score:E})=>E-A).map(({tile:A})=>A);r.emit("world:start-tiles",D),e.entries().reduce((A,E)=>A.then(async()=>{let V=E.player();await E.chooseCivilization(i.entries()),i.unregister(V.civilization().sourceClass());let[se]=a.process(Dd,u,V,U);if(!se)throw new TypeError("Not enough `startingSquare`s.");U.push(se),a.process(Ud,V,se)}),Promise.resolve()).then(()=>r.emit("game:start"))})),new js(new p(u=>{r.emit("world:built",u)}))],"getRules"),XM=IN});var wN={};var tD=n(()=>{MM();EM();I();kM();YM();NM();WM();HM();KM();VM();$M();QM();eD();d.register(...UM(),...DM(),...FM(),...SM(),...zM(),...LM(),...jM(),..._M(),...qM(),...JM(),...ZM(),...XM())});var iD=b(rD=>{"use strict";Object.defineProperty(rD,"__esModule",{value:!0});GM();tD()});var AN={};var oD=n(()=>{sr();G();O.register(xi,io,vi,Yn,ut,bi,oo,Nr,Ci,ln,no,gr,Lr,Rt,Ti,Wr,jr,ao,Pi,so,hr,ct,mn,pn,zn,lo,ca,un,yt,cn,xt,Or,Ii,yn,Rr,Nt,Hr,Lt,Wt,xr,wi,_r,Kr,jt,nr,qr,mo,Vr,Ai,fn,dn,Jr,gn,Bi,vt,$r,po,uo,co,yo,fo,Gi,hn,go,Ui,ar,vr)});var nD=n(()=>{Yg()});var BN,aD,sD=n(()=>{ze();Xn();nD();w();T();BN=t((i=z)=>[new ht(new l(e=>i.getByPlayer(e).researching()===null),new l(e=>i.getByPlayer(e).available().length>0),new p(e=>[new tl(e,i.getByPlayer(e))]))],"getRules"),aD=BN});var GN,lD,mD=n(()=>{G();ze();I();al();T();Bu();GN=t((i=O,e=z,r=d,o=()=>Math.random())=>[new pi(new p(s=>e.register(new Dl(s,i,r)))),new pi(new p(s=>{let a=e.getByPlayer(s);for(let m=0,u=Math.min(a.available().length,Math.floor(4*o()));m<u;m++){let y=a.available();a.addAdvance(y[Math.floor(o()*y.length)])}}))],"getRules"),lD=GN});var UN,pD,uD=n(()=>{ze();Js();T();w();UN=t((i=z,e=()=>Math.random())=>[new yr(new l((r,o,s)=>i.getByPlayer(s).complete().some(a=>!i.getByPlayer(o).completed(a.constructor))),new p((r,o,s)=>{let a=i.getByPlayer(o),m=i.getByPlayer(s).complete().filter(u=>!a.completed(u.constructor));a.addAdvance(m.map(u=>u.constructor)[Math.floor(e()*m.length)])}))],"getRules"),pD=UN});var MN,cD,yD=n(()=>{K();vu();T();MN=t((i=P)=>[new Xa(new p((e,r)=>{i.emit("player:research-complete",e,r)}))],"getRules"),cD=MN});var DN,fD,dD=n(()=>{Cg();T();DN=t(()=>[new Cu(new p((i,e)=>(e.complete().length+1)*(6+2*0)))],"getRules"),fD=DN});var EN,gD,hD=n(()=>{Sm();ze();I();w();T();Ym();Nf();EN=t((i=z,e=d)=>[new ko(new l(r=>r instanceof Kt),new l((r,o,s)=>!e.get(Ln).some(a=>a.validate(o,s))),new p((r,o)=>i.getByPlayer(o.player()).add(r)))],"getRules"),gD=EN});var FN,OD,RD=n(()=>{sr();w();T();Tg();FN=t(()=>[...[[xi,lo,hr],[vi,xr,jt],[Yn,go,Ai],[ut,Lr,yo],[bi,Gi,Ui],[oo,jr,Ii],[ln,ar,wi],[no,zn,cn],[gr,io],[Lr,Bi,pn],[Rt,Vr,xt],[Ti,ct,xr],[Wr,pn,Gi],[jr,Pi,Lt],[ao,bi,xt],[Pi,Nr],[so,Vr,Rr],[hr,_r,Nt],[ct,mn,hr],[mn,jr,hn],[pn,yt,ln],[zn,Lt,Kr],[lo,Lr,Ai],[ca,mo,fo],[un,ao,wi],[yt,Or,Ii],[xt,Jr,bi],[Or,mn,Rr],[Ii,Nr],[yn,Wt,Rt],[Rr,gr,vr],[Nt,nr,Ai],[Hr,io],[Wt,ao,ut],[xr,io,Lt],[wi,Vr,Ui],[_r,yt,ar],[Kr,gr,jt],[jt,Ci],[nr,vi,Hr],[qr,Wt,Yn],[mo,qr,ct],[Vr,jt,Rr],[Ai,nr,xr],[fn,Bi,uo],[Jr,oo,co],[gn,so,Wt],[Bi,ao,ln],[vt,Vr,vr],[$r,Ti,fn],[po,ct,xi],[uo,Ti,po],[co,Or,Ai],[yo,_r,xt],[fo,Wt,fn],[Gi,gr,Rr],[go,vi,ar],[Ui,gr,Pi],[ar,Vr,xr],[vr,io]].map(([i,...e])=>new Pu(new l(r=>r===i),new p((r,o)=>e.every(s=>o.some(a=>a instanceof s)))))],"getRules"),OD=FN});var kN,xD,vD=n(()=>{K();T();wu();kN=t((i=P)=>[new Ml(new p((e,r)=>{i.emit("player:research",e,r)}))],"getRules"),xD=kN});var SN={};var bD=n(()=>{sD();mD();uD();yD();dD();I();hD();RD();vD();d.register(...aD(),...lD(),...pD(),...cD(),...fD(),...gD(),...OD(),...xD())});var TD=b(CD=>{"use strict";Object.defineProperty(CD,"__esModule",{value:!0});oD();bD()});var Ed,Hs,eu=n(()=>{Ve();Ed=class extends W{};t(Ed,"TradeRate");Hs=Ed});var Ha,PD=n(()=>{Jp();eu();Ha=class extends Hs{};t(Ha,"Luxuries"),Ha.tradeYield=RB});var _a,ID=n(()=>{Ef();eu();_a=class extends Hs{};t(_a,"Research"),_a.tradeYield=Kt});var Ka,wD=n(()=>{_l();eu();Ka=class extends Hs{};t(Ka,"Tax"),Ka.tradeYield=lc});var xR=n(()=>{PD();ID();wD()});var Fd,_s,tu=n(()=>{Ho();eu();Fd=class extends He{constructor(){super(Hs)}};t(Fd,"AvailableTradeRateRegistry");_s=new Fd});var YN={};var AD=n(()=>{xR();tu();_s.register(Ha,_a,Ka)});var BD=n(()=>{Mf();na()});var kd,Sd,vR=n(()=>{Z();kd=class extends Ye{#e=100;#t;#r=[];constructor(e,...r){super(),this.#t=e,this.#r=r,this.addKey("all")}all(){return[...this.#r]}balance(e){if(this.total()===1)return;let r=1-e.value(),o=this.#r.filter(a=>a!==e),s=o.reduce((a,m)=>a+m.value(),0);o.forEach(a=>a.set(a.value()/s*r)),this.total()<1&&o[Math.floor(o.length*Math.random())].add(1-this.total()),this.total()>1&&o[Math.floor(o.length*Math.random())].subtract(1-this.total())}get(e){let[r]=this.#r.filter(o=>o instanceof e);return r}player(){return this.#t}set(e,r){let o=this.get(e);o.set(r),this.balance(o)}setAll(e){if(e.reduce((r,[,o])=>r+o,0)!==1)throw new TypeError("Invalid rates provided, must sum to 1.");e.forEach(([r,o])=>this.get(r).set(o))}total(){return Math.round(this.#r.reduce((e,r)=>e+r.value(),0)*this.#e)/this.#e}};t(kd,"PlayerTradeRates");Sd=kd});var Yd,Ks,ru=n(()=>{he();vR();Yd=class extends F{constructor(){super(Sd)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTradeRates for player");return r[0]}};t(Yd,"PlayerTradeRatesRegistry");Ks=new Yd});var zN,GD,UD=n(()=>{tu();BD();ru();T();Ll();Qi();zN=t((i=_s,e=Ks)=>[new Nl(new p((r,o)=>{let s=e.getByPlayer(r.player()),a=Math.max(0,Ke(o,re)),m=a;return i.entries().map(u=>{let y=u.tradeYield,c=Math.min(Math.ceil(a*s.get(u).value()),m);return m-=c,new y(c,u.name)})}))],"getRules"),GD=zN});var NN,MD,DD=n(()=>{ru();Xn();Sg();T();NN=t((i=Ks)=>[new ht(new p(e=>[new ls(e,i.getByPlayer(e))]))],"getRules"),MD=NN});var LN,ED,FD=n(()=>{tu();ru();xR();al();T();vR();LN=t((i=_s,e=Ks)=>[new pi(new p(r=>{let o=[new Ka(.5),new _a(.5),new Ha(0)],s=i.entries(),a=new Sd(r,...s.map(m=>{let[u]=o.filter(y=>y instanceof m);return new m(u||0)}));e.register(a)}))],"getRules"),ED=LN});var zd,WN,kD,SD=n(()=>{tu();Je();I();T();Gl();Ym();$p();Qi();zd=[],WN=t((i=d,e=L,r=_s)=>[new Aa(new Qa,new p(o=>{zd.length===0&&r.entries().forEach(s=>zd.push(s.tradeYield)),e.getByPlayer(o).forEach(s=>{let a=s.yields();sa(a,...zd).reduce((m,u,y)=>(m[y].set(u,"Consolidated"),m),zd.map(m=>new m)).forEach(m=>i.process(ko,m,s,a))})}))],"getRules"),kD=WN});var jN={};var YD=n(()=>{I();UD();DD();FD();SD();d.register(...GD(),...MD(),...ED(),...kD())});var ND=b(zD=>{"use strict";Object.defineProperty(zD,"__esModule",{value:!0});AD();YD()});var HN,LD,WD=n(()=>{Be();w();T();Ug();ta();HN=t(()=>[new Xs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(Ie,i.building().item())),new l(i=>i.progress().value()===0),new p((i,e)=>{let r=i.remaining()/10;return e.add(Math.floor((r+4)*10*r)),e})),new Xs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(Ie,i.building().item())),new l(i=>i.progress().value()>0),new p((i,e)=>{let r=i.remaining()/10;return e.add(Math.floor(5*r**2+20*r)),e})),new Xs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(k,i.building().item())),new l(i=>i.progress().value()===0),new p((i,e)=>(e.add(i.remaining()*4),e))),new Xs(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(k,i.building().item())),new l(i=>i.progress().value()>0),new p((i,e)=>(e.add(i.remaining()*2),e)))],"getRules"),LD=HN});var _N,jD,HD=n(()=>{Je();Xn();_g();T();_N=t((i=L)=>[new ht(new p(e=>i.getByPlayer(e).map(r=>new ms(e,r))))],"getRules"),jD=_N});var KN,_D,KD=n(()=>{el();al();T();Mg();KN=t((i=mi)=>[new pi(new p(e=>i.register(new ac(e))))],"getRules"),_D=KN});var qD=n(()=>{sR();_l()});var Nd,Ld,bR=n(()=>{B();Nd=class extends h{};t(Nd,"Updated");Ld=Nd});var qN,VD,JD=n(()=>{qD();cr();K();el();I();Gg();Sm();w();T();Ym();bR();qN=t((i=mi,e=d,r=ve,o=P)=>[new ko(new l(s=>s instanceof Xt),new p((s,a,m)=>{let u=i.getByPlayer(a.player());m.forEach(y=>{if(y instanceof ue){if(u.value()<y.value()){let c=y.cityImprovement(),f=new Qu(c.constructor,a,e);r.unregister(c),u.add(f.cost().value()),o.emit("city:unsupported-improvement",a,c);return}u.subtract(y.value(),a.name())}})})),new ko(new l(s=>s instanceof Xt),new l((s,a,m)=>!e.get(Ln).some(u=>u.validate(a,m))),new p((s,a)=>{let m=i.getByPlayer(a.player());m.add(s,a.name()),e.process(Ld,m,a)}))],"getRules"),VD=qN});var VN,$D,ZD=n(()=>{K();w();T();bR();VN=t((i=P)=>[new Ld(new l(e=>e.value()<0),new p((e,r)=>{i.emit("player:treasury-exhausted",e.player(),e,r)}))],"getRules"),$D=VN});var JN={};var QD=n(()=>{I();WD();HD();KD();JD();ZD();d.register(...LD(),...jD(),..._D(),...VD(),...$D())});var eE=b(XD=>{"use strict";Object.defineProperty(XD,"__esModule",{value:!0});QD()});var $N={};var tE=n(()=>{Rn();Wl();Tn.register(vo,bo,Co,Ei,To,Po,Fi,ki,Io,wo,ur,Si,Ir,Yi,zi,Ao,Ni,Bo,Go,Li,We,Wi,ti,wr,Uo,Mo,Ar,Do)});var Wd,Qm,CR=n(()=>{B();Wd=class extends h{};t(Wd,"Available");Qm=Wd});var jd,rE,Hd,ZN,iE,oE=n(()=>{Qg();kn();gm();gt();Je();ro();Sn();$t();I();Qo();Sr();Om();fi();_e();ma();vg();CR();w();T();aR();Rn();jd=new l((i,e,r=i.tile())=>i instanceof et),rE=new l((i,e,r=i.tile())=>i instanceof Le),Hd=t((i,e)=>e.getByTile(i)!==null,"tileHasCity"),ZN=t((i=$,e=L,r=d,o=Ue,s=or,a=N,m=lt,u=En,y=Ge)=>[new Ot(em,ci,new Hi(new $a(jd,new l((c,f,g=c.tile())=>g.isLand()),new l((c,f)=>f.isLand()),new l((c,f)=>a.getByTile(f).every(g=>g.player()===c.player()))),new $a(rE,new Hi(new l((c,f,g=c.tile())=>g.isWater()),new l((c,f,g=c.tile())=>e.getByTile(g)?.player()===c.player())),new Hi(new l((c,f)=>f.isWater()),new l((c,f)=>e.getByTile(f)?.player()===c.player()))),new l(c=>c instanceof Gt)),new Hi(new l((c,f)=>!(c instanceof et)),new l((c,f,g=c.tile())=>!(g.getNeighbours().some(U=>a.getByTile(U).some(D=>D instanceof et&&D.tile().terrain()instanceof j&&D.player()!==c.player()))&&f.getNeighbours().some(U=>a.getByTile(U).some(D=>D instanceof et&&D.tile().terrain()instanceof j&&D.player()!==c.player())))),new l((c,f)=>a.getByTile(f).filter(g=>g.player()===c.player()).length>0),new l((c,f)=>{let g=e.getByTile(f);return g===null?!1:g.player()===c.player()})),new l((c,f)=>{let g=e.getByTile(f);return g===null?!0:g.player()===c.player()}),new l((c,f)=>!a.getByTile(f).some(g=>g.player()!==c.player())),new p((c,f,g=c.tile())=>new St(g,f,c,r))),new Ot(em,ci,new l((c,f)=>a.getByTile(f).some(g=>g.player()!==c.player())),new Hi(new $a(new l(c=>c instanceof Gt),new Hi(new l((c,f)=>!a.getByTile(f).every(g=>g instanceof Gt)),new l((c,f)=>c instanceof ur))),new $a(jd,new Hi(new l((c,f)=>Hd(f,e)),new l((c,f)=>a.getByTile(f).some(g=>g instanceof et)))),new $a(rE,new Hi(new l((c,f)=>!(c instanceof ti)),new l((c,f)=>f.isWater())))),new p((c,f,g=c.tile())=>new xs(g,f,c,r,a))),new Ot(em,ci,jd,new l((c,f)=>Hd(f,e)),new l((c,f)=>a.getByTile(f).length===0),new l((c,f)=>e.getByTile(f).player()!==c.player()),new p((c,f,g=c.tile())=>{let U=e.getByTile(f);return new sm(g,f,c,U,r)})),new Ot(ci,Gn,new l(c=>c instanceof Y),new l((c,f)=>o.getByTile(f).filter(g=>[we,Ze,ir,ke].some(U=>g instanceof U)).length>0),new p((c,f,g=c.tile())=>new Ms(g,f,c,r,o,y))),new Ot(ci,Gn,new l(c=>c instanceof Y),new l((c,f,g=c.tile())=>g.isLand()),new p((c,f,g=c.tile())=>new Us(g,f,c,r,y,s))),new Ot(ci,Gn,new p((c,f,g=c.tile())=>new pa(g,f,c,r,y))),new Ot(ci,Gn,new p((c,f,g=c.tile())=>new um(g,f,c,r))),new Ot(Gn,new p((c,f,g=c.tile())=>new eo(g,f,c,r))),new Ot(ci,Gn,new l(c=>c instanceof We),new l((c,f,g=c.tile())=>g.isLand()),new l((c,f,g=c.tile())=>!Hd(g,e)),new p((c,f,g=c.tile())=>new fm(g,f,c,i,r))),...[[we,vs,new Hi(new l((c,f,g=c.tile())=>g.terrain()instanceof ee),new l((c,f,g=c.tile())=>g.getAdjacent().some(U=>U.terrain()instanceof ee||U.terrain()instanceof Jt||o.getByTile(U).some(D=>D instanceof we)&&!Hd(U,e))))],[Ze,bs],[ke,Cs],[ir,Ts,new l((c,f)=>o.getByTile(f).some(g=>g instanceof ke))]].map(([c,f,...g])=>new Ot(new l(U=>U instanceof dr),ci,new l((U,D,A=U.tile())=>r.get(Qm).some(E=>E.validate(A,c,U.player()))),Gn,...g,new p((U,D,A=U.tile())=>new f(A,D,U,r,y)))),...[[Qe,As],[qe,Ps],[ie,Ds],[Xe,Bs]].map(([c,f])=>new Ot(ci,Gn,new l(g=>g instanceof dr),new l((g,U,D=g.tile())=>D.terrain()instanceof c),new p((g,U,D=g.tile())=>new f(D,U,g,r,m,y)))),new Ot(em,ci,jd,new l((c,f)=>f.terrain()instanceof Jt),new l((c,f)=>a.getByTile(f).every(g=>g.player()===c.player())),new l((c,f)=>a.getByTile(f).filter(g=>g instanceof zt).some(g=>g.hasCapacity()&&g.canStow(c))),new p((c,f,g=c.tile())=>{let[U]=a.getByTile(f).filter(D=>D instanceof zt).filter(D=>D.hasCapacity()&&D.canStow(c));return new cm(g,f,c,U,r)})),new Ot(em,new l(c=>{try{return u.getByUnit(c),!0}catch{return!1}}),new Hi(new l((c,f)=>!(c instanceof et)),new l((c,f)=>f.isLand())),new l((c,f,g=c.tile())=>u.getByUnit(c).transport().tile()===g),new p((c,f,g=c.tile())=>{let U=u.getByUnit(c).transport();return new Gs(g,f,c,U,r)})),new Ot(ci,Gn,new l(c=>c instanceof zt),new l(c=>c.hasCargo()),new l((c,f)=>f.getNeighbours().some(g=>g.isLand())),new p((c,f,g=c.tile())=>new dm(g,f,c,r)))],"getRules"),iE=ZN});var QN,nE,aE=n(()=>{ma();Xg();w();T();Yp();QN=t((i=or)=>[new tm(new l(e=>e.moves().value()>0),new p(e=>e.setActive())),new tm(new l(e=>e.busy()!==null),new p(e=>e.setBusy())),...[hi].map(e=>new tm(new l(r=>i.getByUnit(r).some(o=>o instanceof e)),new p(r=>i.unregister(...i.getByUnit(r).filter(o=>o instanceof e)))))],"getRules"),nE=QN});var XN,sE,lE=n(()=>{sr();np();Rn();ze();w();T();kn();XN=t((i=z)=>[new Zt(new l((e,r)=>Object.prototype.isPrototypeOf.call(Le,r)),new p(e=>new l(()=>e.tile().isCoast()))),...[[vo,$r],[bo,yo],[Co,xi],[Ei,_r],[Po,xi],[To,Ui],[Fi,xr],[ki,hn],[Io,Lr],[wo,vr],[ur,lo],[Si,Nt],[Ir,cn],[Yi,co],[zi,no],[Ao,yn],[Ni,yt],[Bo,po],[Go,Wr],[Li,nr],[Wi,Nr],[ti,Wt],[wr,Ii],[Uo,ut],[Mo,xt],[Ar,Hr]].map(([e,r])=>new Zt(new l((o,s)=>s===e),new p(o=>new l(()=>i.getByPlayer(o.player()).completed(r))))),...[[Ei,$r],[Fi,_r],[ki,no],[Si,xt],[Ir,Wr],[Yi,Lr],[zi,ut],[Ni,Wr],[Li,Nt],[Wi,yt],[wr,Wr],[Ar,nr],[Do,yt]].map(([e,r])=>new Zt(new l((o,s)=>s===e),new p(o=>new l(()=>!i.getByPlayer(o.player()).completed(r)))))],"getRules"),sE=XN});var e1,mE,pE=n(()=>{sp();Rn();e1=t(()=>[...[[vo,80],[bo,160],[Co,120],[Ei,40],[To,50],[Po,160],[Fi,40],[ki,40],[Io,80],[wo,30],[ur,60],[Si,40],[Ir,20],[Yi,50],[zi,40],[Ao,50],[Ni,30],[Bo,160],[Go,30],[Li,40],[We,40],[Wi,20],[ti,50],[wr,20],[Uo,80],[Mo,50],[Ar,40],[Do,10]].flatMap(([i,e])=>jl(i,e))],"getRules"),mE=e1});var t1,uE,cE=n(()=>{rr();lp();w();T();Rn();t1=t((i=ye)=>[new Pn(new l((e,r)=>r instanceof We),new p(e=>i.getByCity(e.city()).shrink()))],"getRules"),uE=t1});var r1,yE,fE=n(()=>{K();_e();Xc();T();r1=t((i=N,e=P)=>[new ea(new p(r=>i.register(r))),new ea(new p(r=>r.applyVisibility())),new ea(new p(r=>r.moves().set(r.movement()))),new ea(new p(r=>{e.emit("unit:created",r)}))],"getRules"),yE=r1});var i1,dE,gE=n(()=>{Je();K();I();Sr();_e();w();Gp();Op();T();i1=t((i=L,e=d,r=Ue,o=N,s=P)=>[new $o(new p((a,m)=>{s.emit("unit:defeated",a,m),e.process(Vo,a,m.player())})),new $o(new l(a=>i.getByTile(a.tile())===null),new l(a=>o.getByTile(a.tile()).filter(m=>m!==a&&m.player()===a.player()).length>0),new p((a,m)=>o.getByTile(a.tile()).forEach(u=>{u!==a&&u.player()===a.player()&&e.process(Vo,a,m.player())})))],"getRules"),dE=i1});var o1,hE,OE=n(()=>{K();ma();_e();Op();T();o1=t((i=N,e=or,r=P)=>[new Vo(new p((o,s)=>{r.emit("unit:destroyed",o,s)})),new Vo(new p(o=>{o.setActive(!1),o.setDestroyed()})),new Vo(new p(o=>e.getByUnit(o).forEach(s=>e.unregister(s))))],"getRules"),hE=o1});var _d,Xm,TR=n(()=>{B();_d=class extends h{};t(_d,"LostAtSea");Xm=_d});var n1,RE,xE=n(()=>{K();T();TR();n1=t((i=P)=>[new Xm(new p(e=>{i.emit("unit:lost-at-sea",e)})),new Xm(new p(e=>e.destroy(null)))],"getRules"),RE=n1});var a1,vE,bE=n(()=>{gm();K();I();Om();w();T();TR();At();kn();Rn();Je();a1=t((i=En,e=d,r=()=>Math.random(),o=P,s=L)=>[new q(new p((a,m)=>{o.emit("unit:moved",a,m)})),new q(new p(a=>a.applyVisibility())),new q(new l(a=>a.moves().value()<=.1),new p(a=>a.moves().set(0))),new q(new l(a=>a.moves().value()<.1),new p(a=>a.setActive(!1))),new q(new l(a=>a instanceof zt),new l((a,m)=>m instanceof St),new l(a=>a.hasCargo()),new p((a,m)=>a.cargo().forEach(u=>u.action(m.forUnit(u))))),new q(new l((a,m)=>m instanceof Gs),new p(a=>{let m=i.getByUnit(a);m.transport().unload(a),i.unregister(m)})),new q(new l(a=>a instanceof Ar),new l(a=>a.moves().value()===0),new l(a=>!a.tile().isCoast()),new l(()=>r()<=.5),new p(a=>{e.process(Xm,a)})),new q(new l(a=>a instanceof ur),new l(a=>a.moves().value()===0),new l(a=>s.getByTile(a.tile())!==null),new p(a=>{e.process(Xm,a)}))],"getRules"),vE=a1});var CE,s1,TE,PE=n(()=>{ro();kn();gm();Sn();Sr();Om();w();T();di();CE=[[Bt,2],[Ce,1],[qe,2],[de,1],[Ae,2],[Qe,2],[Se,3],[ot,1],[ie,1],[ee,1],[Xe,2],[mt,1]],s1=t((i=Ue,e=En)=>[...CE.map(([r,o])=>new be(new l((s,a)=>a instanceof St),new l(s=>s instanceof et),new l((s,a)=>a.to().terrain()instanceof r),new p(()=>o))),new be(new l((r,o)=>o instanceof St),new l(r=>r instanceof Gt||r instanceof Le),new p(()=>1)),new be(new l((r,o)=>o instanceof St),new l(r=>r instanceof et),new l((r,o)=>i.getByTile(o.from()).some(s=>s instanceof ke)),new l((r,o)=>i.getByTile(o.to()).some(s=>s instanceof ke)),new p(()=>1/3)),new be(new l((r,o)=>o instanceof St),new l(r=>r instanceof et),new l((r,o)=>i.getByTile(o.from()).some(s=>s instanceof ir)),new l((r,o)=>i.getByTile(o.to()).some(s=>s instanceof ir)),new p(()=>0)),new be(new l((r,o)=>o instanceof St),new l(r=>r instanceof et),new l(r=>{try{return e.getByUnit(r),!0}catch{return!1}}),new l(r=>e.getByUnit(r).transport()instanceof zt),new p(()=>0)),...[[vs,2],[bs,3],[Cs,1],[Ts,2],[Ps,2],[As,3],[Bs,3],[Us,1],[Ms,1],[Ds,3],[pa,0]].flatMap(([r,o])=>CE.map(([s,a])=>new be(new l((m,u)=>u instanceof r),new l(m=>m.tile().terrain()instanceof s),new p(()=>o*a))))],"getRules"),TE=s1});var l1,IE,wE=n(()=>{Rg();_e();Xn();w();T();l1=t((i=N)=>[new ht(new l(e=>i.getByPlayer(e).some(r=>r.active()&&r.moves().value())),new p(e=>i.getByPlayer(e).filter(r=>r.active()&&r.moves().value()>0).sort((r,o)=>(r.waiting()?1:0)-(o.waiting()?1:0)).map(r=>new Va(e,r)))),new ht(new l(e=>i.getByPlayer(e).some(r=>!r.active()||!r.moves().value())),new p(e=>i.getByPlayer(e).filter(r=>!r.active()||r.moves().value()===0).sort((r,o)=>(r.waiting()?1:0)-(o.waiting()?1:0)).map(r=>new Ja(e,r))))],"getRules"),IE=l1});var m1,AE,BE=n(()=>{T();hh();wh();m1=t(()=>[new rf(new p(i=>i.action(new bv(i.tile(),i.tile(),i))))],"getRules"),AE=m1});var p1,GE,UE=n(()=>{Xl();Rn();Yp();I();ma();rm();rm();w();T();p1=t((i=or,e=d)=>[...[[vo,12,2,2],[bo,18,12,4,2],[Co,12,1,8,2],[Ei,8],[To,0],[Po,1,12,5,2],[Fi,6],[ki,4,1,2],[Io,6,6,6,2],[wo,0,0,2],[ur,4,2,10,2],[Si,2,2,3],[Ir,2,1,2],[Yi,4,4,4],[zi,4,2,2],[Ao,6,6,3],[Ni,3,2],[Bo,99,0,16],[Go,3,5],[Li,1,1,3],[We,0],[Wi,1,2],[ti,8,2,3,2],[wr,3],[Uo,10,5,3],[Mo,0,3,4],[Ar,1,0,3],[Do]].flatMap(([r,o=1,s=1,a=1,m=1])=>vx(r,o,s,a,m)),...[[hi,1,ui],[ua,.5,Ji,ui]].flatMap(([r,o,...s])=>s.map(a=>new sl(new l((m,u)=>u instanceof a),new l(m=>i.getByUnit(m).some(u=>u instanceof r)),new p((m,u)=>{let y=new a;e.process(ys,m.constructor,y),u.add(y.value()*o,r.name)}))))],"getRules"),GE=p1});var u1,ME,DE=n(()=>{K();T();Yf();u1=t((i=P)=>[new xl(new p((e,r)=>{i.emit("unit:unsupported",e,r)}))],"getRules"),ME=u1});var c1,EE,FE=n(()=>{w();T();yh();c1=t((i=()=>Math.random())=>[new Up(new l((e,r)=>e.moves().value()>=r),new p((e,r)=>(e.moves().subtract(r),!0))),new Up(new l((e,r)=>e.moves().value()<r),new p((e,r)=>{let o=e.moves().value();return e.moves().set(0),o>=r*.5*i()}))],"getRules"),EE=c1});var y1={};var kE=n(()=>{oE();aE();lE();pE();cE();fE();gE();OE();I();xE();bE();PE();wE();BE();UE();DE();FE();d.register(...iE(),...nE(),...sE(),...mE(),...uE(),...yE(),...dE(),...hE(),...RE(),...vE(),...TE(),...IE(),...AE(),...GE(),...ME(),...EE())});var YE=b(SE=>{"use strict";Object.defineProperty(SE,"__esModule",{value:!0});tE();kE()});var jn,zE=n(()=>{Pe();jn=class extends xe{};t(jn,"ApolloProgram")});var Br,NE=n(()=>{Pe();Br=class extends fe{};t(Br,"Colossus")});var ii,LE=n(()=>{Pe();ii=class extends fe{};t(ii,"CopernicusObservatory")});var So,WE=n(()=>{Pe();So=class extends xe{};t(So,"CureForCancer")});var Yo,jE=n(()=>{Pe();Yo=class extends xe{};t(Yo,"DarwinsVoyage")});var Gr,HE=n(()=>{Pe();Gr=class extends fe{};t(Gr,"GreatLibrary")});var zo,_E=n(()=>{Pe();zo=class extends fe{};t(zo,"GreatWall")});var oi,KE=n(()=>{Pe();oi=class extends fe{};t(oi,"HangingGardens")});var Hn,qE=n(()=>{Pe();Hn=class extends xe{};t(Hn,"HooverDam")});var No,VE=n(()=>{Pe();No=class extends xe{};t(No,"IsaacNewtonsCollege")});var _i,JE=n(()=>{Pe();_i=class extends xe{};t(_i,"JsBachsCathedral")});var ni,$E=n(()=>{Pe();ni=class extends xe{};t(ni,"Lighthouse")});var Lo,ZE=n(()=>{Pe();Lo=class extends fe{};t(Lo,"MagellansExpedition")});var _n,QE=n(()=>{Pe();_n=class extends xe{};t(_n,"ManhattanProject")});var Ur,XE=n(()=>{Pe();Ur=class extends xe{};t(Ur,"MichelangelosChapel")});var qt,eF=n(()=>{Pe();qt=class extends fe{};t(qt,"Oracle")});var Wo,tF=n(()=>{Pe();Wo=class extends fe{};t(Wo,"Pyramids")});var jo,rF=n(()=>{Pe();jo=class extends xe{};t(jo,"SetiProgram")});var Mr,iF=n(()=>{Pe();Mr=class extends xe{};t(Mr,"ShakespearesTheatre")});var Kn,oF=n(()=>{Pe();Kn=class extends xe{};t(Kn,"UnitedNations")});var Ki,nF=n(()=>{Pe();Ki=class extends xe{};t(Ki,"WomensSuffrage")});var qn=n(()=>{zE();NE();LE();WE();jE();HE();_E();KE();qE();VE();JE();$E();ZE();QE();XE();eF();tF();rF();iF();oF();nF()});var f1={};var aF=n(()=>{qn();Wl();Tn.register(jn,Br,ii,So,Yo,Gr,zo,oi,Hn,No,_i,ni,Lo,_n,Ur,qt,Wo,jo,Mr,Kn,Ki)});var Kd,It,Vn=n(()=>{he();Pe();Kd=class extends F{constructor(){super(fe)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.filter(r=>r.city().player()===e)}};t(Kd,"WonderRegistry");It=new Kd});var d1,sF,lF=n(()=>{qn();sr();np();ze();Vn();w();T();Pe();d1=t((i=z,e=It)=>[new Zt(new l((r,o)=>Object.isPrototypeOf.call(fe,o)),new p((r,o)=>new l(()=>e.filter(s=>s instanceof o).length===0))),...[[Br,Nr],[ii,vi],[Gr,Rr],[zo,Lt],[oi,dn],[ni,Hr],[Lo,nr],[qt,Ci],[Wo,Lt],[jn,uo],[So,un],[Yo,Jr],[Hn,ct],[No,go],[_i,vt],[_n,qr],[Ur,vt],[jo,Ti],[Mr,wi],[Kn,Rt],[Ki,xt]].map(([r,o])=>new Zt(new l((s,a)=>a===r),new p(s=>new l(()=>i.getByPlayer(s.player()).completed(o)))))],"getRules"),sF=d1});var g1,mF,pF=n(()=>{qn();sp();g1=t(()=>[...[[jn,600],[Br,200],[ii,300],[So,600],[Yo,300],[Gr,300],[zo,300],[oi,300],[Hn,600],[No,400],[_i,400],[ni,200],[Lo,400],[_n,600],[Ur,300],[qt,300],[Wo,300],[jo,600],[Mr,400],[Kn,600],[Ki,600]].flatMap(([i,e])=>jl(i,e))],"getRules"),mF=g1});var h1,uF,cF=n(()=>{Qn();K();ze();I();Vn();lp();w();qn();T();wu();Pe();h1=t((i=Qt,e=z,r=d,o=It,s=P)=>[new Pn(new l((a,m)=>m instanceof fe),new p((a,m)=>{let u=m.constructor;o.register(m),i.filter(y=>y.building()?.item()===u).forEach(y=>y.revalidate())})),new Pn(new l((a,m)=>m instanceof fe),new p((a,m)=>{s.emit("wonder:built",m,a.city())})),new Pn(new l((a,m)=>m instanceof Yo),new p(a=>{let m=e.getByPlayer(a.city().player()),u=t(c=>{let f=new Ml(new l(g=>g===m),new p(()=>{r.unregister(f),c()}));r.register(f)},"createOnStarted"),y=t(()=>{m.add(m.cost()),u(()=>m.add(m.cost()))},"completeResearch");if(m.researching()===null){u(()=>y());return}y()}))],"getRules"),uF=h1});var ep,qi,iu=n(()=>{Vn();w();ep=t((i,e=It)=>new l(r=>e.getByCity(r).some(o=>o instanceof i)),"cityHasWonder"),qi=t((i,e=It)=>new l(r=>e.getByPlayer(r.player()).some(o=>o instanceof i)),"playerHasWonder")});var yF,bn,qd,ou=n(()=>{ze();w();yF=t((i,e=z)=>new l(r=>e.getByPlayer(r.player()).completed(i)),"discoveredByPlayer"),bn=t((i,e=z)=>new l(()=>i===null||!e.some(r=>r.completed(i))),"notDiscoveredByAnyPlayer"),qd=t((i,e=z)=>new l(r=>i===null||!e.getByPlayer(r.player()).completed(i)),"notDiscoveredByPlayer")});var Vd,fF=n(()=>{cr();w();Vd=t((i,e=ve)=>new l(r=>e.getByCity(r).some(o=>o instanceof i)),"hasCityImprovement")});var O1,dF,gF=n(()=>{Di();cr();sr();qn();sn();ze();_e();Vn();iu();ou();kl();w();T();$n();Lm();Za();Ws();fF();Qi();O1=t((i=ve,e=pt,r=z,o=N,s=It)=>[new rt(new tt,qi(qt,s),Vd(Ut,i),qd(jt,r),bn(vt,r),new p((a,m)=>new Me(-Math.min(1,Ke(m,Me)),qt.name))),new rt(new tt,qi(qt,s),Vd(Ut,i),yF(jt,r),bn(vt,r),new p((a,m)=>new Me(-Math.min(2,Ke(m,Me)),qt.name))),new rt(new Fr(4e3),ep(Mr,s),bn(ct,r),new p((a,m)=>new Me(-Ke(m,Me),Mr.name))),new rt(new tt,qi(_i,s),new p((a,m)=>new Me(-Math.min(2,Ke(m,Me)),_i.name))),new rt(new tt,qi(Ur,s),Vd(mr,i),bn(Rt,r),new p((a,m)=>new Me(-Math.min(4,Ke(m,Me)),Ur.name))),new rt(new tt,qi(Ki,s),new l((a,m)=>m.some(u=>u instanceof wa)),new p((a,m)=>m.flatMap(u=>u instanceof wa?new Me(-1,Ki.name):[])))],"getRules"),dF=O1});var R1,hF,OF=n(()=>{Vn();$s();w();T();R1=t((i=It)=>[new kr(new l(e=>i.getByCity(e).length>0),new p(e=>i.getByCity(e).forEach(r=>i.unregister(r))))],"getRules"),hF=R1});var x1,RF,xF=n(()=>{qn();sr();Ws();ze();Vn();iu();Ll();T();Za();ou();x1=t((i=z,e=It)=>[new Ko(new Fr(500),ep(Br,e),bn(hr,i),new p(r=>new re(r.tilesWorked().filter(o=>o.yields().some(s=>s instanceof re)).length,Br.name))),...[[oi,1,Or],[So,1,null]].map(([r,o,s])=>new Ko(qi(r,e),bn(s,i),new p(()=>new Fo(o,r.name))))],"getRules"),RF=x1});var v1,vF,bF=n(()=>{qn();ze();Vn();iu();sr();T();$n();Ws();_u();ou();Qi();v1=t((i=z,e=It)=>[...[[ii,Kt,1,ut]].map(([r,o,s,a])=>new Zs(new tt,ep(r,e),bn(a,i),new p((m,u)=>new o(Ke(u,o)*s,r.name)))),...[[jo,Kt,.5,null]].map(([r,o,s,a])=>new Zs(new tt,qi(r,e),bn(a,i),new p((m,u)=>new o(Ke(u,o)*s,r.name))))],"getRules"),vF=v1});var Jd,$d,PR=n(()=>{B();Jd=class extends h{};t(Jd,"Obsolete");$d=Jd});var b1,CF,TF=n(()=>{sr();qn();ze();I();Vn();vu();w();T();PR();b1=t((i=z,e=d,r=It)=>[new Xa(new l(()=>r.some(o=>o instanceof Gr)),new l((o,s)=>{let[a]=r.filter(u=>u instanceof Gr).map(u=>u.city().player());return!i.getByPlayer(a).completed(s.sourceClass())}),new l((o,s)=>i.filter(a=>a.completed(s.sourceClass())).length>=3),new p((o,s)=>{let[a]=r.filter(u=>u instanceof Gr).map(u=>u.city().player());return i.getByPlayer(a).addAdvance(s.sourceClass())})),...[[Br,hr],[ii,ut],[Gr,ar],[zo,yt],[oi,Or],[No,qr],[ni,Nt],[Ur,Rt],[qt,vt],[Wo,Rt],[Mr,ct]].map(([o,s])=>new Xa(new l(()=>r.entries().some(a=>a instanceof o)),new l((a,m)=>m instanceof s),new p(()=>{let[a]=r.filter(m=>m instanceof o);e.process($d,a,a.city())})))],"getRules"),CF=b1});var C1,PF,IF=n(()=>{qn();ze();Vn();w();T();$n();sr();Xl();kn();rm();ou();iu();C1=t((i=It,e=z)=>[new Rp(new tt,new l((r,o)=>o instanceof $i),new l(r=>r instanceof Le),qi(ni,i),qd(Nt,e),new p((r,o)=>o.add(1))),new Rp(new tt,new l((r,o)=>o instanceof $i),new l(r=>r instanceof Le),qi(Lo,i),new p((r,o)=>o.add(1)))],"getRules"),PF=C1});var T1,wF,AF=n(()=>{K();T();PR();T1=t((i=P)=>[new $d(new p((e,r)=>{i.emit("wonder:obsolete",e,r)}))],"getRules"),wF=T1});var P1={};var BF=n(()=>{lF();pF();cF();gF();OF();xF();bF();I();TF();IF();AF();d.register(...sF(),...mF(),...uF(),...dF(),...hF(),...RF(),...vF(),...CF(),...PF(),...wF())});var UF=b(GF=>{"use strict";Object.defineProperty(GF,"__esModule",{value:!0});aF();BF()});var I1,MF,DF=n(()=>{ro();Sn();ze();sr();Sr();CR();w();I1=t((i=z,e=Ue)=>[...[[we,Ce,de,Ae,ie,ee],[Ze,Ce,Ae,Se],[ke,Bt,Ce,qe,de,Ae,Qe,Se,ie,Xe,mt]].map(([r,...o])=>new Qm(new l((s,a)=>a===r),new l(s=>o.some(a=>s.terrain()instanceof a)),new l((s,a)=>!e.getByTile(s).some(m=>m instanceof a)))),...[[ke,oo,ee]].map(([r,o,...s])=>new Qm(new l((a,m)=>m===r),new l(a=>s.some(m=>a.terrain()instanceof m)),new l((a,m)=>!e.getByTile(a).some(u=>u instanceof m)),new l((a,m,u)=>i.getByPlayer(u).completed(o)))),...[[ir,Jr,ke,Bt,Ce,qe,de,Ae,Qe,Se,ie,ee,Xe,mt]].map(([r,o,s,...a])=>new Qm(new l((m,u)=>u===r),new l(m=>a.some(u=>m.terrain()instanceof u)),new l((m,u)=>!e.getByTile(m).some(y=>y instanceof u)),new l(m=>e.getByTile(m).some(u=>u instanceof s)),new l((m,u,y)=>i.getByPlayer(y).completed(o))))],"getRules"),MF=I1});var w1,EF,FF=n(()=>{K();Sn();Sr();Ty();w();T();w1=t((i=Ue,e=P)=>[new la(new l((r,o)=>i.getByTile(r).every(s=>o.constructor!==s.constructor)),new p((r,o)=>i.register(o))),new la(new p(r=>r.clearYieldCache(null))),new la(new p((r,o)=>{e.emit("tile-improvement:built",r,o)})),...[[Ze,we],[we,Ze]].map(([r,o])=>new la(new l((s,a)=>a instanceof r),new l(s=>i.getByTile(s).some(a=>a instanceof o)),new p(s=>i.unregister(...i.getByTile(s).filter(a=>a instanceof o)))))],"getRules"),EF=w1});var Zd,Qd,IR=n(()=>{Ho();gi();Zd=class extends He{constructor(){super(Ne)}};t(Zd,"AvailableTerrainFeatureRegistry");Qd=new Zd});var A1,kF,SF=n(()=>{IR();I();Pg();T();mm();A1=t((i=d,e=Qd)=>[new Su(new p(r=>{let o=i.get(Is);e.entries().forEach(s=>o.filter(a=>a.validate(s,r)).forEach(a=>a.process(s,r)))}))],"getRules"),kF=A1});var Mt,wR=n(()=>{B();Mt=class extends h{};t(Mt,"Distribution")});var B1,YF,zF=n(()=>{ro();wR();$t();w();T();B1=t(()=>[new Mt(new l(i=>i===Bt),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{from:0,to:.01,fill:!0},{from:.01,to:.02},{from:.98,to:.99},{from:.99,to:1,fill:!0}])),new Mt(new l(i=>i===Ce),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{from:.4,to:.45},{from:.45,to:.55,coverage:.025,cluster:!0,clusterChance:.1},{from:.55,to:.6}])),new Mt(new l(i=>i===qe),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{from:.05,to:.2},{from:.2,to:.4,cluster:!0,clusterChance:.1,coverage:.1},{from:.4,to:.6},{from:.6,to:.8,cluster:!0,clusterChance:.1,coverage:.1},{from:.8,to:.95}])),new Mt(new l(i=>i===de),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{fill:!0}])),new Mt(new l(i=>i===Ae),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{from:.1,to:.9,path:!0,pathChance:.1,coverage:.06}])),new Mt(new l(i=>i===Qe),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{from:.3,to:.45,cluster:!0,clusterChance:.2,coverage:.08},{from:.55,to:.7,cluster:!0,clusterChance:.2,coverage:.08}])),new Mt(new l(i=>i===Se),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{from:.01,to:.1,coverage:.3,path:!0},{from:.1,to:.9,path:!0},{from:.9,to:.99,coverage:.3,path:!0}])),new Mt(new l(i=>i===ot),new l((i,e)=>e.some(r=>r.constructor===Jt)),new p(()=>[{fill:!0}])),new Mt(new l(i=>i===ie),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{from:.01,to:.2,coverage:.3},{from:.2,to:.4},{from:.1,to:.4,cluster:!0},{from:.4,to:.6},{from:.6,to:.8},{from:.6,to:.9,cluster:!0},{from:.8,to:.99,coverage:.3}])),new Mt(new l(i=>i===ee),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{from:.1,to:.9,coverage:.1,path:!0,pathChance:.5}])),new Mt(new l(i=>i===Xe),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{from:.2,to:.4,cluster:!0},{from:.6,to:.8,cluster:!0}])),new Mt(new l(i=>i===mt),new l((i,e)=>e.some(r=>r instanceof j)),new p(()=>[{from:.01,to:.15,cluster:!0,coverage:.15},{from:.85,to:.99,cluster:!0,coverage:.15}]))],"getRules"),YF=B1});var Xd,eg,AR=n(()=>{B();Xd=class extends h{};t(Xd,"DistributionGroups");eg=Xd});var G1,NF,LF=n(()=>{ro();T();AR();G1=t(()=>[new eg(new p(()=>[ot,de,Xe,Se,Qe,Ae,qe,Ce,ie,mt,Bt,ee]))],"getRules"),NF=G1});var U1,WF,jF=n(()=>{ro();Fp();Qo();mm();U1=t((i=lt)=>[...[[en,.2,Ae],[tn,.2,ot],[Oi,.2,qe,mt],[rn,.2,Qe],[on,.2,Se],[to,.2,ie],[Ri,.2,Ce],[nn,.2,Xe],[an,.2,Bt],[Xo,.5,de,ee]].flatMap(([r,o,...s])=>s.flatMap(a=>Xx(a,r,o,i)))],"getRules"),WF=U1});var tg,rg,HF=n(()=>{B();tg=class extends h{};t(tg,"Pillaged");rg=tg});var M1,_F,KF=n(()=>{K();Sr();HF();w();T();M1=t((i=Ue,e=P)=>[new rg(new l((r,o)=>i.getByTile(r).includes(o)),new p((r,o)=>i.unregister(o))),new rg(new p(r=>r.clearYieldCache(null))),new rg(new p((r,o)=>{e.emit("tile-improvement:pillaged",r,o)}))],"getRules"),_F=M1});var BR,GR,UR,D1,E1,F1,k1,qF,VF=n(()=>{dR();K();aa();ro();T();RR();BR=new Map,GR=new Map,UR=new Map,D1=t((i,e=null)=>(GR.has(i)||GR.set(i,i.score(e,[[J,8],[H,3],[re,1]])),GR.get(i)),"tileScore"),E1=t((i,e=null)=>(UR.has(i)||UR.set(i,i.getSurroundingArea().entries().reduce((r,o)=>r+D1(o,e),0)),UR.get(i)),"areaScore"),F1=t((i,e=P)=>{if(!BR.has(i)){e.emit("world:generate-start-tiles");let r=i.entries().filter(o=>[de,ie,ee].some(s=>o.terrain()instanceof s)).map(o=>({tile:o,score:E1(o)})).sort(({score:o},{score:s})=>s-o).map(({tile:o})=>o);BR.set(i,r),e.emit("world:start-tiles",r)}return BR.get(i)},"pickStartTiles"),k1=t((i=Td,e=P,r=()=>Math.random())=>[new Dd(new p((o,s,a)=>{if(e.option("earth",!1))try{return i.getStartTileByCivilizationAndWorld(s.civilization().sourceClass(),o)}catch{a.push(...i.entries().map(y=>y.startTileForMap(o)))}let m=F1(o,e);return m.forEach(u=>{a.some(y=>y.distanceFrom(u)<=4)&&m.splice(m.indexOf(u),1)}),m[Math.floor(m.length*r())]}))],"getRules"),qF=k1});var ig,tp,og=n(()=>{Rd();Ho();ig=class extends He{constructor(){super(Od)}};t(ig,"GeneratorRegistry");tp=new ig});var ng,ag,MR=n(()=>{B();ng=class extends h{};t(ng,"PickGenerator");ag=ng});var sg,lg,DR=n(()=>{B();sg=class extends h{};t(sg,"Start");lg=sg});var mg,JF,$F=n(()=>{Z();I();wd();he();Vi();mg=class extends S{#e;#t;#r;#i=new Al(ce);#o;constructor(e,r=d){super(),this.#e=e,this.#t=e.height(),this.#o=e.width(),this.#r=r,this.addKey("height","tiles","width")}build(){return new Promise(e=>{this.#e.generate().then(r=>{r.forEach((o,s)=>{let a=new ce(s%this.#o,Math.floor(s/this.#o),o,this,this.#r);this.#i.register(a)}),this.#r.process(js,this),e(this)})})}entries(){return this.#i.entries()}filter(e){return this.entries().filter(e)}forEach(e){return this.#i.forEach(e)}get(e,r){return this.entries()[this.#e.coordsToIndex(e,r)]}height(){return this.#t}includes(e){return this.#i.includes(e)}map(e){return this.#i.map(e)}register(...e){this.#i.register(...e)}tiles(){return this.entries()}width(){return this.#o}};t(mg,"World");JF=mg});var S1,ZF,QF=n(()=>{og();I();K();T();MR();DR();$F();S1=t((i=d,e=tp,r=P)=>[new lg(new p(()=>{let[o]=i.process(ag),s=new o(parseInt(r.option("height",100),10),parseInt(r.option("width",160),10),{landCoverage:parseFloat(r.option("landCoverage",.4)),landSize:parseFloat(r.option("landSize",.2)),maxIterations:parseInt(r.option("maxIterations",20),10)});new JF(s,i).build()}))],"getRules"),ZF=S1});var Y1,XF,e0=n(()=>{Fp();ro();aa();Sn();On();sn();Qo();Sr();w();T();Ag();Y1=t((i=Ue,e=lt,r=pt)=>[...[[J,qe,1],[J,de,2],[J,Ae,1],[J,Qe,1],[J,ot,1],[J,ie,1],[J,ee,2],[J,Xe,1],[J,mt,1],[H,Ce,1],[H,qe,2],[H,Se,1],[H,ie,1]].map(([o,s,a])=>new li(new l(m=>m.terrain()instanceof s),new p(()=>new o(a,s.name)))),...[[H,en,2],[J,tn,1],[J,Oi,1],[re,rn,2],[re,on,3],[H,to,1],[J,Ri,2],[H,nn,3],[J,an,2],[H,Xo,1]].map(([o,s,a])=>new li(new l(m=>e.getByTerrain(m.terrain()).some(u=>u instanceof s)),new p(()=>new o(a,s.name)))),...[[H,en,1],[J,tn,1],[J,Oi,1],[re,rn,2],[re,on,2],[H,to,1],[J,Ri,1],[H,nn,1],[J,an,1]].map(([o,s,a])=>new li(new l((m,u)=>{if(!u)return!1;try{return r.getByPlayer(u).is(bt,nt,at,ft)}catch{return!1}}),new l(m=>e.getByTerrain(m.terrain()).some(u=>u instanceof s)),new p(()=>new o(a,s.name)))),new li(new l(o=>o.terrain()instanceof ot),new p(()=>new re(2,ot.name))),new li(new l(o=>o.terrain()instanceof ee),new p(()=>new re(1))),new li(new l((o,s)=>{if(!s)return!1;try{return r.getByPlayer(s).is(nt,ft)}catch{return!1}}),new l(o=>o.terrain()instanceof ee||o.terrain()instanceof ot),new p(()=>new re(1,ot.name))),...[[Ce,J,we,1],[Ce,H,Ze,1],[Ae,J,we,1],[Ae,H,Ze,2],[Se,H,Ze,1],[ie,J,we,1]].map(([o,s,a,m])=>new li(new l(u=>u.terrain()instanceof o),new l(u=>i.getByTile(u).some(y=>y instanceof a)),new p(()=>new s(m,a.name)))),...[[Ce,H,Ze,1],[de,J,we,1],[Ae,H,Ze,1],[Se,H,Ze,1],[ee,J,we,1]].map(([o,s,a,m])=>new li(new l((u,y)=>{if(!y)return!1;try{return r.getByPlayer(y).is(bt,nt,at,ft)}catch{return!1}}),new l(u=>u.terrain()instanceof o),new l(u=>i.getByTile(u).some(y=>y instanceof a)),new p(()=>new s(m,a.name)))),...[Ce,de,ie].map(o=>new li(new l(s=>s.terrain()instanceof o),new l(s=>i.getByTile(s).some(a=>a instanceof ke)),new p(()=>new re(1,ke.name)))),...[Ce,de,ie].map(o=>new li(new l((s,a)=>{if(!a)return!1;try{return r.getByPlayer(a).is(nt,ft)}catch{return!1}}),new l(s=>s.terrain()instanceof o),new l(s=>i.getByTile(s).some(a=>a instanceof ke)),new p(()=>new re(1,ke.name))))],"getRules"),XF=Y1});var z1,t0,r0=n(()=>{aa();Sr();w();T();$n();Sn();wg();z1=t((i=Ue)=>[...[[J,.5],[H,.5],[re,.5]].map(([e,r])=>new Nu(new Jn,new l((o,s,a)=>a.some(m=>m instanceof e)),new l(o=>i.getByTile(o).some(s=>s instanceof ir)),new p((o,s,a)=>{let m=a.filter(u=>u instanceof e).reduce((u,y)=>u+y.value(),0);a.push(new e(Math.floor(m*r),ir.name))})))],"getRules"),t0=z1});var N1,i0,o0=n(()=>{K();og();vd();T();MR();N1=t((i=tp,e=P,r=()=>Math.random())=>[new ag(new p(()=>{if(e.option("earth",!1))return $m;let o=i.entries();if(o.length===0)throw new TypeError("No available `World` generators.");return o[Math.floor(o.length*r())]}))],"getRules"),i0=N1});var L1={};var n0=n(()=>{DF();FF();SF();zF();LF();jF();I();KF();VF();QF();e0();r0();o0();d.register(...MF(),...EF(),...kF(),...YF(),...NF(),...WF(),..._F(),...qF(),...ZF(),...XF(),...t0(),...i0())});var pg,ug,ER=n(()=>{Ho();Sl();pg=class extends He{constructor(){super(Cn)}};t(pg,"TerrainRegistry");ug=new pg});var W1={};var a0=n(()=>{ro();ER();ug.register(Bt,Ce,qe,de,Ae,Qe,Se,ot,ie,ee,Xe,mt)});var j1={};var s0=n(()=>{Fp();IR();Qd.register(en,tn,Oi,rn,on,to,Ri,nn,an,Xo)});var m0=b(l0=>{"use strict";Object.defineProperty(l0,"__esModule",{value:!0});n0();a0();s0()});var H1,p0,u0=n(()=>{Je();Vt();qo();Vi();H1=t((i=L)=>[new oe(_,"cities",e=>i.getByPlayer(e)),new oe(ce,"city",e=>i.getByTile(e))],"getAdditionalData"),p0=H1});var _1={};var c0=n(()=>{Et();u0();ne.register(...p0())});var f0=b(y0=>{"use strict";Object.defineProperty(y0,"__esModule",{value:!0});c0()});var K1,d0,g0=n(()=>{Qn();Vt();Zn();K1=t((i=Qt)=>[new oe(it,"build",e=>i.getByCity(e))],"getAdditionalData"),d0=K1});var q1={};var h0=n(()=>{g0();Et();ne.register(...d0())});var R0=b(O0=>{"use strict";Object.defineProperty(O0,"__esModule",{value:!0});h0()});var V1,x0,v0=n(()=>{rr();Vt();Zn();V1=t((i=ye)=>[new oe(it,"growth",e=>i.getByCity(e))],"getAdditionalData"),x0=V1});var J1={};var b0=n(()=>{Et();v0();ne.register(...x0())});var T0=b(C0=>{"use strict";Object.defineProperty(C0,"__esModule",{value:!0});b0()});var $1,P0,I0=n(()=>{cr();Vt();Zn();$1=t((i=ve)=>[new oe(it,"improvements",e=>i.getByCity(e))],"getAdditionalData"),P0=$1});var Z1={};var w0=n(()=>{Et();I0();ne.register(...P0())});var B0=b(A0=>{"use strict";Object.defineProperty(A0,"__esModule",{value:!0});w0()});var Q1,G0,U0=n(()=>{Fs();Vt();Vi();Q1=t((i=Yr)=>[new oe(ce,"goodyHut",e=>i.getByTile(e))],"getAdditionalData"),G0=Q1});var X1={};var M0=n(()=>{Et();U0();ne.register(...G0())});var E0=b(D0=>{"use strict";Object.defineProperty(D0,"__esModule",{value:!0});M0()});var eL,F0,k0=n(()=>{sn();Vt();qo();eL=t((i=pt)=>[new oe(_,"government",e=>i.getByPlayer(e))],"getAdditionalData"),F0=eL});var tL={};var S0=n(()=>{k0();Et();ne.register(...F0())});var z0=b(Y0=>{"use strict";Object.defineProperty(Y0,"__esModule",{value:!0});S0()});var rL,N0,L0=n(()=>{Zi();Vt();qo();rL=t((i=ae)=>[new oe(_,"world",e=>i.getByPlayer(e))],"getAdditionalData"),N0=rL});var iL={};var W0=n(()=>{Et();L0();ne.register(...N0())});var H0=b(j0=>{"use strict";Object.defineProperty(j0,"__esModule",{value:!0});W0()});var oL,_0,K0=n(()=>{ze();Vt();qo();oL=t((i=z)=>[new oe(_,"research",e=>i.getByPlayer(e))],"getAdditionalData"),_0=oL});var nL={};var q0=n(()=>{Et();K0();ne.register(..._0())});var J0=b(V0=>{"use strict";Object.defineProperty(V0,"__esModule",{value:!0});q0()});var aL,$0,Z0=n(()=>{Qo();Vt();Sl();aL=t((i=lt)=>[new oe(Cn,"features",e=>i.getByTerrain(e))],"getAdditionalData"),$0=aL});var sL={};var Q0=n(()=>{Et();Z0();ne.register(...$0())});var ek=b(X0=>{"use strict";Object.defineProperty(X0,"__esModule",{value:!0});Q0()});var lL,tk,rk=n(()=>{Sr();Vt();Vi();lL=t((i=Ue)=>[new oe(ce,"improvements",e=>i.getByTile(e))],"getAdditionalData"),tk=lL});var mL={};var ik=n(()=>{Et();rk();ne.register(...tk())});var nk=b(ok=>{"use strict";Object.defineProperty(ok,"__esModule",{value:!0});ik()});var pL,ak,sk=n(()=>{ru();Vt();qo();pL=t((i=Ks)=>[new oe(_,"rates",e=>i.getByPlayer(e))],"getAdditionalData"),ak=pL});var uL={};var lk=n(()=>{Et();sk();ne.register(...ak())});var pk=b(mk=>{"use strict";Object.defineProperty(mk,"__esModule",{value:!0});lk()});var cL,uk,ck=n(()=>{el();Vt();qo();cL=t((i=mi)=>[new oe(_,"treasury",e=>i.getByPlayer(e))],"getAdditionalData"),uk=cL});var yL={};var yk=n(()=>{Et();ck();ne.register(...uk())});var dk=b(fk=>{"use strict";Object.defineProperty(fk,"__esModule",{value:!0});yk()});var cg,gk,hk=n(()=>{B();cg=class extends h{};t(cg,"End");gk=cg});var yg,Ok,Rk=n(()=>{B();yg=class extends h{};t(yg,"Start");Ok=yg});var fL,xk,vk=n(()=>{K();I();fi();hk();DR();Rk();fL=t((i=d,e=P,r=Ge)=>[["engine:start",()=>{i.process(lg)}],...["game:start","turn:end"].map(o=>[o,()=>{e.emit("turn:start",r.increment())}]),["turn:end",()=>{i.process(gk,r)}],["turn:start",()=>{i.process(Ok,r)}]],"getEvents"),xk=fL});var dL={};var bk=n(()=>{K();vk();[...xk()].forEach(([i,e])=>{P.on(i,e)})});var Tk=b(Ck=>{"use strict";Object.defineProperty(Ck,"__esModule",{value:!0});bk()});var gL,Pk,Ik=n(()=>{_e();Vt();Zn();qo();Vi();gL=t((i=N)=>[new oe(it,"units",e=>i.getByCity(e)),new oe(_,"units",e=>i.getByPlayer(e,!0)),new oe(ce,"units",e=>i.getByTile(e))],"getAdditionalData"),Pk=gL});var hL={};var wk=n(()=>{Et();Ik();ne.register(...Pk())});var Bk=b(Ak=>{"use strict";Object.defineProperty(Ak,"__esModule",{value:!0});wk()});var OL,Gk,Uk=n(()=>{ma();Vt();ta();OL=t((i=or)=>[new oe(Ie,"improvements",e=>i.getByUnit(e))],"getAdditionalData"),Gk=OL});var RL={};var Mk=n(()=>{Et();Uk();ne.register(...Gk())});var Ek=b(Dk=>{"use strict";Object.defineProperty(Dk,"__esModule",{value:!0});Mk()});var fg,Fk,kk=n(()=>{Ho();Sh();fg=class extends He{constructor(){super(Tf)}};t(fg,"AIClientRegistry");Fk=new fg});var xL={};var Sk=n(()=>{kk();vm();Fk.register(Nn)});var vL,Yk,zk=n(()=>{fl();_e();Js();w();T();vm();vL=t((i=N,e=Eo)=>[new yr(new l((r,o)=>e.getByPlayer(o)instanceof Nn),new p((r,o,s)=>e.getByPlayer(o).cityLost(r,s,!1)))],"getRules"),Yk=vL});var bL,Nk,Lk=n(()=>{fl();_e();w();$s();T();vm();bL=t((i=N,e=Eo)=>[new kr(new l(r=>e.getByPlayer(r.player())instanceof Nn),new p((r,o)=>e.getByPlayer(r.player()).cityLost(r,o,!0)))],"getRules"),Nk=bL});var CL,Wk,jk=n(()=>{fl();_e();w();Gp();T();vm();CL=t((i=N,e=Eo)=>[new $o(new l(r=>e.getByPlayer(r.player())instanceof Nn),new p((r,o)=>e.getByPlayer(r.player()).unitDestroyed(r,o&&o.player())))],"getRules"),Wk=CL});var TL={};var Hk=n(()=>{I();zk();Lk();jk();d.register(...Yk(),...Wk(),...Nk())});var Kk=b(_k=>{"use strict";Object.defineProperty(_k,"__esModule",{value:!0});Sk();Hk()});var dg,qk,Vk=n(()=>{wR();Rd();$t();I();ER();AR();fR();dg=class extends Jm{#e;#t;#r;#i;#o;#a;#n;#s;#l;#m;constructor(e=100,r=160,o={},s=d,a=ug,m=()=>Math.random()){super(e,r);let{landCoverage:u=.4,landSize:y=.2,maxIterations:c=10,clusterChance:f=.05,coverage:g=.25,pathChance:U=.05}=o;this.#e=u,this.#t=y,this.#r=c,this.#i=f,this.#o=g,this.#a=U,this.#l=s,this.#m=a,this.#s=m,this.#n=new Array(this.height()*this.width()).fill(0).map(()=>new Jt)}async generateIslands(){let e=this.height(),r=this.width(),o=this.#t+this.#s()*.2,s=this.#e,a=this.#r,m=Math.ceil(e*r/100*o),u=new Array(e*r).fill(0);for(;u.length===0||u.filter(y=>y===1).length/u.length<s;){let y={},c=[],f=[],g=Math.floor(e*r*Math.random()),U=t(D=>{D in y||(y[D]=0),y[D]++},"flagAsSeen");for(u[g]=1,c.push(g),U(g),f.push(...Pl(e,r,g));f.length;){let D=f.shift();if((y[D]||0)<=a&&(Math.random()>.3?(u[D]=1,c.push(D),Pl(e,r,D).filter(A=>f.indexOf(A)===-1).forEach(A=>f.push(A))):Pl(e,r,D).forEach(A=>{let E=f.indexOf(A);E>-1&&f.splice(E,1)}),U(D)),c.length>m||u.filter(A=>A===1).length/u.length>=s)break}if(u.filter(D=>D===1).length/u.length>=s)break}this.#n=u.map(y=>y===1?new j:new Jt)}generate(){return this.generateIslands().then(()=>this.populateTerrain().then(()=>this.#n))}getNeighbours(e,r=!0){return Pl(this.height(),this.width(),e,r)}populateTerrain(){return new Promise(e=>{let r=this.#l.get(Mt);this.#l.get(eg).filter(o=>o.validate()).map(o=>{let s=o.process();if(!s)throw new TypeError("Unexpected data from DistributionGroups.");return s}).forEach(o=>o.forEach(s=>r.filter(a=>a.validate(s,this.#n)).map(a=>{let m=a.process(s,this.#n);if(!m)throw new TypeError("Unexpected data from Distribution.");return m}).forEach(a=>a.forEach(({cluster:m=!1,clusterChance:u=this.#i,coverage:y=this.#o,fill:c=!1,from:f=0,path:g=!1,pathChance:U=this.#a,to:D=1})=>{let A=Object.keys(this.#n).map(V=>parseInt(V,10)).filter(V=>this.#n[V]instanceof s.__proto__).filter(V=>V>=f*this.height()*this.width()&&V<=D*this.height()*this.width());if(c){A.forEach(V=>{this.#n[V]=new s});return}let E=A.length*y;for(;E>0;){let V=A[Math.floor(this.#s()*A.length)];if(this.#n[V]=new s,E--,m){let se=this.getNeighbours(V).filter(wt=>!(this.#n[wt]instanceof s));for(;se.length&&E>0;){let wt=se.shift();u>=this.#s()/this.distanceFrom(V,wt)&&(this.#n[wt]=new s,E--,se.push(...this.getNeighbours(wt).filter(Dr=>!(this.#n[Dr]instanceof s)).filter(Dr=>this.#n[Dr]instanceof s.__proto__).filter(Dr=>!se.includes(Dr))))}}if(g){let se=V;for(;U>=this.#s();){let wt=this.getNeighbours(se).filter(Dr=>this.#n[Dr]instanceof s.__proto__&&!(this.#n[Dr]instanceof s));se=wt[Math.floor(this.#s()*wt.length)],this.#n[se]=new s,E--}}}})))),e()})}};t(dg,"BaseGenerator");qk=dg});var PL={};var Jk=n(()=>{Vk();og();tp.register(qk)});var Zk=b($k=>{"use strict";Object.defineProperty($k,"__esModule",{value:!0});Jk()});var IL={};var IHe,wHe,AHe,BHe,GHe,UHe,MHe,DHe,EHe,FHe,kHe,SHe,YHe,zHe,NHe,LHe,WHe,jHe,HHe,_He,KHe,qHe,VHe,JHe,$He,ZHe,QHe,XHe,e_e,t_e,r_e,i_e,o_e,n_e,a_e,s_e,l_e,m_e,p_e,u_e,c_e,y_e,f_e,d_e,g_e,h_e,O_e,R_e,x_e,v_e,b_e,C_e,T_e,P_e,I_e,w_e,A_e,B_e,G_e,U_e,M_e,D_e,E_e,F_e,k_e,S_e,Y_e,z_e,N_e,L_e,W_e,j_e,H_e,__e,K_e,q_e,V_e,J_e,$_e,Z_e,Q_e,X_e,eKe,tKe,rKe,iKe,oKe,nKe,aKe,sKe,lKe,mKe,pKe,uKe,cKe,yKe,fKe,dKe,gKe,hKe,OKe,RKe,xKe,vKe,bKe,CKe,TKe,PKe,IKe,wKe,AKe,BKe,GKe,UKe,Qk=n(()=>{"use strict";IHe=C(fT()),wHe=C(OT()),AHe=C(bT()),BHe=C(IT()),GHe=C(GT()),UHe=C(ET()),MHe=C(YT()),DHe=C(WT()),EHe=C(KT()),FHe=C($T()),kHe=C(eP()),SHe=C(oP()),YHe=C(lP()),zHe=C(cP()),NHe=C(dP()),LHe=C(OP()),WHe=C(vP()),jHe=C(TP()),HHe=C(wP()),_He=C(GP()),KHe=C(DP()),qHe=C(kP()),VHe=C(zP()),JHe=C(WP()),$He=C(_P()),ZHe=C(VP()),QHe=C(ZP()),XHe=C(eI()),e_e=C(iI()),t_e=C(aI()),r_e=C(mI()),i_e=C(cI()),o_e=C(dI()),n_e=C(OI()),a_e=C(vI()),s_e=C(TI()),l_e=C(wI()),m_e=C(GI()),p_e=C(DI()),u_e=C(kI()),c_e=C(zI()),y_e=C(WI()),f_e=C(_I()),d_e=C(VI()),g_e=C(ZI()),h_e=C(ew()),O_e=C(iw()),R_e=C(aw()),x_e=C(mw()),v_e=C(cw()),b_e=C(dw()),C_e=C(Ow()),T_e=C(vw()),P_e=C(Tw()),I_e=C(ww()),w_e=C(Gw()),A_e=C(Dw()),B_e=C(kw()),G_e=C(zw()),U_e=C(Ww()),M_e=C(_w()),D_e=C(Vw()),E_e=C(Zw()),F_e=C(eA()),k_e=C(iA()),S_e=C(aA()),Y_e=C(mA()),z_e=C(cA()),N_e=C(dA()),L_e=C(OA()),W_e=C(vA()),j_e=C(TA()),H_e=C(wA()),__e=C(GA()),K_e=C(DA()),q_e=C(kA()),V_e=C(zA()),J_e=C(WA()),$_e=C(_A()),Z_e=C(VA()),Q_e=C(ZA()),X_e=C(EB()),eKe=C(QB()),tKe=C(bG()),rKe=C(CU()),iKe=C(MU()),oKe=C(LU()),nKe=C(KU()),aKe=C(mM()),sKe=C(vM()),lKe=C(iD()),mKe=C(TD()),pKe=C(ND()),uKe=C(eE()),cKe=C(YE()),yKe=C(UF()),fKe=C(m0()),dKe=C(f0()),gKe=C(R0()),hKe=C(T0()),OKe=C(B0()),RKe=C(E0()),xKe=C(z0()),vKe=C(H0()),bKe=C(J0()),CKe=C(ek()),TKe=C(nk()),PKe=C(pk()),IKe=C(dk()),wKe=C(Tk()),AKe=C(Bk()),BKe=C(Ek()),GKe=C(Kk()),UKe=C(Zk())});Rg();Eg();Fg();uc();Kl();var pp=class extends as{#e;#t;constructor(e,r=wn,o=()=>Math.random()){super(e),this.#e=r,this.#t=o}chooseCivilization(e){let r=e[Math.floor(e.length*this.#t())],o=this.player(),s=new r;o.setCivilization(s),this.chooseLeader(s)}chooseLeader(e){let r=this.#e.getByCivilization(e.constructor),o=r[Math.floor(r.length*this.#t())];e.setLeader(new o)}};t(pp,"Client");Sg();fr();Yg();Zn();Ic();Be();kt();_g();Z();var ps,Dc=class{constructor(){ge(this,ps,[])}add(e,r,o=null){v(this,ps).push({[e]:{type:"add",index:o,value:r}})}clear(){v(this,ps).splice(0)}remove(e,r=null){v(this,ps).push({[e]:{type:"remove",index:r}})}transferData(){return v(this,ps).slice(0).map(e=>{let r={};return Object.entries(e).forEach(([o,{type:s,index:a,value:m}])=>{r[o]={type:s,index:a,value:typeof m=="function"?m():m}}),r})}update(e,r,o=null){v(this,ps).push({[e]:{type:"update",index:o,value:r}})}};t(Dc,"DataQueue"),ps=new WeakMap;var sx=Dc;Fc();qs();qo();qg();Kc();var qc=class extends Error{constructor(e,r,o){super(e)}};t(qc,"RetryFailed");var yx=qc;var yp,fp,$l,dp,Zl,gp,hp,Vc=class{constructor(e,r=5,o=100){ge(this,yp,0);ge(this,fp,void 0);ge(this,$l,void 0);ge(this,dp,void 0);ge(this,Zl,void 0);ge(this,gp,void 0);ge(this,hp,void 0);Ee(this,$l,e),Ee(this,dp,r),Ee(this,Zl,setInterval(()=>this.run(),o)),Ee(this,fp,new Promise((s,a)=>{Ee(this,hp,s),Ee(this,gp,a)}))}run(){if(++SR(this,yp)._>v(this,dp)){clearInterval(v(this,Zl)),v(this,gp).call(this,new yx("Retry failed.",v(this,$l),v(this,yp)));return}v(this,$l).call(this)&&(clearInterval(v(this,Zl)),v(this,hp).call(this))}then(){return v(this,fp)}};t(Vc,"Retryable"),yp=new WeakMap,fp=new WeakMap,$l=new WeakMap,dp=new WeakMap,Zl=new WeakMap,gp=new WeakMap,hp=new WeakMap;var fx=Vc;Jg();Z();var Jc=class extends Ye{constructor(e){super(),Object.assign(this,e),this.addKey(...Object.keys(e))}};t(Jc,"TransferObject");var $c=Jc;Vi();ta();Z();rr();var xp,vp,bp,Cp,th=class extends Ye{constructor(r,o,s,a){super();ge(this,xp,void 0);ge(this,vp,void 0);ge(this,bp,{size:0});ge(this,Cp,void 0);Ee(this,xp,r),Ee(this,vp,s),v(this,bp).size=a,Ee(this,Cp,o),this.addKey("_","growth","name","player","tile")}static fromCity(r){let o=ye.getByCity(r);return new th(r.name(),r.tile(),r.player(),o.size())}_(){return"City"}name(){return v(this,xp)}player(){return v(this,vp)}growth(){return v(this,bp)}tile(){return v(this,Cp)}},ny=th;t(ny,"City"),xp=new WeakMap,vp=new WeakMap,bp=new WeakMap,Cp=new WeakMap;var bx=ny;Z();var Tp,rh=class extends Ye{constructor(r){super();ge(this,Tp,void 0);Ee(this,Tp,r),this.addKey("_","civilization")}static fromPlayer(r){return new rh(r.civilization())}_(){return"Player"}civilization(){return v(this,Tp)}},ay=rh;t(ay,"Player"),Tp=new WeakMap;var Cx=ay;Z();var Pp,Ip,wp,ih=class extends Ye{constructor(r,o,s){super();ge(this,Pp,void 0);ge(this,Ip,void 0);ge(this,wp,void 0);Ee(this,Pp,r),Ee(this,Ip,o),Ee(this,wp,s),this.addKey("_","tile","player")}static fromUnit(r){return new ih(r.constructor.name,r.tile(),r.player())}_(){return v(this,Pp)}player(){return v(this,wp)}tile(){return v(this,Ip)}},sy=ih;t(sy,"Unit"),Pp=new WeakMap,Ip=new WeakMap,wp=new WeakMap;var Tx=sy;Pe();G();Je();Ap();K();Kl();fs();ze();el();Zi();fi();_e();Z();I();fi();nh();var gy=class extends S{#e=new Map;#t;#r;constructor(e=Ge,r=d){super(),this.#t=r,this.#r=e,this.addKey("value")}value(e=this.#r.value()){if(!this.#e.has(e)){let[o]=this.#t.process(ds,e);this.#e.set(e,o)}let r=this.#e.get(e);if(typeof r!="number")throw new TypeError("Invalid cache result.");return r}};t(gy,"Year");var hy=new gy;nm();oh();var Ax=t(i=>i instanceof Ye?{"#ref":i.id()}:i,"referenceObject"),Fe=t((...i)=>e=>i.some(r=>e instanceof r)?Ax(e):e,"filterToReference"),wx=t((...i)=>e=>i.some(r=>e instanceof r)?e:Ax(e),"filterToReferenceAllExcept"),ah=new Map,sh=new Map,lh=new Map,pe,X,ml,hs,Un,Bp,Oy=class extends pp{constructor(r,o,s){super(r);ge(this,pe,t((r=o=>o)=>o=>o instanceof _&&o!==this.player()?(ah.has(o)||ah.set(o,Cx.fromPlayer(o)),ah.get(o)):o instanceof Ie&&o.player()!==this.player()?(sh.has(o)||sh.set(o,Tx.fromUnit(o)),sh.get(o)):o instanceof it&&o.player()!==this.player()?(lh.has(o)||lh.set(o,bx.fromCity(o)),lh.get(o)):o instanceof ce?ae.getByPlayer(this.player()).get(o.x(),o.y()):o instanceof Te?{_:o.constructor.name}:r(o),"#dataFilter"));ge(this,X,new sx);ge(this,ml,void 0);ge(this,hs,void 0);ge(this,Un,void 0);ge(this,Bp,!1);Ee(this,ml,new py),Ee(this,Un,o),Ee(this,hs,s),v(this,hs).call(this,"action",(...a)=>{v(this,ml).emit("action",...a)}),v(this,hs).call(this,"cheat",({name:a,value:m})=>{if(a==="RevealMap"){let u=ae.getByPlayer(this.player()),[y]=u.entries();y.tile().map().entries().forEach(c=>{if(u.includes(c))return;u.register(c);let f=u.getByTile(c);v(this,X).add(u.id(),()=>c.toPlainObject(v(this,pe).call(this)),`entries[${u.entries().indexOf(f)}]`)})}if(a==="GrantAdvance"){let[u]=O.filter(c=>c.name===m),y=z.getByPlayer(this.player());if(!u||y.completed(u))return;y.addAdvance(u),v(this,X).add(y.id(),y.toPlainObject(v(this,pe).call(this,Fe(_))))}if(a==="GrantGold"){let u=mi.getByPlayer(this.player());u.add(m),v(this,X).add(u.id(),u.toPlainObject(v(this,pe).call(this,Fe(_))))}if(a==="ModifyUnit"){let{unitId:u,properties:y}=m,[c]=N.getBy("id",u);if(!c)return;["attack","defence","moves","movement","visibility"].forEach(f=>{f in y&&c[f]().set(y[f])}),v(this,X).add(c.id(),c.toPlainObject(v(this,pe).call(this,Fe(_))))}this.sendPatchData()}),P.on("engine:plugins:load:failed",(a,m)=>{console.log(a+" failed to load"),console.error(m)}),P.on("player:visibility-changed",(a,m)=>{if(m!==this.player())return;let u=ae.getByPlayer(this.player()),y=u.getByTile(a);if(y===null){new fx(()=>{let c=u.getByTile(a);return c===null?!1:(v(this,X).add(u.id(),()=>a.toPlainObject(v(this,pe).call(this,Fe(_))),`tiles[${u.entries().indexOf(c)}]`),!0)},2,20);return}v(this,X).add(u.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_))),`tiles[${u.entries().indexOf(y)}]`)}),["unit:created","unit:defeated"].forEach(a=>{P.on(a,m=>{let u=ae.getByPlayer(this.player()),y=u.getByTile(m.tile());if(!!y&&(v(this,X).update(y.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_)))),m.player()===this.player())){if(a==="unit:created"){let c=N.getByPlayer(this.player()),f=c.indexOf(m),g=N.getByCity(m.city()),U=g.indexOf(m),D=N.getByTile(m.tile()),A=D.indexOf(m);v(this,X).add(r.id(),()=>m.toPlainObject(v(this,pe).call(this,Fe(ce,_,Vl,it))),`units[${f}]`),v(this,X).add(y.id(),()=>m.toPlainObject(v(this,pe).call(this,Fe(Ie))),`units[${A}]`),m.city()!==null&&v(this,X).add(m.city().id(),()=>m.toPlainObject(v(this,pe).call(this,Fe(Ie))),`units[${U}]`);return}v(this,X).update(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,wx(_,Ie))))}})}),["unit:destroyed"].forEach(a=>{P.on(a,(m,u)=>{m.player()===this.player()&&m.city()!==null&&v(this,X).update(m.city().id(),()=>m.city().toPlainObject(v(this,pe).call(this,Fe(In,il,k,_,Vl,ce,Ie))))})}),["unit:moved"].forEach(a=>{P.on(a,(m,u)=>{let y=ae.getByPlayer(this.player()),c=y.getByTile(u.from()),f=y.getByTile(u.to());!c&&!f||(c&&v(this,X).update(c.id(),()=>c.toPlainObject(v(this,pe).call(this,Fe(_,it)))),f&&v(this,X).update(f.id(),()=>f.toPlainObject(v(this,pe).call(this,Fe(_,it)))),m.player()===this.player()&&m.city()!==null&&v(this,X).update(m.city().id(),()=>m.city().toPlainObject(v(this,pe).call(this,Fe(In,il,k,_,Vl,ce,Ie)))))})}),["tile-improvement:built","tile-improvement:pillaged"].forEach(a=>{P.on(a,m=>{let u=ae.getByPlayer(this.player()),y=u.getByTile(m);y&&v(this,X).update(y.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_,it))))})}),P.on("city:captured",(a,m,u)=>{if(u===this.player()){L.getByPlayer(this.player()).indexOf(a)!==-1&&v(this,X).update(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,wx(_)))),this.sendNotification(`${m.civilization().name()} have captured our city ${a.name()}!`);return}if(m===this.player()){this.sendNotification(`We have captured ${a.name()} from ${u.civilization().name()}!`);return}}),["city:created","city:captured","city:destroyed","city:grow","city:shrink"].forEach(a=>{P.on(a,m=>{let u=ae.getByPlayer(this.player()),y=u.getByTile(m.tile());!y||v(this,X).update(y.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_))))})}),P.on("city:shrink",a=>{a.player()===this.player()&&this.sendNotification(`Population decrease in ${a.name()}.`)}),P.on("city:unit-unsupported",(a,m)=>{a.player()===this.player()&&this.sendNotification(`${a.name()} cannot support ${m.constructor.name}.`)}),P.on("city:unsupported-improvement",(a,m)=>{a.player()===this.player()&&this.sendNotification(`${a.name()} cannot support ${m.constructor.name}.`)}),P.on("city:food-storage-exhausted",a=>{a.player()===this.player()&&this.sendNotification(`Food storage exhausted in ${a.name()}!`)}),P.on("city:building-complete",(a,m)=>{let u=ae.getByPlayer(this.player());if(a.city().player()!==this.player()&&m instanceof fe){this.sendNotification(`${u.getByTile(a.city().tile())?a.city().name():"A faraway city"} has completed work on ${m.constructor.name}!`);return}a.city().player()!==this.player()&&!(m instanceof fe)||(v(this,X).update(a.id(),()=>a.toPlainObject(v(this,pe).call(this,Fe(ce,Ie,_)))),this.sendNotification(`${a.city().name()} has completed work on ${m.constructor.name}!`))}),P.on("player:research-complete",(a,m)=>{a.player()===this.player()&&(v(this,X).update(a.id(),()=>a.toPlainObject(v(this,pe).call(this,Fe(_)))),this.sendNotification(`You have discovered the secrets of ${m.constructor.name}!`))}),P.on("goody-hut:action-performed",(a,m)=>{let u=a.tile();if(!!N.getByTile(u).some(c=>c.player()===this.player())){if(m instanceof ts){this.sendNotification("You have discovered scrolls of ancient wisdom...");return}if(m instanceof rs){this.sendNotification("You have discovered an advanced tribe...");return}if(m instanceof is){this.sendNotification("You have discovered valuable treasure...");return}if(m instanceof os){this.sendNotification("You have discovered a friendly tribe of skilled mercenaries...");return}}}),P.on("player:defeated",(a,m)=>{a===this.player()&&(this.sendNotification("You have been defeated!"),yi.unregister(...yi.entries()),ra.unregister(...ra.entries()),v(this,Un).call(this,"restart",null)),this.sendNotification(`${a.civilization().name()} defeated${m?` by ${m.civilization().name()}`:""}.`)}),P.on("city:civil-disorder",a=>{a.player()===this.player()&&this.sendNotification(`Civil disorder in ${a.name()}!`)})}chooseCivilization(r){let o=t(s=>(this.player().setCivilization(new s),this.chooseLeader(this.player().civilization())),"makeChoice");return new Promise((s,a)=>{if(r.length===1){let[m]=r;o(m).then(()=>s());return}v(this,Un).call(this,"chooseCivilization",new $c({choices:r}).toPlainObject()),v(this,hs).call(this,"chooseCivilization",m=>{let[u]=r.filter(y=>y.name===m);if(!u){a(`Invalid civilization ${m} (options: ${r.map(y=>y.name).join(", ")})`);return}o(u).then(()=>s())})})}chooseLeader(r){return new Promise((o,s)=>{let a=wn.getByCivilization(r.constructor);if(a.length===1){let[m]=a;r.setLeader(new m),o();return}v(this,Un).call(this,"chooseLeader",new $c({choices:a}).toPlainObject()),v(this,hs).call(this,"chooseLeader",m=>{let[u]=a.filter(y=>y.name===m);if(!u){s(`Invalid civilization ${m} (options: ${a.map(y=>y.name).join(", ")})`);return}r.setLeader(new u),o()})})}handleAction(...r){let[o]=r,s=this.player(),a=s.actions(),m=a.filter(f=>f instanceof si),{name:u,id:y}=o;if(u==="ReassignWorkers"){let[f]=L.getBy("id",o.city);return f&&(Px(f),v(this,X).update(f.id(),f.toPlainObject(v(this,pe).call(this,Fe(_,ce))))),!1}if(u==="EndTurn")return m.length===1&&m.every(f=>f instanceof nl);if(!u)return console.log("action not specified"),!1;let[c]=a.filter(f=>f.constructor.name===u&&y===(f.value()?f.value().id():void 0));if(!c)return console.log("action not specified"),!1;if(c instanceof Va){let{unitAction:f,target:g}=o,U=c.value(),A=[...U.actions(),...Object.values(U.actionsForNeighbours())].flat().filter(V=>V.constructor.name===f);for(;A.length!==1;){if(A.length===0)return console.log(`action not found: ${f}`),!1;let[V]=ae.getByPlayer(this.player()).filter(se=>se.id()===g);if(!V)return console.log(`tile not found: ${g}`),!1;if(A=A.filter(se=>se.to()===V.tile()),A.length>1&&!g)return console.log(`too many actions found: ${f} (${A.length})`),!1}let[E]=A;return E.perform(),!1}if(c instanceof Ja){let f=c.value();return f.moves().value()>0&&v(this,X).update(f.id(),f.toPlainObject(v(this,pe).call(this,Fe(_,ce)))),f.activate(),!1}if(c instanceof In||c instanceof ns){let f=c.value(),{chosen:g}=o;if(!g)return console.log("no build item specified"),!1;let[U]=f.available().filter(D=>D.item().name===g);return U?(f.build(U.item()),!1):(console.log(`build item not available: ${g}`),!1)}if(c instanceof nx){let f=c.value(),{chosen:g}=o;if(!g)return this.sendNotification("no build item specified"),!1;let[U]=f.available().filter(D=>D.name===g);return U?(f.research(U),!1):(console.log(`build item not available: ${g}`),!1)}if(c instanceof ms){let f=c.value(),g=mi.getByPlayer(this.player());return g.buy(f),v(this,X).update(g.id(),g.toPlainObject(v(this,pe).call(this,Fe(_)))),!1}if(c instanceof us){let f=c.value(),{chosen:g}=o,[U]=f.available().filter(A=>A.name===g);if(!U)return console.error(`Government type: '${g}' not found.`),!1;f.set(new U);let D=ae.getByPlayer(this.player());return v(this,X).update(D.id(),D.toPlainObject(v(this,pe).call(this,Fe(_)))),L.getByPlayer(this.player()).forEach(A=>v(this,X).update(A.id(),A.toPlainObject(v(this,pe).call(this,Fe(_,ce,Ie))))),!1}if(c instanceof ls){let f=c.value(),{value:g}=o;return f.setAll(g.map(([U,D])=>{let[A]=f.all().filter(E=>E.constructor.name===U);return[A.constructor,D]})),L.getByPlayer(this.player()).forEach(U=>v(this,X).update(U.id(),U.toPlainObject(v(this,pe).call(this,Fe(_,ce,Ie))))),!1}return console.log(`unhandled action: ${JSON.stringify(o)}`),!1}sendInitialData(){let r={player:this.player(),turn:Ge,year:hy},o=new $c(r);v(this,Un).call(this,"gameData",o.toPlainObject(v(this,pe).call(this))),Ee(this,Bp,!0)}sendPatchData(){v(this,Un).call(this,"gameDataPatch",v(this,X).transferData()),v(this,X).clear()}sendNotification(r){v(this,Un).call(this,"gameNotification",{message:r})}takeTurn(){return new Promise((r,o)=>{v(this,Bp)||this.sendInitialData(),setTimeout(()=>{v(this,X).update(Ge.id(),()=>Ge.toPlainObject()),v(this,X).update(hy.id(),()=>hy.toPlainObject()),v(this,X).add(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,Fe(ce,me)))),this.sendPatchData()},1);let s=t((...a)=>{try{if(this.handleAction(...a)){v(this,ml).off("action",s),this.sendPatchData(),setTimeout(()=>r(),100);return}v(this,X).update(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,Fe(Jl,ce,it)))),this.sendPatchData()}catch(m){o(m)}},"listener");v(this,ml).on("action",s)})}};t(Oy,"DataTransferClient"),pe=new WeakMap,X=new WeakMap,ml=new WeakMap,hs=new WeakMap,Un=new WeakMap,Bp=new WeakMap;var Bx=Oy;qo();vm();fl();K();fs();var Dt,gg=class{constructor(e){ge(this,Dt,void 0);Ee(this,Dt,e),e.receive("start",()=>{this.bindEvents(),this.start()}),e.receive("setOption",({name:r,value:o})=>{v(this,Dt).send("notification",`setting ${r} to ${o}`),P.setOption(r,o)}),e.receive("getOptions",r=>e.send("getOptions",r.reduce((o,s)=>(o[s]=P.option(s),o),{}))),e.receive("setOptions",r=>{Object.entries(r).forEach(([o,s])=>P.setOption(o,s)),e.send("setOptions")})}bindEvents(){v(this,Dt).send("notification","binding events"),P.on("engine:initialise",()=>v(this,Dt).send("notification","initialising...")),P.on("engine:plugins:load:success",e=>v(this,Dt).send("notification",`loaded plugin: ${e}`)),P.on("engine:plugins-loaded",()=>v(this,Dt).send("notification","plugins loaded")),P.on("engine:start",()=>v(this,Dt).send("notification","starting...")),P.on("world:generate-start-tiles",()=>v(this,Dt).send("notification","generating start tiles...")),P.on("world:built",()=>v(this,Dt).send("notification","world built")),P.on("game:start",()=>v(this,Dt).send("notification","game start")),P.on("turn:start",e=>v(this,Dt).send("notification",`turn start ${e}`)),P.on("player:turn-start",e=>v(this,Dt).send("notification",`player turn-start: ${e.civilization().constructor.name}`))}start(){P.on("engine:start",()=>{new Array(parseInt(P.option("players"),10)).fill(0).forEach((e,r)=>{let o=new _,s=r===0?new Bx(o,(a,m)=>v(this,Dt).send(a,m),(a,m)=>v(this,Dt).receive(a,m)):new Nn(o);yi.register(o),Eo.register(s),v(this,Dt).send("notification","generating world...")})}),P.start(),Promise.resolve().then(()=>(Qk(),IL)).then(()=>P.emit("plugins:load:end"))}};t(gg,"Game"),Dt=new WeakMap;var Xk=gg;var hg=class{async request(e){return new Promise(r=>{this.send(e.channel(),...e.args()),this.receiveOnce(e.channel(),o=>r(o))})}};t(hg,"AbstractTransport");var eS=hg;var Og=class extends eS{receive(e,r){addEventListener("message",({data:{channel:o,data:s}})=>{o===e&&r(s)})}receiveOnce(e,r){addEventListener("message",({data:{channel:o,data:s}})=>{o===e&&r(s)},{once:!0})}send(e,r){postMessage({channel:e,data:r})}};t(Og,"ParentTransport");var tS=Og;var HKe=new Xk(new tS);})();
//# sourceMappingURL=backend.js.map
