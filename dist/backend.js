"use strict";(()=>{var Hk=Object.create;var Xm=Object.defineProperty;var _k=Object.getOwnPropertyDescriptor;var Kk=Object.getOwnPropertyNames;var qk=Object.getPrototypeOf,Vk=Object.prototype.hasOwnProperty;var t=(i,e)=>Xm(i,"name",{value:e,configurable:!0});var n=(i,e)=>()=>(i&&(e=i(i=0)),e);var b=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),tu=(i,e)=>{for(var r in e)Xm(i,r,{get:e[r],enumerable:!0})},IR=(i,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Kk(e))!Vk.call(i,a)&&a!==r&&Xm(i,a,{get:()=>e[a],enumerable:!(o=_k(e,a))||o.enumerable});return i};var C=(i,e,r)=>(r=i!=null?Hk(qk(i)):{},IR(e||!i||!i.__esModule?Xm(r,"default",{value:i,enumerable:!0}):r,i)),R=i=>IR(Xm({},"__esModule",{value:!0}),i);var wR=(i,e,r)=>{if(!e.has(i))throw TypeError("Cannot "+r)};var v=(i,e,r)=>(wR(i,e,"read from private field"),r?r.call(i):e.get(i)),de=(i,e,r)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,r)},De=(i,e,r,o)=>(wR(i,e,"write to private field"),o?o.call(i,r):e.set(i,r),r),AR=(i,e,r,o)=>({set _(a){De(i,e,a,r)},get _(){return v(i,e,o)}});var F,ru,Ce=n(()=>{F=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return this.#e.some(r=>e instanceof r)}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(o=>{let a=o[e];return a instanceof Function?a.bind(o)()===r:o[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let o=this.#t.indexOf(r);o>-1&&this.#t.splice(o,1)})}};t(F,"EntityRegistry");ru=F});var iu,oe,Vt=n(()=>{iu=class{#e;#t;#r;constructor(e,r,o){this.#e=r,this.#t=o,this.#r=e}data(...e){return this.#t(...e)}key(){return this.#e}type(){return this.#r}};t(iu,"AdditionalData");oe=iu});var ou,ne,Dt=n(()=>{Ce();Vt();ou=class extends F{constructor(){super(oe)}getByType(e){return this.filter(r=>r.type()===e||Object.prototype.isPrototypeOf.call(r.type(),e)||Object.prototype.isPrototypeOf.call(r.type().prototype,e))}};t(ou,"AdditionalDataRegistry");ne=new ou});var nu,Jk,ep,S,Ye,Z=n(()=>{Dt();Ce();nu={},Jk=t(i=>{let e=i.sourceClass().name,r=nu[e];return r||(nu[e]=0),r===Number.MAX_SAFE_INTEGER&&(nu[e]=BigInt(r)),e+"-"+(++nu[e]).toString(36)},"idProvider"),ep=t((i,e,r=a=>a,o=ne)=>{if(i=r(i),i instanceof ru&&(i=i.entries()),Array.isArray(i))return i.map(a=>ep(a,e,r,o));if(i instanceof S){let a=i.id();if(!(a in e)){let s={_:i.sourceClass().name};e[a]=s,i.keys().forEach(p=>{let u=i[p]instanceof Function?i[p]():i[p];s[p]=ep(u,e,r,o)}),o.getByType(i.sourceClass()).forEach(p=>{s[p.key()]=ep(p.data(i),e,r,o)})}return{"#ref":a}}return i instanceof Function?{_:i.name}:i&&i instanceof Object?Object.entries(i).reduce((a,[s,p])=>(a[s]=ep(p,e,r,o),a),{}):i},"toPlainObject"),S=class{#e;#t=["id"];constructor(){this.#e=Jk(this)}addKey(...e){this.#t.push(...e)}id(){return this.#e}keys(){return this.#t}sourceClass(){return this.constructor}toPlainObject(e=o=>o,r=ne){let o={};return{hierarchy:ep(this,o,e,r),objects:o}}};t(S,"DataObject");Ye=S});var au,Er,qa=n(()=>{Z();au=class extends S{#e;#t;constructor(e,r){super(),this.#e=e,this.#t=r,this.addKey("value")}player(){return this.#e}value(){return this.#t}};t(au,"PlayerAction");Er=au});var su,ni,Vs=n(()=>{qa();su=class extends Er{};t(su,"MandatoryPlayerAction");ni=su});var Va,GR=n(()=>{Vs();Va=class extends ni{};t(Va,"ActiveUnit")});var Ja,BR=n(()=>{qa();Ja=class extends Er{};t(Ja,"InactiveUnit")});var pg=n(()=>{GR();BR()});var lu,x,M=n(()=>{Z();lu=class extends Ye{};t(lu,"Advance");x=lu});var Ee,Ki=n(()=>{Ee=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return typeof e=="function"&&this.#e.some(r=>Object.prototype.isPrototypeOf.call(r,e)||Object.prototype.isPrototypeOf.call(r.prototype,e))}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(o=>{let a=o[e];return a instanceof Function?a.bind(o)()===r:o[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let o=this.#t.indexOf(r);o>-1&&this.#t.splice(o,1)})}};t(Ee,"ConstructorRegistry")});var mu,O,B=n(()=>{M();Ki();mu=class extends Ee{constructor(){super(x)}};t(mu,"AdvanceRegistry");O=new mu});var Al,l,w=n(()=>{Al=class{#e=null;constructor(e){e&&(this.#e=e)}validate(...e){return this.#e===null?!0:this.#e(...e)}};t(Al,"Criterion");l=Al});var pu,uu,ug=n(()=>{w();pu=class extends l{#e=[];constructor(...e){super(),e.forEach(r=>{this.#e.push(r)})}criteria(){return this.#e}validate(...e){return this.#e.every(r=>r.validate(...e))}};t(pu,"Criteria");uu=pu});var cu,$a,cg=n(()=>{ug();cu=class extends uu{};t(cu,"And");$a=cu});var yu,m,T=n(()=>{yu=class{#e;constructor(e){this.#e=e}apply(...e){return this.#e(...e)}};t(yu,"Effect");m=yu});var fu,Fr,Za=n(()=>{fu=class{#e;constructor(e=2e3){this.#e=e}value(){return this.#e}};t(fu,"Priority");Fr=fu});var Kn,Qa,Gl=n(()=>{Za();Kn=class extends Fr{constructor(){super(1e3)}};t(Kn,"High");Qa=Kn});var Xe,UR,yg=n(()=>{Za();Xe=class extends Fr{constructor(){super(3e3)}};t(Xe,"Low");UR=Xe});var Bl,MR=n(()=>{Za();Bl=class extends Fr{constructor(){super(2e3)}};t(Bl,"Normal")});var qn=n(()=>{Gl();yg();MR()});var du,g,G=n(()=>{cg();w();T();qn();du=class{#e;#t=!0;#r;#i=new Bl;constructor(...e){let r=[];e.forEach(o=>{if(o instanceof m){if(this.#r)throw new TypeError("Rule: effect already specified, but another was provided.");this.#r=o;return}if(o instanceof l){r.push(o);return}this.#i=o}),r.length&&(this.#e=new $a(...r))}disable(){this.#t=!1}enable(){this.#t=!0}enabled(){return this.#t}priority(){return this.#i}process(...e){if(!!this.#t&&this.#r instanceof m)return this.#r.apply(...e)}validate(...e){return this.#t?this.#e instanceof l?this.#e.validate(...e):!0:!1}};t(du,"Rule");g=du});var gu,d,I=n(()=>{Ce();G();gu=class extends F{#e=new Map;constructor(){super(g)}entries(){return super.entries().sort((e,r)=>e.priority().value()-r.priority().value())}get(e){return this.#e.has(e)||this.#e.set(e,this.filter(r=>r.enabled()&&r instanceof e)),this.#e.get(e)||[]}invalidateCache(e){this.#e.delete(e instanceof g?e.constructor:e)}process(e,...r){return this.get(e).filter(o=>o.validate(...r)).map(o=>o.process(...r))}register(...e){super.register(...e),e.forEach(r=>this.invalidateCache(r))}unregister(...e){super.unregister(...e),e.forEach(r=>this.invalidateCache(r))}};t(gu,"RuleRegistry");d=new gu});var hu,Xa,Ou=n(()=>{G();hu=class extends g{};t(hu,"Complete");Xa=hu});var Ru,xu,fg=n(()=>{G();Ru=class extends g{};t(Ru,"Cost");xu=Ru});var vu,bu,dg=n(()=>{G();vu=class extends g{};t(vu,"Requirements");bu=vu});var es,L,Ve=n(()=>{Z();es=class extends S{#e=[];#t=null;constructor(e=0,r="initial"){super(),this.addKey("value","values"),this.add(e,r)}add(e,r=""){if(e instanceof es)return this.add(e.value(),r);this.#e.push([e,r]),this.#t=null}clone(){return new this.constructor(this)}set(e,r=""){if(this.#e.splice(0),e instanceof es)return this.set(e.value(),r);this.#e.push([e,r]),this.#t=e}subtract(e,r=""){if(e instanceof es)return this.subtract(e.value(),r);this.#e.push([-e,r]),this.#t=null}value(){return this.#t===null&&(this.#t=this.#e.reduce((e,[r])=>e+r,0)),this.#t}values(){return this.#e}};t(es,"Yield");L=es});var Js,DR=n(()=>{Ve();Js=class extends L{};t(Js,"Research")});var ER=n(()=>{DR()});var Cu,Tu,gg=n(()=>{G();Cu=class extends g{};t(Cu,"Started");Tu=Cu});var Pu,Ul,Iu=n(()=>{B();Z();I();Ou();fg();dg();ER();gg();Pu=class extends S{#e;#t=[];#r=null;#i;#o=new Js(1/0);#a=new Js(0);#n;constructor(e,r=O,o=d){super(),this.#e=r,this.#i=e,this.#n=o,this.addKey("available","complete","cost","progress","researching")}add(e){this.#a.add(e),this.check()}addAdvance(e){if(this.#t.some(o=>o instanceof e))return;this.#r===e&&(this.#r=null);let r=new e;this.#t.push(r),this.#n.process(Xa,this,r)}available(){let e=this.#n.get(bu);return this.#e.filter(r=>e.filter(o=>o.validate(r,this.#t)).every(o=>o.process(r,this.#t)===!0)&&!this.#t.some(o=>o instanceof r))}check(){if(this.#r!==null&&this.#a.value()>=this.#o.value()){let e=new this.#r;this.#t.push(e),this.#r=null,this.#a.subtract(this.#o),this.#o.set(1/0),this.#n.process(Xa,this,e)}}complete(){return this.#t}completed(e){return this.#t.some(r=>r instanceof e)}cost(){return this.#o}player(){return this.#i}progress(){return this.#a}research(e){let[r]=this.#n.process(xu,e,this);this.#o.set(r),this.#r=e,this.#n.process(Tu,this,e)}researching(){return this.#r}};t(Pu,"PlayerResearch");Ul=Pu});var wu,N,He=n(()=>{Ce();Iu();wu=class extends F{constructor(){super(Ul)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of results for player.");return r[0]}};t(wu,"PlayerResearchRegistry");N=new wu});var Ml,Dl,tp=n(()=>{Ml=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}goodyHut(){return this.#e}perform(){}unit(){return this.#t}};t(Ml,"Action");Dl=Ml});var ts,FR=n(()=>{He();tp();ts=class extends Dl{#e;#t;constructor(e,r,o=N,a=()=>Math.random()){super(e,r),this.#e=o,this.#t=a}perform(){let e=this.#e.getByPlayer(this.unit().player()),r=e.available(),o=r[Math.floor(r.length*this.#t())];e.addAdvance(o)}};t(ts,"Advance")});var Au,cr,$s=n(()=>{G();Au=class extends g{};t(Au,"Captured");cr=Au});var Gu,et,El=n(()=>{G();Gu=class extends g{};t(Gu,"Cost");et=Gu});var Bu,jo,Uu=n(()=>{G();Bu=class extends g{};t(Bu,"Created");jo=Bu});var Mu,yr,Zs=n(()=>{G();Mu=class extends g{};t(Mu,"Destroyed");yr=Mu});var Du,Eu,hg=n(()=>{G();Du=class extends g{};t(Du,"Created");Eu=Du});var Fu,vn,Fl=n(()=>{Z();I();hg();Fu=class extends S{#e;constructor(e=d){super(),this.#e=e,this.#e.process(Eu,this)}clone(){return new this.constructor(this.#e)}};t(Fu,"Terrain");vn=Fu});var W,kR=n(()=>{Fl();W=class extends vn{};t(W,"Land")});var Jt,Og=n(()=>{Fl();Jt=class extends vn{};t(Jt,"Water")});var $t=n(()=>{kR();Og()});var ku,Su,Rg=n(()=>{G();ku=class extends g{};t(ku,"YieldModifier");Su=ku});var Yu,ai,xg=n(()=>{G();Yu=class extends g{};t(Yu,"Yield");ai=Yu});var kl,ce,qi=n(()=>{Z();$t();I();Nu();Ve();Rg();xg();kl=class extends S{#e;#t=[];#r;#i;#o;#a;#n=new Map;constructor(e,r,o,a,s=d){super(),this.#o=e,this.#a=r,this.#i=o,this.#e=a,this.#r=s,this.addKey("terrain","isCoast","isLand","isWater","x","y","yields")}clearYieldCache(e=null){this.#n.delete(e)}getAdjacent(){return this.getAdjacentDirections().map(e=>this.getNeighbour(e))}getAdjacentDirections(){return["n","e","s","w"]}getNeighbour(e){return e==="n"?this.#e.get(this.#o,this.#a-1):e==="ne"?this.#e.get(this.#o+1,this.#a-1):e==="e"?this.#e.get(this.#o+1,this.#a):e==="se"?this.#e.get(this.#o+1,this.#a+1):e==="s"?this.#e.get(this.#o,this.#a+1):e==="sw"?this.#e.get(this.#o-1,this.#a+1):e==="w"?this.#e.get(this.#o-1,this.#a):this.#e.get(this.#o-1,this.#a-1)}getNeighbouringDirections(){return["n","ne","e","se","s","sw","w","nw"]}getNeighbours(){return this.#t.length||(this.#t=this.getNeighbouringDirections().map(e=>this.getNeighbour(e))),this.#t}getSurroundingArea(e=2){return zu.fromSurrounding(this,e)}distanceFrom(e){let r=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[o]=r.map(([a,s])=>Math.hypot(this.#o-e.x()+a*this.#e.width(),this.#a-e.y()+s*this.#e.height())).sort((a,s)=>a-s);return o}isCoast(){let e=this;return e.isWater()&&e.getNeighbours().some(r=>r.isLand())||e.isLand()&&e.getNeighbours().some(r=>r.isWater())}isLand(){return this.#i instanceof W}isNeighbourOf(e){return this.getNeighbours().includes(e)}isWater(){return this.#i instanceof Jt}map(){return this.#e}score(e=null,r=[[L,3]]){return this.yields(e).map(a=>{let[s]=r.filter(([u])=>a instanceof u),p=s?s[1]||1:0;return a.value()*p}).reduce((a,s)=>a+s,0)}terrain(){return this.#i}setTerrain(e){this.#i=e}x(){return this.#o}y(){return this.#a}yields(e=null){if(!this.#n.has(e)){let r=this.#r.process(ai,this,e).flat();this.#r.process(Su,this,e,r).flat(),this.#n.set(e,r)}return this.#n.get(e)}};t(kl,"Tile");ce=kl});var Sl,zu,Nu=n(()=>{Ce();qi();Sl=class extends F{static from(...e){return new this(...e)}static fromSurrounding(e,r=2){let o=t(a=>{let s=[];for(let p=e.x()-a;p<=e.x()+a;p++)for(let u=e.y()-a;u<=e.y()+a;u++)s.push([p,u]);return s},"gen");return this.from(...o(r).map(([a,s])=>e.map().get(a,s)))}constructor(...e){super(kl),this.register(...e)}push(...e){this.register(...e)}shift(){let[e]=this.entries();return this.unregister(e),e}score(e=null,r=[]){return this.entries().reduce((o,a)=>o+a.score(e,r),0)}yields(e=null){return this.entries().flatMap(r=>r.yields(e))}};t(Sl,"Tileset");zu=Sl});var Yl,Ho,zl=n(()=>{G();Yl=class extends g{};t(Yl,"Yield");Ho=Yl});var Lu,Qs,Wu=n(()=>{G();Lu=class extends g{};t(Lu,"YieldModifier");Qs=Lu});var ju,tt,Vn=n(()=>{Z();I();$s();El();Uu();Zs();Nu();Ve();zl();Wu();ju=class extends S{#e;#t;#r;#i;#o;#a;#n=new zu;constructor(e,r,o,a=d){super(),this.#e=o,this.#t=e,this.#r=e,this.#o=r,this.#a=this.#o.getSurroundingArea(),this.#n.push(r),this.#i=a,this.#i.process(jo,this),this.addKey("name","originalPlayer","player","tile","tiles","tilesWorked","yields")}capture(e){let r=this.#r;this.#r=e,this.#i.process(cr,this,e,r)}destroy(e=null){this.#i.process(yr,this,e)}name(){return this.#e}setName(e){this.#e=e}originalPlayer(){return this.#t}player(){return this.#r}tile(){return this.#o}tiles(){return this.#a}tilesWorked(){return this.#n}yields(){let e=[];return[this.#i.get(Ho),this.#i.get(Qs),this.#i.get(et)].flat().forEach(r=>{if(!r.validate(this,e))return;let o=r.process(this,e);if(!!o){if(o instanceof L){e.push(o);return}o.forEach(a=>e.push(a))}}),e}};t(ju,"City");tt=ju});var Hu,j,rt=n(()=>{Ce();Vn();Hu=class extends F{constructor(){super(tt)}getByPlayer(e){return this.filter(r=>r.player()===e)}getByTile(e){let[r]=this.filter(o=>o.tile()===e);return r??null}};t(Hu,"CityRegistry");j=new Hu});var rs,SR=n(()=>{rt();I();tp();Vn();rs=class extends Dl{#e;constructor(e,r,o=j){super(e,r),this.#e=o}perform(e=d){let r=this.unit().player(),o=new tt(r,this.goodyHut().tile(),r.civilization().getCityName(!0),e);this.#e.register(o)}};t(rs,"City")});var is,YR,_u=n(()=>{Z();I();is=class extends S{static build(e,r=d){throw new TypeError("createFromObject: Must be overridden in extending class")}};t(is,"Buildable");YR=is});var Ku,bn,Nl=n(()=>{Ki();_u();Ku=class extends Ee{constructor(){super(YR)}};t(Ku,"AvailableCityBuildItemsRegistry");bn=new Ku});var Zt,zR,rp=n(()=>{w();G();Zt=class extends g{process(e,r){let o=super.process(e,r);if(!(o instanceof Al))throw new TypeError("Invalid build rule.");return o}};t(Zt,"Build");zR=Zt});var qu,Vu,vg=n(()=>{Z();qu=class extends Ye{#e;constructor(e){super(),this.addKey("value"),this.#e=e}value(){return this.#e}};t(qu,"BuildCost");Vu=qu});var ip,NR,Ll,$k,op=n(()=>{vg();w();T();G();ip=class extends g{};t(ip,"BuildCost");NR=ip,Ll=t((i,e)=>$k([[i,e]]),"buildCost"),$k=t(i=>i.map(([e,r])=>new ip(new l(o=>o.item()===e),new m(()=>new Vu(r)))),"buildCosts")});var Ju,$u,bg=n(()=>{I();vg();op();Z();Ju=class extends Ye{#e;#t=new Vu(1/0);#r;#i;constructor(e,r=null,o=d){super(),this.#r=e,this.#e=r,this.#i=o,this.addKey("cost","item")}cost(){if(!Number.isFinite(this.#t.value())){let[e]=this.#i.process(NR,this,this.#e);e&&(this.#t=e)}return this.#t}item(){return this.#r}};t(Ju,"BuildItem");$u=Ju});var Xs,LR=n(()=>{Ve();Xs=class extends L{};t(Xs,"BuildProgress")});var WR=n(()=>{LR()});var Zu,jR,HR=n(()=>{G();Zu=class extends g{};t(Zu,"BuildingCancelled");jR=Zu});var Qu,Jn,np=n(()=>{G();Qu=class extends g{};t(Qu,"BuildingComplete");Jn=Qu});var Xu,Wl,ec=n(()=>{Nl();Z();I();rp();bg();WR();HR();np();Xu=class extends S{#e;#t=null;#r;#i=new Xs(1/0);#o=new Xs;#a;constructor(e,r=bn,o=d){super(),this.#e=r,this.#r=e,this.#a=o,this.addKey("available","building","city","cost","progress","remaining")}add(e){this.#o.add(e)}available(){let e=this.#a.get(zR);return this.#e.filter(r=>e.filter(o=>o.validate(this.city(),r)).every(o=>o.process(this.city(),r).validate())).map(r=>new $u(r,this.city(),this.#a))}build(e){let r=this.getAvailable(e);if(!r)throw new TypeError(`Cannot build ${e.name}, it's not available.`);this.#t=r,this.#i.set(this.#t.cost().value())}building(){return this.#t}check(){if(this.#o.value()>=this.#i.value()&&this.#t){let e=this.#t.item().build(this.#r,this.#a);return this.#o.set(0),this.#t=null,this.#i.set(1/0),this.#a.process(Jn,this,e),e}return null}city(){return this.#r}cost(){return this.#i}getAvailable(e){return this.available().filter(r=>r.item()===e)[0]}progress(){return this.#o}remaining(){return this.#i.value()-this.#o.value()}revalidate(){this.#t&&!this.getAvailable(this.#t.item())&&(this.#t=null,this.#i.set(1/0),this.#a.process(jR,this))}};t(Xu,"CityBuild");Wl=Xu});var tc,Qt,$n=n(()=>{Ce();ec();tc=class extends F{constructor(){super(Wl)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of entities returned.");return r[0]}};t(tc,"CityBuildRegistry");Qt=new tc});var rc,el,Cg=n(()=>{G();rc=class extends g{};t(rc,"Spend");el=rc});var ic,oc,Tg=n(()=>{$n();I();Cg();Ve();ic=class extends L{#e;#t;#r;constructor(e,r=Qt,o=d){super(),this.#e=e,this.#t=o,this.#r=r}buy(e){let r=this.#r.getByCity(e),o=this.cost(e);e.player()!==this.#e||this.value()<o.value()||(r.add(new L(r.remaining())),this.subtract(o.value()))}cost(e){let r=this.#r.getByCity(e),o=new L;return this.#t.process(el,r,o).reduce((a,s)=>(a.add(s),a))}player(){return this.#e}};t(ic,"PlayerTreasury");oc=ic});var nc,si,tl=n(()=>{Ce();Tg();nc=class extends F{constructor(){super(oc)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTreasuries for player.");return r[0]}};t(nc,"PlayerTreasuryRegistry");si=new nc});var Xt,ac,jl=n(()=>{Ve();Xt=class extends L{};t(Xt,"Gold");ac=Xt});var os,_R=n(()=>{tl();tp();jl();os=class extends Dl{#e;constructor(e,r,o=si){super(e,r),this.#e=o}perform(){this.#e.getByPlayer(this.unit().player()).add(new Xt(50))}};t(os,"Gold")});var sc,lc,Pg=n(()=>{G();sc=class extends g{};t(sc,"Unit");lc=sc});var ns,KR=n(()=>{tp();I();Pg();ns=class extends Ml{#e;#t;constructor(e,r,o=()=>Math.random(),a=d){super(e,r),this.#e=o,this.#t=a}perform(){this.#t.process(lc,this.goodyHut(),this.unit())}};t(ns,"Unit")});var Ig=n(()=>{FR();SR();_R();KR()});var as,qR=n(()=>{qa();as=class extends Er{};t(as,"ChangeProduction")});var Cn,VR=n(()=>{Vs();Cn=class extends ni{};t(Cn,"CityBuild")});var wg=n(()=>{qR();VR()});var ss,JR,mc=n(()=>{ss=class{#e;constructor(e){this.#e=e}player(){return this.#e}takeTurn(){return new Promise((e,r)=>r(new TypeError("Client#takeTurn must be implemented.")))}};t(ss,"Client");JR=ss});var pc,ls,ap=n(()=>{Ve();pc=class extends L{#e;constructor(e,r){super(r),this.#e=e}leader(){return this.#e}};t(pc,"Trait");ls=pc});var uc,cc,Ag=n(()=>{Ce();ap();uc=class extends F{constructor(){super(ls)}getByLeader(e){return this.getBy("leader",e)}getBySubclass(e){return this.filter(r=>r instanceof e)}};t(uc,"TraitRegistry");cc=new uc});var yc,te,st=n(()=>{Ag();Z();yc=class extends S{#e=[];constructor(e=cc){super();let r=e.getByLeader(this.sourceClass());this.#e.push(...r),this.addKey("name")}static civilization(){throw new TypeError("Must be implemented in extending class")}name(){throw new TypeError("Must be implemented in extending class")}traits(){return[...this.#e]}};t(yc,"Leader");te=yc});var fc,Tn,Hl=n(()=>{Ki();st();fc=class extends Ee{constructor(){super(te)}getByCivilization(e){return this.getBy("civilization",e)}};t(fc,"LeaderRegistry");Tn=new fc});var ms,$R=n(()=>{qa();ms=class extends Er{};t(ms,"AdjustTradeRates")});var Gg=n(()=>{$R()});var dc,Te,fr=n(()=>{G();dc=class extends g{};t(dc,"Busy");Te=dc});var rl,ZR,Bg=n(()=>{Vs();rl=class extends ni{};t(rl,"ChooseResearch");ZR=rl});var gc,hc,Ug=n(()=>{G();gc=class extends g{};t(gc,"Cost");hc=gc});var Pn,Mg,Oc=n(()=>{Ve();Pn=class extends L{};t(Pn,"FoodStorage");Mg=Pn});var Rc,lp,Dg=n(()=>{G();Rc=class extends g{};t(Rc,"FoodStorage");lp=Rc});var xc,In,vc=n(()=>{G();xc=class extends g{};t(xc,"Grow");In=xc});var bc,il,Eg=n(()=>{G();bc=class extends g{};t(bc,"Shrink");il=bc});var Cc,ol,Tc=n(()=>{Z();I();Ug();Oc();Dg();vc();Eg();Cc=class extends S{#e;#t=new Mg(1/0);#r=new Mg;#i;#o=1;constructor(e,r=d){super(),this.#e=e,this.#i=r,this.setCost(),this.addKey("cost","progress","size")}add(e){this.#r.add(e)}check(){this.#i.process(lp,this)}city(){return this.#e}cost(){return this.#t}setCost(){let e=this.#i.process(hc,this);e.length>0&&this.#t.set(e[0],"setCost")}empty(){this.#r.subtract(this.#r.value())}grow(){this.#o++,this.#i.process(In,this)}progress(){return this.#r}shrink(){this.#o--,this.#i.process(il,this)}size(){return this.#o}};t(Cc,"CityGrowth");ol=Cc});var Pc,mp,Fg=n(()=>{G();Pc=class extends g{};t(Pc,"Created");mp=Pc});var Ic,k,Ge=n(()=>{_u();I();Fg();Ic=class extends is{#e;#t;constructor(e,r=d){super(),this.#e=e,this.#t=r,this.#t.process(mp,this,e)}city(){return this.#e}static build(e,r=d){return new this(e,r)}};t(Ic,"CityImprovement");k=Ic});var wc,ge,er=n(()=>{Z();wc=class extends S{#e;#t;#r;constructor(e,r,o){super(),this.#e=e,this.#t=r,this.#r=o,this.addKey("name","value")}civilization(){return this.#e}name(){return this.#t}value(){return this.#r}};t(wc,"Attribute");ge=wc});var _l,he,tr=n(()=>{Ce();er();_l=class extends F{constructor(){super(ge)}getByCivilization(e){return this.getBy("civilization",e)}getByName(e){return this.getBy("name",e)}};t(_l,"AttributeRegistry");he=new _l});var Ac,Q,Et=n(()=>{Ac=class{#e;#t;#r=!1;constructor(e,r,o=!1){this.#e=e,this.#t=r,this.#r=o}name(){return this.#e}civilization(){return this.#t}capital(){return this.#r}};t(Ac,"CityName");Q=Ac});var Gc,$,gt=n(()=>{Ce();Et();Gc=class extends F{#e=1;#t;constructor(e=()=>Math.random()){super(Q),this.#t=e}takeByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1);return r instanceof Q?(this.unregister(r),r.name()):this.takeUnassociated()}takeCapitalByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1).filter(o=>o.capital());return r instanceof Q?(this.unregister(r),r.name()):this.takeByCivilization(e)}takeUnassociated(){let[e]=this.getBy("civilization",null).sort(()=>Math.floor(this.#t()*3)-1);return e instanceof Q?(this.unregister(e),e.name()):`City #${this.#e++}`}};t(Gc,"CityNameRegistry");$=new Gc});var Bc,me,Ft=n(()=>{tr();gt();Z();Bc=class extends S{#e=null;#t;#r=new _l;constructor(e=he,r=$){super(),this.#t=r,this.#r.register(...e.getByCivilization(this.sourceClass())),this.addKey("name","leader","attributes")}attributes(){return this.#r.entries()}name(){return this.constructor.name}leader(){return this.#e}setLeader(e){this.#e=e}getCityName(e=!1){let r=this.sourceClass();return e?this.#t.takeCapitalByCivilization(r):this.#t.takeByCivilization(r)}};t(Bc,"Civilization");me=Bc});var ps,QR=n(()=>{qa();ps=class extends Er{value(){return super.value()}};t(ps,"CompleteProduction")});var kg=n(()=>{QR()});var nl,Mc,Dc=n(()=>{Vs();nl=class extends ni{};t(nl,"EndTurn");Mc=nl});var Ec,ht,Zn=n(()=>{G();Ec=class extends g{};t(Ec,"Action");ht=Ec});var Fc,li,al=n(()=>{G();Fc=class extends g{};t(Fc,"Added");li=Fc});var kc,Sg,ex=n(()=>{qa();kc=class extends Er{};t(kc,"HiddenPlayerAction");Sg=kc});var Sc,_,_o=n(()=>{Z();I();Zn();al();ex();Vs();Sc=class extends S{#e=null;#t;constructor(e=d){super(),this.#t=e,this.#t.process(li,this),this.addKey("actions","civilization","mandatoryActions")}action(){let[e]=this.actions();return e}actions(){return this.#t.process(ht,this).flat().filter(e=>!(e instanceof Sg))}civilization(){if(this.#e===null)throw new TypeError("Player#civilization is unset.");return this.#e}hasActions(){return!!this.action()}hasMandatoryActions(){return this.actions().some(e=>e instanceof ni)}hiddenActions(){return this.#t.process(ht,this).flat().filter(e=>e instanceof Sg)}mandatoryAction(){let[e]=this.mandatoryActions();return e}mandatoryActions(){return this.actions().filter(e=>e instanceof ni)}setCivilization(e){this.#e=e}};t(Sc,"Player");_=Sc});var Yc,Kl,Yg=n(()=>{Dt();Z();qi();Yc=class extends S{#e={};#t;#r;#i;constructor(e,r,o=ne){super(),this.#t=o,this.#r=r,this.#i=e,this.addKey("isCoast","isLand","isWater","terrain","x","y","yields"),this.setAdditionalData()}addKey(...e){super.addKey(...e)}isCoast(){return this.#i.isCoast()}isLand(){return this.#i.isLand()}isWater(){return this.#i.isWater()}player(){return this.#r}setAdditionalData(){this.#t.getByType(ce).forEach(e=>{this.#e[e.key()]=e.data(this.#i),Object.defineProperty(this,e.key(),{configurable:!0,value:()=>e.data(this.#i)}),this.addKey(e.key())})}terrain(){return this.#i.terrain()}tile(){return this.#i}update(){this.#i.clearYieldCache(this.#r),this.setAdditionalData()}x(){return this.#i.x()}y(){return this.#i.y()}yields(){return this.#i.yields(this.#r)}};t(Yc,"PlayerTile");Kl=Yc});var zc,tx,rx=n(()=>{Fl();zc=class extends vn{};t(zc,"Unknown");tx=zc});var Nc,ix,ox=n(()=>{qi();rx();Nc=class extends ce{constructor(e,r,o){super(e,r,new tx,o)}};t(Nc,"UndiscoveredTile");ix=Nc});var Lc,Wc,zg=n(()=>{G();Lc=class extends g{};t(Lc,"VisibilityChanged");Wc=Lc});var jc,ql,Hc=n(()=>{Z();I();Yg();qi();ox();zg();jc=class extends S{#e;#t;#r=[];#i;constructor(e,r,o=d){super(),this.#e=e,this.#i=r,this.#t=o,this.addKey("height","tiles","width")}entries(){return this.#r}filter(e){return this.entries().filter(e)}forEach(e){return this.#r.forEach(e)}get(e,r){let[o]=this.entries().filter(a=>a.x()===e&&a.y()===r);return o||new ix(e,r,this.#i)}getByTile(e){let[r]=this.filter(o=>o.tile()===e);return r??null}height(){return this.#i.height()}includes(e){return e instanceof ce?!!this.getByTile(e):this.#r.includes(e)}map(e){return this.#r.map(e)}player(){return this.#e}register(...e){e.forEach(r=>{this.includes(r)||(this.#r.push(new Kl(r,this.#e)),this.#t.process(Wc,r,this.player()))})}tiles(){return this.entries()}width(){return this.#i.width()}};t(jc,"PlayerWorld");ql=jc});var cs,sx=n(()=>{qa();cs=class extends Er{};t(cs,"Revolution")});var Ng=n(()=>{sx()});var Vi,lx=n(()=>{Ve();Vi=class extends L{};t(Vi,"Attack")});var mi,mx=n(()=>{Ve();mi=class extends L{};t(mi,"Defence")});var Ji,px,Lg=n(()=>{Ve();Ji=class extends L{};t(Ji,"Movement");px=Ji});var $l,ux=n(()=>{Lg();$l=class extends px{};t($l,"Moves")});var ys,cx=n(()=>{Ve();ys=class extends L{};t(ys,"Visibility")});var Zl=n(()=>{lx();mx();Lg();ux();cx()});var Ot,Wg,pi,wn,Ql,jg=n(()=>{w();T();G();Ot=class extends g{};t(Ot,"Action");Wg=Ot,pi=new l(i=>i.moves().value()>=.1),wn=new l((i,e,r=i.tile())=>r===e),Ql=new l((i,e,r=i.tile())=>e.isNeighbourOf(r))});var Jc,Xl,Hg=n(()=>{G();Jc=class extends g{};t(Jc,"Activate");Xl=Jc});var $c,Qn,Zc=n(()=>{G();$c=class extends g{};t($c,"Created");Qn=$c});var Qc,Xn,Xc=n(()=>{G();Qc=class extends g{};t(Qc,"Destroyed");Xn=Qc});var ey,ty,_g=n(()=>{G();ey=class extends g{};t(ey,"Visibility");ty=ey});var fs,sl,dp,yx,em=n(()=>{Zl();w();T();G();fs=class extends g{};t(fs,"BaseYield");sl=class extends g{};t(sl,"Yield");dp=sl,yx=t((i,e=1,r=1,o=1,a=1)=>[...[[Vi,e],[mi,r],[Ji,o],[ys,a]].flatMap(([s,p])=>[new sl(new l(u=>u instanceof i),new l((u,y)=>y instanceof s),new m((u,y)=>y.set(p))),new fs(new l(u=>u===i),new l((u,y)=>y instanceof s),new m((u,y)=>y.set(p)))])],"unitYield")});var ry,Pe,ea=n(()=>{Zl();_u();I();jg();Hg();Zc();Xc();_g();em();ry=class extends is{#e=!0;#t=null;#r;#i=!1;#o=new $l;#a;#n;#l=null;#s;#m=!1;constructor(e,r,o,a=d){super(),this.#r=e,this.#a=r,this.#s=o,this.#n=a,this.addKey("actions","actionsForNeighbours","active","attack","busy","city","defence","movement","moves","player","status","tile","visibility","waiting"),this.#n.process(Qn,this)}action(e,...r){return e.perform(...r)}actions(e=this.#s,r=this.#s){return typeof e=="string"&&(e=r.getNeighbour(e)),this.#n.process(Wg,this,e,r)}actionsForNeighbours(e=this.#s){return e.getNeighbouringDirections().reduce((r,o)=>({...r,[o]:this.#n.process(Wg,this,e.getNeighbour(o),e)}),{})}activate(){this.#n.process(Xl,this)}active(){return this.#e}setActive(e=!0){this.#e=e}applyVisibility(){this.#s.getSurroundingArea(this.visibility().value()).forEach(e=>{this.#n.process(ty,e,this.#a)})}attack(){let[e]=this.yield(new Vi);return e}busy(){return this.#t}setBusy(e=null){this.#t=e}city(){return this.#r}static build(e,r=d){return new this(e,e.player(),e.tile(),r)}defence(){let[e]=this.yield(new mi);return e}destroy(e=null){this.#n.process(Xn,this,e)}destroyed(){return this.#i}setDestroyed(){this.#i=!0}movement(){let[e]=this.yield(new Ji);return e}moves(){return this.#o}player(){return this.#a}status(){return this.#l}setStatus(e){this.#l=e}tile(){return this.#s}setTile(e){this.#s=e}visibility(){let[e]=this.yield(new ys);return e}waiting(){return this.#m}setWaiting(e=!0){this.#m=e}yield(...e){let r=this.#n.get(dp);return e.forEach(o=>r.filter(a=>a.validate(this,o)).forEach(a=>a.process(this,o))),e}};t(ry,"Unit");Pe=ry});var iy,ye,rr=n(()=>{Ce();Tc();iy=class extends F{constructor(){super(ol)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of CityGrowths returned.");return r[0]}};t(iy,"CityGrowthRegistry");ye=new iy});var Oe,xe,Ie=n(()=>{Ge();Oe=class extends k{};t(Oe,"Wonder");xe=Oe});var tm,ui,ds=n(()=>{Ce();_o();tm=class extends F{constructor(){super(_)}};t(tm,"PlayerRegistry");ui=new tm});var sy,ta,Tp=n(()=>{ds();sy=class extends tm{};t(sy,"CurrentPlayerRegistry");ta=new sy});var ly,my,Jg=n(()=>{ly=class{#e={};on(e,r){e in this.#e||(this.#e[e]=[]),this.#e[e].push(r)}once(e,r){let o=t((...a)=>{r(...a),this.off(e,o)},"onceHandler");this.on(e,o)}off(e,r){if(!(e in this.#e))return;let o=this.#e[e].indexOf(r);o!==-1&&this.#e[e].splice(o,1)}emit(e,...r){e in this.#e&&this.#e[e].forEach(o=>o(...r))}};t(ly,"EventEmitter");my=ly});var py,P,K=n(()=>{Jg();py=class extends my{#e={};#t=!1;debug(e){if(!!this.option("debug"))return e()}emit(e,...r){return this.debug(()=>console.log(`Engine#emit: ${String(e)}: ${r}`)),super.emit(e,...r)}loadPlugins(){return this.emit("plugins:load:start"),new Promise((e,r)=>{this.once("plugins:load:end",()=>e())})}option(e,r=null){return this.#e[e]||r}setOption(e,r){this.#e[e]!==r&&(this.#e[e]=r,this.emit("option:changed",e,r))}start(){this.#t||(this.#t=!0,this.emit("engine:initialise"),this.loadPlugins().then(()=>{this.emit("engine:start")}))}};t(py,"Engine");P=new py});var uy,ae,$i=n(()=>{Ce();Hc();uy=class extends F{constructor(){super(ql)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError(`Wrong number of player worlds exist for player: ${e.id()}`);return r[0]}};t(uy,"PlayerWorldRegistry");ae=new uy});var cy,Be,ci=n(()=>{Z();cy=class extends S{#e=0;constructor(){super(),this.addKey("value")}increment(){return this.#e++,this.#e}value(){return this.#e}};t(cy,"Turn");Be=new cy});var yy,z,_e=n(()=>{Ce();ea();yy=class extends F{constructor(){super(Pe)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.getBy("player",e)}getByTile(e){return this.getBy("tile",e)}};t(yy,"UnitRegistry");z=new yy});var fy,gs,$g=n(()=>{G();fy=class extends g{};t(fy,"Year");gs=fy});var J,Ko,ll=n(()=>{Ve();J=class extends L{};t(J,"Food");Ko=J});var H,ra,rm=n(()=>{Ve();H=class extends L{};t(H,"Production");ra=H});var re,ia,oa=n(()=>{Ve();re=class extends L{};t(re,"Trade");ia=re});var na=n(()=>{ll();rm();oa()});var aa,Ke,Zi=n(()=>{aa=t((i,...e)=>i.reduce((r,o)=>{let a=e.findIndex(s=>o instanceof s);return a===-1||(r[a]+=o.value()),r},e.map(()=>0)),"reduceYields"),Ke=t((i,e)=>aa(i,e).shift()??0,"reduceYield")});var Zk,Qk,hx,Ox,hs,im=n(()=>{rr();na();$i();Zi();Zk=t((i,e=[[J,8],[H,3*(Ke(i.tilesWorked().yields(i.player()),H)===0?3:1)],[re,1*(Ke(i.tilesWorked().yields(i.player()),re)===0?3:1)]])=>i.tiles().entries().sort((r,o)=>o.score(i.player(),e)-r.score(i.player(),e)),"getHighestValueCityTiles"),Qk=t((i,e=ae)=>Zk(i).filter(r=>e.getByPlayer(i.player()).includes(r)&&!i.tilesWorked().includes(r)&&i.tile()!==r),"getHighestValueAvailableCityTiles"),hx=t((i,e=ae,r=ye)=>{i.tilesWorked().unregister(...i.tilesWorked().entries()),i.tilesWorked().register(i.tile()),Ox(i,e,r)},"reassignWorkers"),Ox=t((i,e=ae,r=ye)=>{let o=r.getByCity(i);Qk(i,e).some(a=>i.tilesWorked().length>=o.size()+1?!0:(i.tilesWorked().register(a),!1))},"assignWorkers"),hs=Ox});var Gn,Rs,xs=n(()=>{I();Z();Gn=class extends S{#e;#t;#r;#i;constructor(e,r,o,a=d){super(),this.#e=e,this.#t=a,this.#r=r,this.#i=o,this.addKey("from","to")}forUnit(e){return new this.constructor(this.#e,this.#r,e,this.#t)}from(){return this.#e}perform(...e){}ruleRegistry(){return this.#t}to(){return this.#r}unit(){return this.#i}};t(Gn,"Action");Rs=Gn});var Oy,qo,Ip=n(()=>{G();Oy=class extends g{};t(Oy,"Defeated");qo=Oy});var vs,bx=n(()=>{I();_e();xs();Ip();vs=class extends Rs{#e;#t;constructor(e,r,o,a=d,s=z,p=()=>Math.random()){super(e,r,o,a),this.#t=s,this.#e=p}perform(){let[e]=this.#t.getByTile(this.to()).sort((o,a)=>a.defence().value()-o.defence().value()),r=Math.min(1,this.unit().moves().value());if(this.unit().attack().value()*r*this.#e()>=e.defence().value()*this.#e()){this.ruleRegistry().process(qo,e,this.unit(),this),this.unit().moves().subtract(r,this.constructor.name);return}this.ruleRegistry().process(qo,this.unit(),e,this)}};t(vs,"Attack")});var Ry,Cx,Tx=n(()=>{fr();Ry=class extends Te{};t(Ry,"BuildingIrrigation");Cx=Ry});var xy,q,At=n(()=>{G();xy=class extends g{};t(xy,"Moved");q=xy});var vy,Je,Qi=n(()=>{xs();I();ci();fr();w();T();At();vy=class extends Gn{#e;constructor(e,r,o,a=d,s=Be){super(e,r,o,a),this.#e=s}perform(e,r=()=>{},o=Te){let a=this.#e.value()+e;this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new o(new l(()=>this.#e.value()===a),new m((...s)=>{let p=this.unit();p.setActive(),p.setBusy(),r(...s),this.ruleRegistry().process(q,this.unit(),this)})))}};t(vy,"DelayedAction");Je=vy});var by,sa,Cy=n(()=>{G();by=class extends g{};t(by,"Built");sa=by});var Ty,Vo,pl=n(()=>{Z();I();Cy();Ty=class extends S{#e;constructor(e,r=d){super(),this.#e=e,r.process(sa,e,this)}tile(){return this.#e}};t(Ty,"TileImprovement");Vo=Ty});var we,Px,eh=n(()=>{pl();we=class extends Vo{};t(we,"Irrigation");Px=we});var Py,ve,yi=n(()=>{G();Py=class extends g{};t(Py,"MovementCost");ve=Py});var bs,Ix=n(()=>{Tx();Qi();eh();At();yi();bs=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Px(this.unit().tile())},Cx),this.ruleRegistry().process(q,this.unit(),this)}};t(bs,"BuildIrrigation")});var Iy,wx,Ax=n(()=>{fr();Iy=class extends Te{};t(Iy,"BuildingMine");wx=Iy});var $e,Gx,th=n(()=>{pl();$e=class extends Vo{};t($e,"Mine");Gx=$e});var Cs,Bx=n(()=>{Ax();Qi();th();At();yi();Cs=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Gx(this.unit().tile())},wx),this.ruleRegistry().process(q,this.unit(),this)}};t(Cs,"BuildMine")});var wy,Ux,Mx=n(()=>{fr();wy=class extends Te{};t(wy,"BuildingRoad");Ux=wy});var ke,Dx,rh=n(()=>{pl();ke=class extends Vo{};t(ke,"Road");Dx=ke});var Ts,Ex=n(()=>{Mx();Qi();At();yi();rh();Ts=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Dx(this.unit().tile())},Ux),this.ruleRegistry().process(q,this.unit(),this)}};t(Ts,"BuildRoad")});var Ay,Fx,kx=n(()=>{fr();Ay=class extends Te{};t(Ay,"BuildingRailroad");Fx=Ay});var ir,Sx,ih=n(()=>{pl();ir=class extends Vo{};t(ir,"Railroad");Sx=ir});var Ps,Yx=n(()=>{kx();Qi();At();yi();ih();Ps=class extends Je{perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e||0,()=>{new Sx(this.unit().tile())},Fx),this.ruleRegistry().process(q,this.unit(),this)}};t(Ps,"BuildRailroad")});var Gy,wp,oh=n(()=>{G();Gy=class extends g{};t(Gy,"ValidateMove");wp=Gy});var kt,om,Ap=n(()=>{xs();At();yi();oh();kt=class extends Gn{perform(){return this.validate()?(this.unit().setTile(this.to()),this.ruleRegistry().process(q,this.unit(),this),!0):!1}movementCost(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>r-o);return e}validate(){let[e]=this.ruleRegistry().process(wp,this.unit(),this.movementCost());return e}};t(kt,"Move");om=kt});var nm,zx=n(()=>{I();Ap();nm=class extends om{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.#e.capture(this.unit().player()),!0):!1}};t(nm,"CaptureCity")});var By,ze,fi=n(()=>{Z();By=class extends Ye{#e;constructor(e){super(),this.#e=e}clone(e=this.terrain()){return new this.constructor(e)}terrain(){return this.#e}};t(By,"TerrainFeature");ze=By});var nh,Uy,lt,Jo=n(()=>{Ce();fi();nh=new Map,Uy=class extends F{constructor(){super(ze)}getByTerrain(e){return nh.has(e)||nh.set(e,this.getBy("terrain",e)),nh.get(e)}};t(Uy,"TerrainFeatureRegistry");lt=new Uy});var My,Nx,Lx=n(()=>{fr();My=class extends Te{};t(My,"ClearingForest");Nx=My});var ie,am,Gp=n(()=>{$t();ie=class extends W{};t(ie,"Plains");am=ie});var Is,Wx=n(()=>{I();Jo();ci();Lx();Qi();At();yi();Gp();Is=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Be){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new am,o=this.#e.getByTerrain(this.from().terrain());this.#e.register(...o.map(a=>a.clone(r))),this.#e.unregister(...o),this.from().setTerrain(r)},Nx),this.ruleRegistry().process(q,this.unit(),this)}};t(Is,"ClearForest")});var Dy,jx,Hx=n(()=>{fr();Dy=class extends Te{};t(Dy,"ClearingJungle");jx=Dy});var Bp,ws,_x,sm=n(()=>{Jo();w();T();G();Bp=class extends g{};t(Bp,"Feature");ws=Bp,_x=t((i,e,r=.2,o=lt,a=()=>Math.random())=>[new Bp(new l(s=>s===e),new l((s,p)=>p instanceof i),new l(()=>a()<=r),new m((s,p)=>o.register(new s(p))))],"feature")});var fe,As,lm=n(()=>{$t();fe=class extends W{};t(fe,"Grassland");As=fe});var $o,Ey,Fy=n(()=>{fi();$o=class extends ze{};t($o,"Shield");Ey=$o});var Gs,Kx=n(()=>{I();Jo();ci();Hx();Qi();sm();lm();At();yi();Fy();Gs=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Be){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new As,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(ws,Ey,r),this.#e.unregister(...o),this.from().setTerrain(r)},jx),this.ruleRegistry().process(q,this.unit(),this)}};t(Gs,"ClearJungle")});var ky,qx,Vx=n(()=>{fr();ky=class extends Te{};t(ky,"ClearingSwamp");qx=ky});var Bs,Jx=n(()=>{I();Jo();ci();Vx();Qi();sm();lm();At();yi();Fy();Bs=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Be){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new As,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(ws,Ey,r),this.#e.unregister(...o),this.from().setTerrain(r)},qx),this.ruleRegistry().process(q,this.unit(),this)}};t(Bs,"ClearSwamp")});var mm,$x=n(()=>{xs();mm=class extends Rs{perform(){this.unit().destroy()}};t(mm,"Disband")});var Us,Zx=n(()=>{I();Ap();Us=class extends om{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.unit().moves().set(0),this.#e.unload(this.unit()),!0):!1}};t(Us,"Disembark")});var pm,Qx=n(()=>{I();fr();w();Ap();At();pm=class extends om{#e;constructor(e,r,o,a,s=d){super(e,r,o,s),this.#e=a}perform(){return super.perform()?(this.#e.stow(this.unit()),this.unit().setBusy(new Te(new l(()=>!1))),this.unit().setActive(!1),this.ruleRegistry().process(q,this.unit(),this),!0):!1}};t(pm,"Embark")});var Sy,um,Yy=n(()=>{Z();Sy=class extends Ye{#e;constructor(e){super(),this.#e=e}unit(){return this.#e}};t(Sy,"UnitImprovement");um=Sy});var zy,or,la=n(()=>{Ce();Yy();zy=class extends F{constructor(){super(um)}getByUnit(e){return this.getBy("unit",e)}};t(zy,"UnitImprovementRegistry");or=new zy});var Ny,Xx,ev=n(()=>{fr();Ny=class extends Te{};t(Ny,"Fortified");Xx=Ny});var di,tv,ah=n(()=>{Yy();di=class extends um{};t(di,"Fortified");tv=di});var Ly,rv,iv=n(()=>{fr();Ly=class extends Te{};t(Ly,"Fortifying");rv=Ly});var Ms,ov=n(()=>{I();ci();la();ev();w();Qi();ah();iv();At();yi();Ms=class extends Je{#e;constructor(e,r,o,a=d,s=Be,p=or){super(e,r,o,a,s),this.#e=p}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{this.unit().moves().set(0),this.unit().setActive(!1),this.unit().setBusy(new Xx(new l(()=>!1))),this.#e.register(new tv(this.unit()))},rv),this.ruleRegistry().process(q,this.unit(),this)}};t(Ms,"Fortify")});var cm,nv=n(()=>{gt();I();xs();Vn();At();cm=class extends Rs{#e;constructor(e,r,o,a=$,s=d){super(e,r,o,s),this.#e=a}perform(){new tt(this.unit().player(),this.unit().tile(),this.#e.takeCapitalByCivilization(this.unit().player().civilization().constructor),this.ruleRegistry()),this.unit().destroy(),this.ruleRegistry().process(q,this.unit(),this)}};t(cm,"FoundCity")});var Xi,av=n(()=>{xs();Xi=class extends Gn{perform(){this.unit().moves().subtract(this.unit().moves())}};t(Xi,"NoOrders")});var Wy,Ne,gi=n(()=>{Ce();pl();Wy=class extends F{constructor(){super(Vo)}getByTile(e){return this.getBy("tile",e)}};t(Wy,"TileImprovementRegistry");Ne=new Wy});var Ds,sv=n(()=>{I();gi();ci();Qi();At();yi();Ds=class extends Je{#e;constructor(e,r,o,a=d,s=Ne,p=Be){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let[r]=this.#e.getByTile(this.from());this.#e.unregister(r)}),this.ruleRegistry().process(q,this.unit(),this)}};t(Ds,"Pillage")});var qe,jy,Hy=n(()=>{$t();qe=class extends W{};t(qe,"Forest");jy=qe});var eo,lv,sh=n(()=>{fi();eo=class extends ze{};t(eo,"Horse");lv=eo});var _y,mv,pv=n(()=>{fr();_y=class extends Te{};t(_y,"PlantingForest");mv=_y});var Es,uv=n(()=>{I();Jo();ci();Qi();sm();Hy();sh();At();yi();pv();Es=class extends Je{#e;constructor(e,r,o,a=d,s=lt,p=Be){super(e,r,o,a,p),this.#e=s}perform(){let[e]=this.ruleRegistry().process(ve,this.unit(),this).sort((r,o)=>o-r);super.perform(e,()=>{let r=new jy,o=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(ws,lv,r),this.#e.unregister(...o),this.from().setTerrain(r)},mv),this.ruleRegistry().process(q,this.unit(),this)}};t(Es,"PlantForest")});var Ky,cv,yv=n(()=>{fr();Ky=class extends Te{};t(Ky,"Sleeping");cv=Ky});var ma,fv,lh=n(()=>{I();ci();_e();w();Qi();T();yv();ma=class extends Je{#e;constructor(e,r,o,a=d,s=Be,p=z){super(e,r,o,a,s),this.#e=p}perform(){this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new cv(new l(()=>this.from().getSurroundingArea(this.unit().visibility().value()).some(e=>this.#e.getByTile(e).some(r=>r.player()!==this.unit().player()))),new m(()=>{this.unit().setActive(),this.unit().setBusy()})))}};t(ma,"Sleep");fv=ma});var ym,dv=n(()=>{xs();ym=class extends Rs{perform(){this.unit().setWaiting(),this.unit().cargo().forEach(e=>{e.moves().set(e.movement()),e.activate()})}};t(ym,"Unload")});var fm=n(()=>{bx();Ix();Bx();Ex();Yx();zx();Wx();Kx();Jx();$x();Zx();Qx();ov();nv();Ap();av();sv();uv();lh();dv()});var Gt,gv,mh=n(()=>{$t();Gt=class extends W{};t(Gt,"Arctic");gv=Gt});var be,hv,ph=n(()=>{$t();be=class extends W{};t(be,"Desert");hv=be});var Ae,Ov,uh=n(()=>{$t();Ae=class extends W{};t(Ae,"Hills");Ov=Ae});var Ze,Rv,ch=n(()=>{$t();Ze=class extends W{};t(Ze,"Jungle");Rv=Ze});var Se,xv,yh=n(()=>{$t();Se=class extends W{};t(Se,"Mountains");xv=Se});var it,vv,fh=n(()=>{Og();it=class extends Jt{};t(it,"Ocean");vv=it});var ee,qy,Vy=n(()=>{$t();ee=class extends W{};t(ee,"River");qy=ee});var Qe,bv,dh=n(()=>{$t();Qe=class extends W{};t(Qe,"Swamp");bv=Qe});var mt,Cv,gh=n(()=>{$t();mt=class extends W{};t(mt,"Tundra");Cv=mt});var to=n(()=>{mh();ph();Hy();lm();uh();ch();yh();fh();Gp();Vy();dh();gh()});var St,Fs,dm=n(()=>{ea();St=class extends Pe{};t(St,"Air");Fs=St});var ot,Jy,$y=n(()=>{ea();ot=class extends Pe{};t(ot,"Land");Jy=ot});var Y,Yt=n(()=>{$y();Y=class extends Jy{};t(Y,"Fortifiable")});var Le,Bn,ul=n(()=>{ea();Le=class extends Pe{};t(Le,"Naval");Bn=Le});var Zy,Qy,hh=n(()=>{Zy=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}transport(){return this.#e}unit(){return this.#t}};t(Zy,"TransportManifest");Qy=Zy});var Xy,Un,gm=n(()=>{Ce();hh();Xy=class extends F{constructor(){super(Qy)}getByTransport(e){return this.getBy("transport",e)}getByUnit(e){let r=this.getBy("unit",e);if(r.length!==1)throw new TypeError("Wrong number of results.");return r[0]}};t(Xy,"TransportRegistry");Un=new Xy});var ef,tf,Oh=n(()=>{G();ef=class extends g{};t(ef,"Stowed");tf=ef});var rf,Tv,Pv=n(()=>{G();rf=class extends g{};t(rf,"Unloaded");Tv=rf});var Xk,Iv,wv=n(()=>{I();gm();Oh();hh();Pv();Xk=t(i=>t(class extends i{#e=d;#t=Un;canStow(r){return!this.cargo().includes(r)&&this.hasCapacity()}capacity(){return 0}cargo(){return this.#t.getByTransport(this).map(r=>r.unit())}hasCapacity(){return this.#t.getByTransport(this).length<this.capacity()}hasCargo(){return this.#t.getByTransport(this).length>0}setRuleRegistry(r){this.#e=r}setTransportRegistry(r){this.#t=r}stow(r){return!this.hasCapacity()||!this.canStow(r)?!1:(this.#t.register(new Qy(this,r)),this.#e.process(tf,r,this),!0)}unload(r){try{let o=this.#t.getByUnit(r);return this.#t.unregister(o),this.#e.process(Tv,r,this),!0}catch{return!1}}},"Transport"),"Transport"),Iv=Xk});var zt,Mn,cl=n(()=>{I();gm();ul();wv();zt=class extends Iv(Bn){constructor(e,r,o,a=d,s=Un){super(e,r,o,a),this.setRuleRegistry(a),this.setTransportRegistry(s)}};t(zt,"NavalTransport");Mn=zt});var dr,Rh=n(()=>{$y();dr=class extends Jy{};t(dr,"Worker")});var Dn=n(()=>{dm();Yt();$y();ul();cl();Rh()});var Zo,Av=n(()=>{fi();Zo=class extends ze{};t(Zo,"Coal")});var Qo,Gv=n(()=>{fi();Qo=class extends ze{};t(Qo,"Fish")});var hi,Bv=n(()=>{fi();hi=class extends ze{};t(hi,"Game")});var Xo,Uv=n(()=>{fi();Xo=class extends ze{};t(Xo,"Gems")});var en,Mv=n(()=>{fi();en=class extends ze{};t(en,"Gold")});var Oi,Dv=n(()=>{fi();Oi=class extends ze{};t(Oi,"Oasis")});var tn,Ev=n(()=>{fi();tn=class extends ze{};t(tn,"Oil")});var rn,Fv=n(()=>{fi();rn=class extends ze{};t(rn,"Seal")});var Up=n(()=>{Av();Gv();Bv();Uv();Mv();sh();Dv();Ev();Fv();Fy()});var of,yl,xh=n(()=>{G();of=class extends g{};t(of,"Action");yl=of});var nf,af,vh=n(()=>{G();nf=class extends g{};t(nf,"ActionPerformed");af=nf});var sf,hm,bh=n(()=>{G();sf=class extends g{};t(sf,"Discovered");hm=sf});var lf,mf,Ch=n(()=>{Z();I();xh();vh();bh();lf=class extends S{#e;#t;constructor(e,r=d){super(),this.#e=r,this.#t=e,this.addKey("tile")}action(e){e.perform(),this.#e.process(af,this,e)}actions(e){return this.#e.process(yl,this,e)}process(e){this.#e.process(hm,this,e)}tile(){return this.#t}};t(lf,"GoodyHut");mf=lf});var pf,kr,ks=n(()=>{Ch();Ce();pf=class extends F{constructor(){super(mf)}getByTile(e){let r=this.filter(o=>o.tile()===e);return r.length===0?null:r[0]}};t(pf,"GoodyHutRegistry");kr=new pf});var kv=n(()=>{pl()});var En=n(()=>{eh();th();kv();rh();ih()});var uf,Sv,Yv=n(()=>{uf=class{#e;#t;#r;constructor(e,r,o){this.#e=o,this.#t=r,this.#r=e}end(){return this.#e}generate(){throw new Error(`PathFinder#generate: Must be overridden in '${this.constructor.name}'.`)}start(){return this.#t}unit(){return this.#r}};t(uf,"PathFinder");Sv=uf});var cf,yf,Th=n(()=>{Ki();Yv();cf=class extends Ee{constructor(){super(Sv)}};t(cf,"PathFinderRegistry");yf=new cf});var ff,Sr,Ss=n(()=>{Z();ff=class extends Ye{};t(ff,"Government");Sr=ff});var df,Om,gf=n(()=>{Ki();Ss();df=class extends Ee{constructor(){super(Sr)}};t(df,"AvailableGovernmentRegistry");Om=new df});var hf,Mp,Ph=n(()=>{G();hf=class extends g{};t(hf,"Availability");Mp=hf});var Of,Dp,Ih=n(()=>{G();Of=class extends g{};t(Of,"Changed");Dp=Of});var Rf,xf,wh=n(()=>{gf();Z();I();Ph();Ih();Rf=class extends S{#e;#t=null;#r;#i;constructor(e,r=Om,o=d){super(),this.#r=e,this.#e=r,this.#i=o,this.addKey("available","current")}available(){return this.#e.filter(e=>this.#i.get(Mp).some(r=>r.validate(e,this.#r)))}current(){return this.#t}is(...e){return e.some(r=>this.#t instanceof r)}player(){return this.#r}set(e){this.#t=e,this.#i.process(Dp,this.#r,e)}};t(Rf,"PlayerGovernment");xf=Rf});var vf,pt,on=n(()=>{Ce();wh();vf=class extends F{constructor(){super(xf)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerGovernments for player.");return r[0]}};t(vf,"PlayerGovernmentRegistry");pt=new vf});var bf,Cf,Ah=n(()=>{mc();Hl();bf=class extends ss{#e;#t;constructor(e,r=Tn,o=()=>Math.random()){super(e),this.#e=r,this.#t=o}chooseCivilization(e){let r=e[Math.floor(e.length*this.#t())],o=this.player(),a=new r;o.setCivilization(a),this.chooseLeader(a)}chooseLeader(e){let r=this.#e.getByCivilization(e.constructor),o=r[Math.floor(this.#t()*r.length)];e.setLeader(new o)}};t(bf,"AIClient");Cf=bf});var zv=n(()=>{ah()});var pa,Nv=n(()=>{Yy();pa=class extends um{};t(pa,"Veteran")});var Lv=n(()=>{Nv()});var Ep=n(()=>{zv();Lv()});var Ri,Wv,Gh=n(()=>{M();Ri=class extends x{};t(Ri,"AdvancedFlight");Wv=Ri});var ro,jv,Bh=n(()=>{M();ro=class extends x{};t(ro,"Alphabet");jv=ro});var xi,Hv,Uh=n(()=>{M();xi=class extends x{};t(xi,"Astronomy");Hv=xi});var Fn,_v,Mh=n(()=>{M();Fn=class extends x{};t(Fn,"AtomicTheory");_v=Fn});var ut,Kv,Dh=n(()=>{M();ut=class extends x{};t(ut,"Automobile");Kv=ut});var vi,qv,Eh=n(()=>{M();vi=class extends x{};t(vi,"Banking");qv=vi});var io,Vv,Fh=n(()=>{M();io=class extends x{};t(io,"BridgeBuilding");Vv=io});var Yr,Jv,kh=n(()=>{M();Yr=class extends x{};t(Yr,"BronzeWorking");Jv=Yr});var bi,$v,Sh=n(()=>{M();bi=class extends x{};t(bi,"CeremonialBurial");$v=bi});var nn,Zv,Yh=n(()=>{M();nn=class extends x{};t(nn,"Chemistry");Zv=nn});var oo,Qv,zh=n(()=>{M();oo=class extends x{};t(oo,"Chivalry");Qv=oo});var gr,Xv,Nh=n(()=>{M();gr=class extends x{};t(gr,"CodeOfLaws");Xv=gr});var zr,eb,Lh=n(()=>{M();zr=class extends x{};t(zr,"Combustion");eb=zr});var Rt,tb,Wh=n(()=>{M();Rt=class extends x{};t(Rt,"Communism");tb=Rt});var Ci,rb,jh=n(()=>{M();Ci=class extends x{};t(Ci,"Computers");rb=Ci});var Nr,ib,Hh=n(()=>{M();Nr=class extends x{};t(Nr,"Conscription");ib=Nr});var Lr,ob,_h=n(()=>{M();Lr=class extends x{};t(Lr,"Construction");ob=Lr});var no,nb,Kh=n(()=>{M();no=class extends x{};t(no,"Corporation");nb=no});var Ti,ab,qh=n(()=>{M();Ti=class extends x{};t(Ti,"Currency");ab=Ti});var ao,sb,Vh=n(()=>{M();ao=class extends x{};t(ao,"Democracy");sb=ao});var hr,lb,Jh=n(()=>{M();hr=class extends x{};t(hr,"Electricity");lb=hr});var ct,mb,$h=n(()=>{M();ct=class extends x{};t(ct,"Electronics");mb=ct});var an,pb,Zh=n(()=>{M();an=class extends x{};t(an,"Engineering");pb=an});var sn,ub,Qh=n(()=>{M();sn=class extends x{};t(sn,"Explosives");ub=sn});var kn,cb,Xh=n(()=>{M();kn=class extends x{};t(kn,"Feudalism");cb=kn});var so,yb,eO=n(()=>{M();so=class extends x{};t(so,"Flight");yb=so});var ua,fb,tO=n(()=>{M();ua=class extends x{};t(ua,"FusionPower");fb=ua});var ln,db,rO=n(()=>{M();ln=class extends x{};t(ln,"GeneticEngineering");db=ln});var yt,gb,iO=n(()=>{M();yt=class extends x{};t(yt,"Gunpowder");gb=yt});var mn,hb,oO=n(()=>{M();mn=class extends x{};t(mn,"HorsebackRiding");hb=mn});var xt,Ob,nO=n(()=>{M();xt=class extends x{};t(xt,"Industrialization");Ob=xt});var Or,Rb,aO=n(()=>{M();Or=class extends x{};t(Or,"Invention");Rb=Or});var Pi,xb,sO=n(()=>{M();Pi=class extends x{};t(Pi,"IronWorking");xb=Pi});var pn,vb,lO=n(()=>{M();pn=class extends x{};t(pn,"LaborUnion");vb=pn});var Rr,bb,mO=n(()=>{M();Rr=class extends x{};t(Rr,"Literacy");bb=Rr});var Nt,Cb,pO=n(()=>{M();Nt=class extends x{};t(Nt,"Magnetism");Cb=Nt});var Wr,Tb,uO=n(()=>{M();Wr=class extends x{};t(Wr,"MapMaking");Tb=Wr});var Lt,Pb,cO=n(()=>{M();Lt=class extends x{};t(Lt,"Masonry");Pb=Lt});var Wt,Ib,yO=n(()=>{M();Wt=class extends x{};t(Wt,"MassProduction");Ib=Wt});var xr,wb,fO=n(()=>{M();xr=class extends x{};t(xr,"Mathematics");wb=xr});var Ii,Ab,dO=n(()=>{M();Ii=class extends x{};t(Ii,"Medicine");Ab=Ii});var jr,Gb,gO=n(()=>{M();jr=class extends x{};t(jr,"Metallurgy");Gb=jr});var Hr,Bb,hO=n(()=>{M();Hr=class extends x{};t(Hr,"Monarchy");Bb=Hr});var jt,Ub,OO=n(()=>{M();jt=class extends x{};t(jt,"Mysticism");Ub=jt});var nr,Mb,RO=n(()=>{M();nr=class extends x{};t(nr,"Navigation");Mb=nr});var _r,Db,xO=n(()=>{M();_r=class extends x{};t(_r,"NuclearFission");Db=_r});var lo,Eb,vO=n(()=>{M();lo=class extends x{};t(lo,"NuclearPower");Eb=lo});var Kr,Fb,bO=n(()=>{M();Kr=class extends x{};t(Kr,"Philosophy");Fb=Kr});var wi,kb,CO=n(()=>{M();wi=class extends x{};t(wi,"Physics");kb=wi});var un,Sb,TO=n(()=>{M();un=class extends x{};t(un,"Plastics");Sb=un});var cn,Yb,PO=n(()=>{M();cn=class extends x{};t(cn,"Pottery");Yb=cn});var qr,zb,IO=n(()=>{M();qr=class extends x{};t(qr,"Railroad");zb=qr});var yn,Nb,wO=n(()=>{M();yn=class extends x{};t(yn,"Recycling");Nb=yn});var Ai,Lb,AO=n(()=>{M();Ai=class extends x{};t(Ai,"Refining");Lb=Ai});var vt,Wb,GO=n(()=>{M();vt=class extends x{};t(vt,"Religion");Wb=vt});var Vr,jb,BO=n(()=>{M();Vr=class extends x{};t(Vr,"Robotics");jb=Vr});var mo,Hb,UO=n(()=>{M();mo=class extends x{};t(mo,"Rocketry");Hb=mo});var po,_b,MO=n(()=>{M();po=class extends x{};t(po,"SpaceFlight");_b=po});var uo,Kb,DO=n(()=>{M();uo=class extends x{};t(uo,"SteamEngine");Kb=uo});var co,qb,EO=n(()=>{M();co=class extends x{};t(co,"Steel");qb=co});var yo,Vb,FO=n(()=>{M();yo=class extends x{};t(yo,"Superconductor");Vb=yo});var Gi,Jb,kO=n(()=>{M();Gi=class extends x{};t(Gi,"TheRepublic");Jb=Gi});var fn,$b,SO=n(()=>{M();fn=class extends x{};t(fn,"TheWheel");$b=fn});var fo,Zb,YO=n(()=>{M();fo=class extends x{};t(fo,"TheoryOfGravity");Zb=fo});var Bi,Qb,zO=n(()=>{M();Bi=class extends x{};t(Bi,"Trade");Qb=Bi});var ar,Xb,NO=n(()=>{M();ar=class extends x{};t(ar,"University");Xb=ar});var vr,eC,LO=n(()=>{M();vr=class extends x{};t(vr,"Writing");eC=vr});var sr=n(()=>{Gh();Bh();Uh();Mh();Dh();Eh();Fh();kh();Sh();Yh();zh();Nh();Lh();Wh();jh();Hh();_h();Kh();qh();Vh();Jh();$h();Zh();Qh();Xh();eO();tO();rO();iO();oO();nO();aO();sO();lO();mO();pO();uO();cO();yO();fO();dO();gO();hO();OO();RO();xO();vO();bO();CO();TO();PO();IO();wO();AO();GO();BO();UO();MO();DO();EO();FO();kO();SO();YO();zO();NO();LO()});var Ui,tC=n(()=>{Ss();Ui=class extends Sr{};t(Ui,"Anarchy")});var bt,rC=n(()=>{Ss();bt=class extends Sr{};t(bt,"Communism")});var nt,iC=n(()=>{Ss();nt=class extends Sr{};t(nt,"Democracy")});var Ht,oC=n(()=>{Ss();Ht=class extends Sr{};t(Ht,"Despotism")});var at,nC=n(()=>{Ss();at=class extends Sr{};t(at,"Monarchy")});var ft,aC=n(()=>{Ss();ft=class extends Sr{};t(ft,"Republic")});var dn=n(()=>{tC();rC();iC();oC();nC();aC()});var Jr,sC=n(()=>{Ge();Jr=class extends k{};t(Jr,"Aqueduct")});var lr,lC=n(()=>{Ge();lr=class extends k{};t(lr,"Bank")});var $r,mC=n(()=>{Ge();$r=class extends k{};t($r,"Barracks")});var mr,pC=n(()=>{Ge();mr=class extends k{};t(mr,"Cathedral")});var go,uC=n(()=>{Ge();go=class extends k{};t(go,"CityWalls")});var Zr,cC=n(()=>{Ge();Zr=class extends k{};t(Zr,"Colosseum")});var br,yC=n(()=>{Ge();br=class extends k{};t(br,"Courthouse")});var _t,fC=n(()=>{Ge();_t=class extends k{};t(_t,"Factory")});var Qr,dC=n(()=>{Ge();Qr=class extends k{};t(Qr,"Granary")});var Ct,gC=n(()=>{Ge();Ct=class extends k{};t(Ct,"HydroPlant")});var Cr,hC=n(()=>{Ge();Cr=class extends k{};t(Cr,"Library")});var Tr,OC=n(()=>{Ge();Tr=class extends k{};t(Tr,"ManufacturingPlant")});var pr,RC=n(()=>{Ge();pr=class extends k{};t(pr,"Marketplace")});var ho,xC=n(()=>{Ge();ho=class extends k{};t(ho,"MassTransit")});var Tt,vC=n(()=>{Ge();Tt=class extends k{};t(Tt,"NuclearPlant")});var dt,bC,WO=n(()=>{Ge();dt=class extends k{};t(dt,"Palace");bC=dt});var Pt,CC=n(()=>{Ge();Pt=class extends k{};t(Pt,"PowerPlant")});var Oo,TC=n(()=>{Ge();Oo=class extends k{};t(Oo,"RecyclingCenter")});var Ro,PC=n(()=>{Ge();Ro=class extends k{};t(Ro,"SdiDefence")});var Bt,IC=n(()=>{Ge();Bt=class extends k{};t(Bt,"Temple")});var Pr,wC=n(()=>{Ge();Pr=class extends k{};t(Pr,"University")});var Mi=n(()=>{sC();lC();mC();pC();uC();cC();yC();fC();dC();gC();hC();OC();RC();xC();vC();WO();CC();TC();PC();IC();wC()});var Tf,Ys,AC=n(()=>{Th();Nu();Tf=class extends Sl{#e=1/0;end(){return this.entries()[this.length-1]}static for(e,r,o,a=yf){let[s]=a.entries().map(p=>new p(e,r,o)).map(p=>p.generate()).sort((p,u)=>p.movementCost()-u.movementCost());return s&&(s.shift(),s)}movementCost(){return this.#e}setMovementCost(e){this.#e=e}push(...e){e.forEach(r=>{let o=this.end();if(this.length>0&&!r.isNeighbourOf(o))throw new TypeError(`Tile#push: Invalid element passed, ${r.x()},${r.y()} is not a neighbour of ${o.x()},${o.y()}.`);super.push(r)})}start(){return this.entries()[0]}};t(Tf,"Path");Ys=Tf});var xo,GC=n(()=>{Yt();xo=class extends Y{};t(xo,"Artillery")});var vo,BC=n(()=>{ul();vo=class extends Bn{};t(vo,"Battleship")});var bo,UC=n(()=>{dm();bo=class extends Fs{};t(bo,"Bomber")});var Di,MC=n(()=>{Yt();Di=class extends Y{};t(Di,"Cannon")});var Co,DC=n(()=>{Yt();Co=class extends Y{};t(Co,"Caravan")});var To,EC=n(()=>{dm();cl();To=class extends Mn{canStow(e){return e instanceof Fs&&super.canStow(e)}capacity(){return 8}};t(To,"Carrier")});var Ei,FC=n(()=>{Yt();Ei=class extends Y{};t(Ei,"Catapult")});var Fi,kC=n(()=>{Yt();Fi=class extends Y{};t(Fi,"Chariot")});var Po,SC=n(()=>{ul();Po=class extends Bn{};t(Po,"Cruiser")});var Io,YC=n(()=>{Yt();Io=class extends Y{};t(Io,"Diplomat")});var Xr,zC=n(()=>{dm();Xr=class extends Fs{};t(Xr,"Fighter")});var ki,NC=n(()=>{cl();ki=class extends Mn{capacity(){return 4}};t(ki,"Frigate")});var Ir,LC=n(()=>{Yt();Ir=class extends Y{};t(Ir,"Horseman")});var Si,WC=n(()=>{ul();Si=class extends Bn{};t(Si,"Ironclad")});var Yi,jC=n(()=>{Yt();Yi=class extends Y{};t(Yi,"Knight")});var wo,HC=n(()=>{Yt();wo=class extends Y{};t(wo,"MechanizedInfantry")});var zi,_C=n(()=>{Yt();zi=class extends Y{};t(zi,"Musketman")});var Ao,KC=n(()=>{dm();Ao=class extends Fs{};t(Ao,"Nuclear")});var Go,qC=n(()=>{Yt();Go=class extends Y{};t(Go,"Rifleman")});var Ni,VC=n(()=>{cl();Ni=class extends Mn{capacity(){return 3}};t(Ni,"Sail")});var We,JC,jO=n(()=>{Rh();We=class extends dr{};t(We,"Settlers");JC=We});var Li,$C=n(()=>{Yt();Li=class extends Y{};t(Li,"Spearman")});var Bo,ZC=n(()=>{ul();Bo=class extends Bn{};t(Bo,"Submarine")});var wr,QC=n(()=>{Yt();wr=class extends Y{};t(wr,"Swordman")});var Uo,XC=n(()=>{Yt();Uo=class extends Y{};t(Uo,"Tank")});var Mo,eT=n(()=>{cl();Mo=class extends Mn{capacity(){return 8}};t(Mo,"Transport")});var Ar,tT=n(()=>{cl();Ar=class extends Mn{capacity(){return 2}};t(Ar,"Trireme")});var Do,rT=n(()=>{Yt();Do=class extends Y{};t(Do,"Warrior")});var gn=n(()=>{GC();BC();UC();MC();DC();EC();FC();kC();SC();YC();zC();NC();LC();WC();jC();HC();_C();KC();qC();VC();jO();$C();ZC();QC();XC();eT();tT();rT()});var Pf,If,Sn,Rm=n(()=>{Zl();fm();$n();rr();rt();to();K();na();Dn();Up();ks();En();Hl();Th();on();He();tl();$i();I();Jo();gi();la();_e();Ah();em();ec();Dc();Ep();sr();dn();Mi();AC();Iu();gn();qi();ea();Ie();im();Pf=t((i,e,r=j)=>{let o=r.getByTile(i);return o===null?!1:o.player()===e},"hasPlayerCity"),If=class extends Cf{#e=e=>{let r=this.#A.option("earth",!1),o=this.#p.getByPlayer(this.player()).length===0;if(r&&o)return!0;let a=this.#w.getByTerrain(e.terrain());return(e.terrain()instanceof fe||e.terrain()instanceof ee||e.terrain()instanceof ie||a.some(s=>s instanceof Oi)||a.some(s=>s instanceof hi))&&e.getSurroundingArea().score(this.player(),[[J,4],[H,2],[re,1]])>=160&&!e.getSurroundingArea(4).filter(s=>this.#p.getByTile(s)!==null).length};#t=e=>[be,ie,fe,ee].some(r=>e.terrain()instanceof r)&&!this.#O.getByTile(e).some(r=>r instanceof we)&&e.getSurroundingArea().some(r=>Pf(r,this.player(),this.#p))&&[...e.getAdjacent(),e].some(r=>r.terrain()instanceof ee||r.isCoast()||this.#O.getByTile(r).some(o=>o instanceof we)&&this.#p.getByTile(r)===null);#r=e=>[Ae,Se].some(r=>e.terrain()instanceof r)&&!this.#O.getByTile(e).some(r=>r instanceof $e)&&e.getSurroundingArea().some(r=>Pf(r,this.player(),this.#p));#i=e=>!this.#O.getByTile(e).some(r=>r instanceof ke)&&e.getSurroundingArea().some(r=>Pf(r,this.player(),this.#p));#o=new Map;#a=new Map;#n=new Map;#l=[];#s=[];#m=[];#g=[];#y=[];#f=[];#u=[];#p;#v;#R;#b;#d;#C;#T;#P;#h;#I;#w;#O;#x;#c;#A;constructor(e,r=j,o=Qt,a=ye,s=kr,p=Tn,u=yf,y=pt,c=N,f=si,h=ae,U=d,D=lt,A=Ne,E=or,V=z,se=P){super(e,p),this.#p=r,this.#v=o,this.#R=a,this.#b=s,this.#d=u,this.#C=y,this.#T=c,this.#P=f,this.#h=h,this.#I=U,this.#w=D,this.#x=E,this.#O=A,this.#c=V,this.#A=se}scoreUnitMove(e,r){let o=e.actions(r),{attack:a,buildIrrigation:s,buildMine:p,buildRoad:u,captureCity:y,disembark:c,embark:f,fortify:h,foundCity:U,noOrders:D}=o.reduce((le,je)=>({...le,[je.constructor.name.replace(/^./,oi=>oi.toLowerCase())]:je}),{});if(!o.length||o.length===1&&D||e instanceof Y&&o.length===2&&h&&D)return-1;let A=0;this.#b.getByTile(r)!==null&&(A+=60),(U&&this.#e(r)||p&&this.#r(r)||s&&this.#t(r)||u&&this.#i(r))&&(A+=24);let V=this.#c.getByTile(r).sort((le,je)=>je.defence().value()-le.defence().value()),[se]=V,wt=V.some(le=>le.player()===this.player());e instanceof zt&&e.hasCapacity()&&V.length&&wt&&(A+=10),e instanceof zt&&e.hasCargo()&&r.isCoast()&&r.isWater()&&(A+=16),f&&(A+=16),c&&(A+=16),y&&(A+=100),a&&e.attack()>se.defence()&&(A+=24*(e.attack().value()-se.defence().value())),a&&e.attack().value()>=se.defence().value()&&(A+=16),a&&e.attack().value()>=se.defence().value()*(2/3)&&(A+=8);let Dr=this.#h.getByPlayer(this.player()),Il=r.getNeighbours().filter(le=>!Dr.includes(le)).length;Il>0&&(A+=Il*3);let wl=this.#n.get(e);return wl instanceof ce&&r.distanceFrom(wl)<e.tile().distanceFrom(wl)&&(A+=14),(this.#o.get(e)||[]).includes(r)||(A*=4),A}moveUnit(e){let r=0;for(;e.active()&&e.moves().value()>=.1;){if(r++>1e3){console.log("SimpleAIClient#moveUnit: loopCheck: aborting"),console.log(`${e.player().civilization().name()} ${e.constructor.name}`),console.log(e.actions()),console.log(e.actionsForNeighbours()),e.action(new Xi(e.tile(),e.tile(),e));return}let o=this.#a.get(e);if(o){let c=o.shift(),[f]=e.actions(c).filter(h=>h instanceof kt);if(f){e.action(f),o.length===0&&this.#a.delete(e);return}if(o.length>0){let h=Ys.for(e,e.tile(),o.end());if(h){this.#a.set(e,h);continue}}this.#a.delete(e)}let[a]=e.tile().getNeighbours().map(c=>[c,this.scoreUnitMove(e,c)]).filter(([,c])=>c>-1).sort(([,c],[,f])=>f-c||Math.floor(Math.random()*3)-1).map(([c])=>c);if(!a){e.action(new Xi(e.tile(),e.tile(),e));return}let s=e.actions(a),[p]=s,u=this.#o.get(e)||[],y=this.#n.get(e);if(!p){e.action(new Xi(e.tile(),e.tile(),e));return}y===a&&this.#n.delete(e),u.push(a),this.#o.set(e,u.slice(-50)),e.action(p)}e.moves().value()>0&&e.action(new Xi(e.tile(),e.tile(),e))}preProcessTurn(){this.#l.splice(0),this.#s.splice(0),this.#m.splice(0),this.#g.splice(0),this.#y.splice(0),this.#f.splice(0),this.#u.splice(0);let e=this.#h.getByPlayer(this.player());e.entries().forEach(r=>{let o=r.tile(),a=this.#p.getByTile(o),s=this.#c.getBy("tile",o),p=this.#u.includes(o)&&![...this.#n.values(),...[...this.#a.values()].map(u=>u.end())].includes(o);a&&a.player()===this.player()&&!s.length&&!this.#u.includes(o)&&!p?this.#u.push(o):a&&a.player()!==this.player()&&a.originalPlayer()===this.player()?this.#l.push(o):a&&a.player()!==this.player()&&!this.#s.includes(o)?this.#s.push(o):s.length&&s.some(u=>u.player()!==this.player())&&this.#m.includes(o)?this.#m.push(o):o.isLand()&&o.getNeighbours().some(u=>!e.includes(u))&&!this.#y.includes(o)&&!p?this.#y.push(o):o.isWater()&&o.getNeighbours().some(u=>!e.includes(u))&&this.#f.includes(o)&&!p&&this.#f.push(o),this.#e(o)&&this.#g.includes(o)&&!p&&this.#g.push(o)}),this.#p.getByPlayer(this.player()).forEach(r=>{let o=this.#c.getByTile(r.tile());hs(r,this.#h,this.#R),!o.length&&!this.#u.includes(r.tile())&&this.#u.push(r.tile())})}takeTurn(){return new Promise((e,r)=>{try{let o=0;this.preProcessTurn();let[a]=this.#C.filter(p=>p.player()===this.player()),[s]=this.#T.filter(p=>p.player()===this.player());for(s.completed(Hr)&&!a.is(at)&&a.set(new at);this.player().hasMandatoryActions();){let p=this.player().mandatoryAction(),u=p.value();if(o++>1e3){console.log(""),console.log(""),console.log(u),u instanceof Pe&&(console.log(u.actions()),u.tile().getNeighbours().forEach(y=>console.log(u.actions(y))),console.log(u.active()),console.log(u.busy()),console.log(u.moves().value()),console.log(this.#x.getByUnit(u))),u.action(new Xi(u.tile(),u.tile(),u)),console.error("SimpleAIClient: Couldn't pick an action to do.");break}if(u instanceof Pe){let y=u,c=y.tile(),f=this.#n.get(y),h=y.actions(),{buildIrrigation:U,buildMine:D,buildRoad:A,fortify:E,foundCity:V,unload:se}=h.reduce((Me,le)=>({...Me,[le.constructor.name.replace(/^./,je=>je.toLowerCase())]:le}),{}),wt=this.#c.getByTile(c);if(this.#o.get(y)||this.#o.set(y,[y.tile()]),y instanceof zt&&se&&c.isCoast()&&y.cargo().some(Me=>!c.getNeighbours().some(le=>(this.#o.get(Me)||[]).includes(le)))){y.action(se),y.setWaiting();continue}if(y instanceof dr){V&&this.#e(c)?y.action(V):U&&this.#t(c)?y.action(U):D&&this.#r(c)?y.action(D):A&&this.#i(c)?y.action(A):!f&&this.#g.length&&this.#n.set(y,this.#g.shift()),this.moveUnit(y);continue}let[Il]=wt.filter(Me=>this.#x.getByUnit(Me).some(le=>le instanceof di)&&y.defence()>Me.defence()),wl=this.#p.getByTile(c);if(E&&wl&&(Il||wt.length<=Math.ceil(this.#R.getByCity(wl).size()/5))){y.action(E),Il&&Il.activate();continue}if(!f){if(y instanceof Y&&y.defence().value()>0&&this.#u.length>0){let[Me]=this.#u.sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#u.splice(this.#u.indexOf(Me),1),this.#a.set(y,le))}else if(y.attack().value()>0&&this.#l.length>0){let[Me]=this.#l.filter(je=>y instanceof ot&&je.isLand()).sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#l.splice(this.#l.indexOf(Me),1),this.#a.set(y,le))}else if(y.attack().value()>0&&this.#m.length>0){let[Me]=this.#m.filter(je=>y instanceof ot&&je.isLand()||y instanceof Le&&je.isWater()).sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#m.splice(this.#m.indexOf(Me),1),this.#a.set(y,le))}else if(y instanceof ot&&y.attack().value()>0&&this.#s.length>0){let[Me]=this.#s.sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#s.splice(this.#s.indexOf(Me),1),this.#a.set(y,le))}else if(y instanceof ot&&this.#y.length>0){let[Me]=this.#y.sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#y.splice(this.#y.indexOf(Me),1),this.#a.set(y,le))}else if(y instanceof Le&&this.#f.length>0){let[Me]=this.#f.sort((je,oi)=>je.distanceFrom(y.tile())-oi.distanceFrom(y.tile())),le=Ys.for(y,y.tile(),Me,this.#d);le&&(this.#f.splice(this.#f.indexOf(Me),1),this.#a.set(y,le))}}this.moveUnit(y);continue}if(u instanceof Wl){this.buildItemInCity(u.city());continue}if(u instanceof Ul){let y=u.available();y.length&&u.research(y[Math.floor(y.length*Math.random())]);continue}if(p instanceof Mc)break;console.log(`Can't process: '${u.constructor.name}'`);break}e()}catch(o){if(typeof o=="string"){r(new Error(o));return}if(o instanceof Error){r(o);return}r(new Error(`An unknown error occurred: ${o}`))}})}buildItemInCity(e){let r=e.tile(),o=this.#v.getByCity(e),a=this.#c.getByTile(r),s=o.available(),p=[dt,We],u=s.filter(E=>!p.includes(E.item())&&!Object.prototype.isPrototypeOf.call(xe,E.item())),y=s.filter(E=>Object.prototype.isPrototypeOf.call(xe,E.item())),c=u.filter(E=>Object.prototype.isPrototypeOf.call(Pe,E.item())),f=u[Math.floor(u.length*Math.random())].item(),h=t(E=>{let[[V]]=c.map(se=>{let wt=se.item(),Dr=new E;return this.#I.process(fs,wt,Dr),[wt,Dr]}).sort(([,se],[,wt])=>wt.value()-se.value());return V},"getUnitByYield"),U=(E=>()=>E||(E=h(mi)))(),D=(E=>()=>E||(E=h(Vi)))();if(this.#c.getByTile(r).length<2&&U()){o.build(U());return}let A=this.#R.getByCity(o.city());if(s.some(E=>E.item()===We)&&!this.#c.getByCity(o.city()).some(E=>E instanceof We)&&this.#c.getByPlayer(this.player()).filter(E=>E instanceof We).length<3&&A.size()>1){o.build(We);return}if(this.#l.length>0||this.#s.length>0||this.#m.length>4){o.build(D());return}if(a.filter(E=>this.#x.getByUnit(E).filter(V=>V instanceof di)).length<2||this.#u.length){o.build(U());return}if(o.city().yields().filter(E=>E instanceof H).some(E=>E.value()>4)){let E=y.map(V=>V.item());o.build(E[Math.floor(Math.random()*E.length)])}f&&o.build(f)}cityLost(e,r,o){if(!r)return;let a=this.#h.getByPlayer(this.player());if(o){this.#s.push(...a.entries().filter(s=>Pf(s.tile(),this.player(),this.#p)).map(s=>s.tile())),this.#m.push(...a.entries().filter(s=>this.#c.getByTile(s.tile()).some(p=>p.player()===r)).map(s=>s.tile()));return}this.#l.push(e.tile())}unitDestroyed(e,r){let o=this.#p.getByTile(e.tile()),a=this.#c.getByTile(e.tile());o&&o.player()===this.player()&&a.length<2&&(this.buildItemInCity(o),this.#P.getByPlayer(this.player()).buy(o))}};t(If,"SimpleAIClient");Sn=If});var wf,Eo,fl=n(()=>{Ce();mc();wf=class extends F{constructor(){super(JR)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of Clients for Player.");return r[0]}};t(wf,"ClientRegistry");Eo=new wf});var ca,dl,xm=n(()=>{Ft();ca=class extends me{};t(ca,"American");dl=ca});var eS={};var iT=n(()=>{xm();er();tr();Object.entries({people:"American",nation:"America",colors:["#0055A4","#FFF"]}).forEach(([i,e])=>he.register(new ge(dl,i,e)))});var tS={};var oT=n(()=>{xm();Et();gt();["Washington","New York","Los Angeles","Chicago","Houston","Phoenix","Philadelphia","San Antonio","San Diego","Dallas","San Jose","Austin","Jacksonville","Fort Worth","Columbus","San Francisco","Charlotte","Indianapolis","Seattle","Denver","Boston","El Paso","Detroit","Nashville","Portland","Memphis","Oklahoma City","Las Vegas","Louisville","Baltimore","Milwaukee","Albuquerque","Tucson","Fresno","Mesa","Sacramento","Atlanta","Kansas City","Colorado Springs","Miami","Raleigh","Omaha","Long Beach","Virginia Beach","Oakland","Minneapolis","Tulsa","Arlington","Tampa","New Orleans","Wichita","Cleveland","Bakersfield","Aurora","Anaheim","Honolulu","Santa Ana","Riverside","Corpus Christi","Lexington","Stockton","Henderson","Saint Paul","St. Louis","Cincinnati","Pittsburgh","Greensboro","Anchorage","Plano","Lincoln","Orlando","Irvine","Newark","Toledo","Durham","Chula Vista","Fort Wayne","Jersey City","St. Petersburg","Laredo","Madison","Chandler","Buffalo","Lubbock","Scottsdale","Reno","Glendale","Gilbert","Winston\u2013Salem","North Las Vegas","Norfolk","Chesapeake","Garland","Irving","Hialeah","Fremont","Boise","Richmond","Baton Rouge","Spokane","Des Moines","Tacoma","San Bernardino","Modesto","Fontana","Santa Clarita","Birmingham","Oxnard","Fayetteville","Moreno Valley","Rochester","Glendale","Huntington Beach","Salt Lake City","Grand Rapids","Amarillo","Yonkers","Aurora","Montgomery","Akron","Little Rock","Huntsville","Augusta","Port St. Lucie","Grand Prairie","Columbus","Tallahassee","Overland Park","Tempe","McKinney","Mobile","Cape Coral","Shreveport","Frisco","Knoxville","Worcester","Brownsville","Vancouver","Fort Lauderdale","Sioux Falls","Ontario","Chattanooga","Providence","Newport News","Rancho Cucamonga","Santa Rosa","Oceanside","Salem","Elk Grove","Garden Grove","Pembroke Pines","Peoria","Eugene","Corona","Cary","Springfield","Fort Collins","Jackson","Alexandria","Hayward","Lancaster","Lakewood","Clarksville","Palmdale","Salinas","Springfield","Hollywood","Pasadena","Sunnyvale","Macon","Kansas City","Pomona","Escondido","Killeen","Naperville","Joliet","Bellevue","Rockford","Savannah","Paterson","Torrance","Bridgeport","McAllen","Mesquite","Syracuse","Midland","Pasadena","Murfreesboro","Miramar","Dayton","Fullerton","Olathe","Orange","Thornton","Roseville","Denton","Waco","Surprise","Carrollton","West Valley City","Charleston","Warren","Hampton","Gainesville","Visalia","Coral Springs","Columbia","Cedar Rapids","Sterling Heights","New Haven","Stamford","Concord","Kent","Santa Clara","Elizabeth","Round Rock","Thousand Oaks","Lafayette","Athens","Topeka","Simi Valley","Fargo","Norman","Columbia","Abilene","Wilmington","Hartford","Victorville","Pearland","Vallejo","Ann Arbor","Berkeley","Allentown","Richardson","Odessa","Arvada","Cambridge","Sugar Land","Beaumont","Lansing","Evansville","Rochester","Independence","Fairfield","Provo","Clearwater","College Station","West Jordan","Carlsbad","El Monte","Murrieta","Temecula","Springfield","Palm Bay","Costa Mesa","Westminster","North Charleston","Miami Gardens","Manchester","High Point","Downey","Clovis","Pompano Beach","Pueblo","Elgin","Lowell","Antioch","West Palm Beach","Peoria","Everett","Ventura","Centennial","Lakeland","Gresham","Richmond","Billings","Inglewood","Broken Arrow","Sandy Springs","Jurupa Valley","Hillsboro","Waterbury","Santa Maria","Boulder","Greeley","Daly City","Meridian","Lewisville","Davie","West Covina","League City","Tyler","Norwalk","San Mateo","Green Bay","Wichita Falls","Sparks","Lakewood","Burbank","Rialto","Allen","El Cajon","Las Cruces","Renton","Davenport","South Bend","Vista","Tuscaloosa","Clinton","Edison","Woodbridge","San Angelo","Kenosha","Vacaville"].forEach((i,e)=>$.register(new Q(i,dl,e===0)))});var aT=b(nT=>{"use strict";Object.defineProperty(nT,"__esModule",{value:!0});iT();oT()});var ya,vm,Fp=n(()=>{Ft();ya=class extends me{};t(ya,"Aztec");vm=ya});var rS={};var sT=n(()=>{Fp();er();tr();Object.entries({people:"Aztec",nation:"Aztec",colors:["#A1DAB5","#EA6B76"]}).forEach(([i,e])=>he.register(new ge(vm,i,e)))});var iS={};var lT=n(()=>{Fp();Et();gt();["Tenochtitlan","Teotihuacan","Tlatelolco","Texcoco","Tlaxcala","Calixtlahuaca","Xochicalco","Tlacopan","Atzcapotzalco","Tzintzuntzan","Malinalco","Tula","Tamuin","Teayo","Cempoala","Chalco","Tlalmanalco","Ixtapaluca","Huexotla","Tepexpan","Tepetlaoxtoc","Chiconautla","Zitlaltepec","Coyotepec","Tequixquiac","Jilotzingo","Tlapanaloya","Tultitan","Ecatepec","Coatepec","Chalchiuites","Chiauhita","Chapultepec","Itzapalapa","Ayotzinco","Iztapam"].forEach((i,e)=>$.register(new Q(i,vm,e===0)))});var pT=b(mT=>{"use strict";Object.defineProperty(mT,"__esModule",{value:!0});sT();lT()});var fa,bm,kp=n(()=>{Ft();fa=class extends me{};t(fa,"Babylonian");bm=fa});var oS={};var uT=n(()=>{kp();er();tr();Object.entries({people:"Babylonian",nation:"Babylon",colors:["#D0B8A6","#2f7b00"]}).forEach(([i,e])=>he.register(new ge(bm,i,e)))});var nS={};var cT=n(()=>{kp();Et();gt();["Babilim","Eshnunna","Diniktum","Tutub","Der","Sippar","Kutha","Jemdet Nasr","Kish","Borsippa","Mashkan-shapir","Dilbat","Nippur","Marad","Adab","Isin","Kisurra","Shuruppak","Bad-tibira","Zabalam","Umma","Girsu","Lagash","Urum","Uruk","Larsa","Ur","Kuara","Eridu","Akshak","Akkad"].forEach((i,e)=>$.register(new Q(i,bm,e===0)))});var fT=b(yT=>{"use strict";Object.defineProperty(yT,"__esModule",{value:!0});uT();cT()});var da,Cm,Sp=n(()=>{Ft();da=class extends me{};t(da,"Chinese");Cm=da});var aS={};var dT=n(()=>{Sp();er();tr();Object.entries({people:"Chinese",nation:"China",colors:["#ee1c25","#ff0"]}).forEach(([i,e])=>he.register(new ge(Cm,i,e)))});var sS={};var gT=n(()=>{Sp();Et();gt();["Beijing","Shanghai","Chongqing","Tianjin","Guangzhou","Shenzhen\u2020","Chengdu","Nanjing","Wuhan","Xi'an","Hangzhou","Dongguan","Foshan","Shenyang","Harbin","Qingdao","Dalian","Jinan","Zhengzhou","Changsha","Kunming","Changchun","\xDCr\xFCmqi","Shantou","Hefei","Shijiazhuang","Ningbo","Taiyuan","Nanning","Xiamen\u2020","Fuzhou","Changzhou","Wenzhou","Nanchang","Tangshan","Guiyang","Wuxi","Lanzhou","Zhongshan","Handan","Huai'an","Weifang","Zibo","Shaoxing","Yantai","Huizhou","Luoyang","Nantong","Baotou","Liuzhou"].forEach((i,e)=>$.register(new Q(i,Cm,e===0)))});var OT=b(hT=>{"use strict";Object.defineProperty(hT,"__esModule",{value:!0});dT();gT()});var ga,Tm,Yp=n(()=>{Ft();ga=class extends me{};t(ga,"Egyptian");Tm=ga});var lS={};var RT=n(()=>{Yp();er();tr();Object.entries({people:"Egyptian",nation:"Egypt",colors:["#CE1126","#FFF"]}).forEach(([i,e])=>he.register(new ge(Tm,i,e)))});var mS={};var xT=n(()=>{Yp();Et();gt();["Cairo","Alexandria","Gizeh","Shubra El-Kheima","Port Said","Suez","Luxor","al-Mansura","El-Mahalla El-Kubra","Tanta","Asyut","Ismailia","Fayyum","Zagazig","Aswan","Damietta","Damanhur","al-Minya","Beni Suef","Qena","Sohag","Hurghada","6th of October City","Shibin El Kom","Banha","Kafr el-Sheikh","Arish","Mallawi","10th of Ramadan City","Bilbais","Marsa Matruh","Idfu","Mit Ghamr","Al-Hamidiyya","Desouk","Qalyub","Abu Kabir","Kafr el-Dawwar","Girga","Akhmim","Matarey"].forEach((i,e)=>$.register(new Q(i,Tm,e===0)))});var bT=b(vT=>{"use strict";Object.defineProperty(vT,"__esModule",{value:!0});RT();xT()});var ha,gl,Pm=n(()=>{Ft();ha=class extends me{};t(ha,"English");gl=ha});var pS={};var CT=n(()=>{Pm();er();tr();Object.entries({people:"English",nation:"England",colors:["#FFF","#C8102E"]}).forEach(([i,e])=>he.register(new ge(gl,i,e)))});var uS={};var TT=n(()=>{Pm();Et();gt();["London","Birmingham","Liverpool","Leeds","Sheffield","Bristol","Manchester","Leicester","Coventry","Kingston upon Hull","Stoke-on-Trent","Wolverhampton","Nottingham","Plymouth","Southampton","Reading","Derby","Dudley","Newcastle upon Tyne","Northampton","Portsmouth","Luton","Preston","Sunderland","Norwich","Walsall","Bournemouth","Southend-on-Sea","Swindon","Huddersfield","Poole","Oxford","Middlesbrough","Blackpool","Oldbury","Boldon","Ipswich","York","West Bromwich","Peterborough","Stockport","Brighton","Slough","Gloucester","Rotherham","Cambridge","Exeter","Eastbourne","Sutton Coldfield","Blackburn","Colchester","Oldham","St Helens","Woking","Chesterfield","Crawley"].forEach((i,e)=>$.register(new Q(i,gl,e===0)))});var IT=b(PT=>{"use strict";Object.defineProperty(PT,"__esModule",{value:!0});CT();TT()});var Oa,Im,zp=n(()=>{Ft();Oa=class extends me{};t(Oa,"French");Im=Oa});var cS={};var wT=n(()=>{zp();er();tr();Object.entries({people:"French",nation:"France",colors:["#FFF","#0055A4"]}).forEach(([i,e])=>he.register(new ge(Im,i,e)))});var yS={};var AT=n(()=>{zp();Et();gt();["Paris","Marseille","Lyon","Toulouse","Nice","Nantes","Strasbourg","Montpellier","Bordeaux","Lille","Rennes","Reims","Le Havre","Saint-\xC9tienne","Toulon","Grenoble","Dijon","N\xEEmes","Angers","Villeurbanne","Le Mans","Saint-Denis","Aix-en-Provence","Clermont-Ferrand","Brest","Limoges","Tours","Amiens","Perpignan","Metz","Besan\xE7on","Boulogne-Billancourt","Orl\xE9ans","Mulhouse","Rouen","Saint-Denis","Caen","Argenteuil","Saint-Paul","Montreuil","Nancy","Roubaix","Tourcoing","Nanterre","Avignon","Vitry-sur-Seine","Cr\xE9teil","Dunkirk","Poitiers","Asni\xE8res-sur-Seine","Courbevoie","Versailles","Colombes","Fort-de-France","Aulnay-sous-Bois","Saint-Pierre","Rueil-Malmaison","Pau","Aubervilliers","Le Tampon","Champigny-sur-Marne","Antibes","B\xE9ziers","La Rochelle","Saint-Maur-des-Foss\xE9s","Cannes","Calais","Saint-Nazaire","M\xE9rignac","Drancy","Colmar","Ajaccio","Bourges","Issy-les-Moulineaux","Levallois-Perret","La Seyne-sur-Mer","Quimper","Noisy-le-Grand","Villeneuve-d'Ascq","Neuilly-sur-Seine","Valence","Antony","Cergy","V\xE9nissieux","Pessac","Troyes","Clichy","Ivry-sur-Seine","Chamb\xE9ry","Lorient","Les Abymes","Montauban","Sarcelles","Niort","Villejuif","Saint-Andr\xE9","Hy\xE8res","Saint-Quentin","Beauvais","\xC9pinay-sur-Seine","Cayenne","Maisons-Alfort","Cholet","Meaux","Chelles","Pantin","\xC9vry","Fontenay-sous-Bois","Fr\xE9jus","Vannes","Bondy","Le Blanc-Mesnil","La Roche-sur-Yon","Saint-Louis","Arles","Clamart","Narbonne","Annecy","Sartrouville","Grasse","Laval","Belfort","Bobigny","\xC9vreux","Vincennes","Montrouge","Sevran","Albi","Charleville-M\xE9zi\xE8res","Suresnes","Martigues","Corbeil-Essonnes","Saint-Ouen","Bayonne","Cagnes-sur-Mer","Brive-la-Gaillarde","Carcassonne","Massy","Blois","Aubagne","Saint-Brieuc","Ch\xE2teauroux","Chalon-sur-Sa\xF4ne","Mantes-la-Jolie","Meudon","Saint-Malo","Ch\xE2lons-en-Champagne","Alfortville","S\xE8te","Salon-de-Provence","Vaulx-en-Velin","Puteaux","Rosny-sous-Bois","Saint-Herblain","Gennevilliers","Le Cannet","Livry-Gargan","Saint-Priest","Istres","Valenciennes","Choisy-le-Roi","Caluire-et-Cuire","Boulogne-sur-Mer","Bastia","Angoul\xEAme","Garges-l\xE8s-Gonesse","Castres","Thionville","Wattrelos","Talence","Saint-Laurent-du-Maroni","Douai","Noisy-le-Sec","Tarbes","Arras","Al\xE8s","La Courneuve","Bourg-en-Bresse","Compi\xE8gne","Gap","Melun","Le Lamentin","Rez\xE9","Saint-Germain-en-Laye","Marcq-en-Bar\u0153ul","Gagny","Anglet","Draguignan","Chartres","Bron","Bagneux","Colomiers","Saint-Martin-d'H\xE8res","Pontault-Combault","Montlu\xE7on","Jou\xE9-l\xE8s-Tours","Saint-Joseph","Poissy","Savigny-sur-Orge","Cherbourg-Octeville","Mont\xE9limar","Villefranche-sur-Sa\xF4ne","Stains","Saint-Beno\xEEt","Bagnolet","Ch\xE2tillon","Le Port","Sainte-Genevi\xE8ve-des-Bois","\xC9chirolles","Roanne","Villepinte","Saint-Chamond","Conflans-Sainte-Honorine","Auxerre","Nevers","Neuilly-sur-Marne","La Ciotat","Tremblay-en-France","Thonon-les-Bains","Vitrolles","Haguenau","Six-Fours-les-Plages","Agen","Creil","Annemasse","Saint-Rapha\xEBl","Marignane","Romans-sur-Is\xE8re","Montigny-le-Bretonneux","Le Perreux-sur-Marne","Franconville","M\xE2con","Saint-Leu","Cambrai","Ch\xE2tenay-Malabry","Sainte-Marie","Villeneuve-Saint-Georges","Houilles","\xC9pinal","Lens","Li\xE9vin","Les Mureaux","Schiltigheim","La Possession","Meyzieu","Dreux","Nogent-sur-Marne","Plaisir","Mont-de-Marsan","Palaiseau","Ch\xE2tellerault","Goussainville","L'Ha\xFF-les-Roses","Viry-Ch\xE2tillon","Vigneux-sur-Seine","Chatou","Trappes","Clichy-sous-Bois","Rillieux-la-Pape","Villenave-'Ornon","Maubeuge","Charenton-le-Pont","Malakoff","Matoury","Dieppe","Athis-Mons","Savigny-le-Temple","P\xE9rigueux","Baie-Mahault","Vandoeuvre-l\xE8s-Nancy","Pontoise","Aix-les-Bains","Cachan","Vienne","Thiais","Orange","Saint-M\xE9dard-en-Jalles","Villemomble","Saint-Cloud","Saint-Laurent-du-Var","Yerres","Saint-\xC9tienne-du-Rouvray","Sotteville-l\xE8s-Rouen","Draveil","Le Chesnay","Bois-Colombes","Le Plessis-Robinson","La Garenne-Colombes","Lambersart","Soissons","Pierrefitte-sur-Seine","Carpentras","Villiers-sur-Marne","Vanves","Menton","Bergerac","Ermont","Bezons","Grigny","Guyancourt","Saumur","Herblay","Ris-Orangis","Villiers-le-Bel","Bourgoin-Jallieu","Vierzon","Le Gosier","D\xE9cines-Charpieu","H\xE9nin-Beaumont","Fresnes","Aurillac","Sannois","Vallauris","Illkirch-Graffenstaden","Alen\xE7on","\xC9lancourt","Tournefeuille","B\xE8gles","Gonesse","Oullins","Brunoy","Taverny","Armenti\xE8res","Montfermeil","Rambouillet","Villeparisis","Le Kremlin-Bic\xEAtre","Sucy-en-Brie","Kourou","Montb\xE9liard","Romainville","Cavaillon","Saint-Dizier","Br\xE9tigny-sur-Orge","Saint-S\xE9bastien-sur-Loire","Saintes","La Teste-de-Buch","Villeneuve-la-Garenne","B\xE9thune","Bussy-Saint-Georges","Vichy","La Garde","Agde","Laon","Sens","Lunel","Miramas","Biarritz","Le Grand-Quevilly","Orvault","Les Ulis","Champs-sur-Marne","Rochefort","Muret","Sainte-Anne","Eaubonne","\xC9tampes","Gradignan","Vernon","Petit-Bourg","Libourne","Abbeville","Rodez","Saint-Ouen-l'Aum\xF4ne","Torcy","Maisons-Laffitte","Montgeron","Villeneuve-sur-Lot","Cormeilles-en-Parisis","\xC9pernay","S\xE8vres","Dole","Le Robert","Le Bouscat","Blagnac","Frontignan","Cenon","Mandelieu-la-Napoule","Vertou","Les Lilas","Bruay-la-Buissi\xE8re","Les Pavillons-sous-Bois","Chaumont","Roissy-en-Brie","Le Moule","Le Petit-Quevilly","Manosque","Saint-Mand\xE9","Fontenay-aux-Roses","Orly","Le Creusot","Oyonnax","La Madeleine","Sainte-Suzanne","Millau","Combs-la-Ville","Fontaine","Deuil-la-Barre","Coudekerque-Branche","Auch","Lanester","Beaune","Montigny-l\xE8s-Metz","Hazebrouck","Longjumeau","Sainte-Foy-l\xE8s-Lyon","Forbach","Sarreguemines","Mons-en-Bar\u0153ul","La Valette-du-Var","H\xE9rouville-Saint-Clair","Morsang-sur-Orge","Grande-Synthe","La Celle-Saint-Cloud","Lisieux","Croix","Dammarie-les-Lys","V\xE9lizy-Villacoublay","Wasquehal","Saint-Gratien","Halluin","Neuilly-Plaisance","Montmorency","Dax","Lagny-sur-Marne","Le M\xE9e-sur-Seine","Saint-Genis-Laval","Fleury-les-Aubrais","Loos","Gif-sur-Yvette","Denain","Saint-Di\xE9-des-Vosges","Sainte-Rose","Saint-Michel-sur-Orge"].forEach((i,e)=>$.register(new Q(i,Im,e===0)))});var BT=b(GT=>{"use strict";Object.defineProperty(GT,"__esModule",{value:!0});wT();AT()});var Ra,hl,wm=n(()=>{Ft();Ra=class extends me{};t(Ra,"German");hl=Ra});var fS={};var UT=n(()=>{wm();er();tr();Object.entries({people:"German",nation:"Germany",colors:["#000","#FC0"]}).forEach(([i,e])=>he.register(new ge(hl,i,e)))});var dS={};var MT=n(()=>{wm();Et();gt();["Berlin","Hamburg","Munich","Cologne","Frankfurt","Stuttgart","D\xFCsseldorf","Dortmund","Essen","Leipzig","Bremen","Dresden","Hanover","Nuremberg","Duisburg","Bochum","Wuppertal","Bielefeld","Bonn","M\xFCnster","Karlsruhe","Mannheim","Augsburg","Wiesbaden","Gelsenkirchen","M\xF6nchengladbach","Braunschweig","Chemnitz","Kiel","Aachen","Halle","Magdeburg","Freiburg","Krefeld","L\xFCbeck","Oberhausen","Erfurt","Mainz","Rostock","Kassel","Hagen","Hamm","Saarbr\xFCcken","M\xFClheim an der Ruhr","Potsdam","Ludwigshafen am Rhein","Oldenburg","Leverkusen","Osnabr\xFCck","Solingen"].forEach((i,e)=>$.register(new Q(i,hl,e===0)))});var ET=b(DT=>{"use strict";Object.defineProperty(DT,"__esModule",{value:!0});UT();MT()});var xa,Am,Np=n(()=>{Ft();xa=class extends me{};t(xa,"Greek");Am=xa});var gS={};var FT=n(()=>{Np();er();tr();Object.entries({people:"Greek",nation:"Greece",colors:["#2175D8","#FFF"]}).forEach(([i,e])=>he.register(new ge(Am,i,e)))});var hS={};var kT=n(()=>{Np();Et();gt();["Athens","Thessaloniki","Patras","Piraeus","Larissa","Heraklion","Peristeri","Kallithea","Acharnes","Kalamaria","Nikaia","Glyfada","Volos","Ilio","Ilioupoli","Keratsini","Evosmos","Chalandri","Nea Smyrni","Marousi","Agios Dimitrios","Zografou","Egaleo","Nea Ionia","Ioannina","Palaio Faliro","Korydallos","Trikala","Vyronas","Agia Paraskevi","Galatsi","Agrinio","Chalcis","Petroupoli","Serres","Alexandroupoli","Xanthi","Katerini","Kalamata","Kavala","Chania","Lamia","Komotini","Irakleio","Rhodes","Kifissia","Stavroupoli","Chaidari","Drama","Veria","Alimos","Kozani","Polichni","Karditsa","Sykies","Ampelokipoi","Pylaia","Agioi Anargyroi","Argyroupoli","Ano Liosia","Nea Ionia","Rethymno","Ptolemaida","Tripoli","Cholargos","Vrilissia","Aspropyrgos","Corinth","Gerakas","Metamorfosi","Giannitsa","Voula","Kamatero","Mytilene","Neapoli","Eleftherio-Kordelio","Chios","Agia Varvara","Kaisariani","Nea Filadelfeia","Moschato","Perama","Salamina","Eleusis","Corfu","Pyrgos","Megara","Kilkis","Dafni","Thebes","Melissia","Argos","Arta","Artemida","Livadeia","Pefki","Oraiokastro","Aigio","Kos","Koropi","Preveza","Naousa","Orestiada","Peraia","Edessa","Florina","Panorama","Nea Erythraia1","Elliniko1","Amaliada","Pallini","Sparta","Agios Ioannis Rentis","Thermi","Vari","Nea Makri","Tavros","Alexandreia","Menemeni","Paiania","Kalyvia Thorikou","Nafplio","Drapetsona","Efkarpia","Papagou","Nafpaktos","Kastoria","Grevena","Pefka","Nea Alikarnassos","Missolonghi","Gazi","Ierapetra","Kalymnos","Rafina","Loutraki","Agios Nikolaos","Ermoupoli","Ialysos","Mandra","Tyrnavos","Glyka Nera","Ymittos","Neo Psychiko"].forEach((i,e)=>$.register(new Q(i,Am,e===0)))});var YT=b(ST=>{"use strict";Object.defineProperty(ST,"__esModule",{value:!0});FT();kT()});var va,Gm,Lp=n(()=>{Ft();va=class extends me{};t(va,"Indian");Gm=va});var OS={};var zT=n(()=>{Lp();er();tr();Object.entries({people:"Indian",nation:"India",colors:["#138808","#FF9933"]}).forEach(([i,e])=>he.register(new ge(Gm,i,e)))});var RS={};var NT=n(()=>{Lp();Et();gt();["Delhi","Mumbai","Bangalore","Hyderabad","Ahmedabad","Chennai","Kolkata","Surat","Pune","Jaipur","Lucknow","Kanpur","Nagpur","Indore","Thane","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara","Ghaziabad","Ludhiana","Agra","Nashik","Faridabad","Meerut","Rajkot","Kalyan-Dombivli","Vasai-Virar","Varanasi","Srinagar","Aurangabad","Dhanbad","Amritsar","Navi Mumbai","Allahabad","Howrah","Ranchi","Gwalior","Jabalpur","Coimbatore","Vijayawada","Jodhpur","Madurai","Raipur","Kota","Chandigarh","Guwahati","Solapur","Hubli\u2013Dharwad","Tiruchirappalli","Bareilly","Moradabad","Mysore","Tiruppur","Gurgaon","Aligarh","Jalandhar","Bhubaneswar","Salem","Mira-Bhayandar","Warangal","Jalgaon","Guntur","Bhiwandi","Saharanpur","Gorakhpur","Bikaner","Amravati","Noida","Jamshedpur","Bhilai","Cuttack","Firozabad","Kochi","Nellore","Bhavnagar","Dehradun","Durgapur","Asansol","Rourkela","Nanded","Kolhapur","Ajmer","Akola","Gulbarga","Jamnagar","Ujjain","Loni","Siliguri","Jhansi","Ulhasnagar","Jammu","Sangli-Miraj & Kupwad","Mangalore","Erode","Belgaum","Ambattur","Tirunelveli","Malegaon","Gaya","Thiruvananthapuram","Udaipur","Maheshtala","Davanagere","Kozhikode","Kurnool","Rajpur Sonarpur","Rajahmundry","Bokaro","South Dumdum","Bellary","Patiala","Gopalpur","Agartala","Bhagalpur","Muzaffarnagar","Bhatpara","Panihati","Latur","Dhule","Tirupati","Rohtak","Korba","Bhilwara","Berhampur","Muzaffarpur","Ahmednagar","Mathura","Kollam","Avadi","Kadapa","Kamarhati","Sambalpur","Bilaspur","Shahjahanpur","Satara","Bijapur","Kakinada","Rampur","Shimoga","Chandrapur","Junagadh","Thrissur","Alwar","Bardhaman","Kulti","Nizamabad","Parbhani","Tumkur","Khammam","Ozhukarai","Bihar Sharif","Panipat","Darbhanga","Bally","Aizawl","Dewas","Ichalkaranji","Karnal","Bathinda","Jalna","Eluru","Barasat","Kirari Suleman Nagar","Purnia","Satna","Mau","Sonipat","Farrukhabad","Sagar","Durg","Imphal","Ratlam","Hapur","Arrah","Anantapur","Karimnagar","Etawah","Ambarnath","North Dumdum","Bharatpur","Begusarai","New Delhi","Gandhidham","Baranagar","Tiruvottiyur","Pondicherry","Sikar","Thoothukudi","Rewa","Mirzapur","Raichur","Pali","Ramagundam","Haridwar","Vijayanagaram","Katihar","Nagercoil","Sri Ganganagar","Karawal Nagar","Mango","Thanjavur","Bulandshahr","Uluberia","Katni","Sambhal","Singrauli","Nadiad","Secunderabad","Naihati","Yamunanagar","Bidhannagar","Pallavaram","Bidar","Munger","Panchkula","Burhanpur","Raurkela Industrial Township","Kharagpur","Dindigul","Gandhinagar","Hospet","Nangloi Jat","Malda","Ongole","Deoghar","Chapra","Haldia","Khandwa","Nandyal","Morena","Amroha","Anand","Bhind","Bhalswa Jahangir Pur","Madhyamgram","Bhiwani","Berhampore","Ambala","Morbi","Fatehpur","Raebareli","Mahaboobnagar","Chittoor","Bhusawal","Orai","Bahraich","Vellore","Mehsana","Raiganj","Sirsa","Danapur","Serampore","Sultan Pur Majra","Guna","Jaunpur","Panvel","Shivpuri","Surendranagar Dudhrej","Unnao","Chinsurah","Alappuzha","Kottayam","Machilipatnam","Shimla","Adoni","Udupi","Tenali","Proddatur","Saharsa","Hindupur","Sasaram","Hajipur","Bhimavaram","Kumbakonam","Dehri","Madanapalle","Siwan","Bettiah","Guntakal","Srikakulam","Motihari","Dharmavaram","Gudivada","Phagwara","Narasaraopet","Suryapet","Miryalaguda","Tadipatri","Karaikudi","Kishanganj","Jamalpur","Ballia","Kavali","Tadepalligudem","Amaravati","Buxar","Jehanabad","Aurangabad","Gangtok"].forEach((i,e)=>$.register(new Q(i,Gm,e===0)))});var WT=b(LT=>{"use strict";Object.defineProperty(LT,"__esModule",{value:!0});zT();NT()});var ba,Bm,Wp=n(()=>{Ft();ba=class extends me{};t(ba,"Mongol");Bm=ba});var xS={};var jT=n(()=>{Wp();er();tr();Object.entries({people:"Mongol",nation:"Mongolia",colors:["#DA2032","#0066B3"]}).forEach(([i,e])=>he.register(new ge(Bm,i,e)))});var vS={};var HT=n(()=>{Wp();Et();gt();["Ulaanbaatar","Erdenet","Darkhan","Choibalsan","M\xF6r\xF6n","Nalaikh","Bayankhongor","\xD6lgii","Khovd","Arvaikheer","Ulaangom","Baganuur","Sainshand","Tsetserleg","S\xFCkhbaatar","\xD6nd\xF6rkhaan","Dalanzadgad","Z\xFC\xFCnkharaa","Uliastai","Altai","Baruun-Urt","Mandalgovi","Zuunmod","Zamyn-\xDC\xFCd","Bulgan","Kharkhorin","Choir","Bor-\xD6nd\xF6r","Sharyngo"].forEach((i,e)=>$.register(new Q(i,Bm,e===0)))});var KT=b(_T=>{"use strict";Object.defineProperty(_T,"__esModule",{value:!0});jT();HT()});var Ca,Um,jp=n(()=>{Ft();Ca=class extends me{};t(Ca,"Roman");Um=Ca});var bS={};var qT=n(()=>{jp();er();tr();Object.entries({people:"Roman",nation:"Rome",colors:["#A20101","#D1B24F"]}).forEach(([i,e])=>he.register(new ge(Um,i,e)))});var CS={};var VT=n(()=>{jp();Et();gt();["Roma","Ariminum","Belum","Placentia","Tarraco","Italica","Mod","Salernum","Bononia","Forum Livii","Regium Lepidi","Aquileia","Ascrivium","Valentia Edetanorum","Scalabis","Villa Euracini","Palma","Colonia Narbo Martius","Massa","Pistoria","Segovia","Gerunda","Pompaelo","Naissus","Brigantium","Florentia","Vesontio","Lutetia Parisiorum","Atuatuca Tungrorum","Iulia Romula Hispalis","Augusta Raurica","Noviodunum","Lugdunum","Siscia","Marsonia","Augusta Treverorum","Castra Legionis","Augusta Taurinorum","Augusta Praetoria Salassorum","Emerita Augusta","Norba Caesarina","Lucus Augusta","Caesarea","Bracara Augusta","Novaesium","Castra Vetera","Pons Drusi","Ovilava","Iuvavum","Augusta Vindelicorum","Turicum","Asturica Augusta","Borbetomagus","Caesaraugusta","Sirmium","Sorviodurum","Mogontiacum","Argentoratum","Bonna","Noviomagus","Castellum apud Confluentes","Divodurum","Caesaromagus","Ambianum","Faventia Paterna Barcino","Abila","Lousonna","Ulpia Noviomagus Batavorum","Rigomagus","Aquae Mattiacorum","Mursa","Emona","Vindonissa","Aventicum","Praetorium Agrippinae","Lugdunum Batavorum","Aequum","Londinium","Albanianis","Lauri","Durovernum Cantiacorum","Regulbium","Rutupiae","Viminacium","Camulodunum","Traiectum","Matilo","Forum Hadriani","Nigrum Pullum","Lindum Colonia","Ratae Corieltauvorum","Durocobrivis","Colonia Agrippina","Durocornovium","Verulamium","Letocetum","Dubris","Danum","Mediolanum","Isca Dumnoniorum","Blestium","Viroconium Cornoviorum","Aquae Sulis","Durnovaria","Lindinis","Ad Flexum","Clausentum","Venta Belgarum","Calleva Atrebatum","Duroliponte","Concangis","Condate","Corinium Dobunnorum","Eboracum","Luguvalium","Arae Flaviae","Isca Augusta","Lagentium","Lopodunum","Moridunum","Venta Silurum","Deva Victrix","Mamucium","Olicana","Vinovia","Bonames","Coria","Gerulata","Vindobona","Biriciana","Cannstatt Castrum","Colonia Nervia Glevensium","Sumelocenna","Lopodunum","Traiectum ad Nicrem","Castra Batavar","Nida","Lactodurum","Bovium","Burgodunum","Lentia","Aquae Granni","Complutum","Aeminium","Traiectum ad Mosam","Coriovallum","Portus Lemanis","Andautonia","Salona","Cibalae","Aquae Helveticae","Aquincum","Apulum","Pons Aelius","Durovigutum","Aelia Capitolina","Ala","Castra Regina","Theranda","Pomaria","Partiscum","Gesoriacum","Aurelia Aquensis","Urbs Aurelianorum","Venetiae","Ragusium"].forEach((i,e)=>$.register(new Q(i,Um,e===0)))});var $T=b(JT=>{"use strict";Object.defineProperty(JT,"__esModule",{value:!0});qT();VT()});var Ta,Ol,Mm=n(()=>{Ft();Ta=class extends me{};t(Ta,"Russian");Ol=Ta});var TS={};var ZT=n(()=>{Mm();er();tr();Object.entries({people:"Russian",nation:"Russia",colors:["#0032A0","#DA291C"]}).forEach(([i,e])=>he.register(new ge(Ol,i,e)))});var PS={};var QT=n(()=>{Mm();Et();gt();["Moscow","Saint Petersburg","Novosibirsk","Yekaterinburg","Nizhny Novgorod","Kazan","Chelyabinsk","Omsk","Samara","Ufa","Rostov-on-Don","Krasnoyarsk","Voronezh","Perm","Volgograd","Krasnodar","Saratov","Tyumen","Makhachkala","Tolyatti","Barnaul","Ulyanovsk","Izhevsk","Vladivostok","Irkutsk","Khabarovsk","Yaroslavl","Tomsk","Orenburg","Kemerovo","Novokuznetsk","Tula","Ryazan","Kirov","Astrakhan","Naberezhnye Chelny","Sochi","Penza","Lipetsk","Cheboksary","Balashikha","Kaliningrad","Kursk","Stavropol","Ulan-Ude","Bryansk","Tver","Magnitogorsk","Ivanovo","Belgorod","Surgut","Vladimir","Arkhangelsk","Nizhny Tagil","Kaluga","Chita","Saransk","Yakutsk","Smolensk","Podolsk","Volzhsky","Vladikavkaz","Vologda","Cherepovets","Kurgan","Oryol","Grozny","Murmansk","Tambov","Petrozavodsk","Sterlitamak","Kostroma","Nizhnevartovsk","Novorossiysk","Yoshkar-Ola","Taganrog","Komsomolsk-on-Amur","Khimki","Syktyvkar","Nalchik","Nizhnekamsk","Shakhty","Dzerzhinsk","Bratsk","Orsk","Angarsk","Engels","Blagoveshchensk","Stary Oskol","Veliky Novgorod","Korolyov","Pskov","Mytishchi","Biysk","Lyubertsy","Prokopyevsk","Yuzhno-Sakhalinsk","Balakovo","Armavir","Rybinsk","Severodvinsk","Abakan","Petropavlovsk-Kamchatsky","Norilsk","Syzran","Volgodonsk","Ussuriysk","Kamensk-Uralsky","Novocherkassk","Zlatoust","Elektrostal","Almetyevsk","Krasnogorsk","Salavat","Miass","Nakhodka","Kopeysk","Pyatigorsk","Rubtsovsk","Berezniki","Kolomna","Maykop","Odintsovo","Khasavyurt","Kovrov","Kislovodsk","Neftekamsk","Nefteyugansk","Novocheboksarsk","Serpukhov","Shchyolkovo","Novomoskovsk","Bataysk","Pervouralsk","Domodedovo","Derbent","Cherkessk","Orekhovo-Zuyevo","Nevinnomyssk","Dimitrovgrad","Nazran","Kyzyl","Oktyabrsky","Obninsk","Kaspiysk","Novy Urengoy","Ramenskoye","Kamyshin","Murom","Zhukovsky"].forEach((i,e)=>$.register(new Q(i,Ol,e===0)))});var eP=b(XT=>{"use strict";Object.defineProperty(XT,"__esModule",{value:!0});ZT();QT()});var Pa,Dm,Hp=n(()=>{Ft();Pa=class extends me{};t(Pa,"Zulu");Dm=Pa});var IS={};var tP=n(()=>{Hp();er();tr();Object.entries({people:"Zulu",nation:"Zulus",colors:["#FFFD1E","#000"]}).forEach(([i,e])=>he.register(new ge(Dm,i,e)))});var wS={};var rP=n(()=>{Hp();Et();gt();["uMgungundlovu","Nobamba","Bulawayo","KwaDukuza","Nongoma","oNdini","Nodwengu","Ndondakusuka","Babanango","Khangela","Kwahlomendlini","Hlobane","eThekwini","Mlambongwenya","Eziqwaqweni","Isiphezi","Masotsheni","Mtunzini","Nyakamubi","Hlatikulu","Mthonjaneni","Empangeni","Pongola","Tungela","Kwamashu","Ingwavuma","Hluhluwe","Mtubatuba","Mhlahlandlela","Mthatha","Maseru","Lobamba","Qunu"].forEach((i,e)=>$.register(new Q(i,Dm,e===0)))});var oP=b(iP=>{"use strict";Object.defineProperty(iP,"__esModule",{value:!0});tP();rP()});var AS={};var nP=n(()=>{B();Gh();O.register(Wv)});var sP=b(aP=>{"use strict";Object.defineProperty(aP,"__esModule",{value:!0});nP()});var GS={};var lP=n(()=>{B();Bh();O.register(jv)});var pP=b(mP=>{"use strict";Object.defineProperty(mP,"__esModule",{value:!0});lP()});var BS={};var uP=n(()=>{B();Uh();O.register(Hv)});var yP=b(cP=>{"use strict";Object.defineProperty(cP,"__esModule",{value:!0});uP()});var US={};var fP=n(()=>{B();Mh();O.register(_v)});var gP=b(dP=>{"use strict";Object.defineProperty(dP,"__esModule",{value:!0});fP()});var MS={};var hP=n(()=>{B();Dh();O.register(Kv)});var RP=b(OP=>{"use strict";Object.defineProperty(OP,"__esModule",{value:!0});hP()});var DS={};var xP=n(()=>{B();Eh();O.register(qv)});var bP=b(vP=>{"use strict";Object.defineProperty(vP,"__esModule",{value:!0});xP()});var ES={};var CP=n(()=>{B();Fh();O.register(Vv)});var PP=b(TP=>{"use strict";Object.defineProperty(TP,"__esModule",{value:!0});CP()});var FS={};var IP=n(()=>{B();kh();O.register(Jv)});var AP=b(wP=>{"use strict";Object.defineProperty(wP,"__esModule",{value:!0});IP()});var kS={};var GP=n(()=>{B();Sh();O.register($v)});var UP=b(BP=>{"use strict";Object.defineProperty(BP,"__esModule",{value:!0});GP()});var SS={};var MP=n(()=>{B();Yh();O.register(Zv)});var EP=b(DP=>{"use strict";Object.defineProperty(DP,"__esModule",{value:!0});MP()});var YS={};var FP=n(()=>{B();zh();O.register(Qv)});var SP=b(kP=>{"use strict";Object.defineProperty(kP,"__esModule",{value:!0});FP()});var zS={};var YP=n(()=>{B();Nh();O.register(Xv)});var NP=b(zP=>{"use strict";Object.defineProperty(zP,"__esModule",{value:!0});YP()});var NS={};var LP=n(()=>{B();Lh();O.register(eb)});var jP=b(WP=>{"use strict";Object.defineProperty(WP,"__esModule",{value:!0});LP()});var LS={};var HP=n(()=>{B();Wh();O.register(tb)});var KP=b(_P=>{"use strict";Object.defineProperty(_P,"__esModule",{value:!0});HP()});var WS={};var qP=n(()=>{B();jh();O.register(rb)});var JP=b(VP=>{"use strict";Object.defineProperty(VP,"__esModule",{value:!0});qP()});var jS={};var $P=n(()=>{B();Hh();O.register(ib)});var QP=b(ZP=>{"use strict";Object.defineProperty(ZP,"__esModule",{value:!0});$P()});var HS={};var XP=n(()=>{B();_h();O.register(ob)});var tI=b(eI=>{"use strict";Object.defineProperty(eI,"__esModule",{value:!0});XP()});var _S={};var rI=n(()=>{B();Kh();O.register(nb)});var oI=b(iI=>{"use strict";Object.defineProperty(iI,"__esModule",{value:!0});rI()});var KS={};var nI=n(()=>{B();qh();O.register(ab)});var sI=b(aI=>{"use strict";Object.defineProperty(aI,"__esModule",{value:!0});nI()});var qS={};var lI=n(()=>{B();Vh();O.register(sb)});var pI=b(mI=>{"use strict";Object.defineProperty(mI,"__esModule",{value:!0});lI()});var VS={};var uI=n(()=>{B();Jh();O.register(lb)});var yI=b(cI=>{"use strict";Object.defineProperty(cI,"__esModule",{value:!0});uI()});var JS={};var fI=n(()=>{B();$h();O.register(mb)});var gI=b(dI=>{"use strict";Object.defineProperty(dI,"__esModule",{value:!0});fI()});var $S={};var hI=n(()=>{B();Zh();O.register(pb)});var RI=b(OI=>{"use strict";Object.defineProperty(OI,"__esModule",{value:!0});hI()});var ZS={};var xI=n(()=>{B();Qh();O.register(ub)});var bI=b(vI=>{"use strict";Object.defineProperty(vI,"__esModule",{value:!0});xI()});var QS={};var CI=n(()=>{B();Xh();O.register(cb)});var PI=b(TI=>{"use strict";Object.defineProperty(TI,"__esModule",{value:!0});CI()});var XS={};var II=n(()=>{B();eO();O.register(yb)});var AI=b(wI=>{"use strict";Object.defineProperty(wI,"__esModule",{value:!0});II()});var eY={};var GI=n(()=>{B();tO();O.register(fb)});var UI=b(BI=>{"use strict";Object.defineProperty(BI,"__esModule",{value:!0});GI()});var tY={};var MI=n(()=>{B();rO();O.register(db)});var EI=b(DI=>{"use strict";Object.defineProperty(DI,"__esModule",{value:!0});MI()});var rY={};var FI=n(()=>{B();iO();O.register(gb)});var SI=b(kI=>{"use strict";Object.defineProperty(kI,"__esModule",{value:!0});FI()});var iY={};var YI=n(()=>{B();oO();O.register(hb)});var NI=b(zI=>{"use strict";Object.defineProperty(zI,"__esModule",{value:!0});YI()});var oY={};var LI=n(()=>{B();nO();O.register(Ob)});var jI=b(WI=>{"use strict";Object.defineProperty(WI,"__esModule",{value:!0});LI()});var nY={};var HI=n(()=>{B();aO();O.register(Rb)});var KI=b(_I=>{"use strict";Object.defineProperty(_I,"__esModule",{value:!0});HI()});var aY={};var qI=n(()=>{B();sO();O.register(xb)});var JI=b(VI=>{"use strict";Object.defineProperty(VI,"__esModule",{value:!0});qI()});var sY={};var $I=n(()=>{B();lO();O.register(vb)});var QI=b(ZI=>{"use strict";Object.defineProperty(ZI,"__esModule",{value:!0});$I()});var lY={};var XI=n(()=>{B();mO();O.register(bb)});var tw=b(ew=>{"use strict";Object.defineProperty(ew,"__esModule",{value:!0});XI()});var mY={};var rw=n(()=>{B();pO();O.register(Cb)});var ow=b(iw=>{"use strict";Object.defineProperty(iw,"__esModule",{value:!0});rw()});var pY={};var nw=n(()=>{B();uO();O.register(Tb)});var sw=b(aw=>{"use strict";Object.defineProperty(aw,"__esModule",{value:!0});nw()});var uY={};var lw=n(()=>{B();cO();O.register(Pb)});var pw=b(mw=>{"use strict";Object.defineProperty(mw,"__esModule",{value:!0});lw()});var cY={};var uw=n(()=>{B();yO();O.register(Ib)});var yw=b(cw=>{"use strict";Object.defineProperty(cw,"__esModule",{value:!0});uw()});var yY={};var fw=n(()=>{B();fO();O.register(wb)});var gw=b(dw=>{"use strict";Object.defineProperty(dw,"__esModule",{value:!0});fw()});var fY={};var hw=n(()=>{B();dO();O.register(Ab)});var Rw=b(Ow=>{"use strict";Object.defineProperty(Ow,"__esModule",{value:!0});hw()});var dY={};var xw=n(()=>{B();gO();O.register(Gb)});var bw=b(vw=>{"use strict";Object.defineProperty(vw,"__esModule",{value:!0});xw()});var gY={};var Cw=n(()=>{B();hO();O.register(Bb)});var Pw=b(Tw=>{"use strict";Object.defineProperty(Tw,"__esModule",{value:!0});Cw()});var hY={};var Iw=n(()=>{B();OO();O.register(Ub)});var Aw=b(ww=>{"use strict";Object.defineProperty(ww,"__esModule",{value:!0});Iw()});var OY={};var Gw=n(()=>{B();RO();O.register(Mb)});var Uw=b(Bw=>{"use strict";Object.defineProperty(Bw,"__esModule",{value:!0});Gw()});var RY={};var Mw=n(()=>{B();xO();O.register(Db)});var Ew=b(Dw=>{"use strict";Object.defineProperty(Dw,"__esModule",{value:!0});Mw()});var xY={};var Fw=n(()=>{B();vO();O.register(Eb)});var Sw=b(kw=>{"use strict";Object.defineProperty(kw,"__esModule",{value:!0});Fw()});var vY={};var Yw=n(()=>{B();bO();O.register(Fb)});var Nw=b(zw=>{"use strict";Object.defineProperty(zw,"__esModule",{value:!0});Yw()});var bY={};var Lw=n(()=>{B();CO();O.register(kb)});var jw=b(Ww=>{"use strict";Object.defineProperty(Ww,"__esModule",{value:!0});Lw()});var CY={};var Hw=n(()=>{B();TO();O.register(Sb)});var Kw=b(_w=>{"use strict";Object.defineProperty(_w,"__esModule",{value:!0});Hw()});var TY={};var qw=n(()=>{B();PO();O.register(Yb)});var Jw=b(Vw=>{"use strict";Object.defineProperty(Vw,"__esModule",{value:!0});qw()});var PY={};var $w=n(()=>{B();IO();O.register(zb)});var Qw=b(Zw=>{"use strict";Object.defineProperty(Zw,"__esModule",{value:!0});$w()});var IY={};var Xw=n(()=>{B();wO();O.register(Nb)});var tA=b(eA=>{"use strict";Object.defineProperty(eA,"__esModule",{value:!0});Xw()});var wY={};var rA=n(()=>{B();AO();O.register(Lb)});var oA=b(iA=>{"use strict";Object.defineProperty(iA,"__esModule",{value:!0});rA()});var AY={};var nA=n(()=>{B();GO();O.register(Wb)});var sA=b(aA=>{"use strict";Object.defineProperty(aA,"__esModule",{value:!0});nA()});var GY={};var lA=n(()=>{B();BO();O.register(jb)});var pA=b(mA=>{"use strict";Object.defineProperty(mA,"__esModule",{value:!0});lA()});var BY={};var uA=n(()=>{B();UO();O.register(Hb)});var yA=b(cA=>{"use strict";Object.defineProperty(cA,"__esModule",{value:!0});uA()});var UY={};var fA=n(()=>{B();MO();O.register(_b)});var gA=b(dA=>{"use strict";Object.defineProperty(dA,"__esModule",{value:!0});fA()});var MY={};var hA=n(()=>{B();DO();O.register(Kb)});var RA=b(OA=>{"use strict";Object.defineProperty(OA,"__esModule",{value:!0});hA()});var DY={};var xA=n(()=>{B();EO();O.register(qb)});var bA=b(vA=>{"use strict";Object.defineProperty(vA,"__esModule",{value:!0});xA()});var EY={};var CA=n(()=>{B();FO();O.register(Vb)});var PA=b(TA=>{"use strict";Object.defineProperty(TA,"__esModule",{value:!0});CA()});var FY={};var IA=n(()=>{B();YO();O.register(Zb)});var AA=b(wA=>{"use strict";Object.defineProperty(wA,"__esModule",{value:!0});IA()});var kY={};var GA=n(()=>{B();kO();O.register(Jb)});var UA=b(BA=>{"use strict";Object.defineProperty(BA,"__esModule",{value:!0});GA()});var SY={};var MA=n(()=>{B();SO();O.register($b)});var EA=b(DA=>{"use strict";Object.defineProperty(DA,"__esModule",{value:!0});MA()});var YY={};var FA=n(()=>{B();zO();O.register(Qb)});var SA=b(kA=>{"use strict";Object.defineProperty(kA,"__esModule",{value:!0});FA()});var zY={};var YA=n(()=>{B();NO();O.register(Xb)});var NA=b(zA=>{"use strict";Object.defineProperty(zA,"__esModule",{value:!0});YA()});var NY={};var LA=n(()=>{B();LO();O.register(eC)});var jA=b(WA=>{"use strict";Object.defineProperty(WA,"__esModule",{value:!0});LA()});var LY,HA,_A=n(()=>{np();T();K();LY=t((i=P)=>[new Jn(new m((e,r)=>{i.emit("city:building-complete",e,r)}))],"getRules"),HA=LY});var WY,KA,qA=n(()=>{rt();rr();$n();_e();K();$s();T();WY=t((i=j,e=z,r=ye,o=Qt,a=P)=>[new cr(new m(s=>o.getByCity(s).progress().set(0))),new cr(new m(s=>r.getByCity(s).shrink())),new cr(new m((s,p,u)=>{a.emit("city:captured",s,p,u)})),new cr(new m(s=>e.getByCity(s).forEach(p=>p.destroy())))],"getRules"),KA=WY});var HO,Af,ei,zs=n(()=>{Ve();HO=t(i=>i instanceof L?-i.value():-i,"negate"),Af=class extends L{add(e,r=""){super.add(HO(e),r)}set(e,r=""){super.set(HO(e),r)}subtract(e,r=""){super.subtract(HO(e),r)}};t(Af,"NegativeYield");ei=t(i=>{["add","set","subtract"].forEach(e=>Object.defineProperty(i.prototype,e,Object.getOwnPropertyDescriptor(Af.prototype,e)||Object.create(null)))},"makeNegative")});var Em,VA,_O=n(()=>{ll();zs();Em=class extends Ko{};t(Em,"PopulationSupportFood");ei(Em);VA=Em});var Ns,JA,KO=n(()=>{ll();zs();Ns=class extends Ko{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ns,"UnitSupportFood");ei(Ns);JA=Ns});var Ls,qO,VO=n(()=>{rm();zs();Ls=class extends ra{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ls,"UnitSupportProduction");ei(Ls);qO=Ls});var jY,$A,ZA=n(()=>{Dn();dn();rr();on();_e();El();w();T();_O();gn();KO();VO();jY=t((i=ye,e=pt,r=z)=>[new et(new m(o=>new VA(i.getByCity(o).size()*2))),...[[We,1,Ui,Ht],[We,2,bt,nt,at,ft]].map(([o,a,...s])=>new et(new l(p=>r.getByCity(p).some(u=>u instanceof o)),new l(p=>e.getByPlayer(p.player()).is(...s)),new m(p=>r.getByCity(p).filter(u=>u instanceof o).map(u=>new JA(a,u))))),new et(new l(o=>e.getByPlayer(o.player()).is(Ui,Ht)),new l(o=>{let a=i.getByCity(o);return r.getByCity(o).filter(s=>[St,Y,Le,dr].some(p=>s instanceof p)).length>a.size()}),new m(o=>{let a=i.getByCity(o);return r.getByCity(o).filter(s=>[St,Y,Le,dr].some(p=>s instanceof p)).slice(a.size()).map(s=>new qO(1,s))})),new et(new l(o=>e.getByPlayer(o.player()).is(bt,nt,at,ft)),new m(o=>r.getByCity(o).filter(a=>[St,Y,Le,dr].some(s=>a instanceof s)).map(a=>new qO(1,a))))],"getRules"),$A=jY});var HY,QA,XA=n(()=>{Nl();$n();rr();rt();K();En();$i();I();gi();ec();Tc();Uu();T();im();w();HY=t((i=Ne,e=Qt,r=ye,o=j,a=ae,s=d,p=bn,u=P)=>[...[we,ke].map(y=>new jo(new l(c=>i.getByTile(c.tile()).every(f=>!(f instanceof y))),new m(c=>i.register(new y(c.tile()))))),new jo(new m(y=>e.register(new Wl(y,p,s)))),new jo(new m(y=>r.register(new ol(y,s)))),new jo(new m(y=>o.register(y))),new jo(new m(y=>{u.emit("city:created",y)})),new jo(new m(y=>hs(y,a,r)))],"getRules"),QA=HY});var _Y,eG,tG=n(()=>{rt();K();gi();_e();Zs();T();En();_Y=t((i=Ne,e=j,r=P,o=z)=>[new yr(new m(a=>i.getByTile(a.tile()).filter(s=>s instanceof we).forEach(s=>i.unregister(s)))),new yr(new m(a=>e.unregister(a))),new yr(new m((a,s)=>{r.emit("city:destroyed",a,s)})),new yr(new m(a=>o.getByCity(a).forEach(s=>s.destroy())))],"getRules"),eG=_Y});var Gf,Bf,JO=n(()=>{G();Gf=class extends g{};t(Gf,"FoodExhausted");Bf=Gf});var KY,rG,iG=n(()=>{T();JO();KY=t(()=>[new Bf(new m(i=>i.shrink()))],"getRules"),rG=KY});var qY,oG,nG=n(()=>{I();w();T();Dg();JO();qY=t((i=d)=>[new lp(new l(e=>e.progress().value()>=e.cost().value()),new m(e=>e.grow())),new lp(new l(e=>e.progress().value()<0),new m(e=>{i.process(Bf,e)}))],"getRules"),oG=qY});var VY,aG,sG=n(()=>{rr();$i();w();T();vc();im();VY=t((i=ye,e=ae)=>[new In(new m(r=>r.empty())),new In(new m(r=>r.cost().set((r.size()+1)*10,"city-grow"))),new In(new l(r=>r.city().tilesWorked().length<r.size()+1),new m(r=>hs(r.city(),e,i))),new In(new l(r=>r.city().tilesWorked().length>r.size()+1),new m(r=>r.city().tilesWorked().entries().slice(r.size()+1).forEach(o=>r.city().tilesWorked().unregister(o))))],"getRules"),aG=VY});var JY,lG,mG=n(()=>{Ug();T();JY=t(()=>[new hc(new m(i=>10*(i.size()+1)))],"getRules"),lG=JY});var hn,Uf=n(()=>{oa();zs();hn=class extends ia{};t(hn,"Corruption");ei(hn)});var Fo,pG,Mf=n(()=>{Ve();Fo=class extends L{};t(Fo,"Happiness");pG=Fo});var Wi,uG,_p=n(()=>{Ve();Wi=class extends L{};t(Wi,"Luxuries");uG=Wi});var Kt,Df=n(()=>{Ve();Kt=class extends L{};t(Kt,"Research")});var Ue,Ws,Rl=n(()=>{Ve();Ue=class extends L{};t(Ue,"Unhappiness");Ws=Ue});var js=n(()=>{na();Uf();Oc();jl();Mf();_p();_O();Df();oa();Rl();KO();VO()});var Ef,Yn,Fm=n(()=>{G();Ef=class extends g{};t(Ef,"CivilDisorder");Yn=Ef});var Ff,ko,km=n(()=>{G();Ff=class extends g{};t(Ff,"ProcessYield");ko=Ff});var kf,xl,Sf=n(()=>{G();kf=class extends g{};t(kf,"Unsupported");xl=kf});var $Y,cG,yG=n(()=>{$n();rr();na();js();I();_e();Fm();w();T();km();Sf();$Y=t((i=Qt,e=ye,r=z,o=d)=>[new ko(new l(a=>a instanceof J),new m((a,s,p)=>{let u=e.getByCity(s),y=new Pn(a);p.forEach(c=>{if(!(c instanceof Ns)||y.value()>=0)return;let f=c.unit();f!==null&&(o.process(xl,s,f,c),y.subtract(c))}),u.add(y),u.check()})),new ko(new l(a=>a instanceof H),new m((a,s,p)=>{let u=i.getByCity(s),y=a.clone();p.filter(f=>f instanceof Ls).sort((f,h)=>(f.unit()?.tile().distanceFrom(s.tile())??0)-(h.unit()?.tile().distanceFrom(s.tile())??0)).forEach(f=>{if(y.value()>=0)return;let h=f.unit();h!==null&&(o.process(xl,s,h,f),y.subtract(f))});let c=s.yields();o.get(Yn).some(f=>f.validate(s,c))||u.add(y),u.check()}))],"getRules"),cG=$Y});var ZY,fG,dG=n(()=>{rr();$i();w();T();Eg();im();ZY=t((i=ye,e=ae)=>[new il(new l(r=>r.size()>0),new m(r=>r.cost().set((r.size()+1)*10,"city-shrink"))),new il(new l(r=>r.size()>0),new l(r=>r.city().tilesWorked().length>r.size()+1),new m(r=>r.city().tilesWorked().entries().slice(r.size()+1).forEach(o=>r.city().tilesWorked().unregister(o)))),new il(new l(r=>r.size()>0),new l(r=>r.city().tilesWorked().length<r.size()+1),new m(r=>hs(r.city(),e,i))),new il(new l(r=>r.size()<=0),new m(r=>r.city().destroy()))],"getRules"),fG=ZY});var Yf,Re,ur=n(()=>{Ge();Ce();Yf=class extends F{constructor(){super(k)}getByCity(e){return this.filter(r=>r.city()===e)}};t(Yf,"CityImprovementRegistry");Re=new Yf});var QY,gG,hG=n(()=>{dn();ur();js();on();T();qn();WO();Za();zl();Zi();QY=t((i=Re,e=pt)=>[new Ho(new Kn,new m((r,o)=>{let a=e.getByPlayer(r.player()),[s]=i.filter(c=>c instanceof bC&&r.player()===c.city().player()).map(c=>c.city()),p=Ke(o,re),u=a.is(bt)?10:a.is(nt)?0:s?s.tile().distanceFrom(r.tile()):32,[y]=[[Ui,8],[bt,20],[nt,0],[Ht,12],[at,16],[ft,24]].filter(([c])=>a.is(c)).map(([,c])=>c);return new hn(y?Math.min(Math.floor(p*u*3/(10*y)),p):0,u.toFixed(2))})),new Ho(new Fr(0),new m(r=>r.tilesWorked().entries().flatMap(o=>o.yields(r.player()).flatMap(a=>new a.constructor(a.value(),o.id()+": "+a.values().map(([,s])=>s).join("-"))))))],"getRules"),gG=QY});var XY,OG,RG=n(()=>{wg();$n();rt();Zn();w();T();XY=t((i=Qt,e=j)=>[new ht(new l(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).some(o=>!o.building())),new m(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).filter(o=>!o.building()).map(o=>new Cn(r,o)))),new ht(new l(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).some(o=>!!o.building())),new m(r=>e.getByPlayer(r).map(o=>i.getByCity(o)).filter(o=>!!o.building()).map(o=>new as(r,o))))],"getRules"),OG=XY});var ez,xG,vG=n(()=>{rr();rt();K();fm();w();Ip();T();ez=t((i=j,e=ye,r=P)=>[new qo(new l((o,a,s)=>s instanceof vs&&s.to()===o.tile()&&i.getByTile(s.to())!==null),new m(o=>{let a=i.getByTile(o.tile());e.getByCity(a).shrink()})),new qo(new m((o,a,s)=>r.emit("unit:defeated",o,a,s)))],"getRules"),xG=ez});var tz,bG,CG=n(()=>{T();Sf();tz=t(()=>[new xl(new m((i,e)=>e.destroy()))],"getRules"),bG=tz});var rz={};var TG=n(()=>{_A();qA();ZA();XA();tG();iG();nG();sG();mG();yG();dG();hG();I();RG();vG();CG();d.register(...HA(),...KA(),...$A(),...QA(),...eG(),...rG(),...oG(),...aG(),...lG(),...cG(),...fG(),...gG(),...OG(),...xG(),...bG())});var IG=b(PG=>{"use strict";Object.defineProperty(PG,"__esModule",{value:!0});TG()});var vl,wG=n(()=>{Rl();zs();vl=class extends Ws{#e;constructor(e,r){super(e,r.id()),this.#e=r}cityImprovement(){return this.#e}};t(vl,"CityImprovementContent");ei(vl)});var Sm,AG=n(()=>{Mf();Sm=class extends pG{};t(Sm,"LuxuryHappiness")});var bl,GG=n(()=>{Rl();zs();bl=class extends Ws{#e;constructor(e,r){super(e,r.id()),this.#e=r}unit(){return this.#e}};t(bl,"MartialLaw");ei(bl)});var Ia,BG=n(()=>{Rl();Ia=class extends Ws{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ia,"MilitaryUnhappiness")});var Ym,UG=n(()=>{Rl();Ym=class extends Ws{};t(Ym,"PopulationUnhappiness")});var zf=n(()=>{Df()});var zm=n(()=>{wG();js();Mf();_p();AG();GG();BG();UG();na();zf();Rl()});var Nf,Lf,$O=n(()=>{G();Nf=class extends g{};t(Nf,"CelebrateLeader");Lf=Nf});var iz,MG,DG=n(()=>{rr();zm();$O();w();Zi();iz=t((i=ye)=>[new Lf(new l(e=>i.getByCity(e).size()>2),new l((e,r=e.yields())=>{let[o,a]=aa(r,Fo,Ue);return a===0&&Math.floor(o)>=i.getByCity(e).size()/2}))],"getRules"),MG=iz});var oz,EG,FG=n(()=>{Dn();rr();dn();zm();on();_e();zl();w();T();oz=t((i=ye,e=pt,r=z)=>[new Ho(new m(o=>new Ym(Math.max(i.getByCity(o).size()-5,0)))),...[[ft,1],[nt,2]].map(([o,a])=>new Ho(new l(s=>{try{return e.getByPlayer(s.player()).is(o)}catch{return!1}}),new l(s=>r.getByCity(s).filter(p=>[St,Y,Le].some(u=>p instanceof u)&&p.tile()!==s.tile()).length>0),new m(s=>r.getByCity(s).filter(p=>[St,Y,Le].some(u=>p instanceof u)&&p.tile()!==s.tile()).map(p=>new Ia(a,p)))))],"getRules"),EG=oz});var nz,kG,SG=n(()=>{zm();Fm();w();Zi();nz=t(()=>[new Yn(new l((i,e=i.yields())=>{let[r,o]=aa(e,Fo,Ue);return o>r}))],"getRules"),kG=nz});var Wf,On,ZO=n(()=>{ug();Wf=class extends uu{validate(...e){return!this.criteria().length||this.criteria().some(r=>r.validate(...e))}};t(Wf,"Or");On=Wf});var az,YG,zG=n(()=>{dn();Mi();rr();zm();ur();on();He();I();_e();El();w();T();Dn();Gl();qn();sr();ZO();Zi();az=t((i=d,e=ye,r=Re,o=pt,a=N,s=z)=>[new et(new l(p=>o.getByPlayer(p.player()).is(Ui,bt,Ht,at)),new m((p,u)=>s.getByTile(p.tile()).filter(y=>y instanceof Y).slice(0,Math.min(4,Ke(u,Ue))).map(y=>new bl(1,y)))),...[[Bt,1],[Bt,1,jt],[Zr,3],[mr,4]].map(([p,u,...y])=>new et(new Xe,new l(c=>r.getByCity(c).some(f=>f instanceof p)),new On(new l(c=>y.length===0),new l(c=>y.every(f=>a.getByPlayer(c.player()).completed(f)))),new l((c,f)=>Ke(f,Ue)>0),new m((c,f)=>new vl(Math.min(u,Ke(f,Ue)),r.getByCity(c).filter(h=>h instanceof p)[0])))),new et(new Qa,new m((p,u)=>new Sm(Math.floor(Ke(u,Wi)/2),Wi.name)))],"getRules"),YG=az});var jf,wa,Kp=n(()=>{G();jf=class extends g{};t(jf,"TurnStart");wa=jf});var sz,NG,LG=n(()=>{rt();K();I();$O();Fm();T();qn();Kp();sz=t((i=j,e=d,r=P)=>[new wa(new Xe,new m(o=>i.getByPlayer(o).forEach(a=>{e.get(Yn).some(s=>s.validate(a,a.yields()))&&r.emit("city:civil-disorder",a),e.get(Lf).some(s=>s.validate(a,a.yields()))&&r.emit("city:leader-celebration",a)})))],"getRules"),NG=sz});var lz={};var WG=n(()=>{I();DG();FG();SG();zG();LG();d.register(...MG(),...EG(),...kG(),...YG(),...NG())});var HG=b(jG=>{"use strict";Object.defineProperty(jG,"__esModule",{value:!0});WG()});var mz={};var _G=n(()=>{Mi();Nl();bn.register(Jr,lr,$r,mr,go,Zr,br,_t,Qr,Ct,Cr,Tr,pr,ho,Tt,dt,Pt,Oo,Ro,Bt,Pr)});var pz,KG,qG=n(()=>{Mi();sr();rp();ur();He();w();T();pz=t((i=Re,e=N)=>[new Zt(new m((r,o)=>new l(()=>!i.getByCity(r).some(a=>a instanceof o)))),...[[Jr,Lr],[go,Lt],[Zr,Lr],[br,gr],[Qr,cn],[Cr,vr],[pr,Ti],[dt,Lt],[Bt,bi],[lr,vi],[mr,vt],[_t,xt],[Ct,ct],[ho,Wt],[Tr,Vr],[Tt,lo],[Pt,Ai],[Oo,yn],[Ro,yo],[Pr,ar]].map(([r,o])=>new Zt(new l((a,s)=>s===r),new m(a=>new l(()=>e.getByPlayer(a.player()).completed(o))))),...[[lr,pr],[Pr,Cr],[Ct,_t],[Tt,_t],[Pt,_t],[Tr,Ct,Tt,Pt]].map(([r,...o])=>new Zt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByCity(a).some(s=>o.some(p=>s instanceof p)))))),...[[br,dt],[Ct,Tt,Pt],[Tt,Pt,Ct],[Pt,Ct,Tt]].map(([r,...o])=>new Zt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByCity(a).every(s=>!o.some(p=>s instanceof p))))))],"getRules"),KG=pz});var uz,VG,JG=n(()=>{Mi();op();uz=t(()=>[...[[Jr,120],[$r,40],[go,120],[Zr,100],[br,80],[Qr,60],[Cr,80],[pr,80],[dt,200],[Bt,40],[lr,120],[mr,160],[_t,200],[Ct,240],[ho,160],[Tr,320],[Tt,160],[Pt,160],[Oo,200],[Ro,200],[Pr,160]].flatMap(([i,e])=>Ll(i,e))],"getRules"),VG=uz});var cz,$G,ZG=n(()=>{ur();$s();T();Mi();cz=t((i=Re)=>[new cr(new m(e=>{let[r]=i.getByCity(e).filter(o=>o instanceof dt);!r||i.unregister(r)}))],"getRules"),$G=cz});var ue,QO=n(()=>{jl();zs();ue=class extends ac{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("cityImprovement")}cityImprovement(){return this.#e}};t(ue,"CityImprovementMaintenanceGold");ei(ue)});var Hf=n(()=>{js();QO();Uf();Oc();_p();zf();oa()});var yz,QG,XG=n(()=>{Mi();sr();ur();He();Hf();El();w();T();yz=t((i=Re,e=N)=>[...[[Jr,ue,2],[lr,ue,3],[mr,ue,3],[go,ue,2],[Zr,ue,2],[br,ue,1],[_t,ue,4],[Qr,ue,1],[Ct,ue,4],[Cr,ue,1],[Tr,ue,6],[pr,ue,1],[ho,ue,4],[Tt,ue,2],[dt,ue,0],[Pt,ue,4],[Oo,ue,2],[Ro,ue,4],[Bt,ue,1],[Pr,ue,3]].map(([r,o,a])=>new et(new l(s=>i.getByCity(s).some(p=>p instanceof r)),new m(s=>{let[p]=i.getByCity(s).filter(u=>u instanceof r);return new o(a,p)}))),...[[$r,ue,0,null,yt],[$r,ue,1,yt,ut],[$r,ue,2,ut,null]].map(([r,o,a,s,p])=>new et(new l(u=>i.getByCity(u).some(y=>y instanceof r)),new l(u=>s===null||e.getByPlayer(u.player()).completed(s)),new l(u=>p===null||!e.getByPlayer(u.player()).completed(p)),new m(u=>{let[y]=i.getByCity(u).filter(c=>c instanceof r);return new o(a,y)})))],"getRules"),QG=yz});var fz,eB,tB=n(()=>{ur();rt();I();Uu();w();T();Mi();fz=t((i=j,e=Re,r=d)=>[new jo(new l(o=>i.getByPlayer(o.player()).length===0),new m(o=>e.register(new dt(o,r))))],"getRules"),eB=fz});var dz,rB,iB=n(()=>{ur();w();Zs();T();dz=t((i=Re)=>[new yr(new l(e=>i.getByCity(e).length>0),new m(e=>i.getByCity(e).forEach(r=>i.unregister(r))))],"getRules"),rB=dz});var gz,oB,nB=n(()=>{Mi();ur();w();T();Hf();vc();gz=t((i=Re)=>[new In(new l(e=>!i.getByCity(e.city()).some(r=>r instanceof Jr)),new l(e=>e.size()>10),new m(e=>e.shrink())),new In(new l(e=>i.getByCity(e.city()).some(r=>r instanceof Qr)),new m(e=>e.add(new Pn(e.cost().value()/2))))],"getRules"),oB=gz});var hz,aB,sB=n(()=>{ur();K();Fg();T();hz=t((i=Re,e=P)=>[new mp(new m(r=>i.register(r))),new mp(new m((r,o)=>{e.emit("city-improvement:created",r,o)}))],"getRules"),aB=hz});var Oz,lB,mB=n(()=>{Mi();ur();Hf();w();T();yg();Wu();Zi();Oz=t((i=Re)=>[...[[pr,Xt,.5],[pr,Wi,.5],[lr,Xt,.5],[lr,Wi,.5],[Cr,Kt,.5],[Pr,Kt,.5],[_t,H,.5],[Pt,H,.5],[Ct,H,.5],[Tt,H,.5],[Tr,H,.5],[br,hn,.5]].map(([e,r,o])=>new Qs(new UR,new l(a=>i.getByCity(a).some(s=>s instanceof e)),new m((a,s)=>new r(Math.floor(Ke(s,r)*o),e.name))))],"getRules"),lB=Oz});var Rz,pB,uB=n(()=>{ur();la();Mi();Zc();w();T();Ep();Rz=t((i=Re,e=or)=>[new Qn(new l(r=>r.city()!==null),new l(r=>i.getByCity(r.city()).some(o=>o instanceof $r)),new m(r=>e.register(new pa(r))))],"getRules"),pB=Rz});var xz={};var cB=n(()=>{I();qG();JG();ZG();XG();tB();iB();nB();sB();mB();uB();d.register(...KG(),...VG(),...$G(),...QG(),...eB(),...rB(),...oB(),...aB(),...lB(),...pB())});var fB=b(yB=>{"use strict";Object.defineProperty(yB,"__esModule",{value:!0});_G();cB()});var gB={};tu(gB,{default:()=>vz,registerCityNames:()=>dB});var dB,vz,hB=n(()=>{Et();gt();dB=t((i=$)=>{["Bergen","Cannae","Capua","Cordoba","Cremona","Crete","Cunaxa","Damascus","Dublin","Genoa","Ghent","Issus","Lisbon","Mecca","Melbourne","Milan","Naples","Pisa","Prague","Salamis","Salzburg","Seville","Sidon","Sydney","Tarsus","Toronto","Turin","Tyre","Utica","Venice","Verona"].forEach(e=>i.register(new Q(e,null)))},"registerCityNames"),vz=dB});var XO=n(()=>{xm();Fp();kp();Sp();Yp();Pm();zp();wm();Np();Lp();Wp();jp();Mm();Hp()});var _f,Kf,eR=n(()=>{Ki();Ft();_f=class extends Ee{constructor(){super(me)}};t(_f,"CivilizationRegistry");Kf=new _f});var RB={};tu(RB,{default:()=>bz,registerCivilizations:()=>OB});var OB,bz,xB=n(()=>{XO();eR();OB=t((i=Kf)=>{i.register(ca,ya,fa,da,ga,ha,Oa,Ra,xa,va,ba,Ca,Ta,Pa)},"registerCivilizations"),bz=OB});var Aa,vB=n(()=>{st();xm();Aa=class extends te{static civilization(){return dl}name(){return"Abraham Lincoln"}};t(Aa,"AbrahamLincoln")});var bB=n(()=>{st();xm()});var CB=n(()=>{vB();bB()});var Ga,TB=n(()=>{st();Fp();Ga=class extends te{static civilization(){return vm}name(){return"Moctezuma II"}};t(Ga,"MoctezumaII")});var PB=n(()=>{TB()});var Ba,IB=n(()=>{st();kp();Ba=class extends te{static civilization(){return bm}name(){return"Hammurabi"}};t(Ba,"Hammurabi")});var wB=n(()=>{IB()});var Ua,AB=n(()=>{st();Sp();Ua=class extends te{static civilization(){return Cm}name(){return"Mao Zedong"}};t(Ua,"MaoZedong")});var GB=n(()=>{AB()});var Ma,BB=n(()=>{st();Yp();Ma=class extends te{static civilization(){return Tm}name(){return"Ramesses II"}};t(Ma,"RamessesII")});var UB=n(()=>{BB()});var Da,MB=n(()=>{st();Pm();Da=class extends te{static civilization(){return gl}name(){return"Elizabeth I"}};t(Da,"ElizabethI")});var DB=n(()=>{st();Pm()});var EB=n(()=>{MB();DB()});var Ea,FB=n(()=>{st();zp();Ea=class extends te{static civilization(){return Im}name(){return"Napoleon I"}};t(Ea,"NapoleonI")});var kB=n(()=>{FB()});var Fa,SB=n(()=>{st();wm();Fa=class extends te{static civilization(){return hl}name(){return"Frederick the Great"}};t(Fa,"FrederickTheGreat")});var YB=n(()=>{st();wm()});var zB=n(()=>{SB();YB()});var ka,NB=n(()=>{st();Np();ka=class extends te{static civilization(){return Am}name(){return"Alexander the Great"}};t(ka,"AlexanderTheGreat")});var LB=n(()=>{NB()});var Sa,WB=n(()=>{st();Lp();Sa=class extends te{static civilization(){return Gm}name(){return"Mahatma Gandhi"}};t(Sa,"MahatmaGandhi")});var jB=n(()=>{WB()});var Ya,HB=n(()=>{st();Wp();Ya=class extends te{static civilization(){return Bm}name(){return"Genghis Khan"}};t(Ya,"GenghisKhan")});var _B=n(()=>{HB()});var za,KB=n(()=>{st();jp();za=class extends te{static civilization(){return Um}name(){return"Julius Caesar"}};t(za,"JuliusCaesar")});var qB=n(()=>{KB()});var VB=n(()=>{st();Mm()});var Na,JB=n(()=>{st();Mm();Na=class extends te{static civilization(){return Ol}name(){return"Joseph Stalin"}};t(Na,"JosephStalin")});var $B=n(()=>{VB();JB()});var La,ZB=n(()=>{st();Hp();La=class extends te{static civilization(){return Dm}name(){return"Shaka"}};t(La,"Shaka")});var QB=n(()=>{ZB()});var tR=n(()=>{CB();PB();wB();GB();UB();EB();kB();zB();LB();jB();_B();qB();$B();QB()});var eU={};tu(eU,{default:()=>Cz,registerLeaders:()=>XB});var XB,Cz,tU=n(()=>{tR();Hl();XB=t((i=Tn)=>{i.register(Aa,Ga,Ba,Ua,Ma,Da,Ea,Fa,ka,Sa,Ya,za,Na,La)},"registerLeaders"),Cz=XB});var qf,Nm,Vf=n(()=>{ap();qf=class extends ls{};t(qf,"Aggression");Nm=qf});var Jf,Lm,rU=n(()=>{Vf();Jf=class extends Nm{constructor(e){super(e,1)}};t(Jf,"Aggressive");Lm=Jf});var $f,Wm,Zf=n(()=>{ap();$f=class extends ls{};t($f,"Militarism");Wm=$f});var Qf,Wa,iU=n(()=>{Zf();Qf=class extends Wm{constructor(e){super(e,0)}};t(Qf,"Civilized");Wa=Qf});var Xf,jm,ed=n(()=>{ap();Xf=class extends ls{};t(Xf,"Development");jm=Xf});var td,Hm,oU=n(()=>{ed();td=class extends jm{constructor(e){super(e,1)}};t(td,"Expansionist");Hm=td});var rd,id,nU=n(()=>{Vf();rd=class extends Nm{constructor(e){super(e,0)}};t(rd,"Friendly");id=rd});var od,nd,aU=n(()=>{Zf();od=class extends Wm{constructor(e){super(e,1)}};t(od,"Militaristic");nd=od});var ad,Cl,sU=n(()=>{Vf();ad=class extends Nm{constructor(e){super(e,.5)}};t(ad,"Normal");Cl=ad});var sd,_m,lU=n(()=>{ed();sd=class extends jm{constructor(e){super(e,.5)}};t(sd,"Normal");_m=sd});var ld,md,mU=n(()=>{Zf();ld=class extends Wm{constructor(e){super(e,.5)}};t(ld,"Normal");md=ld});var pd,qp,pU=n(()=>{ed();pd=class extends jm{constructor(e){super(e,0)}};t(pd,"Perfectionist");qp=pd});var cU={};tu(cU,{default:()=>Tz,registerTraits:()=>uU});var uU,Tz,yU=n(()=>{tR();Ag();rU();iU();oU();nU();aU();sU();lU();mU();pU();uU=t((i=cc)=>{[[Aa,id,_m,Wa],[Ga,Cl,qp,Wa],[Ba,id,qp,Wa],[Ua,Cl,_m,Wa],[Ma,Cl,_m,Wa],[Da,Cl,Hm,md],[Ea,Lm,Hm,Wa],[Fa,Lm,qp,Wa],[ka,Cl,Hm,nd],[Sa,id,qp,md],[Ya,Lm,Hm,nd],[za,Cl,Hm,Wa],[Na,Lm,_m,nd],[La,Lm,_m,md]].forEach(([e,...r])=>r.forEach(o=>i.register(new o(e))))},"registerTraits"),Tz=uU});var dU=b(fU=>{"use strict";Object.defineProperty(fU,"__esModule",{value:!0});var Pz=(hB(),R(gB)),Iz=(xB(),R(RB)),wz=(tU(),R(eU)),Az=(yU(),R(cU));(0,Pz.default)();(0,Iz.default)();(0,wz.default)();(0,Az.default)()});var ud,cd,rR=n(()=>{ud=class{#e=[];constructor(...e){this.#e.push(...e)}isBetween(...e){return e.every(r=>this.#e.includes(r))&&e.length===this.#e.length}players(){return this.#e}};t(ud,"Interaction");cd=ud});var yd,gU,hU=n(()=>{Ce();rR();yd=class extends F{constructor(){super(cd)}getByPlayer(e){return this.entries().filter(r=>r.players().includes(e))}getByPlayers(...e){return this.entries().filter(r=>r.isBetween(...e))}};t(yd,"InteractionRegistry");gU=new yd});var Km,OU=n(()=>{rR();Km=class extends cd{constructor(...e){let r=e.map(o=>o.player());super(...r)}};t(Km,"Contact")});var RU=n(()=>{OU()});var Gz,xU,vU=n(()=>{hU();_e();RU();w();T();At();Gz=t((i=gU,e=z)=>[new q(new l(r=>r.tile().getNeighbours().some(o=>e.getByTile(o).some(a=>a.player()!==r.player()))),new m(r=>r.tile().getNeighbours().forEach(o=>e.getByTile(o).filter(a=>a.player()!==r.player()).forEach(a=>i.register(new Km(r,a))))))],"getRules"),xU=Gz});var Bz={};var bU=n(()=>{I();vU();d.register(...xU())});var TU=b(CU=>{"use strict";Object.defineProperty(CU,"__esModule",{value:!0});bU()});var Uz,PU,IU=n(()=>{w();T();$g();Uz=t(()=>[new gs(new l(i=>i<252),new m(i=>i*20-4020)),new gs(new l(i=>i>251),new l(i=>i<302),new m(i=>(i-151)*10+1e3)),new gs(new l(i=>i>301),new l(i=>i<352),new m(i=>(i-201)*5+1500)),new gs(new l(i=>i>351),new l(i=>i<402),new m(i=>(i-251)*2+1750)),new gs(new l(i=>i>401),new m(i=>i-301+1850))],"getRules"),PU=Uz});var Mz={};var wU=n(()=>{I();IU();d.register(...PU())});var GU=b(AU=>{"use strict";Object.defineProperty(AU,"__esModule",{value:!0});wU()});var Dz,BU,UU=n(()=>{Ig();rt();to();He();xh();w();T();ll();rm();oa();Dz=t((i=N,e=j)=>[new yl(new l((r,o)=>i.getByPlayer(o.player()).available().length>0),new m((r,o)=>new ts(r,o))),new yl(new l(r=>[fe,ie,ee].some(o=>r.tile().terrain()instanceof o)),new l((r,o)=>r.tile().getSurroundingArea().score(null,[[Ko,8],[ra,3],[ia,1]])>=150),new l(r=>r.tile().getSurroundingArea(4).every(o=>e.getByTile(o)===null)),new m((r,o)=>new rs(r,o))),new yl(new m((r,o)=>new os(r,o))),new yl(new m((r,o)=>new ns(r,o)))],"getRules"),BU=Dz});var Ez,MU,DU=n(()=>{K();vh();T();Ez=t((i=P)=>[new af(new m((e,r)=>{i.emit("goody-hut:action-performed",e,r)}))],"getRules"),MU=Ez});var Fz,EU,FU=n(()=>{K();ks();bh();T();Fz=t((i=kr,e=P,r=()=>Math.random())=>[new hm(new m(o=>i.unregister(o))),new hm(new m((o,a)=>{let s=o.actions(a),p=s[Math.floor(s.length*r())];o.action(p)})),new hm(new m((o,a)=>{e.emit("goody-hut:discovered",o,a)}))],"getRules"),EU=Fz});var fd,qm,iR=n(()=>{G();fd=class extends g{};t(fd,"Distribution");qm=fd});var kz,kU,SU=n(()=>{ks();w();iR();kz=t((i=kr,e=()=>Math.random())=>[new qm(new l(r=>r.isLand())),new qm(new l(r=>r.getSurroundingArea(3).every(o=>i.getByTile(o)===null))),new qm(new l(()=>e()<.05))],"getRules"),kU=kz});var Sz,YU,zU=n(()=>{ks();gn();I();T();Pg();Sz=t((i=kr,e=()=>Math.random(),r=d)=>[new lc(new m((o,a)=>{let s=[Ir,wr],p=s[Math.floor(s.length*e())];return new p(null,a.player(),a.tile(),r)}))],"getRules"),YU=Sz});var Yz,NU,LU=n(()=>{ks();w();T();At();Yz=t((i=kr)=>[new q(new l(e=>i.getByTile(e.tile())!==null),new m(e=>{i.getByTile(e.tile()).process(e)}))],"getRules"),NU=Yz});var dd,Hs,gd=n(()=>{G();dd=class extends g{};t(dd,"Built");Hs=dd});var zz,WU,jU=n(()=>{ks();I();gd();T();Ch();iR();zz=t((i=kr,e=d)=>[new Hs(new m(r=>{let o=e.get(qm);r.forEach(a=>{o.every(s=>s.validate(a))&&i.register(new mf(a))})}))],"getRules"),WU=zz});var Nz={};var HU=n(()=>{UU();DU();FU();SU();zU();I();LU();jU();d.register(...BU(),...MU(),...EU(),...kU(),...YU(),...NU(),...WU())});var KU=b(_U=>{"use strict";Object.defineProperty(_U,"__esModule",{value:!0});HU()});var Lz={};var qU=n(()=>{dn();gf();Om.register(bt,nt,Ht,at,ft)});var Wz,VU,JU=n(()=>{on();dn();w();T();Ng();Zn();Wz=t((i=pt)=>[new ht(new l(e=>!i.getByPlayer(e).is(Ui)),new m(e=>[new cs(e,i.getByPlayer(e))]))],"getRules"),VU=Wz});var jz,$U,ZU=n(()=>{gf();on();I();al();dn();T();Gl();wh();jz=t((i=Om,e=pt,r=d)=>[new li(new Qa,new m(o=>{let a=new xf(o,i,r);a.set(new Ht),e.register(a)}))],"getRules"),$U=jz});var Hz,QU,XU=n(()=>{sr();dn();He();Ph();w();Hz=t((i=N)=>[new Mp(new l(e=>e===Ht)),...[[bt,Rt],[nt,ao],[at,Hr],[ft,Gi]].map(([e,r])=>new Mp(new l(o=>o===e),new l((o,a)=>i.getByPlayer(a).completed(r))))],"getRules"),QU=Hz});var _z,eM,tM=n(()=>{K();$i();Ih();w();T();_z=t((i=P,e=ae)=>[new Dp(new m((r,o)=>{i.emit("player:government:changed",r,o)})),new Dp(new l(r=>{try{return e.getByPlayer(r),!0}catch(o){if(o instanceof TypeError&&o.message.match(/Wrong number of player worlds exist/))return!1;throw o}}),new m(r=>{e.getByPlayer(r).entries().forEach(a=>a.tile().clearYieldCache(r))}))],"getRules"),eM=_z});var Kz={};var rM=n(()=>{I();JU();ZU();XU();tM();d.register(...VU(),...$U(),...QU(),...eM())});var oM=b(iM=>{"use strict";Object.defineProperty(iM,"__esModule",{value:!0});qU();rM()});var hd,nM,aM=n(()=>{G();hd=class extends g{};t(hd,"TurnEnd");nM=hd});var qz,sM,lM=n(()=>{Tp();K();I();aM();qz=t((i=ta,e=d,r=P)=>[["player:turn-end",o=>{i.unregister(o),e.process(nM,o);let[a]=i.entries();if(!a){r.emit("turn:end");return}r.emit("player:turn-start",a)}]],"getEvents"),sM=qz});var Vz,mM,pM=n(()=>{fl();K();I();Kp();Vz=t((i=Eo,e=P,r=d)=>[["player:turn-start",o=>{r.process(wa,o),i.getByPlayer(o).takeTurn().catch(s=>console.error(s)).finally(()=>{e.emit("player:turn-end",o)})}]],"getEvents"),mM=Vz});var Jz,uM,cM=n(()=>{Tp();K();ds();Jz=t((i=ui,e=ta,r=P)=>[["turn:start",()=>{e.register(...i.entries());let[o]=e.entries();r.emit("player:turn-start",o)}]],"getEvents"),uM=Jz});var $z={};var yM=n(()=>{K();lM();pM();cM();[...sM(),...mM(),...uM()].forEach(([i,e])=>P.on(i,e))});var Od,zn,Vp=n(()=>{G();Od=class extends g{};t(Od,"Defeated");zn=Od});var Zz,fM,dM=n(()=>{rt();I();$s();w();Vp();T();Zz=t((i=j,e=d)=>[new cr(new l((r,o,a)=>i.getByPlayer(a).filter(s=>s!==r).length===0),new m((r,o,a)=>{e.process(zn,a,o)}))],"getRules"),fM=Zz});var Qz,gM,hM=n(()=>{rt();I();w();Vp();Zs();T();Qz=t((i=j,e=d)=>[new yr(new l((r,o)=>i.getByPlayer(r.player()).filter(a=>a!==r).length===0),new m((r,o)=>e.process(zn,r.player(),o)))],"getRules"),gM=Qz});var oR,Xz,OM,RM=n(()=>{Zn();w();T();Dc();Za();oR=new ht(new Fr(9001),new l(i=>{oR.disable();let e=i.mandatoryActions();return oR.enable(),e.length===0}),new m(i=>[new Mc(i,null)])),Xz=t(()=>[oR],"getRules"),OM=Xz});var eN,xM,vM=n(()=>{K();al();T();eN=t((i=P)=>[new li(new m(e=>{i.emit("player:added",e)}))],"getRules"),xM=eN});var tN,bM,CM=n(()=>{Tp();K();ds();w();Vp();T();tN=t((i=ta,e=ui,r=P)=>[new zn(new l(o=>i.includes(o)),new m(o=>i.unregister(o))),new zn(new l(o=>e.includes(o)),new m(o=>e.unregister(o))),new zn(new m((o,a)=>{r.emit("player:defeated",o,a)}))],"getRules"),bM=tN});var Rd,xd,nR=n(()=>{G();Rd=class extends g{};t(Rd,"Spawn");xd=Rd});var rN,TM,PM=n(()=>{I();T();jO();nR();rN=t((i=d)=>[new xd(new m((e,r)=>{new JC(null,e,r,i)}))],"getRules"),TM=rN});var iN,IM,wM=n(()=>{rt();I();_e();T();ll();Gl();km();rm();oa();Kp();Zi();iN=t((i=d,e=j,r=z)=>[new wa(new Qa,new m(o=>{e.getByPlayer(o).forEach(a=>{let s=a.yields();aa(s,Ko,ra,ia).reduce((p,u,y)=>(p[y].set(u,"Consolidated"),p),[new Ko(0,"Consolidated"),new ra(0,"Consolidated"),new ia(0,"Consolidated")]).forEach(p=>i.process(ko,p,a,s))})})),new wa(new m(o=>r.getByPlayer(o).forEach(a=>{a.moves().set(a.movement());let s=a.busy();if(!s){a.setActive(),a.setWaiting(!1);return}!s.validate()||s.process()})))],"getRules"),IM=iN});var oN,AM,GM=n(()=>{K();T();zg();oN=t((i=P)=>[new Wc(new m((e,r)=>{i.emit("player:visibility-changed",e,r)}))],"getRules"),AM=oN});var nN,BM,UM=n(()=>{ds();$i();Cy();T();nN=t((i=ui,e=ae)=>[new sa(new m(r=>{r.clearYieldCache(null),i.forEach(o=>{e.getByPlayer(o).getByTile(r)!==null&&r.clearYieldCache(o)})}))],"getRules"),BM=nN});var aN,MM,DM=n(()=>{rt();I();w();Vp();Xc();T();aN=t((i=j,e=d)=>[new Xn(new l((r,o)=>i.getByPlayer(r.player()).length===0),new m((r,o)=>e.process(zn,r.player(),o)))],"getRules"),MM=aN});var sN,EM,FM=n(()=>{$i();T();_g();sN=t((i=ae)=>[new ty(new m((e,r)=>{e.clearYieldCache(r);let o=i.getByPlayer(r);o.register(e),o.getByTile(e).update()}))],"getRules"),EM=sN});var vd,Jp,aR=n(()=>{G();vd=class extends g{};t(vd,"PickStartTile");Jp=vd});var lN,kM,SM=n(()=>{eR();fl();K();ds();$i();I();gd();T();ll();lm();aR();Gp();Hc();rm();Vy();oa();nR();lN=t((i=Kf,e=Eo,r=P,o=ui,a=ae,s=d,p=()=>Math.random())=>[new Hs(new m(u=>o.entries().forEach(y=>a.register(new ql(y,u))))),new Hs(new m(u=>{let y=new Map,c=new Map,f=t((A,E=null)=>(y.has(A)||y.set(A,A.score(E,[[Ko,8],[ra,3],[ia,1]])),y.get(A)),"tileScore"),h=t((A,E=null)=>(c.has(A)||c.set(A,A.getSurroundingArea().entries().reduce((V,se)=>V+f(se,E),0)),c.get(A)),"areaScore");r.emit("world:generate-start-tiles");let U=[],D=u.entries().filter(A=>[As,am,qy].some(E=>A.terrain()instanceof E)).map(A=>({tile:A,score:h(A)})).sort(({score:A},{score:E})=>E-A).map(({tile:A})=>A);r.emit("world:start-tiles",D),e.entries().reduce((A,E)=>A.then(async()=>{let V=E.player();await E.chooseCivilization(i.entries()),i.unregister(V.civilization().sourceClass());let[se]=s.process(Jp,u,V,U);if(!se)throw new TypeError("Not enough `startingSquare`s.");U.push(se),s.process(xd,V,se)}),Promise.resolve()).then(()=>r.emit("game:start"))})),new Hs(new m(u=>{r.emit("world:built",u)}))],"getRules"),kM=lN});var mN={};var YM=n(()=>{dM();hM();I();RM();vM();CM();PM();wM();GM();UM();DM();FM();SM();d.register(...fM(),...gM(),...OM(),...xM(),...bM(),...TM(),...IM(),...AM(),...BM(),...MM(),...EM(),...kM())});var NM=b(zM=>{"use strict";Object.defineProperty(zM,"__esModule",{value:!0});yM();YM()});var pN={};var LM=n(()=>{sr();B();O.register(Ri,ro,xi,Fn,ut,vi,io,Yr,bi,nn,oo,gr,zr,Rt,Ci,Nr,Lr,no,Ti,ao,hr,ct,an,sn,kn,so,ua,ln,yt,mn,xt,Or,Pi,pn,Rr,Nt,Wr,Lt,Wt,xr,Ii,jr,Hr,jt,nr,_r,lo,Kr,wi,un,cn,qr,yn,Ai,vt,Vr,mo,po,uo,co,yo,Gi,fn,fo,Bi,ar,vr)});var WM=n(()=>{Bg()});var uN,jM,HM=n(()=>{He();Zn();WM();w();T();uN=t((i=N)=>[new ht(new l(e=>i.getByPlayer(e).researching()===null),new l(e=>i.getByPlayer(e).available().length>0),new m(e=>[new rl(e,i.getByPlayer(e))]))],"getRules"),jM=uN});var cN,_M,KM=n(()=>{B();He();I();al();T();Iu();cN=t((i=O,e=N,r=d,o=()=>Math.random())=>[new li(new m(a=>e.register(new Ul(a,i,r)))),new li(new m(a=>{let s=e.getByPlayer(a);for(let p=0,u=Math.min(s.available().length,Math.floor(4*o()));p<u;p++){let y=s.available();s.addAdvance(y[Math.floor(o()*y.length)])}}))],"getRules"),_M=cN});var yN,qM,VM=n(()=>{He();$s();T();w();yN=t((i=N,e=()=>Math.random())=>[new cr(new l((r,o,a)=>i.getByPlayer(a).complete().some(s=>!i.getByPlayer(o).completed(s.constructor))),new m((r,o,a)=>{let s=i.getByPlayer(o),p=i.getByPlayer(a).complete().filter(u=>!s.completed(u.constructor));s.addAdvance(p.map(u=>u.constructor)[Math.floor(e()*p.length)])}))],"getRules"),qM=yN});var fN,JM,$M=n(()=>{K();Ou();T();fN=t((i=P)=>[new Xa(new m((e,r)=>{i.emit("player:research-complete",e,r)}))],"getRules"),JM=fN});var dN,ZM,QM=n(()=>{fg();T();dN=t(()=>[new xu(new m((i,e)=>(e.complete().length+1)*(6+2*0)))],"getRules"),ZM=dN});var gN,XM,eD=n(()=>{Fm();He();I();w();T();km();zf();gN=t((i=N,e=d)=>[new ko(new l(r=>r instanceof Kt),new l((r,o,a)=>!e.get(Yn).some(s=>s.validate(o,a))),new m((r,o)=>i.getByPlayer(o.player()).add(r)))],"getRules"),XM=gN});var hN,tD,rD=n(()=>{sr();w();T();dg();hN=t(()=>[...[[Ri,so,hr],[xi,xr,jt],[Fn,fo,wi],[ut,zr,co],[vi,Gi,Bi],[io,Lr,Pi],[nn,ar,Ii],[oo,kn,mn],[gr,ro],[zr,Ai,sn],[Rt,Kr,xt],[Ci,ct,xr],[Nr,sn,Gi],[Lr,Ti,Lt],[no,vi,xt],[Ti,Yr],[ao,Kr,Rr],[hr,jr,Nt],[ct,an,hr],[an,Lr,fn],[sn,yt,nn],[kn,Lt,Hr],[so,zr,wi],[ua,lo,yo],[ln,no,Ii],[yt,Or,Pi],[xt,qr,vi],[Or,an,Rr],[Pi,Yr],[pn,Wt,Rt],[Rr,gr,vr],[Nt,nr,wi],[Wr,ro],[Wt,no,ut],[xr,ro,Lt],[Ii,Kr,Bi],[jr,yt,ar],[Hr,gr,jt],[jt,bi],[nr,xi,Wr],[_r,Wt,Fn],[lo,_r,ct],[Kr,jt,Rr],[wi,nr,xr],[un,Ai,po],[qr,io,uo],[yn,ao,Wt],[Ai,no,nn],[vt,Kr,vr],[Vr,Ci,un],[mo,ct,Ri],[po,Ci,mo],[uo,Or,wi],[co,jr,xt],[yo,Wt,un],[Gi,gr,Rr],[fo,xi,ar],[Bi,gr,Ti],[ar,Kr,xr],[vr,ro]].map(([i,...e])=>new bu(new l(r=>r===i),new m((r,o)=>e.every(a=>o.some(s=>s instanceof a)))))],"getRules"),tD=hN});var ON,iD,oD=n(()=>{K();T();gg();ON=t((i=P)=>[new Tu(new m((e,r)=>{i.emit("player:research",e,r)}))],"getRules"),iD=ON});var RN={};var nD=n(()=>{HM();KM();VM();$M();QM();I();eD();rD();oD();d.register(...jM(),..._M(),...qM(),...JM(),...ZM(),...XM(),...tD(),...iD())});var sD=b(aD=>{"use strict";Object.defineProperty(aD,"__esModule",{value:!0});LM();nD()});var bd,_s,$p=n(()=>{Ve();bd=class extends L{};t(bd,"TradeRate");_s=bd});var ja,lD=n(()=>{_p();$p();ja=class extends _s{};t(ja,"Luxuries"),ja.tradeYield=uG});var Ha,mD=n(()=>{Df();$p();Ha=class extends _s{};t(Ha,"Research"),Ha.tradeYield=Kt});var _a,pD=n(()=>{jl();$p();_a=class extends _s{};t(_a,"Tax"),_a.tradeYield=ac});var sR=n(()=>{lD();mD();pD()});var Cd,Ks,Zp=n(()=>{Ki();$p();Cd=class extends Ee{constructor(){super(_s)}};t(Cd,"AvailableTradeRateRegistry");Ks=new Cd});var xN={};var uD=n(()=>{sR();Zp();Ks.register(ja,Ha,_a)});var cD=n(()=>{Uf();oa()});var Td,Pd,lR=n(()=>{Z();Td=class extends Ye{#e=100;#t;#r=[];constructor(e,...r){super(),this.#t=e,this.#r=r,this.addKey("all")}all(){return[...this.#r]}balance(e){if(this.total()===1)return;let r=1-e.value(),o=this.#r.filter(s=>s!==e),a=o.reduce((s,p)=>s+p.value(),0);o.forEach(s=>s.set(s.value()/a*r)),this.total()<1&&o[Math.floor(o.length*Math.random())].add(1-this.total()),this.total()>1&&o[Math.floor(o.length*Math.random())].subtract(1-this.total())}get(e){let[r]=this.#r.filter(o=>o instanceof e);return r}player(){return this.#t}set(e,r){let o=this.get(e);o.set(r),this.balance(o)}setAll(e){if(e.reduce((r,[,o])=>r+o,0)!==1)throw new TypeError("Invalid rates provided, must sum to 1.");e.forEach(([r,o])=>this.get(r).set(o))}total(){return Math.round(this.#r.reduce((e,r)=>e+r.value(),0)*this.#e)/this.#e}};t(Td,"PlayerTradeRates");Pd=Td});var Id,qs,Qp=n(()=>{Ce();lR();Id=class extends F{constructor(){super(Pd)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTradeRates for player");return r[0]}};t(Id,"PlayerTradeRatesRegistry");qs=new Id});var vN,yD,fD=n(()=>{Zp();cD();Qp();T();zl();Zi();vN=t((i=Ks,e=qs)=>[new Yl(new m((r,o)=>{let a=e.getByPlayer(r.player()),s=Math.max(0,Ke(o,re)),p=s;return i.entries().map(u=>{let y=u.tradeYield,c=Math.min(Math.ceil(s*a.get(u).value()),p);return p-=c,new y(c,u.name)})}))],"getRules"),yD=vN});var bN,dD,gD=n(()=>{Qp();Zn();Gg();T();bN=t((i=qs)=>[new ht(new m(e=>[new ms(e,i.getByPlayer(e))]))],"getRules"),dD=bN});var CN,hD,OD=n(()=>{Zp();Qp();sR();al();T();lR();CN=t((i=Ks,e=qs)=>[new li(new m(r=>{let o=[new _a(.5),new Ha(.5),new ja(0)],a=i.entries(),s=new Pd(r,...a.map(p=>{let[u]=o.filter(y=>y instanceof p);return new p(u||0)}));e.register(s)}))],"getRules"),hD=CN});var wd,TN,RD,xD=n(()=>{Zp();rt();I();T();Gl();km();Kp();Zi();wd=[],TN=t((i=d,e=j,r=Ks)=>[new wa(new Qa,new m(o=>{wd.length===0&&r.entries().forEach(a=>wd.push(a.tradeYield)),e.getByPlayer(o).forEach(a=>{let s=a.yields();aa(s,...wd).reduce((p,u,y)=>(p[y].set(u,"Consolidated"),p),wd.map(p=>new p)).forEach(p=>i.process(ko,p,a,s))})}))],"getRules"),RD=TN});var PN={};var vD=n(()=>{I();fD();gD();OD();xD();d.register(...yD(),...dD(),...hD(),...RD())});var CD=b(bD=>{"use strict";Object.defineProperty(bD,"__esModule",{value:!0});uD();vD()});var IN,TD,PD=n(()=>{Ge();w();T();Cg();ea();IN=t(()=>[new el(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(Pe,i.building().item())),new l(i=>i.progress().value()===0),new m((i,e)=>{let r=i.remaining()/10;return e.add(Math.floor((r+4)*10*r)),e})),new el(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(Pe,i.building().item())),new l(i=>i.progress().value()>0),new m((i,e)=>{let r=i.remaining()/10;return e.add(Math.floor(5*r**2+20*r)),e})),new el(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(k,i.building().item())),new l(i=>i.progress().value()===0),new m((i,e)=>(e.add(i.remaining()*4),e))),new el(new l(i=>typeof i.building()<"u"&&Object.isPrototypeOf.call(k,i.building().item())),new l(i=>i.progress().value()>0),new m((i,e)=>(e.add(i.remaining()*2),e)))],"getRules"),TD=IN});var wN,ID,wD=n(()=>{rt();Zn();kg();T();wN=t((i=j)=>[new ht(new m(e=>i.getByPlayer(e).map(r=>new ps(e,r))))],"getRules"),ID=wN});var AN,AD,GD=n(()=>{tl();al();T();Tg();AN=t((i=si)=>[new li(new m(e=>i.register(new oc(e))))],"getRules"),AD=AN});var BD=n(()=>{QO();jl()});var Ad,Gd,mR=n(()=>{G();Ad=class extends g{};t(Ad,"Updated");Gd=Ad});var GN,UD,MD=n(()=>{BD();ur();K();tl();I();bg();Fm();w();T();km();mR();GN=t((i=si,e=d,r=Re,o=P)=>[new ko(new l(a=>a instanceof Xt),new m((a,s,p)=>{let u=i.getByPlayer(s.player());p.forEach(y=>{if(y instanceof ue){if(u.value()<y.value()){let c=y.cityImprovement(),f=new $u(c.constructor,s,e);r.unregister(c),u.add(f.cost().value()),o.emit("city:unsupported-improvement",s,c);return}u.subtract(y.value(),s.name())}})})),new ko(new l(a=>a instanceof Xt),new l((a,s,p)=>!e.get(Yn).some(u=>u.validate(s,p))),new m((a,s)=>{let p=i.getByPlayer(s.player());p.add(a,s.name()),e.process(Gd,p,s)}))],"getRules"),UD=GN});var BN,DD,ED=n(()=>{K();w();T();mR();BN=t((i=P)=>[new Gd(new l(e=>e.value()<0),new m((e,r)=>{i.emit("player:treasury-exhausted",e.player(),e,r)}))],"getRules"),DD=BN});var UN={};var FD=n(()=>{I();PD();wD();GD();MD();ED();d.register(...TD(),...ID(),...AD(),...UD(),...DD())});var SD=b(kD=>{"use strict";Object.defineProperty(kD,"__esModule",{value:!0});FD()});var MN={};var YD=n(()=>{gn();Nl();bn.register(xo,vo,bo,Di,Co,To,Ei,Fi,Po,Io,Xr,ki,Ir,Si,Yi,wo,zi,Ao,Go,Ni,We,Li,Bo,wr,Uo,Mo,Ar,Do)});var Bd,Vm,pR=n(()=>{G();Bd=class extends g{};t(Bd,"Available");Vm=Bd});var Ud,zD,uR,DN,ND,LD=n(()=>{jg();Dn();fm();gt();rt();to();En();$t();I();Jo();gi();gm();ci();_e();la();cg();pR();w();T();ZO();gn();Ud=new l((i,e,r=i.tile())=>i instanceof ot),zD=new l((i,e,r=i.tile())=>i instanceof Le),uR=t((i,e)=>e.getByTile(i)!==null,"tileHasCity"),DN=t((i=$,e=j,r=d,o=Ne,a=or,s=z,p=lt,u=Un,y=Be)=>[new Ot(Ql,pi,new On(new $a(Ud,new l((c,f,h=c.tile())=>h.isLand()),new l((c,f)=>f.isLand()),new l((c,f)=>s.getByTile(f).every(h=>h.player()===c.player()))),new $a(zD,new On(new l((c,f,h=c.tile())=>h.isWater()),new l((c,f,h=c.tile())=>e.getByTile(h)?.player()===c.player())),new On(new l((c,f)=>f.isWater()),new l((c,f)=>e.getByTile(f)?.player()===c.player()))),new l(c=>c instanceof St)),new On(new l((c,f)=>!(c instanceof ot)),new l((c,f,h=c.tile())=>!(h.getNeighbours().some(U=>s.getByTile(U).some(D=>D instanceof ot&&D.tile().terrain()instanceof W&&D.player()!==c.player()))&&f.getNeighbours().some(U=>s.getByTile(U).some(D=>D instanceof ot&&D.tile().terrain()instanceof W&&D.player()!==c.player())))),new l((c,f)=>s.getByTile(f).filter(h=>h.player()===c.player()).length>0),new l((c,f)=>{let h=e.getByTile(f);return h===null?!1:h.player()===c.player()})),new l((c,f)=>{let h=e.getByTile(f);return h===null?!0:h.player()===c.player()}),new l((c,f)=>!s.getByTile(f).some(h=>h.player()!==c.player())),new m((c,f,h=c.tile())=>new kt(h,f,c,r))),new Ot(Ql,pi,new On(new l(c=>c instanceof St),new $a(Ud,new l((c,f)=>f.isLand())),new $a(zD,new On(new l((c,f)=>f.isWater()),new $a(new l((c,f)=>s.getByTile(f).some(h=>h.player()!==c.player())))))),new l((c,f)=>s.getByTile(f).some(h=>h.player()!==c.player())),new m((c,f,h=c.tile())=>new vs(h,f,c,r,s))),new Ot(Ql,pi,Ud,new l((c,f)=>uR(f,e)),new l((c,f)=>s.getByTile(f).length===0),new l((c,f)=>e.getByTile(f).player()!==c.player()),new m((c,f,h=c.tile())=>{let U=e.getByTile(f);return new nm(h,f,c,U,r)})),new Ot(pi,wn,new l(c=>c instanceof Y),new l((c,f)=>o.getByTile(f).filter(h=>[we,$e,ir,ke].some(U=>h instanceof U)).length>0),new m((c,f,h=c.tile())=>new Ds(h,f,c,r,o,y))),new Ot(pi,wn,new l(c=>c instanceof Y),new l((c,f,h=c.tile())=>h.isLand()),new m((c,f,h=c.tile())=>new Ms(h,f,c,r,y,a))),new Ot(pi,wn,new m((c,f,h=c.tile())=>new ma(h,f,c,r,y))),new Ot(pi,wn,new m((c,f,h=c.tile())=>new mm(h,f,c,r))),new Ot(wn,new m((c,f,h=c.tile())=>new Xi(h,f,c,r))),new Ot(pi,wn,new l(c=>c instanceof We),new l((c,f,h=c.tile())=>h.isLand()),new l((c,f,h=c.tile())=>!uR(h,e)),new m((c,f,h=c.tile())=>new cm(h,f,c,i,r))),...[[we,bs,new On(new l((c,f,h=c.tile())=>h.terrain()instanceof ee),new l((c,f,h=c.tile())=>h.getAdjacent().some(U=>U.terrain()instanceof ee||U.terrain()instanceof Jt||o.getByTile(U).some(D=>D instanceof we)&&!uR(U,e))))],[$e,Cs],[ke,Ts],[ir,Ps,new l((c,f)=>o.getByTile(f).some(h=>h instanceof ke))]].map(([c,f,...h])=>new Ot(new l(U=>U instanceof dr),pi,new l((U,D,A=U.tile())=>r.get(Vm).some(E=>E.validate(A,c,U.player()))),wn,...h,new m((U,D,A=U.tile())=>new f(A,D,U,r,y)))),...[[Ze,Gs],[qe,Is],[ie,Es],[Qe,Bs]].map(([c,f])=>new Ot(pi,wn,new l(h=>h instanceof dr),new l((h,U,D=h.tile())=>D.terrain()instanceof c),new m((h,U,D=h.tile())=>new f(D,U,h,r,p,y)))),new Ot(Ql,pi,Ud,new l((c,f)=>f.terrain()instanceof Jt),new l((c,f)=>s.getByTile(f).every(h=>h.player()===c.player())),new l((c,f)=>s.getByTile(f).filter(h=>h instanceof zt).some(h=>h.hasCapacity()&&h.canStow(c))),new m((c,f,h=c.tile())=>{let[U]=s.getByTile(f).filter(D=>D instanceof zt).filter(D=>D.hasCapacity()&&D.canStow(c));return new pm(h,f,c,U,r)})),new Ot(Ql,new l(c=>{try{return u.getByUnit(c),!0}catch{return!1}}),new On(new l((c,f)=>!(c instanceof ot)),new l((c,f)=>f.isLand())),new l((c,f,h=c.tile())=>u.getByUnit(c).transport().tile()===h),new m((c,f,h=c.tile())=>{let U=u.getByUnit(c).transport();return new Us(h,f,c,U,r)})),new Ot(pi,wn,new l(c=>c instanceof zt),new l(c=>c.hasCargo()),new l((c,f)=>f.getNeighbours().some(h=>h.isLand())),new m((c,f,h=c.tile())=>new ym(h,f,c,r)))],"getRules"),ND=DN});var EN,WD,jD=n(()=>{la();Hg();w();T();Ep();EN=t((i=or)=>[new Xl(new l(e=>e.moves().value()>0),new m(e=>e.setActive())),new Xl(new l(e=>e.busy()!==null),new m(e=>e.setBusy())),...[di].map(e=>new Xl(new l(r=>i.getByUnit(r).some(o=>o instanceof e)),new m(r=>i.unregister(...i.getByUnit(r).filter(o=>o instanceof e)))))],"getRules"),WD=EN});var FN,HD,_D=n(()=>{sr();rp();gn();He();w();T();Dn();FN=t((i=N)=>[new Zt(new l((e,r)=>Object.prototype.isPrototypeOf.call(Le,r)),new m(e=>new l(()=>e.tile().isCoast()))),...[[xo,Vr],[vo,co],[bo,Ri],[Di,jr],[To,Ri],[Co,Bi],[Ei,xr],[Fi,fn],[Po,zr],[Io,vr],[Xr,so],[ki,Nt],[Ir,mn],[Si,uo],[Yi,oo],[wo,pn],[zi,yt],[Ao,mo],[Go,Nr],[Ni,nr],[Li,Yr],[Bo,Wt],[wr,Pi],[Uo,ut],[Mo,xt],[Ar,Wr]].map(([e,r])=>new Zt(new l((o,a)=>a===e),new m(o=>new l(()=>i.getByPlayer(o.player()).completed(r))))),...[[Di,Vr],[Ei,jr],[Fi,oo],[ki,xt],[Ir,Nr],[Si,zr],[Yi,ut],[zi,Nr],[Ni,Nt],[Li,yt],[wr,Nr],[Ar,nr],[Do,yt]].map(([e,r])=>new Zt(new l((o,a)=>a===e),new m(o=>new l(()=>!i.getByPlayer(o.player()).completed(r)))))],"getRules"),HD=FN});var kN,KD,qD=n(()=>{op();gn();kN=t(()=>[...[[xo,80],[vo,160],[bo,120],[Di,40],[Co,50],[To,160],[Ei,40],[Fi,40],[Po,80],[Io,30],[Xr,60],[ki,40],[Ir,20],[Si,50],[Yi,40],[wo,50],[zi,30],[Ao,160],[Go,30],[Ni,40],[We,40],[Li,20],[Bo,50],[wr,20],[Uo,80],[Mo,50],[Ar,40],[Do,10]].flatMap(([i,e])=>Ll(i,e))],"getRules"),KD=kN});var SN,VD,JD=n(()=>{rr();np();w();T();gn();SN=t((i=ye)=>[new Jn(new l((e,r)=>r instanceof We),new m(e=>i.getByCity(e.city()).shrink()))],"getRules"),VD=SN});var YN,$D,ZD=n(()=>{K();_e();Zc();T();YN=t((i=z,e=P)=>[new Qn(new m(r=>i.register(r))),new Qn(new m(r=>r.applyVisibility())),new Qn(new m(r=>r.moves().set(r.movement()))),new Qn(new m(r=>{e.emit("unit:created",r)}))],"getRules"),$D=YN});var zN,QD,XD=n(()=>{K();_e();Ip();T();zN=t((i=z,e=P)=>[new qo(new m(r=>{r.setDestroyed(),i.unregister(r)})),new qo(new m((r,o)=>{e.emit("unit:defeated",r,o)}))],"getRules"),QD=zN});var NN,eE,tE=n(()=>{K();la();_e();Xc();T();NN=t((i=z,e=or,r=P)=>[new Xn(new m((o,a)=>{r.emit("unit:destroyed",o,a)})),new Xn(new m(o=>i.unregister(o))),new Xn(new m(o=>{o.setActive(!1),o.setDestroyed()})),new Xn(new m(o=>e.getByUnit(o).forEach(a=>e.unregister(a))))],"getRules"),eE=NN});var Md,Jm,cR=n(()=>{G();Md=class extends g{};t(Md,"LostAtSea");Jm=Md});var LN,rE,iE=n(()=>{K();T();cR();LN=t((i=P)=>[new Jm(new m(e=>{i.emit("unit:lost-at-sea",e)})),new Jm(new m(e=>e.destroy(null)))],"getRules"),rE=LN});var WN,oE,nE=n(()=>{fm();K();I();gm();w();T();cR();At();Dn();gn();rt();WN=t((i=Un,e=d,r=()=>Math.random(),o=P,a=j)=>[new q(new m((s,p)=>{o.emit("unit:moved",s,p)})),new q(new m(s=>s.applyVisibility())),new q(new l(s=>s.moves().value()<=.1),new m(s=>s.moves().set(0))),new q(new l(s=>s.moves().value()<.1),new m(s=>s.setActive(!1))),new q(new l(s=>s instanceof zt),new l((s,p)=>p instanceof kt),new l(s=>s.hasCargo()),new m((s,p)=>s.cargo().forEach(u=>u.action(p.forUnit(u))))),new q(new l((s,p)=>p instanceof Us),new m(s=>{let p=i.getByUnit(s);p.transport().unload(s),i.unregister(p)})),new q(new l(s=>s instanceof Ar),new l(s=>s.moves().value()===0),new l(s=>!s.tile().isCoast()),new l(()=>r()<=.5),new m(s=>{e.process(Jm,s)})),new q(new l(s=>s instanceof Xr),new l(s=>s.moves().value()===0),new l(s=>a.getByTile(s.tile())!==null),new m(s=>{e.process(Jm,s)}))],"getRules"),oE=WN});var aE,jN,sE,lE=n(()=>{to();Dn();fm();En();gi();gm();w();T();yi();aE=[[Gt,2],[be,1],[qe,2],[fe,1],[Ae,2],[Ze,2],[Se,3],[it,1],[ie,1],[ee,1],[Qe,2],[mt,1]],jN=t((i=Ne,e=Un)=>[...aE.map(([r,o])=>new ve(new l((a,s)=>s instanceof kt),new l(a=>a instanceof ot),new l((a,s)=>s.to().terrain()instanceof r),new m(()=>o))),new ve(new l((r,o)=>o instanceof kt),new l(r=>r instanceof St||r instanceof Le),new m(()=>1)),new ve(new l((r,o)=>o instanceof kt),new l(r=>r instanceof ot),new l((r,o)=>i.getByTile(o.from()).some(a=>a instanceof ke)),new l((r,o)=>i.getByTile(o.to()).some(a=>a instanceof ke)),new m(()=>1/3)),new ve(new l((r,o)=>o instanceof kt),new l(r=>r instanceof ot),new l((r,o)=>i.getByTile(o.from()).some(a=>a instanceof ir)),new l((r,o)=>i.getByTile(o.to()).some(a=>a instanceof ir)),new m(()=>0)),new ve(new l((r,o)=>o instanceof kt),new l(r=>r instanceof ot),new l(r=>{try{return e.getByUnit(r),!0}catch{return!1}}),new l(r=>e.getByUnit(r).transport()instanceof zt),new m(()=>0)),...[[bs,2],[Cs,3],[Ts,1],[Ps,2],[Is,2],[Gs,3],[Bs,3],[Ms,1],[Ds,1],[Es,3],[ma,0]].flatMap(([r,o])=>aE.map(([a,s])=>new ve(new l((p,u)=>u instanceof r),new l(p=>p.tile().terrain()instanceof a),new m(()=>o*s))))],"getRules"),sE=jN});var HN,mE,pE=n(()=>{pg();_e();Zn();w();T();HN=t((i=z)=>[new ht(new l(e=>i.getByPlayer(e).some(r=>r.active()&&r.moves().value())),new m(e=>i.getByPlayer(e).filter(r=>r.active()&&r.moves().value()>0).sort((r,o)=>(r.waiting()?1:0)-(o.waiting()?1:0)).map(r=>new Va(e,r)))),new ht(new l(e=>i.getByPlayer(e).some(r=>!r.active()||!r.moves().value())),new m(e=>i.getByPlayer(e).filter(r=>!r.active()||r.moves().value()===0).sort((r,o)=>(r.waiting()?1:0)-(o.waiting()?1:0)).map(r=>new Ja(e,r))))],"getRules"),mE=HN});var _N,uE,cE=n(()=>{T();lh();Oh();_N=t(()=>[new tf(new m(i=>i.action(new fv(i.tile(),i.tile(),i))))],"getRules"),uE=_N});var KN,yE,fE=n(()=>{Zl();gn();Ep();I();la();em();em();w();T();KN=t((i=or,e=d)=>[...[[xo,12,2,2],[vo,18,12,4,2],[bo,12,1,8,2],[Di,8],[Co,0],[To,1,12,5,2],[Ei,6],[Fi,4,1,2],[Po,6,6,6,2],[Io,0,0,2],[Xr,4,2,10,2],[ki,2,2,3],[Ir,2,1,2],[Si,4,4,4],[Yi,4,2,2],[wo,6,6,3],[zi,3,2],[Ao,99,0,16],[Go,3,5],[Ni,1,1,3],[We,0],[Li,1,2],[Bo,8,2,3,2],[wr,3],[Uo,10,5,3],[Mo,0,3,4],[Ar,1,0,3],[Do]].flatMap(([r,o=1,a=1,s=1,p=1])=>yx(r,o,a,s,p)),...[[di,1,mi],[pa,.5,Vi,mi]].flatMap(([r,o,...a])=>a.map(s=>new sl(new l((p,u)=>u instanceof s),new l(p=>i.getByUnit(p).some(u=>u instanceof r)),new m((p,u)=>{let y=new s;e.process(fs,p.constructor,y),u.add(y.value()*o,r.name)}))))],"getRules"),yE=KN});var qN,dE,gE=n(()=>{K();T();Sf();qN=t((i=P)=>[new xl(new m((e,r)=>{i.emit("unit:unsupported",e,r)}))],"getRules"),dE=qN});var VN,hE,OE=n(()=>{w();T();oh();VN=t((i=()=>Math.random())=>[new wp(new l((e,r)=>e.moves().value()>=r),new m((e,r)=>(e.moves().subtract(r),!0))),new wp(new l((e,r)=>e.moves().value()<r),new m((e,r)=>{let o=e.moves().value();return e.moves().set(0),o>=r*.5*i()}))],"getRules"),hE=VN});var JN={};var RE=n(()=>{LD();jD();_D();qD();JD();ZD();XD();tE();I();iE();nE();lE();pE();cE();fE();gE();OE();d.register(...ND(),...WD(),...HD(),...KD(),...VD(),...$D(),...QD(),...eE(),...rE(),...oE(),...sE(),...mE(),...uE(),...yE(),...dE(),...hE())});var vE=b(xE=>{"use strict";Object.defineProperty(xE,"__esModule",{value:!0});YD();RE()});var Nn,bE=n(()=>{Ie();Nn=class extends Oe{};t(Nn,"ApolloProgram")});var Gr,CE=n(()=>{Ie();Gr=class extends xe{};t(Gr,"Colossus")});var ti,TE=n(()=>{Ie();ti=class extends xe{};t(ti,"CopernicusObservatory")});var So,PE=n(()=>{Ie();So=class extends Oe{};t(So,"CureForCancer")});var Ln,IE=n(()=>{Ie();Ln=class extends Oe{};t(Ln,"DarwinsVoyage")});var Br,wE=n(()=>{Ie();Br=class extends xe{};t(Br,"GreatLibrary")});var Yo,AE=n(()=>{Ie();Yo=class extends xe{};t(Yo,"GreatWall")});var ri,GE=n(()=>{Ie();ri=class extends xe{};t(ri,"HangingGardens")});var Wn,BE=n(()=>{Ie();Wn=class extends Oe{};t(Wn,"HooverDam")});var zo,UE=n(()=>{Ie();zo=class extends Oe{};t(zo,"IsaacNewtonsCollege")});var ji,ME=n(()=>{Ie();ji=class extends Oe{};t(ji,"JsBachsCathedral")});var ii,DE=n(()=>{Ie();ii=class extends Oe{};t(ii,"Lighthouse")});var No,EE=n(()=>{Ie();No=class extends xe{};t(No,"MagellansExpedition")});var jn,FE=n(()=>{Ie();jn=class extends Oe{};t(jn,"ManhattanProject")});var Ur,kE=n(()=>{Ie();Ur=class extends Oe{};t(Ur,"MichelangelosChapel")});var qt,SE=n(()=>{Ie();qt=class extends xe{};t(qt,"Oracle")});var Lo,YE=n(()=>{Ie();Lo=class extends xe{};t(Lo,"Pyramids")});var Wo,zE=n(()=>{Ie();Wo=class extends Oe{};t(Wo,"SetiProgram")});var Mr,NE=n(()=>{Ie();Mr=class extends Oe{};t(Mr,"ShakespearesTheatre")});var Hn,LE=n(()=>{Ie();Hn=class extends Oe{};t(Hn,"UnitedNations")});var Hi,WE=n(()=>{Ie();Hi=class extends Oe{};t(Hi,"WomensSuffrage")});var Ka=n(()=>{bE();CE();TE();PE();IE();wE();AE();GE();BE();UE();ME();DE();EE();FE();kE();SE();YE();zE();NE();LE();WE()});var $N={};var jE=n(()=>{Ka();Nl();bn.register(Nn,Gr,ti,So,Ln,Br,Yo,ri,Wn,zo,ji,ii,No,jn,Ur,qt,Lo,Wo,Mr,Hn,Hi)});var Dd,It,_n=n(()=>{Ce();Ie();Dd=class extends F{constructor(){super(xe)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.filter(r=>r.city().player()===e)}};t(Dd,"WonderRegistry");It=new Dd});var ZN,HE,_E=n(()=>{Ka();sr();rp();He();_n();w();T();Ie();ZN=t((i=N,e=It)=>[new Zt(new l((r,o)=>Object.isPrototypeOf.call(xe,o)),new m((r,o)=>new l(()=>e.filter(a=>a instanceof o).length===0))),...[[Gr,Yr],[ti,xi],[Br,Rr],[Yo,Lt],[ri,cn],[ii,Wr],[No,nr],[qt,bi],[Lo,Lt],[Nn,po],[So,ln],[Ln,qr],[Wn,ct],[zo,fo],[ji,vt],[jn,_r],[Ur,vt],[Wo,Ci],[Mr,Ii],[Hn,Rt],[Hi,xt]].map(([r,o])=>new Zt(new l((a,s)=>s===r),new m(a=>new l(()=>i.getByPlayer(a.player()).completed(o)))))],"getRules"),HE=ZN});var QN,KE,qE=n(()=>{Ka();op();QN=t(()=>[...[[Nn,600],[Gr,200],[ti,300],[So,600],[Ln,300],[Br,300],[Yo,300],[ri,300],[Wn,600],[zo,400],[ji,400],[ii,200],[No,400],[jn,600],[Ur,300],[qt,300],[Lo,300],[Wo,600],[Mr,400],[Hn,600],[Hi,600]].flatMap(([i,e])=>Ll(i,e))],"getRules"),KE=QN});var XN,VE,JE=n(()=>{$n();K();_n();np();w();T();Ie();XN=t((i=Qt,e=It,r=P)=>[new Jn(new l((o,a)=>a instanceof xe),new m((o,a)=>{let s=a.constructor;e.register(a),i.filter(p=>p.building()?.item()===s).forEach(p=>p.revalidate())})),new Jn(new l((o,a)=>a instanceof xe),new m((o,a)=>{r.emit("wonder:built",a,o.city())}))],"getRules"),VE=XN});var $m,_i,Xp=n(()=>{_n();w();$m=t((i,e=It)=>new l(r=>e.getByCity(r).some(o=>o instanceof i)),"cityHasWonder"),_i=t((i,e=It)=>new l(r=>e.getByPlayer(r.player()).some(o=>o instanceof i)),"playerHasWonder")});var $E,Rn,Ed,eu=n(()=>{He();w();$E=t((i,e=N)=>new l(r=>e.getByPlayer(r.player()).completed(i)),"discoveredByPlayer"),Rn=t((i,e=N)=>new l(()=>i===null||!e.some(r=>r.completed(i))),"notDiscoveredByAnyPlayer"),Ed=t((i,e=N)=>new l(r=>i===null||!e.getByPlayer(r.player()).completed(i)),"notDiscoveredByPlayer")});var Fd,ZE=n(()=>{ur();w();Fd=t((i,e=Re)=>new l(r=>e.getByCity(r).some(o=>o instanceof i)),"hasCityImprovement")});var e1,QE,XE=n(()=>{Mi();ur();sr();Ka();on();He();_e();_n();Xp();eu();El();w();T();qn();zm();Za();js();ZE();Zi();e1=t((i=Re,e=pt,r=N,o=z,a=It)=>[new et(new Xe,_i(qt,a),Fd(Bt,i),Ed(jt,r),Rn(vt,r),new m((s,p)=>new Ue(-Math.min(1,Ke(p,Ue)),qt.name))),new et(new Xe,_i(qt,a),Fd(Bt,i),$E(jt,r),Rn(vt,r),new m((s,p)=>new Ue(-Math.min(2,Ke(p,Ue)),qt.name))),new et(new Fr(4e3),$m(Mr,a),Rn(ct,r),new m((s,p)=>new Ue(-Ke(p,Ue),Mr.name))),new et(new Xe,_i(ji,a),new m((s,p)=>new Ue(-Math.min(2,Ke(p,Ue)),ji.name))),new et(new Xe,_i(Ur,a),Fd(mr,i),Rn(Rt,r),new m((s,p)=>new Ue(-Math.min(4,Ke(p,Ue)),Ur.name))),new et(new Xe,_i(Hi,a),new l((s,p)=>p.some(u=>u instanceof Ia)),new m((s,p)=>p.flatMap(u=>u instanceof Ia?new Ue(-1,Hi.name):[])))],"getRules"),QE=e1});var t1,eF,tF=n(()=>{_n();Zs();w();T();t1=t((i=It)=>[new yr(new l(e=>i.getByCity(e).length>0),new m(e=>i.getByCity(e).forEach(r=>i.unregister(r))))],"getRules"),eF=t1});var r1,rF,iF=n(()=>{Ka();sr();js();He();_n();Xp();zl();T();Za();eu();r1=t((i=N,e=It)=>[new Ho(new Fr(500),$m(Gr,e),Rn(hr,i),new m(r=>new re(r.tilesWorked().filter(o=>o.yields().some(a=>a instanceof re)).length,Gr.name))),...[[ri,1,Or],[So,1,null]].map(([r,o,a])=>new Ho(_i(r,e),Rn(a,i),new m(()=>new Fo(o,r.name))))],"getRules"),rF=r1});var i1,oF,nF=n(()=>{Ka();He();_n();Xp();sr();T();qn();js();Wu();eu();Zi();i1=t((i=N,e=It)=>[...[[ti,Kt,1,ut]].map(([r,o,a,s])=>new Qs(new Xe,$m(r,e),Rn(s,i),new m((p,u)=>new o(Ke(u,o)*a,r.name)))),...[[Wo,Kt,.5,null]].map(([r,o,a,s])=>new Qs(new Xe,_i(r,e),Rn(s,i),new m((p,u)=>new o(Ke(u,o)*a,r.name))))],"getRules"),oF=i1});var kd,Sd,yR=n(()=>{G();kd=class extends g{};t(kd,"Obsolete");Sd=kd});var o1,aF,sF=n(()=>{sr();Ka();He();I();_n();Ou();w();T();yR();o1=t((i=N,e=d,r=It)=>[new Xa(new l(()=>r.some(o=>o instanceof Br)),new l((o,a)=>{let[s]=r.filter(u=>u instanceof Br).map(u=>u.city().player());return!i.getByPlayer(s).completed(a.sourceClass())}),new l((o,a)=>i.filter(s=>s.completed(a.sourceClass())).length>=3),new m((o,a)=>{let[s]=r.filter(u=>u instanceof Br).map(u=>u.city().player());return i.getByPlayer(s).addAdvance(a.sourceClass())})),...[[Gr,hr],[ti,ut],[Br,ar],[Yo,yt],[ri,Or],[zo,_r],[ii,Nt],[Ur,Rt],[qt,vt],[Lo,Rt],[Mr,ct]].map(([o,a])=>new Xa(new l(()=>r.entries().some(s=>s instanceof o)),new l((s,p)=>p instanceof a),new m(()=>{let[s]=r.filter(p=>p instanceof o);e.process(Sd,s,s.city())})))],"getRules"),aF=o1});var n1,lF,mF=n(()=>{Ka();He();_n();w();T();qn();sr();Zl();Dn();em();eu();Xp();n1=t((i=It,e=N)=>[new dp(new Xe,new l((r,o)=>o instanceof Ji),new l(r=>r instanceof Le),_i(ii,i),Ed(Nt,e),new m((r,o)=>o.add(1))),new dp(new Xe,new l((r,o)=>o instanceof Ji),new l(r=>r instanceof Le),_i(No,i),new m((r,o)=>o.add(1)))],"getRules"),lF=n1});var a1,pF,uF=n(()=>{K();T();yR();a1=t((i=P)=>[new Sd(new m((e,r)=>{i.emit("wonder:obsolete",e,r)}))],"getRules"),pF=a1});var s1={};var cF=n(()=>{_E();qE();JE();XE();tF();iF();nF();I();sF();mF();uF();d.register(...HE(),...KE(),...VE(),...QE(),...eF(),...rF(),...oF(),...aF(),...lF(),...pF())});var fF=b(yF=>{"use strict";Object.defineProperty(yF,"__esModule",{value:!0});jE();cF()});var l1,dF,gF=n(()=>{to();En();He();sr();gi();pR();w();l1=t((i=N,e=Ne)=>[...[[we,be,fe,Ae,ie,ee],[$e,be,Ae,Se],[ke,Gt,be,qe,fe,Ae,Ze,Se,ie,Qe,mt]].map(([r,...o])=>new Vm(new l((a,s)=>s===r),new l(a=>o.some(s=>a.terrain()instanceof s)),new l((a,s)=>!e.getByTile(a).some(p=>p instanceof s)))),...[[ke,io,ee]].map(([r,o,...a])=>new Vm(new l((s,p)=>p===r),new l(s=>a.some(p=>s.terrain()instanceof p)),new l((s,p)=>!e.getByTile(s).some(u=>u instanceof p)),new l((s,p,u)=>i.getByPlayer(u).completed(o)))),...[[ir,qr,ke,Gt,be,qe,fe,Ae,Ze,Se,ie,ee,Qe,mt]].map(([r,o,a,...s])=>new Vm(new l((p,u)=>u===r),new l(p=>s.some(u=>p.terrain()instanceof u)),new l((p,u)=>!e.getByTile(p).some(y=>y instanceof u)),new l(p=>e.getByTile(p).some(u=>u instanceof a)),new l((p,u,y)=>i.getByPlayer(y).completed(o))))],"getRules"),dF=l1});var m1,hF,OF=n(()=>{K();En();gi();Cy();w();T();m1=t((i=Ne,e=P)=>[new sa(new l((r,o)=>i.getByTile(r).every(a=>o.constructor!==a.constructor)),new m((r,o)=>i.register(o))),new sa(new m(r=>r.clearYieldCache(null))),new sa(new m((r,o)=>{e.emit("tile-improvement:built",r,o)})),...[[$e,we],[we,$e]].map(([r,o])=>new sa(new l((a,s)=>s instanceof r),new l(a=>i.getByTile(a).some(s=>s instanceof o)),new m(a=>i.unregister(...i.getByTile(a).filter(s=>s instanceof o)))))],"getRules"),hF=m1});var Yd,zd,fR=n(()=>{Ki();fi();Yd=class extends Ee{constructor(){super(ze)}};t(Yd,"AvailableTerrainFeatureRegistry");zd=new Yd});var p1,RF,xF=n(()=>{fR();I();hg();T();sm();p1=t((i=d,e=zd)=>[new Eu(new m(r=>{let o=i.get(ws);e.entries().forEach(a=>o.filter(s=>s.validate(a,r)).forEach(s=>s.process(a,r)))}))],"getRules"),RF=p1});var Ut,dR=n(()=>{G();Ut=class extends g{};t(Ut,"Distribution")});var u1,vF,bF=n(()=>{to();dR();$t();w();T();u1=t(()=>[new Ut(new l(i=>i===Gt),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:0,to:.01,fill:!0},{from:.01,to:.02},{from:.98,to:.99},{from:.99,to:1,fill:!0}])),new Ut(new l(i=>i===be),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.4,to:.45},{from:.45,to:.55,coverage:.025,cluster:!0,clusterChance:.1},{from:.55,to:.6}])),new Ut(new l(i=>i===qe),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.05,to:.2},{from:.2,to:.4,cluster:!0,clusterChance:.1,coverage:.1},{from:.4,to:.6},{from:.6,to:.8,cluster:!0,clusterChance:.1,coverage:.1},{from:.8,to:.95}])),new Ut(new l(i=>i===fe),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{fill:!0}])),new Ut(new l(i=>i===Ae),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.1,to:.9,path:!0,pathChance:.1,coverage:.06}])),new Ut(new l(i=>i===Ze),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.3,to:.45,cluster:!0,clusterChance:.2,coverage:.08},{from:.55,to:.7,cluster:!0,clusterChance:.2,coverage:.08}])),new Ut(new l(i=>i===Se),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.01,to:.1,coverage:.3,path:!0},{from:.1,to:.9,path:!0},{from:.9,to:.99,coverage:.3,path:!0}])),new Ut(new l(i=>i===it),new l((i,e)=>e.some(r=>r.constructor===Jt)),new m(()=>[{fill:!0}])),new Ut(new l(i=>i===ie),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.01,to:.2,coverage:.3},{from:.2,to:.4},{from:.1,to:.4,cluster:!0},{from:.4,to:.6},{from:.6,to:.8},{from:.6,to:.9,cluster:!0},{from:.8,to:.99,coverage:.3}])),new Ut(new l(i=>i===ee),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.1,to:.9,coverage:.1,path:!0,pathChance:.5}])),new Ut(new l(i=>i===Qe),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.2,to:.4,cluster:!0},{from:.6,to:.8,cluster:!0}])),new Ut(new l(i=>i===mt),new l((i,e)=>e.some(r=>r instanceof W)),new m(()=>[{from:.01,to:.15,cluster:!0,coverage:.15},{from:.85,to:.99,cluster:!0,coverage:.15}]))],"getRules"),vF=u1});var Nd,Ld,gR=n(()=>{G();Nd=class extends g{};t(Nd,"DistributionGroups");Ld=Nd});var c1,CF,TF=n(()=>{to();T();gR();c1=t(()=>[new Ld(new m(()=>[it,fe,Qe,Se,Ze,Ae,qe,be,ie,mt,Gt,ee]))],"getRules"),CF=c1});var y1,PF,IF=n(()=>{to();Up();Jo();sm();y1=t((i=lt)=>[...[[Zo,.2,Ae],[Qo,.2,it],[hi,.2,qe,mt],[Xo,.2,Ze],[en,.2,Se],[eo,.2,ie],[Oi,.2,be],[tn,.2,Qe],[rn,.2,Gt],[$o,.5,fe,ee]].flatMap(([r,o,...a])=>a.flatMap(s=>_x(s,r,o,i)))],"getRules"),PF=y1});var Wd,jd,wF=n(()=>{G();Wd=class extends g{};t(Wd,"Pillaged");jd=Wd});var f1,AF,GF=n(()=>{K();gi();wF();w();T();f1=t((i=Ne,e=P)=>[new jd(new l((r,o)=>i.getByTile(r).includes(o)),new m((r,o)=>i.unregister(o))),new jd(new m(r=>r.clearYieldCache(null))),new jd(new m((r,o)=>{e.emit("tile-improvement:pillaged",r,o)}))],"getRules"),AF=f1});var d1,xn,hR=n(()=>{d1=t((i,e,r,o)=>{for(;r<0;)r+=e;for(;o<0;)o+=i;return r=r%e,o=o%i,o*e+r},"coordsToIndex"),xn=d1});var g1,Tl,Hd=n(()=>{g1=t((i,e,r)=>{let o=i*e;for(;r<0;)r+=o;return r=r%o,[r%e,Math.floor(r/e)]},"indexToCoords"),Tl=g1});var h1,BF,UF=n(()=>{Hd();h1=t((i,e,r,o)=>{let[a,s]=Tl(i,e,r),[p,u]=Tl(i,e,o),y=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[c]=y.map(([f,h])=>[f*e,h*i]).map(([f,h])=>[a-p+f,s-u+h]).map(f=>Math.hypot(...f)).sort((f,h)=>f-h);return c},"distanceFrom"),BF=h1});var O1,Pl,OR=n(()=>{hR();Hd();O1=t((i,e,r,o=!0)=>{let[a,s]=Tl(i,e,r),p=xn(i,e,a,s-1),u=xn(i,e,a+1,s-1),y=xn(i,e,a+1,s),c=xn(i,e,a+1,s),f=xn(i,e,a,s+1),h=xn(i,e,a-1,s+1),U=xn(i,e,a-1,s),D=xn(i,e,a-1,s-1);return o?[p,y,f,U]:[p,u,y,c,f,h,U,D]},"getNeighbours"),Pl=O1});var Zm,_d,Kd=n(()=>{hR();UF();OR();Hd();Zm=class{#e;#t;#r;constructor(e,r,o={}){this.#e=e,this.#t=o,this.#r=r}coordsToIndex(e,r){return xn(this.#e,this.#r,e,r)}distanceFrom(e,r){return BF(this.#e,this.#r,e,r)}generate(){throw new Error(`Generator#generate(): Must be overridden in '${this.constructor.name}'.`)}getNeighbours(e,r=!0){return Pl(this.#e,this.#r,e,r)}height(){return this.#e}indexToCoords(e){return Tl(this.#e,this.#r,e)}options(){return this.#t}width(){return this.#r}};t(Zm,"Generator");_d=Zm});var R1,MF,DF,qd,EF,RR=n(()=>{XO();mh();ph();Hy();Kd();lm();uh();ch();yh();fh();Gp();Vy();dh();gh();R1={A:gv,D:hv,F:jy,G:As,H:Ov,J:Rv,M:xv,O:vv,P:am,R:qy,S:bv,T:Cv},MF=new Map;[[ca,{x:12,y:18}],[ya,{x:5,y:23}],[fa,{x:45,y:22}],[da,{x:67,y:19}],[ga,{x:41,y:24}],[ha,{x:31,y:14}],[Oa,{x:33,y:16}],[Ra,{x:38,y:15}],[xa,{x:39,y:18}],[va,{x:57,y:26}],[ba,{x:49,y:19}],[Ca,{x:36,y:19}],[Ta,{x:44,y:12}],[Pa,{x:42,y:42}]].forEach(([i,e])=>MF.set(i,e));DF=t((i,e)=>{let{x:r,y:o}=MF.get(e.sourceClass());return i.get(r,o)},"startSquare"),qd=class extends _d{async generate(){return Array.from(`OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOAAAAAAAOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOAAOAOAAAOAAAAAAAAOOOOOOAOOOOOGGOOOOOTAGOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOTTTTAOOOOAAAAAAAAOOOOAAAAAATOOOOOAAOOOOOOOOOOOOOOOAAOOOOOTOOOOOOOOOOOOOOOOOO
OOOTTTTTTTTTAAOAOAAAAAOOOAAAAATOOOOOOOOOOOOOOOAOOOOOFFAAFFFFFOOFFFOOOOFFFOOOOOOO
OTPTGPPPPTTTTTOTAAAOOAOOOAAAATOOOOOOOOOOOOOOOAOOAAOFFGAFFFFFFFAFFFFFFFFFFOTOOOOO
OOOOOPGTPTOOTTAAAAAAAAOOAAGGOOOOOOOOOOGAAOOOOOOGOGFFFGFFFFFFFFAFFAFFFFFGFGGOOOOO
OOOOOGGFGPPTTAAOOOAOTOOOAGOOOOAOOOOOOAFGFPGFOAAFGTGFFFFFFFFFFFFFFFGFFGOGFFOOOOOO
OOOOPMGFPPPPTTOOOATAAOOOOOOOOOOOOOOOGFPGGFOFFFFFFGFFFFFFFFFFFFFFGFFFFGOOFOOOOOOO
OOOOPMGFGPPOTTTAATTTTOOOOOOOOOOHOOOPFGOGGGFFFGFGGGFFFFFFFFFFFFFFFFFFOOOOFGOOOOOO
OOOOPHFFGPGOPPPOPTTTTOOOOOOOOOGROOOOOPOGFGFFGFFFGFGFGGFGGFFFGFFFFFFFGOOOOPOOOOOO
OOOOGGHFGPPPPPPPPPTPPOOOOOOOOOOFOOOFOOOFFFRFFFFRGFPFFPFGPFGFFOFFFFFGPPGOOOOOOOOO
OOOGGGMGGGPPPOPPPPPOPOOOOOOOOOGGOOOGPPFFFGRRFRRRGGFGGGGGPGGFFFFDPPPPPPOOOOOOOOOO
OOOGGFMGRGRPGORRGOPOOOOOOOOOOOOOOGRGGGGFFGFRFRPGPGGGGGPPPPPPPPPPPPPPGPGOOOOOOOOO
OOGGGMMGRGRGGGGOOOOOOOOOOOOOOOOOGGRMMGGGGPGRPRRPPPPPPPPPPPPPPPPPPPPPGPGOPGOOOOOO
OOGGPPHGRRRGGGOOOOOOOOOOOOOOOOOOPGGGGFGRRGPRPDOOPPOPPPDPDDDPPPPPPDPPPGOOGOOOOOOO
OOGFPPFGGRGGGPOOOOOOOOOOOOOOOOPPPPOGHOOGRFOOOHPOGPPDPDPDDPPPPPPDDPPOPGOOMGOOOOOO
OOGPPDDGGRGGOOOOOOOOOOOOOOOOOOPPPOOOGHOOOGPPPPPOPPPPDPPHPDDDDDDPPPGOOOOOOPOOOOOO
OOPOGDDPOOOPOOOOOOOOOOOOOOOOOOOOOOOOOGOOOOOPPPPGPPPPPPHHMHHHHHHHHMHPGOOGOOOOOOOO
OOPOGDDOOOOPOOOOOOOOOOOOOOOOOOGPPDDOOOOOOOOPPRRHPPPDPPHPGHMMMMMHHHPPPGOOOOOOOOOO
OOOOGDGOOOOOOOOOOOOOOOOOOOOOOODPHHPPPGODPOPPPGRRPPPPPHHRDPGMHHMHHPPRRROOOOOOOOOO
OOOOGGPOPOOOGPOOOOOOOOOOOOOOOPPHDDDPPPPDDRGDPPDOPPPPHPRRDGGGHHHHHPGPPPOOOOOOOOOO
OOOOOGGPGOOOOGPOOOOOOOOOOOOOPPDDDDDPDDDDDRDOPDDOOOOHHRRDPGGRGGGHGPGGPOOOOOOOOOOO
OOOOOOOOGGOOOOOOOOOOOOOOOOOOPDDDDDDDDDDDSRSODDDDDDOOOOPPGGGRRPPGFGGGOOOGOOOOOOOO
OOOOOOOOOGOOOOOOOOOOOOOOOOOPDDDDDDPPPDDDDRDOOPDDDDPOOOOGGGGGOOGGGGGOOOOPGOOOOOOO
OOOOOOOOOPPOGPPGOOOOOOOOOOODDDDDDDPDDDDDDRDDOODDDDOOOOOOGGGOOOPPGGOOOOOGGOOOOOOO
OOOOOOOOOOPGFPPPGOOOOOOOOOODDDDDDDDPDPDPPDHHDOOPDOOOOOOOGGOOOOOGGGGOOOOOFGOOOOOO
OOOOOOOOOOOGHGGGGGGOOOOOOOOPPDPPPPDDDPPPPPPMDPOOGOOOOOOOPGOOOOOOOGGOOOOOOGOOOOOO
OOOOOOOOOOOHJJJGGGGROOOOOOOOPPDPPPPPPPPPPPPHMDPOOOOOOOOOOGOOOOOOOOOOOPOOOOOOOOOO
OOOOOOOOOOGHJRRJJRRRGOOOOOOOOPPPGOPPGPGGGGGGMDDPOOOOOOOOOOOOOOOOOOOGPPOOGPOOOOOO
OOOOOOOOOOPGJJRRRRJGFGGOOOOOOOOOOOOGGGGJJJGGODPPOOOOOOOOOOOOOOOGFGOOPGFGGGOGOOOO
OOOOOOOOOOOFGGJJGJJFGGGPOOOOOOOOOOOGGJJRRRGGHPPOOOOOOOOOOOOOOOOOGFOOGOPGOOOPGGOO
OOOOOOOOOOOGHGGGGGGGGGGOOOOOOOOOOOOGGRRRJJHOGGOOOOOOOOOOOOOOOOOOOGOOOOOOOOOOOGGO
OOOOOOOOOOOOGMFGGGGGGPOOOOOOOOOOOOOOGRJJJGHMGOOOOOOOOOOOOOOOOOOOOPPOOOOOGOOOOOOO
OOOOOOOOOOOOGFMGGFGPPPOOOOOOOOOOOOOORRGGGGGMPOOOOOOOOOOOOOOOOOOOOOGOOOOOOOPGOOOO
OOOOOOOOOOOOOOHMGGRPGGOOOOOOOOOOOOOOOGGGGGGHGOOOOOOOOOOOOOOOOOOOOOOOOOOGGPGPGGOO
OOOOOOOOOOOOOOGHGGRGGOOOOOOOOOOOOOOOODPPGGGGGGOOOOOOOOOOOOOOOOOOOOOOOOOGGPPPPGOO
OOOOOOOOOOOOOOGMGPRROOOOOOOOOOOOOOOOPPPPPPPGGGOPOOOOOOOOOOOOOOOOOOOOGGPPPDDDPPPO
OOOOOOOOOOOOOOGMGGGPOOOOOOOOOOOOOOOOHPDDPPGGOOOPOOOOOOOOOOOOOOOOOOOGGGPDDDDDDPFO
OOOOOOOOOOOOOOPMGGGOOOOOOOOOOOOOOOOOOPPDPPGGOOOGOOOOOOOOOOOOOOOOOOOGPDDDDDDDDPPO
OOOOOOOOOOOOOOOMGPOOOOOOOOOOOOOOOOOOOHPPPGGGOOGPOOOOOOOOOOOOOOOOOOOGDDDDDPDDDPGO
OOOOOOOOOOOOOOOGGOOOOOOOOOOOOOOOOOOOOHPPGHGOOOPOOOOOOOOOOOOOOOOOOOODDDDDDDPDDHFO
OOOOOOOOOOOOOOOPGOOOOOOOOOOOOOOOOOOOOODPGHGOOOOOOOOOOOOOOOOOOOOOOOODDDOOGDDDHGOO
OOOOOOOOOOOOOOOOGOOOOOOOOOOOOOOOOOOOOOPGGGOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOGHHHGOOO
OOOOOOOOOOOOOOOOFOOOOOOOOOOOOOOOOOOOOOGOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOPGOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
`.replace(/\n/g,"")).map(e=>new R1[e])}height(){return 50}width(){return 80}};t(qd,"Earth");EF=qd});var xR,vR,bR,x1,v1,b1,C1,FF,kF=n(()=>{K();na();to();w();T();aR();RR();xR=new Map,vR=new Map,bR=new Map,x1=t((i,e=null)=>(vR.has(i)||vR.set(i,i.score(e,[[J,8],[H,3],[re,1]])),vR.get(i)),"tileScore"),v1=t((i,e=null)=>(bR.has(i)||bR.set(i,i.getSurroundingArea().entries().reduce((r,o)=>r+x1(o,e),0)),bR.get(i)),"areaScore"),b1=t((i,e=P)=>{if(!xR.has(i)){e.emit("world:generate-start-tiles");let r=i.entries().filter(o=>[fe,ie,ee].some(a=>o.terrain()instanceof a)).map(o=>({tile:o,score:v1(o)})).sort(({score:o},{score:a})=>a-o).map(({tile:o})=>o);xR.set(i,r),e.emit("world:start-tiles",r)}return xR.get(i)},"pickStartTiles"),C1=t((i=P,e=()=>Math.random())=>[new Jp(new l(()=>i.option("earth",!1)),new m((r,o)=>DF(r,o.civilization()))),new Jp(new l(()=>!i.option("earth",!1)),new m((r,o,a)=>{let s=b1(r);return s.forEach(p=>{a.some(u=>u.distanceFrom(p)<=4)&&s.splice(s.indexOf(p),1)}),s[Math.floor(s.length*e())]}))],"getRules"),FF=C1});var Vd,Qm,Jd=n(()=>{Kd();Ki();Vd=class extends Ee{constructor(){super(_d)}};t(Vd,"GeneratorRegistry");Qm=new Vd});var $d,Zd,CR=n(()=>{G();$d=class extends g{};t($d,"PickGenerator");Zd=$d});var Qd,Xd,TR=n(()=>{G();Qd=class extends g{};t(Qd,"Start");Xd=Qd});var eg,SF,YF=n(()=>{Z();I();gd();Ce();qi();eg=class extends S{#e;#t;#r;#i=new ru(ce);#o;constructor(e,r=d){super(),this.#e=e,this.#t=e.height(),this.#o=e.width(),this.#r=r,this.addKey("height","tiles","width")}build(){return new Promise(e=>{this.#e.generate().then(r=>{r.forEach((o,a)=>{let s=new ce(a%this.#o,Math.floor(a/this.#o),o,this,this.#r);this.#i.register(s)}),this.#r.process(Hs,this),e(this)})})}entries(){return this.#i.entries()}filter(e){return this.entries().filter(e)}forEach(e){return this.#i.forEach(e)}get(e,r){return this.entries()[this.#e.coordsToIndex(e,r)]}height(){return this.#t}includes(e){return this.#i.includes(e)}map(e){return this.#i.map(e)}register(...e){this.#i.register(...e)}tiles(){return this.entries()}width(){return this.#o}};t(eg,"World");SF=eg});var T1,zF,NF=n(()=>{Jd();I();K();T();CR();TR();YF();T1=t((i=d,e=Qm,r=P)=>[new Xd(new m(()=>{let[o]=i.process(Zd),a=new o(parseInt(r.option("height",100),10),parseInt(r.option("width",160),10),{landCoverage:parseFloat(r.option("landCoverage",.4)),landSize:parseFloat(r.option("landSize",.2)),maxIterations:parseInt(r.option("maxIterations",20),10)});new SF(a,i).build()}))],"getRules"),zF=T1});var P1,LF,WF=n(()=>{Up();to();na();En();dn();on();Jo();gi();w();T();xg();P1=t((i=Ne,e=lt,r=pt)=>[...[[J,qe,1],[J,fe,2],[J,Ae,1],[J,Ze,1],[J,it,1],[J,ie,1],[J,ee,2],[J,Qe,1],[J,mt,1],[H,be,1],[H,qe,2],[H,Se,1],[H,ie,1]].map(([o,a,s])=>new ai(new l(p=>p.terrain()instanceof a),new m(()=>new o(s,a.name)))),...[[H,Zo,2],[J,Qo,1],[J,hi,1],[re,Xo,2],[re,en,3],[H,eo,1],[J,Oi,2],[H,tn,3],[J,rn,2],[H,$o,1]].map(([o,a,s])=>new ai(new l(p=>e.getByTerrain(p.terrain()).some(u=>u instanceof a)),new m(()=>new o(s,a.name)))),...[[H,Zo,1],[J,Qo,1],[J,hi,1],[re,Xo,2],[re,en,2],[H,eo,1],[J,Oi,1],[H,tn,1],[J,rn,1]].map(([o,a,s])=>new ai(new l((p,u)=>{if(!u)return!1;try{return r.getByPlayer(u).is(bt,nt,at,ft)}catch{return!1}}),new l(p=>e.getByTerrain(p.terrain()).some(u=>u instanceof a)),new m(()=>new o(s,a.name)))),new ai(new l(o=>o.terrain()instanceof it),new m(()=>new re(2,it.name))),new ai(new l(o=>o.terrain()instanceof ee),new m(()=>new re(1))),new ai(new l((o,a)=>{if(!a)return!1;try{return r.getByPlayer(a).is(nt,ft)}catch{return!1}}),new l(o=>o.terrain()instanceof ee||o.terrain()instanceof it),new m(()=>new re(1,it.name))),...[[be,J,we,1],[be,H,$e,1],[Ae,J,we,1],[Ae,H,$e,2],[Se,H,$e,1],[ie,J,we,1]].map(([o,a,s,p])=>new ai(new l(u=>u.terrain()instanceof o),new l(u=>i.getByTile(u).some(y=>y instanceof s)),new m(()=>new a(p,s.name)))),...[[be,H,$e,1],[fe,J,we,1],[Ae,H,$e,1],[Se,H,$e,1],[ee,J,we,1]].map(([o,a,s,p])=>new ai(new l((u,y)=>{if(!y)return!1;try{return r.getByPlayer(y).is(bt,nt,at,ft)}catch{return!1}}),new l(u=>u.terrain()instanceof o),new l(u=>i.getByTile(u).some(y=>y instanceof s)),new m(()=>new a(p,s.name)))),...[be,fe,ie].map(o=>new ai(new l(a=>a.terrain()instanceof o),new l(a=>i.getByTile(a).some(s=>s instanceof ke)),new m(()=>new re(1,ke.name)))),...[be,fe,ie].map(o=>new ai(new l((a,s)=>{if(!s)return!1;try{return r.getByPlayer(s).is(nt,ft)}catch{return!1}}),new l(a=>a.terrain()instanceof o),new l(a=>i.getByTile(a).some(s=>s instanceof ke)),new m(()=>new re(1,ke.name))))],"getRules"),LF=P1});var I1,jF,HF=n(()=>{na();gi();w();T();qn();En();Rg();I1=t((i=Ne)=>[...[[J,.5],[H,.5],[re,.5]].map(([e,r])=>new Su(new Kn,new l((o,a,s)=>s.some(p=>p instanceof e)),new l(o=>i.getByTile(o).some(a=>a instanceof ir)),new m((o,a,s)=>{let p=s.filter(u=>u instanceof e).reduce((u,y)=>u+y.value(),0);s.push(new e(Math.floor(p*r),ir.name))})))],"getRules"),jF=I1});var w1,_F,KF=n(()=>{K();Jd();RR();T();CR();w1=t((i=Qm,e=P,r=()=>Math.random())=>[new Zd(new m(()=>{if(e.option("earth",!1))return EF;let o=i.entries();if(o.length===0)throw new TypeError("No available `World` generators.");return o[Math.floor(o.length*r())]}))],"getRules"),_F=w1});var A1={};var qF=n(()=>{gF();OF();xF();bF();TF();IF();I();GF();kF();NF();WF();HF();KF();d.register(...dF(),...hF(),...RF(),...vF(),...CF(),...PF(),...AF(),...FF(),...zF(),...LF(),...jF(),..._F())});var tg,rg,PR=n(()=>{Ki();Fl();tg=class extends Ee{constructor(){super(vn)}};t(tg,"TerrainRegistry");rg=new tg});var G1={};var VF=n(()=>{to();PR();rg.register(Gt,be,qe,fe,Ae,Ze,Se,it,ie,ee,Qe,mt)});var B1={};var JF=n(()=>{Up();fR();zd.register(Zo,Qo,hi,Xo,en,eo,Oi,tn,rn,$o)});var ZF=b($F=>{"use strict";Object.defineProperty($F,"__esModule",{value:!0});qF();VF();JF()});var U1,QF,XF=n(()=>{rt();Vt();_o();qi();U1=t((i=j)=>[new oe(_,"cities",e=>i.getByPlayer(e)),new oe(ce,"city",e=>i.getByTile(e))],"getAdditionalData"),QF=U1});var M1={};var e0=n(()=>{Dt();XF();ne.register(...QF())});var r0=b(t0=>{"use strict";Object.defineProperty(t0,"__esModule",{value:!0});e0()});var D1,i0,o0=n(()=>{$n();Vt();Vn();D1=t((i=Qt)=>[new oe(tt,"build",e=>i.getByCity(e))],"getAdditionalData"),i0=D1});var E1={};var n0=n(()=>{Dt();o0();ne.register(...i0())});var s0=b(a0=>{"use strict";Object.defineProperty(a0,"__esModule",{value:!0});n0()});var F1,l0,m0=n(()=>{rr();Vt();Vn();F1=t((i=ye)=>[new oe(tt,"growth",e=>i.getByCity(e))],"getAdditionalData"),l0=F1});var k1={};var p0=n(()=>{Dt();m0();ne.register(...l0())});var c0=b(u0=>{"use strict";Object.defineProperty(u0,"__esModule",{value:!0});p0()});var S1,y0,f0=n(()=>{ur();Vt();Vn();S1=t((i=Re)=>[new oe(tt,"improvements",e=>i.getByCity(e))],"getAdditionalData"),y0=S1});var Y1={};var d0=n(()=>{Dt();f0();ne.register(...y0())});var h0=b(g0=>{"use strict";Object.defineProperty(g0,"__esModule",{value:!0});d0()});var z1,O0,R0=n(()=>{ks();Vt();qi();z1=t((i=kr)=>[new oe(ce,"goodyHut",e=>i.getByTile(e))],"getAdditionalData"),O0=z1});var N1={};var x0=n(()=>{Dt();R0();ne.register(...O0())});var b0=b(v0=>{"use strict";Object.defineProperty(v0,"__esModule",{value:!0});x0()});var L1,C0,T0=n(()=>{on();Vt();_o();L1=t((i=pt)=>[new oe(_,"government",e=>i.getByPlayer(e))],"getAdditionalData"),C0=L1});var W1={};var P0=n(()=>{T0();Dt();ne.register(...C0())});var w0=b(I0=>{"use strict";Object.defineProperty(I0,"__esModule",{value:!0});P0()});var j1,A0,G0=n(()=>{$i();Vt();_o();j1=t((i=ae)=>[new oe(_,"world",e=>i.getByPlayer(e))],"getAdditionalData"),A0=j1});var H1={};var B0=n(()=>{Dt();G0();ne.register(...A0())});var M0=b(U0=>{"use strict";Object.defineProperty(U0,"__esModule",{value:!0});B0()});var _1,D0,E0=n(()=>{He();Vt();_o();_1=t((i=N)=>[new oe(_,"research",e=>i.getByPlayer(e))],"getAdditionalData"),D0=_1});var K1={};var F0=n(()=>{Dt();E0();ne.register(...D0())});var S0=b(k0=>{"use strict";Object.defineProperty(k0,"__esModule",{value:!0});F0()});var q1,Y0,z0=n(()=>{Jo();Vt();Fl();q1=t((i=lt)=>[new oe(vn,"features",e=>i.getByTerrain(e))],"getAdditionalData"),Y0=q1});var V1={};var N0=n(()=>{Dt();z0();ne.register(...Y0())});var W0=b(L0=>{"use strict";Object.defineProperty(L0,"__esModule",{value:!0});N0()});var J1,j0,H0=n(()=>{gi();Vt();qi();J1=t((i=Ne)=>[new oe(ce,"improvements",e=>i.getByTile(e))],"getAdditionalData"),j0=J1});var $1={};var _0=n(()=>{Dt();H0();ne.register(...j0())});var q0=b(K0=>{"use strict";Object.defineProperty(K0,"__esModule",{value:!0});_0()});var Z1,V0,J0=n(()=>{Qp();Vt();_o();Z1=t((i=qs)=>[new oe(_,"rates",e=>i.getByPlayer(e))],"getAdditionalData"),V0=Z1});var Q1={};var $0=n(()=>{Dt();J0();ne.register(...V0())});var Q0=b(Z0=>{"use strict";Object.defineProperty(Z0,"__esModule",{value:!0});$0()});var X1,X0,ek=n(()=>{tl();Vt();_o();X1=t((i=si)=>[new oe(_,"treasury",e=>i.getByPlayer(e))],"getAdditionalData"),X0=X1});var eL={};var tk=n(()=>{Dt();ek();ne.register(...X0())});var ik=b(rk=>{"use strict";Object.defineProperty(rk,"__esModule",{value:!0});tk()});var ig,ok,nk=n(()=>{G();ig=class extends g{};t(ig,"End");ok=ig});var og,ak,sk=n(()=>{G();og=class extends g{};t(og,"Start");ak=og});var tL,lk,mk=n(()=>{K();I();ci();nk();TR();sk();tL=t((i=d,e=P,r=Be)=>[["engine:start",()=>{i.process(Xd)}],...["game:start","turn:end"].map(o=>[o,()=>{e.emit("turn:start",r.increment())}]),["turn:end",()=>{i.process(ok,r)}],["turn:start",()=>{i.process(ak,r)}]],"getEvents"),lk=tL});var rL={};var pk=n(()=>{K();mk();[...lk()].forEach(([i,e])=>{P.on(i,e)})});var ck=b(uk=>{"use strict";Object.defineProperty(uk,"__esModule",{value:!0});pk()});var iL,yk,fk=n(()=>{_e();Vt();Vn();_o();qi();iL=t((i=z)=>[new oe(tt,"units",e=>i.getByCity(e)),new oe(_,"units",e=>i.getByPlayer(e)),new oe(ce,"units",e=>i.getByTile(e))],"getAdditionalData"),yk=iL});var oL={};var dk=n(()=>{Dt();fk();ne.register(...yk())});var hk=b(gk=>{"use strict";Object.defineProperty(gk,"__esModule",{value:!0});dk()});var nL,Ok,Rk=n(()=>{la();Vt();ea();nL=t((i=or)=>[new oe(Pe,"improvements",e=>i.getByUnit(e))],"getAdditionalData"),Ok=nL});var aL={};var xk=n(()=>{Dt();Rk();ne.register(...Ok())});var bk=b(vk=>{"use strict";Object.defineProperty(vk,"__esModule",{value:!0});xk()});var ng,Ck,Tk=n(()=>{Ki();Ah();ng=class extends Ee{constructor(){super(Cf)}};t(ng,"AIClientRegistry");Ck=new ng});var sL={};var Pk=n(()=>{Tk();Rm();Ck.register(Sn)});var lL,Ik,wk=n(()=>{fl();_e();$s();w();T();Rm();lL=t((i=z,e=Eo)=>[new cr(new l((r,o)=>e.getByPlayer(o)instanceof Sn),new m((r,o,a)=>e.getByPlayer(o).cityLost(r,a,!1)))],"getRules"),Ik=lL});var mL,Ak,Gk=n(()=>{fl();_e();w();Zs();T();Rm();mL=t((i=z,e=Eo)=>[new yr(new l(r=>e.getByPlayer(r.player())instanceof Sn),new m((r,o)=>e.getByPlayer(r.player()).cityLost(r,o,!0)))],"getRules"),Ak=mL});var pL,Bk,Uk=n(()=>{fl();_e();w();Ip();T();Rm();pL=t((i=z,e=Eo)=>[new qo(new l(r=>e.getByPlayer(r.player())instanceof Sn),new m((r,o)=>e.getByPlayer(r.player()).unitDestroyed(r,o&&o.player())))],"getRules"),Bk=pL});var uL={};var Mk=n(()=>{I();wk();Gk();Uk();d.register(...Ik(),...Bk(),...Ak())});var Ek=b(Dk=>{"use strict";Object.defineProperty(Dk,"__esModule",{value:!0});Pk();Mk()});var ag,Fk,kk=n(()=>{dR();Kd();$t();I();PR();gR();OR();ag=class extends Zm{#e;#t;#r;#i;#o;#a;#n;#l;#s;#m;constructor(e=100,r=160,o={},a=d,s=rg,p=()=>Math.random()){super(e,r);let{landCoverage:u=.4,landSize:y=.2,maxIterations:c=10,clusterChance:f=.05,coverage:h=.25,pathChance:U=.05}=o;this.#e=u,this.#t=y,this.#r=c,this.#i=f,this.#o=h,this.#a=U,this.#s=a,this.#m=s,this.#l=p,this.#n=new Array(this.height()*this.width()).fill(0).map(()=>new Jt)}async generateIslands(){let e=this.height(),r=this.width(),o=this.#t+this.#l()*.2,a=this.#e,s=this.#r,p=Math.ceil(e*r/100*o),u=new Array(e*r).fill(0);for(;u.length===0||u.filter(y=>y===1).length/u.length<a;){let y={},c=[],f=[],h=Math.floor(e*r*Math.random()),U=t(D=>{D in y||(y[D]=0),y[D]++},"flagAsSeen");for(u[h]=1,c.push(h),U(h),f.push(...Pl(e,r,h));f.length;){let D=f.shift();if((y[D]||0)<=s&&(Math.random()>.3?(u[D]=1,c.push(D),Pl(e,r,D).filter(A=>f.indexOf(A)===-1).forEach(A=>f.push(A))):Pl(e,r,D).forEach(A=>{let E=f.indexOf(A);E>-1&&f.splice(E,1)}),U(D)),c.length>p||u.filter(A=>A===1).length/u.length>=a)break}if(u.filter(D=>D===1).length/u.length>=a)break}this.#n=u.map(y=>y===1?new W:new Jt)}generate(){return this.generateIslands().then(()=>this.populateTerrain().then(()=>this.#n))}getNeighbours(e,r=!0){return Pl(this.height(),this.width(),e,r)}populateTerrain(){return new Promise(e=>{let r=this.#s.get(Ut);this.#s.get(Ld).filter(o=>o.validate()).map(o=>{let a=o.process();if(!a)throw new TypeError("Unexpected data from DistributionGroups.");return a}).forEach(o=>o.forEach(a=>r.filter(s=>s.validate(a,this.#n)).map(s=>{let p=s.process(a,this.#n);if(!p)throw new TypeError("Unexpected data from Distribution.");return p}).forEach(s=>s.forEach(({cluster:p=!1,clusterChance:u=this.#i,coverage:y=this.#o,fill:c=!1,from:f=0,path:h=!1,pathChance:U=this.#a,to:D=1})=>{let A=Object.keys(this.#n).map(V=>parseInt(V,10)).filter(V=>this.#n[V]instanceof a.__proto__).filter(V=>V>=f*this.height()*this.width()&&V<=D*this.height()*this.width());if(c){A.forEach(V=>{this.#n[V]=new a});return}let E=A.length*y;for(;E>0;){let V=A[Math.floor(this.#l()*A.length)];if(this.#n[V]=new a,E--,p){let se=this.getNeighbours(V).filter(wt=>!(this.#n[wt]instanceof a));for(;se.length&&E>0;){let wt=se.shift();u>=this.#l()/this.distanceFrom(V,wt)&&(this.#n[wt]=new a,E--,se.push(...this.getNeighbours(wt).filter(Dr=>!(this.#n[Dr]instanceof a)).filter(Dr=>this.#n[Dr]instanceof a.__proto__).filter(Dr=>!se.includes(Dr))))}}if(h){let se=V;for(;U>=this.#l();){let wt=this.getNeighbours(se).filter(Dr=>this.#n[Dr]instanceof a.__proto__&&!(this.#n[Dr]instanceof a));se=wt[Math.floor(this.#l()*wt.length)],this.#n[se]=new a,E--}}}})))),e()})}};t(ag,"BaseGenerator");Fk=ag});var cL={};var Sk=n(()=>{kk();Jd();Qm.register(Fk)});var zk=b(Yk=>{"use strict";Object.defineProperty(Yk,"__esModule",{value:!0});Sk()});var yL={};var kje,Sje,Yje,zje,Nje,Lje,Wje,jje,Hje,_je,Kje,qje,Vje,Jje,$je,Zje,Qje,Xje,eHe,tHe,rHe,iHe,oHe,nHe,aHe,sHe,lHe,mHe,pHe,uHe,cHe,yHe,fHe,dHe,gHe,hHe,OHe,RHe,xHe,vHe,bHe,CHe,THe,PHe,IHe,wHe,AHe,GHe,BHe,UHe,MHe,DHe,EHe,FHe,kHe,SHe,YHe,zHe,NHe,LHe,WHe,jHe,HHe,_He,KHe,qHe,VHe,JHe,$He,ZHe,QHe,XHe,e_e,t_e,r_e,i_e,o_e,n_e,a_e,s_e,l_e,m_e,p_e,u_e,c_e,y_e,f_e,d_e,g_e,h_e,O_e,R_e,x_e,v_e,b_e,C_e,T_e,P_e,I_e,w_e,A_e,G_e,B_e,U_e,M_e,D_e,E_e,F_e,k_e,S_e,Y_e,z_e,N_e,Nk=n(()=>{"use strict";kje=C(aT()),Sje=C(pT()),Yje=C(fT()),zje=C(OT()),Nje=C(bT()),Lje=C(IT()),Wje=C(BT()),jje=C(ET()),Hje=C(YT()),_je=C(WT()),Kje=C(KT()),qje=C($T()),Vje=C(eP()),Jje=C(oP()),$je=C(sP()),Zje=C(pP()),Qje=C(yP()),Xje=C(gP()),eHe=C(RP()),tHe=C(bP()),rHe=C(PP()),iHe=C(AP()),oHe=C(UP()),nHe=C(EP()),aHe=C(SP()),sHe=C(NP()),lHe=C(jP()),mHe=C(KP()),pHe=C(JP()),uHe=C(QP()),cHe=C(tI()),yHe=C(oI()),fHe=C(sI()),dHe=C(pI()),gHe=C(yI()),hHe=C(gI()),OHe=C(RI()),RHe=C(bI()),xHe=C(PI()),vHe=C(AI()),bHe=C(UI()),CHe=C(EI()),THe=C(SI()),PHe=C(NI()),IHe=C(jI()),wHe=C(KI()),AHe=C(JI()),GHe=C(QI()),BHe=C(tw()),UHe=C(ow()),MHe=C(sw()),DHe=C(pw()),EHe=C(yw()),FHe=C(gw()),kHe=C(Rw()),SHe=C(bw()),YHe=C(Pw()),zHe=C(Aw()),NHe=C(Uw()),LHe=C(Ew()),WHe=C(Sw()),jHe=C(Nw()),HHe=C(jw()),_He=C(Kw()),KHe=C(Jw()),qHe=C(Qw()),VHe=C(tA()),JHe=C(oA()),$He=C(sA()),ZHe=C(pA()),QHe=C(yA()),XHe=C(gA()),e_e=C(RA()),t_e=C(bA()),r_e=C(PA()),i_e=C(AA()),o_e=C(UA()),n_e=C(EA()),a_e=C(SA()),s_e=C(NA()),l_e=C(jA()),m_e=C(IG()),p_e=C(HG()),u_e=C(fB()),c_e=C(dU()),y_e=C(TU()),f_e=C(GU()),d_e=C(KU()),g_e=C(oM()),h_e=C(NM()),O_e=C(sD()),R_e=C(CD()),x_e=C(SD()),v_e=C(vE()),b_e=C(fF()),C_e=C(ZF()),T_e=C(r0()),P_e=C(s0()),I_e=C(c0()),w_e=C(h0()),A_e=C(b0()),G_e=C(w0()),B_e=C(M0()),U_e=C(S0()),M_e=C(W0()),D_e=C(q0()),E_e=C(Q0()),F_e=C(ik()),k_e=C(ck()),S_e=C(hk()),Y_e=C(bk()),z_e=C(Ek()),N_e=C(zk())});pg();Ig();wg();mc();Hl();var sp=class extends ss{#e;#t;constructor(e,r=Tn,o=()=>Math.random()){super(e),this.#e=r,this.#t=o}chooseCivilization(e){let r=e[Math.floor(e.length*this.#t())],o=this.player(),a=new r;o.setCivilization(a),this.chooseLeader(a)}chooseLeader(e){let r=this.#e.getByCivilization(e.constructor),o=r[Math.floor(r.length*this.#t())];e.setLeader(new o)}};t(sp,"Client");Gg();fr();Bg();Vn();Tc();Ge();Ft();kg();Z();var us,Uc=class{constructor(){de(this,us,[])}add(e,r,o=null){v(this,us).push({[e]:{type:"add",index:o,value:r}})}clear(){v(this,us).splice(0)}remove(e,r=null){v(this,us).push({[e]:{type:"remove",index:r}})}transferData(){return v(this,us).slice(0).map(e=>{let r={};return Object.entries(e).forEach(([o,{type:a,index:s,value:p}])=>{r[o]={type:a,index:s,value:typeof p=="function"?p():p}}),r})}update(e,r,o=null){v(this,us).push({[e]:{type:"update",index:o,value:r}})}};t(Uc,"DataQueue"),us=new WeakMap;var XR=Uc;Dc();Vs();_o();Yg();Hc();var _c=class extends Error{constructor(r,o,a){super(r);this.handler=o;this.attempts=a}};t(_c,"RetryFailed");var nx=_c;var pp,up,Vl,cp,Jl,yp,fp,Kc=class{constructor(e,r=5,o=100){de(this,pp,0);de(this,up,void 0);de(this,Vl,void 0);de(this,cp,void 0);de(this,Jl,void 0);de(this,yp,void 0);de(this,fp,void 0);De(this,Vl,e),De(this,cp,r),De(this,Jl,setInterval(()=>this.run(),o)),De(this,up,new Promise((a,s)=>{De(this,fp,a),De(this,yp,s)}))}run(){if(++AR(this,pp)._>v(this,cp)){clearInterval(v(this,Jl)),v(this,yp).call(this,new nx("Retry failed.",v(this,Vl),v(this,pp)));return}v(this,Vl).call(this)&&(clearInterval(v(this,Jl)),v(this,fp).call(this))}then(){return v(this,up)}};t(Kc,"Retryable"),pp=new WeakMap,up=new WeakMap,Vl=new WeakMap,cp=new WeakMap,Jl=new WeakMap,yp=new WeakMap,fp=new WeakMap;var ax=Kc;Ng();Z();var qc=class extends Ye{constructor(e){super(),Object.assign(this,e),this.addKey(...Object.keys(e))}};t(qc,"TransferObject");var Vc=qc;qi();ea();Z();rr();var gp,hp,Op,Rp,Kg=class extends Ye{constructor(r,o,a,s){super();de(this,gp,void 0);de(this,hp,void 0);de(this,Op,{size:0});de(this,Rp,void 0);De(this,gp,r),De(this,hp,a),v(this,Op).size=s,De(this,Rp,o),this.addKey("_","growth","name","player","tile")}static fromCity(r){let o=ye.getByCity(r);return new Kg(r.name(),r.tile(),r.player(),o.size())}_(){return"City"}name(){return v(this,gp)}player(){return v(this,hp)}growth(){return v(this,Op)}tile(){return v(this,Rp)}},oy=Kg;t(oy,"City"),gp=new WeakMap,hp=new WeakMap,Op=new WeakMap,Rp=new WeakMap;var fx=oy;Z();var xp,qg=class extends Ye{constructor(r){super();de(this,xp,void 0);De(this,xp,r),this.addKey("_","civilization")}static fromPlayer(r){return new qg(r.civilization())}_(){return"Player"}civilization(){return v(this,xp)}},ny=qg;t(ny,"Player"),xp=new WeakMap;var dx=ny;Z();var vp,bp,Cp,Vg=class extends Ye{constructor(r,o,a){super();de(this,vp,void 0);de(this,bp,void 0);de(this,Cp,void 0);De(this,vp,r),De(this,bp,o),De(this,Cp,a),this.addKey("_","tile","player")}static fromUnit(r){return new Vg(r.constructor.name,r.tile(),r.player())}_(){return v(this,vp)}player(){return v(this,Cp)}tile(){return v(this,bp)}},ay=Vg;t(ay,"Unit"),vp=new WeakMap,bp=new WeakMap,Cp=new WeakMap;var gx=ay;Ie();B();rt();Tp();K();Hl();ds();He();tl();$i();ci();_e();Z();I();ci();$g();var dy=class extends S{#e=new Map;#t;#r;constructor(e=Be,r=d){super(),this.#t=r,this.#r=e,this.addKey("value")}value(e=this.#r.value()){if(!this.#e.has(e)){let[o]=this.#t.process(gs,e);this.#e.set(e,o)}let r=this.#e.get(e);if(typeof r!="number")throw new TypeError("Invalid cache result.");return r}};t(dy,"Year");var gy=new dy;im();Jg();var xx=t(i=>i instanceof Ye?{"#ref":i.id()}:i,"referenceObject"),Fe=t((...i)=>e=>i.some(r=>e instanceof r)?xx(e):e,"filterToReference"),Rx=t((...i)=>e=>i.some(r=>e instanceof r)?e:xx(e),"filterToReferenceAllExcept"),Zg=new Map,Qg=new Map,Xg=new Map,pe,X,ml,Os,An,Pp,hy=class extends sp{constructor(r,o,a){super(r);de(this,pe,t((r=o=>o)=>o=>o instanceof _&&o!==this.player()?(Zg.has(o)||Zg.set(o,dx.fromPlayer(o)),Zg.get(o)):o instanceof Pe&&o.player()!==this.player()?(Qg.has(o)||Qg.set(o,gx.fromUnit(o)),Qg.get(o)):o instanceof tt&&o.player()!==this.player()?(Xg.has(o)||Xg.set(o,fx.fromCity(o)),Xg.get(o)):o instanceof ce?ae.getByPlayer(this.player()).get(o.x(),o.y()):o instanceof Te?{_:o.constructor.name}:r(o),"#dataFilter"));de(this,X,new XR);de(this,ml,void 0);de(this,Os,void 0);de(this,An,void 0);de(this,Pp,!1);De(this,ml,new my),De(this,An,o),De(this,Os,a),v(this,Os).call(this,"action",(...s)=>{v(this,ml).emit("action",...s)}),v(this,Os).call(this,"cheat",({name:s,value:p})=>{if(s==="RevealMap"){let u=ae.getByPlayer(this.player()),[y]=u.entries();y.tile().map().entries().forEach(c=>{if(u.includes(c))return;u.register(c);let f=u.getByTile(c);v(this,X).add(u.id(),()=>c.toPlainObject(v(this,pe).call(this)),`entries[${u.entries().indexOf(f)}]`)})}if(s==="GrantAdvance"){let[u]=O.filter(c=>c.name===p),y=N.getByPlayer(this.player());if(!u||y.completed(u))return;y.addAdvance(u),v(this,X).add(y.id(),y.toPlainObject(v(this,pe).call(this,Fe(_))))}if(s==="GrantGold"){let u=si.getByPlayer(this.player());u.add(p),v(this,X).add(u.id(),u.toPlainObject(v(this,pe).call(this,Fe(_))))}if(s==="ModifyUnit"){let{unitId:u,properties:y}=p,[c]=z.getBy("id",u);if(!c)return;["attack","defence","moves","movement","visibility"].forEach(f=>{f in y&&c[f]().set(y[f])}),v(this,X).add(c.id(),c.toPlainObject(v(this,pe).call(this,Fe(_))))}this.sendPatchData()}),P.on("engine:plugins:load:failed",(s,p)=>{console.log(s+" failed to load"),console.error(p)}),P.on("player:visibility-changed",(s,p)=>{if(p!==this.player())return;let u=ae.getByPlayer(this.player()),y=u.getByTile(s);if(y===null){new ax(()=>{let c=u.getByTile(s);return c===null?!1:(v(this,X).add(u.id(),()=>s.toPlainObject(v(this,pe).call(this,Fe(_))),`tiles[${u.entries().indexOf(c)}]`),!0)},2,20);return}v(this,X).add(u.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_))),`tiles[${u.entries().indexOf(y)}]`)}),["unit:created","unit:defeated"].forEach(s=>{P.on(s,p=>{let u=ae.getByPlayer(this.player()),y=u.getByTile(p.tile());if(!!y&&(v(this,X).update(y.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_)))),p.player()===this.player())){if(s==="unit:created"){let c=z.getByPlayer(this.player()),f=c.indexOf(p),h=z.getByCity(p.city()),U=h.indexOf(p),D=z.getByTile(p.tile()),A=D.indexOf(p);v(this,X).add(r.id(),()=>p.toPlainObject(v(this,pe).call(this,Fe(ce,_,Kl,tt))),`units[${f}]`),v(this,X).add(y.id(),()=>p.toPlainObject(v(this,pe).call(this,Fe(Pe))),`units[${A}]`),p.city()!==null&&v(this,X).add(p.city().id(),()=>p.toPlainObject(v(this,pe).call(this,Fe(Pe))),`units[${U}]`);return}v(this,X).update(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,Rx(_,Pe))))}})}),["unit:destroyed"].forEach(s=>{P.on(s,(p,u)=>{p.player()===this.player()&&p.city()!==null&&v(this,X).update(p.city().id(),()=>p.city().toPlainObject(v(this,pe).call(this,Fe(Cn,ol,k,_,Kl,ce,Pe))))})}),["unit:moved"].forEach(s=>{P.on(s,(p,u)=>{let y=ae.getByPlayer(this.player()),c=y.getByTile(u.from()),f=y.getByTile(u.to());!c&&!f||(c&&v(this,X).update(c.id(),()=>c.toPlainObject(v(this,pe).call(this,Fe(_,tt)))),f&&v(this,X).update(f.id(),()=>f.toPlainObject(v(this,pe).call(this,Fe(_,tt)))),p.player()===this.player()&&p.city()!==null&&v(this,X).update(p.city().id(),()=>p.city().toPlainObject(v(this,pe).call(this,Fe(Cn,ol,k,_,Kl,ce,Pe)))))})}),["tile-improvement:built","tile-improvement:pillaged"].forEach(s=>{P.on(s,p=>{let u=ae.getByPlayer(this.player()),y=u.getByTile(p);y&&v(this,X).update(y.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_,tt))))})}),P.on("city:captured",(s,p,u)=>{if(u===this.player()){j.getByPlayer(this.player()).indexOf(s)!==-1&&v(this,X).update(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,Rx(_)))),this.sendNotification(`${p.civilization().name()} have captured our city ${s.name()}!`);return}if(p===this.player()){this.sendNotification(`We have captured ${s.name()} from ${u.civilization().name()}!`);return}}),["city:created","city:captured","city:destroyed","city:grow","city:shrink"].forEach(s=>{P.on(s,p=>{let u=ae.getByPlayer(this.player()),y=u.getByTile(p.tile());!y||v(this,X).update(y.id(),()=>y.toPlainObject(v(this,pe).call(this,Fe(_))))})}),P.on("city:shrink",s=>{s.player()===this.player()&&this.sendNotification(`Population decrease in ${s.name()}.`)}),P.on("city:unit-unsupported",(s,p)=>{s.player()===this.player()&&this.sendNotification(`${s.name()} cannot support ${p.constructor.name}.`)}),P.on("city:unsupported-improvement",(s,p)=>{s.player()===this.player()&&this.sendNotification(`${s.name()} cannot support ${p.constructor.name}.`)}),P.on("city:food-storage-exhausted",s=>{s.player()===this.player()&&this.sendNotification(`Food storage exhausted in ${s.name()}!`)}),P.on("city:building-complete",(s,p)=>{let u=ae.getByPlayer(this.player());if(s.city().player()!==this.player()&&p instanceof xe){this.sendNotification(`${u.getByTile(s.city().tile())?s.city().name():"A faraway city"} has completed work on ${p.constructor.name}!`);return}s.city().player()!==this.player()&&!(p instanceof xe)||(v(this,X).update(s.id(),()=>s.toPlainObject(v(this,pe).call(this,Fe(ce,Pe,_)))),this.sendNotification(`${s.city().name()} has completed work on ${p.constructor.name}!`))}),P.on("player:research-complete",(s,p)=>{s.player()===this.player()&&(v(this,X).update(s.id(),()=>s.toPlainObject(v(this,pe).call(this,Fe(_)))),this.sendNotification(`You have discovered the secrets of ${p.constructor.name}!`))}),P.on("goody-hut:action-performed",(s,p)=>{let u=s.tile();if(!!z.getByTile(u).some(c=>c.player()===this.player())){if(p instanceof ts){this.sendNotification("You have discovered scrolls of ancient wisdom...");return}if(p instanceof rs){this.sendNotification("You have discovered an advanced tribe...");return}if(p instanceof os){this.sendNotification("You have discovered valuable treasure...");return}if(p instanceof ns){this.sendNotification("You have discovered a friendly tribe of skilled mercenaries...");return}}}),P.on("player:defeated",(s,p)=>{s===this.player()&&(this.sendNotification("You have been defeated!"),ui.unregister(...ui.entries()),ta.unregister(...ta.entries()),v(this,An).call(this,"restart",null)),this.sendNotification(`${s.civilization().name()} defeated${p?` by ${p.civilization().name()}`:""}.`)}),P.on("city:civil-disorder",s=>{s.player()===this.player()&&this.sendNotification(`Civil disorder in ${s.name()}!`)})}chooseCivilization(r){let o=t(a=>(this.player().setCivilization(new a),this.chooseLeader(this.player().civilization())),"makeChoice");return new Promise((a,s)=>{if(r.length===1){let[p]=r;o(p).then(()=>a());return}v(this,An).call(this,"chooseCivilization",new Vc({choices:r}).toPlainObject()),v(this,Os).call(this,"chooseCivilization",p=>{let[u]=r.filter(y=>y.name===p);if(!u){s(`Invalid civilization ${p} (options: ${r.map(y=>y.name).join(", ")})`);return}o(u).then(()=>a())})})}chooseLeader(r){return new Promise((o,a)=>{let s=Tn.getByCivilization(r.constructor);if(s.length===1){let[p]=s;r.setLeader(new p),o();return}v(this,An).call(this,"chooseLeader",new Vc({choices:s}).toPlainObject()),v(this,Os).call(this,"chooseLeader",p=>{let[u]=s.filter(y=>y.name===p);if(!u){a(`Invalid civilization ${p} (options: ${s.map(y=>y.name).join(", ")})`);return}r.setLeader(new u),o()})})}handleAction(...r){let[o]=r,a=this.player(),s=a.actions(),p=s.filter(f=>f instanceof ni),{name:u,id:y}=o;if(u==="ReassignWorkers"){let[f]=j.getBy("id",o.city);return f&&(hx(f),v(this,X).update(f.id(),f.toPlainObject(v(this,pe).call(this,Fe(_,ce))))),!1}if(u==="EndTurn")return p.length===1&&p.every(f=>f instanceof nl);if(!u)return console.log("action not specified"),!1;let[c]=s.filter(f=>f.constructor.name===u&&y===(f.value()?f.value().id():void 0));if(!c)return console.log("action not specified"),!1;if(c instanceof Va){let{unitAction:f,target:h}=o,U=c.value(),A=[...U.actions(),...Object.values(U.actionsForNeighbours())].flat().filter(V=>V.constructor.name===f);for(;A.length!==1;){if(A.length===0)return console.log(`action not found: ${f}`),!1;let[V]=ae.getByPlayer(this.player()).filter(se=>se.id()===h);if(!V)return console.log(`tile not found: ${h}`),!1;if(A=A.filter(se=>se.to()===V.tile()),A.length>1&&!h)return console.log(`too many actions found: ${f} (${A.length})`),!1}let[E]=A;return E.perform(),!1}if(c instanceof Ja){let f=c.value();return f.moves().value()>0&&v(this,X).update(f.id(),f.toPlainObject(v(this,pe).call(this,Fe(_,ce)))),f.activate(),!1}if(c instanceof Cn||c instanceof as){let f=c.value(),{chosen:h}=o;if(!h)return console.log("no build item specified"),!1;let[U]=f.available().filter(D=>D.item().name===h);return U?(f.build(U.item()),!1):(console.log(`build item not available: ${h}`),!1)}if(c instanceof ZR){let f=c.value(),{chosen:h}=o;if(!h)return this.sendNotification("no build item specified"),!1;let[U]=f.available().filter(D=>D.name===h);return U?(f.research(U),!1):(console.log(`build item not available: ${h}`),!1)}if(c instanceof ps){let f=c.value(),h=si.getByPlayer(this.player());return h.buy(f),v(this,X).update(h.id(),h.toPlainObject(v(this,pe).call(this,Fe(_)))),!1}if(c instanceof cs){let f=c.value(),{chosen:h}=o,[U]=f.available().filter(A=>A.name===h);if(!U)return console.error(`Government type: '${h}' not found.`),!1;f.set(new U);let D=ae.getByPlayer(this.player());return v(this,X).update(D.id(),D.toPlainObject(v(this,pe).call(this,Fe(_)))),j.getByPlayer(this.player()).forEach(A=>v(this,X).update(A.id(),A.toPlainObject(v(this,pe).call(this,Fe(_,ce,Pe))))),!1}if(c instanceof ms){let f=c.value(),{value:h}=o;return f.setAll(h.map(([U,D])=>{let[A]=f.all().filter(E=>E.constructor.name===U);return[A.constructor,D]})),j.getByPlayer(this.player()).forEach(U=>v(this,X).update(U.id(),U.toPlainObject(v(this,pe).call(this,Fe(_,ce,Pe))))),!1}return console.log(`unhandled action: ${JSON.stringify(o)}`),!1}sendInitialData(){let r={player:this.player(),turn:Be,year:gy},o=new Vc(r);v(this,An).call(this,"gameData",o.toPlainObject(v(this,pe).call(this))),De(this,Pp,!0)}sendPatchData(){v(this,An).call(this,"gameDataPatch",v(this,X).transferData()),v(this,X).clear()}sendNotification(r){v(this,An).call(this,"gameNotification",{message:r})}takeTurn(){return new Promise((r,o)=>{v(this,Pp)||this.sendInitialData(),setTimeout(()=>{v(this,X).update(Be.id(),()=>Be.toPlainObject()),v(this,X).update(gy.id(),()=>gy.toPlainObject()),v(this,X).add(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,Fe(ce,me)))),this.sendPatchData()},1);let a=t((...s)=>{try{if(this.handleAction(...s)){v(this,ml).off("action",a),this.sendPatchData(),setTimeout(()=>r(),100);return}v(this,X).update(this.player().id(),()=>this.player().toPlainObject(v(this,pe).call(this,Fe(ql,ce,tt)))),this.sendPatchData()}catch(p){o(p)}},"listener");v(this,ml).on("action",a)})}};t(hy,"DataTransferClient"),pe=new WeakMap,X=new WeakMap,ml=new WeakMap,Os=new WeakMap,An=new WeakMap,Pp=new WeakMap;var vx=hy;_o();Rm();fl();K();ds();var Mt,sg=class{constructor(e){de(this,Mt,void 0);De(this,Mt,e),e.receive("start",()=>{this.bindEvents(),this.start()}),e.receive("setOption",({name:r,value:o})=>{v(this,Mt).send("notification",`setting ${r} to ${o}`),P.setOption(r,o)}),e.receive("getOptions",r=>e.send("getOptions",r.reduce((o,a)=>(o[a]=P.option(a),o),{}))),e.receive("setOptions",r=>{Object.entries(r).forEach(([o,a])=>P.setOption(o,a)),e.send("setOptions")})}bindEvents(){v(this,Mt).send("notification","binding events"),P.on("engine:initialise",()=>v(this,Mt).send("notification","initialising...")),P.on("engine:plugins:load:success",e=>v(this,Mt).send("notification",`loaded plugin: ${e}`)),P.on("engine:plugins-loaded",()=>v(this,Mt).send("notification","plugins loaded")),P.on("engine:start",()=>v(this,Mt).send("notification","starting...")),P.on("world:generate-start-tiles",()=>v(this,Mt).send("notification","generating start tiles...")),P.on("world:built",()=>v(this,Mt).send("notification","world built")),P.on("game:start",()=>v(this,Mt).send("notification","game start")),P.on("turn:start",e=>v(this,Mt).send("notification",`turn start ${e}`)),P.on("player:turn-start",e=>v(this,Mt).send("notification",`player turn-start: ${e.civilization().constructor.name}`))}start(){P.on("engine:start",()=>{new Array(parseInt(P.option("players"),10)).fill(0).forEach((e,r)=>{let o=new _,a=r===0?new vx(o,(s,p)=>v(this,Mt).send(s,p),(s,p)=>v(this,Mt).receive(s,p)):new Sn(o);ui.register(o),Eo.register(a),v(this,Mt).send("notification","generating world...")})}),P.start(),Promise.resolve().then(()=>(Nk(),yL)).then(()=>P.emit("plugins:load:end"))}};t(sg,"Game"),Mt=new WeakMap;var Lk=sg;var lg=class{async request(e){return new Promise(r=>{this.send(e.channel(),...e.args()),this.receiveOnce(e.channel(),o=>r(o))})}};t(lg,"AbstractTransport");var Wk=lg;var mg=class extends Wk{receive(e,r){addEventListener("message",({data:{channel:o,data:a}})=>{o===e&&r(a)})}receiveOnce(e,r){addEventListener("message",({data:{channel:o,data:a}})=>{o===e&&r(a)},{once:!0})}send(e,r){postMessage({channel:e,data:r})}};t(mg,"ParentTransport");var jk=mg;var X_e=new Lk(new jk);})();
//# sourceMappingURL=backend.js.map
