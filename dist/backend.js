"use strict";(()=>{var mq=Object.create;var ou=Object.defineProperty;var lq=Object.getOwnPropertyDescriptor;var pq=Object.getOwnPropertyNames;var fq=Object.getPrototypeOf,uq=Object.prototype.hasOwnProperty;var t=(o,e)=>ou(o,"name",{value:e,configurable:!0});var i=(o,e)=>()=>(o&&(e=o(o=0)),e);var I=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports),Kc=(o,e)=>{for(var r in e)ou(o,r,{get:e[r],enumerable:!0})},OI=(o,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of pq(e))!uq.call(o,a)&&a!==r&&ou(o,a,{get:()=>e[a],enumerable:!(n=lq(e,a))||n.enumerable});return o};var w=(o,e,r)=>(r=o!=null?mq(fq(o)):{},OI(e||!o||!o.__esModule?ou(r,"default",{value:o,enumerable:!0}):r,o)),O=o=>OI(ou({},"__esModule",{value:!0}),o);var vI=(o,e,r)=>{if(!e.has(o))throw TypeError("Cannot "+r)};var T=(o,e,r)=>(vI(o,e,"read from private field"),r?r.call(o):e.get(o)),ne=(o,e,r)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,r)},ce=(o,e,r,n)=>(vI(o,e,"write to private field"),n?n.call(o,r):e.set(o,r),r),bI=(o,e,r,n)=>({set _(a){ce(o,e,a,r)},get _(){return T(o,e,n)}});var F,Bm,he=i(()=>{F=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return this.#e.some(r=>e instanceof r)}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(n=>{let a=n[e];return a instanceof Function?a.bind(n)()===r:n[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let n=this.#t.indexOf(r);n>-1&&this.#t.splice(n,1)})}};t(F,"EntityRegistry");Bm=F});var qc,re,Nt=i(()=>{qc=class{#e;#t;#r;constructor(e,r,n){this.#e=r,this.#t=n,this.#r=e}data(...e){return this.#t(...e)}key(){return this.#e}type(){return this.#r}};t(qc,"AdditionalData");re=qc});var Vc,pe,Qt=i(()=>{he();Nt();Vc=class extends F{constructor(){super(re)}getByType(e){return this.filter(r=>r.type()===e||Object.prototype.isPrototypeOf.call(r.type(),e)||Object.prototype.isPrototypeOf.call(r.type().prototype,e))}};t(Vc,"AdditionalDataRegistry");pe=new Vc});var cq,Zv,CI=i(()=>{J();cq=t(o=>{let e=o instanceof ae?o.sourceClass():o,r=[];for(;e instanceof Function;)r.push(e),e=Object.getPrototypeOf(e);return r.map(n=>n.name)},"generateInheritance"),Zv=cq});var Jc,yq,iu,k,ae,J=i(()=>{Qt();he();CI();Jc={},yq=t(o=>{let e=o.sourceClass().name,r=Jc[e];return r||(Jc[e]=0),r>=Number.MAX_SAFE_INTEGER&&(Jc[e]=BigInt(r)),e+"-"+(++Jc[e]).toString(36)},"idProvider"),iu=t((o,e,r=a=>a,n=pe)=>{if(o=r(o),o instanceof Bm&&(o=o.entries()),Array.isArray(o))return o.map(a=>iu(a,e,r,n));if(o instanceof k){let a=o.id();if(!(a in e)){let s={_:o.sourceClass().name,__:Zv(o)};e[a]=s,o.keys().forEach(m=>{let f=o[m]instanceof Function?o[m]():o[m];s[m]=iu(f,e,r,n)}),n.getByType(o.sourceClass()).forEach(m=>{s[m.key()]=iu(m.data(o),e,r,n)})}return{"#ref":a}}return o instanceof Function?{_:o.name,__:Zv(o)}:o&&o instanceof Object?Object.entries(o).reduce((a,[s,m])=>(a[s]=iu(m,e,r,n),a),{}):o},"toPlainObject"),k=class{#e;#t=["id"];constructor(){this.#e=yq(this)}addKey(...e){this.#t.push(...e)}id(){return this.#e}keys(){return this.#t}sourceClass(){return this.constructor}toPlainObject(e=n=>n,r=pe){let n={};return{hierarchy:iu(this,n,e,r),objects:n}}};t(k,"DataObject");ae=k});var np,$r,Os=i(()=>{J();np=class extends k{#e;#t;constructor(e,r){super(),this.#e=e,this.#t=r,this.addKey("value")}player(){return this.#e}value(){return this.#t}};t(np,"PlayerAction");$r=np});var $c,_i,gl=i(()=>{Os();$c=class extends $r{};t($c,"MandatoryPlayerAction");_i=$c});var Aa,Qv=i(()=>{gl();Aa=class extends _i{};t(Aa,"ActiveUnit")});var TI=i(()=>{Qv();Qv()});var Ba,Xv=i(()=>{Os();Ba=class extends $r{};t(Ba,"InactiveUnit")});var PI=i(()=>{Xv();Xv()});var II=i(()=>{TI();PI()});var eb=i(()=>{II()});var Gm,wI=i(()=>{Os();Gm=class extends $r{};t(Gm,"ChangeProduction")});var vs,AI=i(()=>{gl();vs=class extends _i{};t(vs,"CityBuild")});var tb=i(()=>{wI();AI()});var Zc,BI,GI=i(()=>{J();Zc=class extends k{#e;constructor(e){super(),this.addKey("value"),this.#e=e}value(){return this.#e}};t(Zc,"Choice");BI=Zc});var Mm,Um,ap=i(()=>{J();GI();Mm=class extends k{#e=[];#t;#r;constructor(e,r,n){super(),this.addKey("choices","data","key"),e.forEach(a=>this.#e.push(new BI(a))),this.#t=n,this.#r=r}choices(){return this.#e}data(){return this.#t}key(){return this.#r}};t(Mm,"ChoiceMeta");Um=Mm});var Dm,MI,Qc=i(()=>{Dm=class{#e;#t;constructor(e,r=()=>Math.random()){this.#e=e,this.#t=r}async chooseFromList(e){let r=e.choices();return r[Math.floor(this.#t()*r.length)].value()}player(){return this.#e}async takeTurn(){throw new TypeError("Client#takeTurn must be implemented.")}};t(Dm,"Client");MI=Dm});var Xc,hl,ey=i(()=>{Qc();Xc=class extends Dm{};t(Xc,"AIClient");hl=Xc});var Em,UI=i(()=>{Os();Em=class extends $r{};t(Em,"AdjustTradeRates")});var rb=i(()=>{UI()});var sp,l,U=i(()=>{sp=class{#e=null;constructor(e){e&&(this.#e=e)}validate(...e){return this.#e===null?!0:this.#e(...e)}};t(sp,"Criterion");l=sp});var ty,ry,ob=i(()=>{U();ty=class extends l{#e=[];constructor(...e){super(),e.forEach(r=>{this.#e.push(r)})}criteria(){return this.#e}validate(...e){return this.#e.every(r=>r.validate(...e))}};t(ty,"Criteria");ry=ty});var oy,bs,iy=i(()=>{ob();oy=class extends ry{};t(oy,"And");bs=oy});var ny,p,b=i(()=>{ny=class{#e;constructor(e){this.#e=e}apply(...e){return this.#e(...e)}};t(ny,"Effect");p=ny});var ay,pi,km=i(()=>{ay=class{#e;constructor(e=2e3){this.#e=e}value(){return this.#e}};t(ay,"Priority");pi=ay});var Xs,Cs,xl=i(()=>{km();Xs=class extends pi{constructor(){super(1e3)}};t(Xs,"High");Cs=Xs});var Ot,sy,my=i(()=>{km();Ot=class extends pi{constructor(){super(3e3)}};t(Ot,"Low");sy=Ot});var mp,DI=i(()=>{km();mp=class extends pi{constructor(){super(2e3)}};t(mp,"Normal")});var em=i(()=>{xl();my();DI()});var ly,x,M=i(()=>{iy();U();b();em();ly=class{#e;#t=!0;#r;#o=new mp;constructor(...e){let r=[];e.forEach(n=>{if(n instanceof p){if(this.#r)throw new TypeError("Rule: effect already specified, but another was provided.");this.#r=n;return}if(n instanceof l){r.push(n);return}this.#o=n}),r.length&&(this.#e=new bs(...r))}disable(){this.#t=!1}enable(){this.#t=!0}enabled(){return this.#t}priority(){return this.#o}process(...e){if(!!this.#t&&this.#r instanceof p)return this.#r.apply(...e)}validate(...e){return this.#t?this.#e instanceof l?this.#e.validate(...e):!0:!1}};t(ly,"Rule");x=ly});var py,Ge,Zr=i(()=>{M();py=class extends x{};t(py,"Busy");Ge=py});var tm,ib=i(()=>{gl();tm=class extends _i{};t(tm,"ChooseResearch")});var EI,nb=i(()=>{ib();ib();EI=tm});var Rl,c,kI,A=i(()=>{he();M();Rl=class extends F{#e=new Map;constructor(){super(x)}entries(){return super.entries().sort((e,r)=>e.priority().value()-r.priority().value())}get(e){return this.#e.has(e)||this.#e.set(e,this.filter(r=>r.enabled()&&r instanceof e)),this.#e.get(e)||[]}invalidateCache(e){this.#e.delete(e instanceof x?e.constructor:e)}process(e,...r){return this.get(e).filter(n=>n.validate(...r)).map(n=>n.process(...r))}register(...e){super.register(...e),e.forEach(r=>this.invalidateCache(r))}unregister(...e){super.unregister(...e),e.forEach(r=>this.invalidateCache(r))}};t(Rl,"RuleRegistry");c=new Rl,kI=Rl});var fy,lp,ab=i(()=>{M();fy=class extends x{};t(fy,"CanBeWorked");lp=fy});var uy,cy,sb=i(()=>{M();uy=class extends x{};t(uy,"Created");cy=uy});var yy,Ts,pp=i(()=>{J();A();sb();yy=class extends k{#e;constructor(e=c){super(),this.#e=e,this.#e.process(cy,this)}clone(){return new this.constructor(this.#e)}};t(yy,"Terrain");Ts=yy});var Q,SI=i(()=>{pp();Q=class extends Ts{};t(Q,"Land")});var Qr,mb=i(()=>{pp();Qr=class extends Ts{};t(Qr,"Water")});var Xr=i(()=>{SI();mb()});var Sm,Y,We=i(()=>{J();Sm=class extends k{#e=[];#t=null;constructor(e=0,r="initial"){super(),this.addKey("value","values"),this.add(e,r)}add(e,r=""){if(e instanceof Sm)return this.add(e.value(),r);this.#e.push([e,r]),this.#t=null}clone(){return new this.constructor(this)}set(e,r=""){if(this.#e.splice(0),e instanceof Sm)return this.set(e.value(),r);this.#e.push([e,r]),this.#t=e}subtract(e,r=""){if(e instanceof Sm)return this.subtract(e.value(),r);this.#e.push([-e,r]),this.#t=null}value(){return this.#t===null&&(this.#t=this.#e.reduce((e,[r])=>e+r,0)),this.#t}values(){return this.#e}};t(Sm,"Yield");Y=Sm});var dy,gy,lb=i(()=>{M();dy=class extends x{};t(dy,"YieldModifier");gy=dy});var hy,Ki,pb=i(()=>{M();hy=class extends x{};t(hy,"Yield");Ki=hy});var fp,xe,qi=i(()=>{J();Xr();A();nu();We();lb();pb();fp=class extends k{#e;#t=[];#r;#o;#i;#n;#a=new Map;constructor(e,r,n,a,s=c){super(),this.#i=e,this.#n=r,this.#o=n,this.#e=a,this.#r=s,this.addKey("terrain","isCoast","isLand","isWater","x","y","yields")}clearYieldCache(e=null){this.#a.delete(e)}getAdjacent(){return this.getAdjacentDirections().map(e=>this.getNeighbour(e))}getAdjacentDirections(){return["n","e","s","w"]}getNeighbour(e){return e==="n"?this.#e.get(this.#i,this.#n-1):e==="ne"?this.#e.get(this.#i+1,this.#n-1):e==="e"?this.#e.get(this.#i+1,this.#n):e==="se"?this.#e.get(this.#i+1,this.#n+1):e==="s"?this.#e.get(this.#i,this.#n+1):e==="sw"?this.#e.get(this.#i-1,this.#n+1):e==="w"?this.#e.get(this.#i-1,this.#n):this.#e.get(this.#i-1,this.#n-1)}getNeighbouringDirections(){return["n","ne","e","se","s","sw","w","nw"]}getNeighbours(){return this.#t.length||(this.#t=this.getNeighbouringDirections().map(e=>this.getNeighbour(e))),this.#t}getSurroundingArea(e=2){return up.fromSurrounding(this,e)}distanceFrom(e){let r=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[n]=r.map(([a,s])=>Math.hypot(this.#i-e.x()+a*this.#e.width(),this.#n-e.y()+s*this.#e.height())).sort((a,s)=>a-s);return n}isCoast(){let e=this;return e.isWater()&&e.getNeighbours().some(r=>r.isLand())||e.isLand()&&e.getNeighbours().some(r=>r.isWater())}isLand(){return this.#o instanceof Q}isNeighbourOf(e){return this.getNeighbours().includes(e)}isWater(){return this.#o instanceof Qr}map(){return this.#e}score(e=null,r=[[Y,3]]){return this.yields(e).map(a=>{let[s]=r.filter(([f])=>a instanceof f),m=s?s[1]||1:0;return a.value()*m}).reduce((a,s)=>a+s,0)}terrain(){return this.#o}setTerrain(e){this.#o=e}x(){return this.#i}y(){return this.#n}yields(e=null){if(!this.#a.has(e)){let r=this.#r.process(Ki,this,e).flat();this.#r.process(gy,this,e,r).flat(),this.#a.set(e,r)}return this.#a.get(e)}};t(fp,"Tile");xe=fp});var cp,up,nu=i(()=>{he();qi();cp=class extends F{static from(...e){return new this(...e)}static fromSurrounding(e,r=2){let n=t(a=>{let s=[];for(let m=e.x()-a;m<=e.x()+a;m++)for(let f=e.y()-a;f<=e.y()+a;f++)s.push([m,f]);return s},"gen");return this.from(...n(r).map(([a,s])=>e.map().get(a,s)))}constructor(...e){super(fp),this.register(...e)}push(...e){this.register(...e)}shift(){let[e]=this.entries();return this.unregister(e),e}score(e=null,r=[]){return this.entries().reduce((n,a)=>n+a.score(e,r),0)}yields(e=null){return this.entries().flatMap(r=>r.yields(e))}};t(cp,"Tileset");up=cp});var xy,Fm,Ry=i(()=>{J();xy=class extends ae{#e;#t;constructor(e,r){super(),this.#e=r,this.#t=e,this.addKey("city","tile")}city(){return this.#e}tile(){return this.#t}};t(xy,"WorkedTile");Fm=xy});var Oy,Se,fi=i(()=>{A();ab();he();nu();Ry();Oy=class extends Bm{#e;constructor(e=c){super(Fm),this.#e=e}getByCity(e){return this.getBy("city",e)}getByTile(e){let[r]=this.getBy("tile",e);return r??null}getTilesByCity(e){return up.from(...this.filter(r=>r.city()===e).map(r=>r.tile()))}register(...e){e.forEach(r=>{let n=r.tile();if(this.getByTile(n)!==null)throw new TypeError(`Tile ${n.x()}, ${n.y()} is already worked!`);super.register(r)})}tileCanBeWorkedBy(e,r){return this.#e.process(lp,e,r).every(n=>n)}tileIsWorked(e){return!!this.getByTile(e)}unregisterByTile(e){let r=this.getByTile(e);r!==null&&this.unregister(r)}};t(Oy,"WorkedTileRegistry");Se=new Oy});var vy,eo,Ol=i(()=>{M();vy=class extends x{};t(vy,"Captured");eo=vy});var by,Cy,fb=i(()=>{M();by=class extends x{};t(by,"Tiles");Cy=by});var Ty,Gt,yp=i(()=>{M();Ty=class extends x{};t(Ty,"Cost");Gt=Ty});var Py,Ga,Iy=i(()=>{M();Py=class extends x{};t(Py,"Created");Ga=Py});var wy,Uo,vl=i(()=>{M();wy=class extends x{};t(wy,"Destroyed");Uo=wy});var dp,Ma,gp=i(()=>{M();dp=class extends x{};t(dp,"Yield");Ma=dp});var Ay,bl,By=i(()=>{M();Ay=class extends x{};t(Ay,"YieldModifier");bl=Ay});var Gy,it,Ps=i(()=>{J();A();fi();Ol();fb();yp();Iy();vl();We();gp();By();Gy=class extends k{#e=!1;#t;#r;#o;#i;#n;#a;#m;constructor(e,r,n,a=c,s=Se){super(),this.#t=n,this.#r=e,this.#o=e,this.#n=r,this.#i=a,this.#m=s,[this.#a]=this.#i.process(Cy,this),this.#i.process(Ga,this),this.addKey("destroyed","name","originalPlayer","player","tile","tiles","tilesWorked","yields")}capture(e){let r=this.#o;this.#o=e,this.#i.process(eo,this,e,r)}destroy(e=null){this.#e=!0,this.#i.process(Uo,this,e)}destroyed(){return this.#e}name(){return this.#t}setName(e){this.#t=e}originalPlayer(){return this.#r}player(){return this.#o}tile(){return this.#n}tiles(){return this.#a}tilesWorked(){return this.#m.getTilesByCity(this)}yields(){let e=[];return[this.#i.get(Ma),this.#i.get(bl),this.#i.get(Gt)].flat().forEach(r=>{if(!r.validate(this,e))return;let n=r.process(this,e);if(!!n){if(n instanceof Y){e.push(n);return}n.forEach(a=>e.push(a))}}),e}};t(Gy,"City");it=Gy});var My,Uy,ub=i(()=>{M();My=class extends x{};t(My,"Cost");Uy=My});var Vi,cb,Dy=i(()=>{We();Vi=class extends Y{};t(Vi,"FoodStorage");cb=Vi});var Ey,au,yb=i(()=>{M();Ey=class extends x{};t(Ey,"FoodStorage");au=Ey});var ky,Is,Sy=i(()=>{M();ky=class extends x{};t(ky,"Grow");Is=ky});var Fy,hp,db=i(()=>{M();Fy=class extends x{};t(Fy,"Shrink");hp=Fy});var Ny,Cl,Wy=i(()=>{J();A();ub();Dy();yb();Sy();db();Ny=class extends k{#e;#t=new cb(1/0);#r=new cb;#o;#i=1;constructor(e,r=c){super(),this.#e=e,this.#o=r,this.setCost(),this.addKey("cost","progress","size")}add(e){this.#r.add(e)}check(){this.#o.process(au,this)}city(){return this.#e}cost(){return this.#t}setCost(){let e=this.#o.process(Uy,this);e.length>0&&this.#t.set(e[0],"setCost")}empty(){this.#r.subtract(this.#r.value())}grow(){this.#i++,this.#o.process(Is,this)}progress(){return this.#r}shrink(){this.#i--,this.#o.process(hp,this)}size(){return this.#i}};t(Ny,"CityGrowth");Cl=Ny});var Nm,FI,Yy=i(()=>{J();A();Nm=class extends k{static build(e,r=c){throw new TypeError("createFromObject: Must be overridden in extending class")}};t(Nm,"Buildable");FI=Nm});var Ly,su,gb=i(()=>{M();Ly=class extends x{};t(Ly,"Created");su=Ly});var zy,K,qe=i(()=>{Yy();A();gb();zy=class extends Nm{#e;#t=!1;#r;constructor(e,r=c){super(),this.addKey("destroyed"),this.#e=e,this.#r=r,this.#r.process(su,this,e)}static build(e,r=c){return new this(e,r)}city(){return this.#e}destroy(){this.#t=!0}destroyed(){return this.#t}};t(zy,"CityImprovement");K=zy});var jy,Me,to=i(()=>{J();jy=class extends k{#e;#t;#r;constructor(e,r,n){super(),this.#e=e,this.#t=r,this.#r=n,this.addKey("name","value")}civilization(){return this.#e}name(){return this.#t}value(){return this.#r}};t(jy,"Attribute");Me=jy});var xp,Te,Br=i(()=>{he();to();xp=class extends F{constructor(){super(Me)}getByCivilization(e){return this.getBy("civilization",e)}getByName(e){return this.getBy("name",e)}};t(xp,"AttributeRegistry");Te=new xp});var Hy,ye,Gr=i(()=>{Hy=class{#e;#t;#r=!1;constructor(e,r,n=!1){this.#e=e,this.#t=r,this.#r=n}name(){return this.#e}civilization(){return this.#t}capital(){return this.#r}};t(Hy,"CityName");ye=Hy});var _y,se,Wt=i(()=>{he();Gr();_y=class extends F{#e=1;#t;constructor(e=()=>Math.random()){super(ye),this.#t=e}takeByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1);return r instanceof ye?(this.unregister(r),r.name()):this.takeUnassociated()}takeCapitalByCivilization(e){let[r]=this.getBy("civilization",e).sort(()=>Math.floor(this.#t()*3)-1).filter(n=>n.capital());return r instanceof ye?(this.unregister(r),r.name()):this.takeByCivilization(e)}takeUnassociated(){let[e]=this.getBy("civilization",null).sort(()=>Math.floor(this.#t()*3)-1);return e instanceof ye?(this.unregister(e),e.name()):`City #${this.#e++}`}};t(_y,"CityNameRegistry");se=new _y});var Ky,ve,Mr=i(()=>{Br();Wt();J();Ky=class extends k{#e=null;#t;#r=new xp;constructor(e=Te,r=se){super(),this.#t=r,this.#r.register(...e.getByCivilization(this.sourceClass())),this.addKey("name","leader","attributes")}attributes(){return this.#r.entries()}name(){return this.constructor.name}leader(){return this.#e}setLeader(e){this.#e=e}getCityName(e=!1){let r=this.sourceClass();return e?this.#t.takeCapitalByCivilization(r):this.#t.takeByCivilization(r)}};t(Ky,"Civilization");ve=Ky});var Wm,NI=i(()=>{Os();Wm=class extends np{};t(Wm,"CompleteProduction")});var hb=i(()=>{NI()});var Tl,Vy,Jy=i(()=>{gl();Tl=class extends _i{};t(Tl,"EndTurn");Vy=Tl});var $y,Zy,xb=i(()=>{$y=class{#e={};on(e,r){e in this.#e||(this.#e[e]=[]),this.#e[e].push(r)}once(e,r){let n=t((...a)=>{r(...a),this.off(e,n)},"onceHandler");this.on(e,n)}off(e,r){if(!(e in this.#e))return;let n=this.#e[e].indexOf(r);n!==-1&&this.#e[e].splice(n,1)}emit(e,...r){e in this.#e&&this.#e[e].forEach(n=>n(...r))}};t($y,"EventEmitter");Zy=$y});var Xe,ws,rm=i(()=>{We();Xe=class extends Y{};t(Xe,"Unhappiness");ws=Xe});var Rb,Qy,ui,Lm=i(()=>{We();Rb=t(o=>o instanceof Y?-o.value():-o,"negate"),Qy=class extends Y{add(e,r=""){super.add(Rb(e),r)}set(e,r=""){super.set(Rb(e),r)}subtract(e,r=""){super.subtract(Rb(e),r)}};t(Qy,"NegativeYield");ui=t(o=>{["add","set","subtract"].forEach(e=>Object.defineProperty(o.prototype,e,Object.getOwnPropertyDescriptor(Qy.prototype,e)||Object.create(null)))},"makeNegative")});var As,Xy=i(()=>{rm();Lm();As=class extends ws{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("cityImprovement")}cityImprovement(){return this.#e}};t(As,"CityImprovementContent");ui(As)});var YI=i(()=>{Xy();Xy()});var je,ci,Bs=i(()=>{We();je=class extends Y{};t(je,"Gold");ci=je});var de,ed=i(()=>{Bs();Lm();de=class extends ci{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("cityImprovement")}cityImprovement(){return this.#e}};t(de,"CityImprovementMaintenanceGold");ui(de)});var LI=i(()=>{ed();ed()});var oe,om,Gs=i(()=>{We();oe=class extends Y{};t(oe,"Trade");om=oe});var yi,td=i(()=>{Gs();Lm();yi=class extends om{};t(yi,"Corruption");ui(yi)});var zI=i(()=>{td();td()});var X,Ua,Ms=i(()=>{We();X=class extends Y{};t(X,"Food");Ua=X});var jI=i(()=>{Ms();Ms()});var HI=i(()=>{Dy();Dy()});var _I=i(()=>{Bs();Bs()});var Da,rd,Rp=i(()=>{We();Da=class extends Y{};t(Da,"Happiness");rd=Da});var KI=i(()=>{Rp();Rp()});var ro,qI,mu=i(()=>{We();ro=class extends Y{};t(ro,"Luxuries");qI=ro});var VI=i(()=>{mu();mu()});var im,od=i(()=>{Rp();im=class extends rd{};t(im,"LuxuryHappiness")});var JI=i(()=>{od();od()});var Us,id=i(()=>{rm();Lm();Us=class extends ws{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Us,"MartialLaw");ui(Us)});var $I=i(()=>{id();id()});var Rn,nd=i(()=>{rm();Rn=class extends ws{#e;constructor(e,r){super(e,r.id()),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Rn,"MilitaryUnhappiness")});var ZI=i(()=>{nd();nd()});var nm,QI,ad=i(()=>{Ms();Lm();nm=class extends Ua{};t(nm,"PopulationSupportFood");ui(nm);QI=nm});var XI=i(()=>{ad();ad()});var am,sd=i(()=>{rm();am=class extends ws{};t(am,"PopulationUnhappiness")});var ew=i(()=>{sd();sd()});var $,sm,mm=i(()=>{We();$=class extends Y{};t($,"Production");sm=$});var tw=i(()=>{mm();mm()});var ct,Op=i(()=>{We();ct=class extends Y{};t(ct,"Research")});var rw=i(()=>{Op();Op()});var ow=i(()=>{Gs();Gs()});var iw=i(()=>{rm();rm()});var Ea,nw,md=i(()=>{Ms();Lm();Ea=class extends Ua{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(Ea,"UnitSupportFood");ui(Ea);nw=Ea});var aw=i(()=>{md();md()});var ka,Ob,ld=i(()=>{mm();Lm();ka=class extends sm{#e;constructor(e=0,r=null){super(e,r?r.id():"none"),this.#e=r,this.addKey("unit")}unit(){return this.#e}};t(ka,"UnitSupportProduction");ui(ka);Ob=ka});var sw=i(()=>{ld();ld()});var pd=i(()=>{YI();LI();zI();jI();HI();_I();KI();VI();JI();$I();ZI();XI();ew();tw();rw();ow();iw();aw();sw()});var lm=i(()=>{pd()});var fd,yt,Sa=i(()=>{M();fd=class extends x{};t(fd,"Action");yt=fd});var ud,Ji,Pl=i(()=>{M();ud=class extends x{};t(ud,"Added");Ji=ud});var cd,vb,mw=i(()=>{Os();cd=class extends $r{};t(cd,"HiddenPlayerAction");vb=cd});var yd,q,Do=i(()=>{J();A();Sa();Pl();mw();gl();yd=class extends k{#e=null;#t;constructor(e=c){super(),this.#t=e,this.#t.process(Ji,this),this.addKey("actions","civilization","mandatoryActions")}action(){let[e]=this.actions();return e}actions(){return this.#t.process(yt,this).flat().filter(e=>!(e instanceof vb))}civilization(){if(this.#e===null)throw new TypeError("Player#civilization is unset.");return this.#e}hasActions(){return!!this.action()}hasMandatoryActions(){return this.actions().some(e=>e instanceof _i)}hiddenActions(){return this.#t.process(yt,this).flat().filter(e=>e instanceof vb)}mandatoryAction(){let[e]=this.mandatoryActions();return e}mandatoryActions(){return this.actions().filter(e=>e instanceof _i)}setCivilization(e){this.#e=e}};t(yd,"Player");q=yd});var dd,lw,pw=i(()=>{M();dd=class extends x{};t(dd,"Created");lw=dd});var zm,te,Mt=i(()=>{J();zm=class extends k{#e=0;constructor(){super(),this.addKey("value")}increment(){return this.#e++,this.#e}value(){return this.#e}};t(zm,"Turn");te=new zm});var On,fw,vp=i(()=>{J();A();Do();pw();Mt();On=class extends k{#e=new Set;#t=c;#r=te;#o;constructor(...e){super(),e.forEach(r=>{r instanceof q&&this.#e.add(r),r instanceof Rl&&(this.#t=r),r instanceof zm&&(this.#r=r)}),this.#o=this.#r.value(),this.addKey("players","when"),this.#t.process(lw,this)}isBetween(...e){let r=Array.from(new Set(e));return r.every(n=>this.#e.has(n))&&r.length===this.#e.size}players(){return Array.from(this.#e)}ruleRegistry(){return this.#t}when(){return this.#o}};t(On,"Interaction");fw=On});var jm,uw,gd=i(()=>{vp();A();jm=class extends On{#e;#t;constructor(e,r,n=c){super(...r.players(),n),this.#e=e,this.#t=r,this.addKey("by","for","negotiation")}by(){return this.#e}for(){return this.players().filter(e=>e!==this.#e)}negotiation(){return this.#t}};t(jm,"Action");uw=jm});var hd,bp,xd=i(()=>{M();hd=class extends x{};t(hd,"Step");bp=hd});var Rd,Cp,bb=i(()=>{M();Rd=class extends x{};t(Rd,"Resolved");Cp=Rd});var Tp,Hm,Pp=i(()=>{gd();A();xd();bb();Tp=class extends jm{#e=null;constructor(e,r,n=c){super(e,r,n),this.addKey("resolution","resolved")}choices(){return this.ruleRegistry().process(bp,this.negotiation())}resolution(){return this.#e}async resolve(e){this.#e=e,await Promise.all(this.ruleRegistry().process(Cp,e,this))}resolved(){return this.#e!==null}};t(Tp,"Proposal");Hm=Tp});var Od,vn,lu=i(()=>{Pp();Od=class extends Hm{};t(Od,"Initiate");vn=Od});var Il,cw,Cb=i(()=>{Os();Il=class extends $r{};t(Il,"LaunchSpaceship");cw=Il});var bn,yw=i(()=>{We();bn=class extends Y{};t(bn,"Attack")});var $i,dw=i(()=>{We();$i=class extends Y{};t($i,"Defence")});var Cn,gw,Tb=i(()=>{We();Cn=class extends Y{};t(Cn,"Movement");gw=Cn});var Ip,hw=i(()=>{Tb();Ip=class extends gw{};t(Ip,"Moves")});var _m,xw=i(()=>{We();_m=class extends Y{};t(_m,"Visibility")});var wp=i(()=>{yw();dw();Tb();hw();xw()});var vt,Pb,di,Ds,Ap,Ib=i(()=>{U();b();M();vt=class extends x{};t(vt,"Action");Pb=vt,di=new l(o=>o.moves().value()>=.1),Ds=new l((o,e,r=o.tile())=>r===e),Ap=new l((o,e,r=o.tile())=>e.isNeighbourOf(r))});var vd,Bp,wb=i(()=>{M();vd=class extends x{};t(vd,"Activate");Bp=vd});var bd,pm,Cd=i(()=>{M();bd=class extends x{};t(bd,"Created");pm=bd});var Td,Fa,pu=i(()=>{M();Td=class extends x{};t(Td,"Destroyed");Fa=Td});var Pd,Id,Ab=i(()=>{M();Pd=class extends x{};t(Pd,"Visibility");Id=Pd});var Km,fm,fu,Rw,Gp=i(()=>{wp();U();b();M();Km=class extends x{};t(Km,"BaseYield");fm=class extends x{};t(fm,"Yield");fu=fm,Rw=t((o,e=1,r=1,n=1,a=1)=>[...[[bn,e],[$i,r],[Cn,n],[_m,a]].flatMap(([s,m])=>[new fm(new l(f=>f instanceof o),new l((f,u)=>u instanceof s),new p((f,u)=>u.set(m))),new Km(new l(f=>f===o),new l((f,u)=>u instanceof s),new p((f,u)=>u.set(m)))])],"unitYield")});var uu,Fe,Es=i(()=>{wp();Yy();A();Ib();wb();Cd();pu();Ab();Gp();uu=class extends Nm{#e=!0;#t=null;#r;#o=!1;#i=new Ip;#n;#a;#m=null;#s;#l=!1;constructor(e,r,n,a=c){super(),this.#r=e,this.#n=r,this.#s=n,this.#a=a,this.addKey("actions","actionsForNeighbours","active","attack","busy","city","defence","destroyed","movement","moves","player","status","tile","visibility","waiting"),this.#a.process(pm,this)}static build(e,r=c){return new this(e,e.player(),e.tile(),r)}action(e,...r){return e.perform(...r)}actions(e=this.#s,r=this.#s){return typeof e=="string"&&(e=r.getNeighbour(e)),this.#a.process(Pb,this,e,r)}actionsForNeighbours(e=this.#s){return e.getNeighbouringDirections().reduce((r,n)=>({...r,[n]:this.#a.process(Pb,this,e.getNeighbour(n),e)}),{})}activate(){this.#a.process(Bp,this)}active(){return this.#e}setActive(e=!0){this.#e=e}applyVisibility(){this.#s.getSurroundingArea(this.visibility().value()).forEach(e=>{this.#a.process(Id,e,this.#n)})}attack(){let[e]=this.yield(new bn);return e}busy(){return this.#t}setBusy(e=null){this.#t=e}city(){return this.#r}defence(){let[e]=this.yield(new $i);return e}destroy(e=null){this.#a.process(Fa,this,e)}destroyed(){return this.#o}setDestroyed(){this.#o=!0}movement(){let[e]=this.yield(new Cn);return e}moves(){return this.#i}player(){return this.#n}status(){return this.#m}setStatus(e){this.#m=e}tile(){return this.#s}setTile(e){this.#s=e}visibility(){let[e]=this.yield(new _m);return e}waiting(){return this.#l}setWaiting(e=!0){this.#l=e}yield(...e){let r=this.#a.get(fu);return e.forEach(n=>r.filter(a=>a.validate(this,n)).forEach(a=>a.process(this,n))),e}};t(uu,"Unit");Fe=uu});var wd,z,Ve=i(()=>{he();Es();wd=class extends F{constructor(){super(Fe)}getByCity(e){return this.filter(r=>r.city()===e&&!r.destroyed())}getByPlayer(e,r=!1){return r?this.getBy("player",e):this.filter(n=>n.player()===e&&!n.destroyed())}getByTile(e){return this.filter(r=>r.tile()===e&&!r.destroyed())}};t(wd,"UnitRegistry");z=new wd});var ks,Ss,um=i(()=>{A();J();ks=class extends k{#e;#t;#r;#o;constructor(e,r,n,a=c){super(),this.#e=e,this.#t=a,this.#r=r,this.#o=n,this.addKey("from","to")}forUnit(e){return new this.constructor(this.#e,this.#r,e,this.#t)}from(){return this.#e}perform(...e){}ruleRegistry(){return this.#t}to(){return this.#r}unit(){return this.#o}};t(ks,"Action");Ss=ks});var Ad,Na,cu=i(()=>{M();Ad=class extends x{};t(Ad,"Defeated");Na=Ad});var Bd,j,dt=i(()=>{M();Bd=class extends x{};t(Bd,"Moved");j=Bd});var Zi,Bb=i(()=>{A();Ve();um();cu();dt();Zi=class extends Ss{#e;#t;constructor(e,r,n,a=c,s=z,m=()=>Math.random()){super(e,r,n,a),this.#t=s,this.#e=m}perform(){let[e]=this.#t.getByTile(this.to()).sort((n,a)=>a.defence().value()-n.defence().value()),r=Math.min(1,this.unit().moves().value());if(this.unit().attack().value()*r*this.#e()>=e.defence().value()*this.#e()){this.ruleRegistry().process(Na,e,this.unit(),this),this.unit().moves().subtract(r,this.constructor.name),this.ruleRegistry().process(j,this.unit(),this);return}this.ruleRegistry().process(Na,this.unit(),e,this),this.ruleRegistry().process(j,this.unit(),this)}};t(Zi,"Attack")});var Ow=i(()=>{Bb();Bb()});var Gd,vw,bw=i(()=>{Zr();Gd=class extends Ge{};t(Gd,"BuildingIrrigation");vw=Gd});var Md,bt,Tn=i(()=>{um();A();Mt();Zr();U();b();dt();Md=class extends ks{#e;constructor(e,r,n,a=c,s=te){super(e,r,n,a),this.#e=s}perform(e,r=()=>{},n=Ge){let a=this.#e.value()+e;this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new n(new l(()=>this.#e.value()===a),new p((...s)=>{let m=this.unit();m.setActive(),m.setBusy(),r(...s),this.ruleRegistry().process(j,this.unit(),this)})))}};t(Md,"DelayedAction");bt=Md});var Ud,cm,Dd=i(()=>{M();Ud=class extends x{};t(Ud,"Built");cm=Ud});var Ed,Wa,wl=i(()=>{J();A();Dd();Ed=class extends k{#e;constructor(e,r=c){super(),this.#e=e,r.process(cm,e,this)}tile(){return this.#e}};t(Ed,"TileImprovement");Wa=Ed});var Ue,Cw,kd=i(()=>{wl();Ue=class extends Wa{};t(Ue,"Irrigation");Cw=Ue});var Sd,we,gi=i(()=>{M();Sd=class extends x{};t(Sd,"MovementCost");we=Sd});var Ya,Gb=i(()=>{bw();Tn();kd();dt();gi();Ya=class extends bt{perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e||0,()=>{new Cw(this.unit().tile())},vw),this.ruleRegistry().process(j,this.unit(),this)}};t(Ya,"BuildIrrigation")});var Tw=i(()=>{Gb();Gb()});var Fd,Pw,Iw=i(()=>{Zr();Fd=class extends Ge{};t(Fd,"BuildingMine");Pw=Fd});var et,ww,Nd=i(()=>{wl();et=class extends Wa{};t(et,"Mine");ww=et});var La,Mb=i(()=>{Iw();Tn();Nd();dt();gi();La=class extends bt{perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e||0,()=>{new ww(this.unit().tile())},Pw),this.ruleRegistry().process(j,this.unit(),this)}};t(La,"BuildMine")});var Aw=i(()=>{Mb();Mb()});var Wd,Bw,Gw=i(()=>{Zr();Wd=class extends Ge{};t(Wd,"BuildingRailroad");Bw=Wd});var Xt,Mw,Yd=i(()=>{wl();Xt=class extends Wa{};t(Xt,"Railroad");Mw=Xt});var za,Ub=i(()=>{Gw();Tn();dt();gi();Yd();za=class extends bt{perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e||0,()=>{new Mw(this.unit().tile())},Bw),this.ruleRegistry().process(j,this.unit(),this)}};t(za,"BuildRailroad")});var Uw=i(()=>{Ub();Ub()});var Ld,Dw,Ew=i(()=>{Zr();Ld=class extends Ge{};t(Ld,"BuildingRoad");Dw=Ld});var Ye,kw,zd=i(()=>{wl();Ye=class extends Wa{};t(Ye,"Road");kw=Ye});var ja,Db=i(()=>{Ew();Tn();dt();gi();zd();ja=class extends bt{perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e||0,()=>{new kw(this.unit().tile())},Dw),this.ruleRegistry().process(j,this.unit(),this)}};t(ja,"BuildRoad")});var Sw=i(()=>{Db();Db()});var jd,yu,Eb=i(()=>{M();jd=class extends x{};t(jd,"ValidateMove");yu=jd});var nt,qm,Al=i(()=>{um();dt();gi();Eb();nt=class extends ks{perform(){return this.validate()?(this.unit().setTile(this.to()),this.ruleRegistry().process(j,this.unit(),this),!0):!1}movementCost(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>r-n);return e}validate(){let[e]=this.ruleRegistry().process(yu,this.unit(),this.movementCost());return e}};t(nt,"Move");qm=nt});var Ha,kb=i(()=>{A();Al();Ha=class extends qm{#e;constructor(e,r,n,a,s=c){super(e,r,n,s),this.#e=a}perform(){return super.perform()?(this.#e.capture(this.unit().player()),!0):!1}};t(Ha,"CaptureCity")});var Fw=i(()=>{kb();kb()});var Hd,at,Qi=i(()=>{J();Hd=class extends ae{#e;constructor(e){super(),this.#e=e}clone(e=this.terrain()){return new this.constructor(e)}terrain(){return this.#e}};t(Hd,"TerrainFeature");at=Hd});var Sb,_d,Yt,_a=i(()=>{he();Qi();Sb=new Map,_d=class extends F{constructor(){super(at)}getByTerrain(e){return Sb.has(e)||Sb.set(e,this.getBy("terrain",e)),Sb.get(e)}};t(_d,"TerrainFeatureRegistry");Yt=new _d});var Kd,Nw,Ww=i(()=>{Zr();Kd=class extends Ge{};t(Kd,"ClearingForest");Nw=Kd});var fe,Mp,Up=i(()=>{Xr();fe=class extends Q{};t(fe,"Plains");Mp=fe});var Ka,Fb=i(()=>{A();_a();Mt();Ww();Tn();dt();gi();Up();Ka=class extends bt{#e;constructor(e,r,n,a=c,s=Yt,m=te){super(e,r,n,a,m),this.#e=s}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{let r=new Mp,n=this.#e.getByTerrain(this.from().terrain());this.#e.register(...n.map(a=>a.clone(r))),this.#e.unregister(...n),this.from().setTerrain(r)},Nw),this.ruleRegistry().process(j,this.unit(),this)}};t(Ka,"ClearForest")});var Yw=i(()=>{Fb();Fb()});var qd,Lw,zw=i(()=>{Zr();qd=class extends Ge{};t(qd,"ClearingJungle");Lw=qd});var du,Vm,jw,Dp=i(()=>{_a();U();b();M();du=class extends x{};t(du,"Feature");Vm=du,jw=t((o,e,r=.2,n=Yt,a=()=>Math.random())=>[new du(new l(s=>s===e),new l((s,m)=>m instanceof o),new l(()=>a()<=r),new p((s,m)=>n.register(new s(m))))],"feature")});var Re,Jm,Bl=i(()=>{Xr();Re=class extends Q{};t(Re,"Grassland");Jm=Re});var hi,Vd,gu=i(()=>{Qi();hi=class extends at{};t(hi,"Shield");Vd=hi});var qa,Nb=i(()=>{A();_a();Mt();zw();Tn();Dp();Bl();dt();gi();gu();qa=class extends bt{#e;constructor(e,r,n,a=c,s=Yt,m=te){super(e,r,n,a,m),this.#e=s}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{let r=new Jm,n=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(Vm,Vd,r),this.#e.unregister(...n),this.from().setTerrain(r)},Lw),this.ruleRegistry().process(j,this.unit(),this)}};t(qa,"ClearJungle")});var Hw=i(()=>{Nb();Nb()});var Jd,_w,Kw=i(()=>{Zr();Jd=class extends Ge{};t(Jd,"ClearingSwamp");_w=Jd});var Va,Wb=i(()=>{A();_a();Mt();Kw();Tn();Dp();Bl();dt();gi();gu();Va=class extends bt{#e;constructor(e,r,n,a=c,s=Yt,m=te){super(e,r,n,a,m),this.#e=s}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{let r=new Jm,n=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(Vm,Vd,r),this.#e.unregister(...n),this.from().setTerrain(r)},_w),this.ruleRegistry().process(j,this.unit(),this)}};t(Va,"ClearSwamp")});var qw=i(()=>{Wb();Wb()});var ym,Yb=i(()=>{um();dt();ym=class extends Ss{perform(){this.unit().destroy(),this.ruleRegistry().process(j,this.unit(),this)}};t(ym,"Disband")});var Vw=i(()=>{Yb();Yb()});var Ja,Lb=i(()=>{A();Al();Ja=class extends qm{#e;constructor(e,r,n,a,s=c){super(e,r,n,s),this.#e=a}perform(){return super.perform()?(this.unit().moves().set(0),this.#e.unload(this.unit()),!0):!1}};t(Ja,"Disembark")});var Jw=i(()=>{Lb();Lb()});var $d,$w,Zw=i(()=>{Zr();U();$d=class extends Ge{constructor(){super(new l(()=>!1))}};t($d,"Stowed");$w=$d});var dm,zb=i(()=>{A();Al();dt();Zw();dm=class extends qm{#e;constructor(e,r,n,a,s=c){super(e,r,n,s),this.#e=a}perform(){return super.perform()?(this.#e.stow(this.unit(),this.from()),this.unit().setBusy(new $w),this.unit().setActive(!1),this.ruleRegistry().process(j,this.unit(),this),!0):!1}};t(dm,"Embark")});var Qw=i(()=>{zb();zb()});var Zd,Ep,Qd=i(()=>{J();Zd=class extends ae{#e;constructor(e){super(),this.#e=e}unit(){return this.#e}};t(Zd,"UnitImprovement");Ep=Zd});var Xd,oo,gm=i(()=>{he();Qd();Xd=class extends F{constructor(){super(Ep)}getByUnit(e){return this.getBy("unit",e)}};t(Xd,"UnitImprovementRegistry");oo=new Xd});var eg,Xw,eA=i(()=>{Zr();eg=class extends Ge{};t(eg,"Fortified");Xw=eg});var Eo,tA,tg=i(()=>{Qd();Eo=class extends Ep{};t(Eo,"Fortified");tA=Eo});var rg,rA,oA=i(()=>{Zr();rg=class extends Ge{};t(rg,"Fortifying");rA=rg});var $a,jb=i(()=>{A();Mt();gm();eA();U();Tn();tg();oA();dt();gi();$a=class extends bt{#e;constructor(e,r,n,a=c,s=te,m=oo){super(e,r,n,a,s),this.#e=m}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{this.unit().moves().set(0),this.unit().setActive(!1),this.unit().setBusy(new Xw(new l(()=>!1))),this.#e.register(new tA(this.unit()))},rA),this.ruleRegistry().process(j,this.unit(),this)}};t($a,"Fortify")});var iA=i(()=>{jb();jb()});var hm,Hb=i(()=>{Wt();A();fi();um();Ps();dt();hm=class extends Ss{#e;#t;constructor(e,r,n,a=se,s=c,m=Se){super(e,r,n,s),this.#e=a,this.#t=m}perform(){new it(this.unit().player(),this.unit().tile(),this.#e.takeCapitalByCivilization(this.unit().player().civilization().constructor),this.ruleRegistry(),this.#t),this.unit().destroy(),this.ruleRegistry().process(j,this.unit(),this)}};t(hm,"FoundCity")});var nA=i(()=>{Hb();Hb()});var st,aA,Pn=i(()=>{st=class{#e=[];#t=[];constructor(...e){this.#e.push(...e)}accepts(e){return typeof e=="function"&&this.#e.some(r=>Object.prototype.isPrototypeOf.call(r,e)||Object.prototype.isPrototypeOf.call(r.prototype,e))}entries(){return this.#t.slice()}every(e){return this.entries().every(e)}filter(e){return this.entries().filter(e)}forEach(e){return this.entries().forEach(e)}getBy(e,r){return this.filter(n=>{let a=n[e];return a instanceof Function?a.bind(n)()===r:n[e]===r})}includes(e){return this.#t.includes(e)}indexOf(e){return this.#t.indexOf(e)}get length(){return this.entries().length}map(e){return this.entries().map(e)}register(...e){e.forEach(r=>{if(!this.accepts(r))throw new TypeError(`Registry#register: Invalid entity attempted to be registered: '${r}'.`);this.#t.includes(r)||this.#t.push(r)})}some(e){return this.entries().some(e)}unregister(...e){e.forEach(r=>{let n=this.#t.indexOf(r);n>-1&&this.#t.splice(n,1)})}};t(st,"ConstructorRegistry");aA=st});var kp,sA,_b=i(()=>{kp=class{#e;#t;#r;constructor(e,r,n){this.#e=n,this.#t=r,this.#r=e}end(){return this.#e}generate(){throw new Error(`PathFinder#generate: Must be overridden in '${this.constructor.name}'.`)}start(){return this.#t}unit(){return this.#r}};t(kp,"PathFinder");sA=kp});var og,Fs,Sp=i(()=>{Pn();_b();og=class extends st{constructor(){super(sA)}};t(og,"PathFinderRegistry");Fs=new og});var Fp,mA,lA,Kb=i(()=>{J();Fp=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}key(){return this.#e}value(){return this.#t}};t(Fp,"StrategyNote");mA=t((...o)=>o.map(e=>e instanceof ae?e.id():typeof e=="string"?e:e.toString()).join("-"),"generateKey"),lA=Fp});var ig,Np,ng=i(()=>{he();Kb();ig=class extends F{getByKey(e){return this.getBy("key",e)[0]}getOrCreateByKey(e,r){let n=this.getByKey(e);if(n)return n;let a=new lA(e,r);return this.register(a),a}register(...e){e.forEach(r=>{if(this.getByKey(r.key()))throw new TypeError(`Entity with key '${r.key()}' already exists.`);super.register(r)})}replace(...e){e.forEach(r=>{let n=this.getByKey(r.key());n&&this.unregister(n),this.register(r)})}};t(ig,"StrategyNoteRegistry");Np=new ig});var ag,sg,qb=i(()=>{Zr();ag=class extends Ge{};t(ag,"GoTo");sg=ag});var mg,pA,fA=i(()=>{mg=class extends Error{};t(mg,"NoPathAvailable");pA=mg});var lg,uA,cA=i(()=>{lg=class extends Error{};t(lg,"NoPathFinderAvailable");uA=lg});var In,yA,pg=i(()=>{um();In=class extends ks{perform(){this.unit().moves().subtract(this.unit().moves())}};t(In,"NoOrders");yA=In});var dq,fg,Vb=i(()=>{Al();pg();dq=t((o,e)=>{for(;o.moves().value()>.25;){let[n]=o.actions(e.shift()).filter(a=>a instanceof qm);if(!n)break;n.perform()}if(e.length===0&&(o.setBusy(),o.setActive()),o.moves().value()===0){o.setActive(!1);return}let[r]=o.actions().filter(n=>n instanceof yA);if(r){r.perform();return}o.moves().set(0),o.setActive(!1)},"moveAlongPath"),fg=dq});var Jb,xm,ug=i(()=>{Sp();A();Kb();ng();um();qb();U();b();dt();fA();cA();Vb();Jb=t(o=>mA(o,"currentPath"),"generateKey"),xm=class extends Ss{#e;#t;constructor(e,r,n,a=c,s=Fs,m=Np){super(e,r,n,a),this.#e=s,this.#t=m}perform(){let[e]=this.#e.entries();if(!e)throw new uA;let r=new e(this.unit(),this.unit().tile(),this.to()).generate();if(!r)throw new pA;this.unit().setBusy(),r.shift(),this.#t.replace(new Fp(Jb(this.unit()),r)),fg(this.unit(),r),this.unit().setBusy(new sg(new l(()=>this.unit().tile()===r.end()),new p(()=>{this.unit().setActive(),this.unit().setBusy()}))),this.ruleRegistry().process(j,this.unit(),this)}};t(xm,"GoTo")});var dA=i(()=>{ug();ug()});var gA=i(()=>{Al();Al()});var hA=i(()=>{pg();pg()});var cg,Je,xi=i(()=>{he();wl();cg=class extends F{constructor(){super(Wa)}getByTile(e){return this.getBy("tile",e)}};t(cg,"TileImprovementRegistry");Je=new cg});var Za,$b=i(()=>{A();xi();Mt();Tn();dt();gi();Za=class extends bt{#e;constructor(e,r,n,a=c,s=Je,m=te){super(e,r,n,a,m),this.#e=s}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{let[r]=this.#e.getByTile(this.from());this.#e.unregister(r)}),this.ruleRegistry().process(j,this.unit(),this)}};t(Za,"Pillage")});var xA=i(()=>{$b();$b()});var $e,yg,hu=i(()=>{Xr();$e=class extends Q{};t($e,"Forest");yg=$e});var ko,RA,dg=i(()=>{Qi();ko=class extends at{};t(ko,"Horse");RA=ko});var gg,OA,vA=i(()=>{Zr();gg=class extends Ge{};t(gg,"PlantingForest");OA=gg});var Qa,Zb=i(()=>{A();_a();Mt();Tn();Dp();hu();dg();dt();gi();vA();Qa=class extends bt{#e;constructor(e,r,n,a=c,s=Yt,m=te){super(e,r,n,a,m),this.#e=s}perform(){let[e]=this.ruleRegistry().process(we,this.unit(),this).sort((r,n)=>n-r);super.perform(e,()=>{let r=new yg,n=this.#e.getByTerrain(this.from().terrain());this.ruleRegistry().process(Vm,RA,r),this.#e.unregister(...n),this.from().setTerrain(r)},OA),this.ruleRegistry().process(j,this.unit(),this)}};t(Qa,"PlantForest")});var bA=i(()=>{Zb();Zb()});var hg,CA,TA=i(()=>{Zr();hg=class extends Ge{};t(hg,"Sleeping");CA=hg});var wn,PA,xg=i(()=>{A();Mt();Ve();U();Tn();b();TA();wn=class extends bt{#e;constructor(e,r,n,a=c,s=te,m=z){super(e,r,n,a,s),this.#e=m}perform(){this.unit().setActive(!1),this.unit().moves().set(0),this.unit().setBusy(new CA(new l(()=>this.from().getSurroundingArea(this.unit().visibility().value()).some(e=>this.#e.getByTile(e).some(r=>r.player()!==this.unit().player()))),new p(()=>{this.unit().setActive(),this.unit().setBusy()})))}};t(wn,"Sleep");PA=wn});var IA=i(()=>{xg();xg()});var Xa,wA=i(()=>{A();Ve();xu();Xa=class extends Zi{#e;constructor(e,r,n,a,s=c,m=z){super(e,r,n,s,m),this.#e=a,this.addKey("enemy")}enemy(){return this.#e}};t(Xa,"SneakAttack")});var An,AA=i(()=>{A();xu();An=class extends Ha{#e;constructor(e,r,n,a,s,m=c){super(e,r,n,a,m),this.#e=s,this.addKey("enemy")}enemy(){return this.#e}};t(An,"SneakCaptureCity")});var Rm,Qb=i(()=>{um();dt();Rm=class extends Ss{perform(){this.unit().setWaiting(),this.unit().cargo().forEach(e=>{e.moves().set(e.movement()),e.activate()}),this.ruleRegistry().process(j,this.unit(),this)}};t(Rm,"Unload")});var BA=i(()=>{Qb();Qb()});var xu=i(()=>{Ow();Tw();Aw();Uw();Sw();Fw();Yw();Hw();qw();Vw();Jw();Qw();iA();nA();dA();gA();hA();xA();bA();IA();wA();AA();BA()});var Gl=i(()=>{xu()});var Rg,Og,Xb=i(()=>{M();Rg=class extends x{};t(Rg,"Interaction");Og=Rg});var vg,Om,bg=i(()=>{gd();vg=class extends uw{};t(vg,"Terminate");Om=vg});var Cg,GA,MA=i(()=>{Cg=class extends Error{};t(Cg,"Terminated");GA=Cg});var Tg,eC,UA=i(()=>{Tg=class extends Error{};t(Tg,"Unsupported");eC=Tg});var Pg,Wp,tC=i(()=>{vp();Xb();Do();xd();bg();MA();UA();Pg=class extends On{#e=[];constructor(...e){if(e.filter(n=>n instanceof q).length!==2)throw new eC;super(...e);let[r]=e.filter(n=>n instanceof q);if(!r)throw new eC("Not enough `Player`s for `Negotiation`.");this.addKey("interactions","lastInteraction","terminated")}interactions(){return this.#e}lastInteraction(){return this.#e.length===0?null:this.#e[this.#e.length-1]}nextSteps(){let e=this.ruleRegistry().process(bp,this);return e.length===0&&e.push(new Om(this.players()[0],this,this.ruleRegistry())),e}proceed(e){if(this.terminated())throw new GA;this.#e.push(e),this.ruleRegistry().process(Og,e,this)}terminated(){return this.#e.some(e=>e instanceof Om)}};t(Pg,"Negotiation");Wp=Pg});var wg,Ag,rC=i(()=>{M();wg=class extends x{};t(wg,"Yield");Ag=wg});var Bg,Ct,es=i(()=>{A();Yy();rC();Bg=class extends FI{#e;#t;constructor(e,r=c){super(),this.#e=e,this.#t=r,this.addKey("city","yields")}static build(e,r=c){return new this(e,r)}city(){return this.#e}yields(){return this.#t.process(Ag,this).flat()}};t(Bg,"Part");Ct=Bg});var Gg,$m,oC=i(()=>{Qt();J();qi();Gg=class extends k{#e={};#t;#r;#o;constructor(e,r,n=pe){super(),this.#t=n,this.#r=r,this.#o=e,this.addKey("isCoast","isLand","isWater","terrain","x","y","yields"),this.setAdditionalData()}addKey(...e){super.addKey(...e)}isCoast(){return this.#o.isCoast()}isLand(){return this.#o.isLand()}isWater(){return this.#o.isWater()}player(){return this.#r}setAdditionalData(){this.#t.getByType(xe).forEach(e=>{this.#e[e.key()]=e.data(this.#o),Object.defineProperty(this,e.key(),{configurable:!0,value:()=>e.data(this.#o)}),this.addKey(e.key())})}terrain(){return this.#o.terrain()}tile(){return this.#o}update(){this.#o.clearYieldCache(this.#r),this.setAdditionalData()}x(){return this.#o.x()}y(){return this.#o.y()}yields(){return this.#o.yields(this.#r)}};t(Gg,"PlayerTile");$m=Gg});var Mg,DA,EA=i(()=>{pp();Mg=class extends Ts{};t(Mg,"Unknown");DA=Mg});var Ug,kA,SA=i(()=>{qi();EA();Ug=class extends xe{constructor(e,r,n){super(e,r,new DA,n)}};t(Ug,"UndiscoveredTile");kA=Ug});var Dg,Eg,iC=i(()=>{M();Dg=class extends x{};t(Dg,"VisibilityChanged");Eg=Dg});var kg,Ml,Sg=i(()=>{J();A();oC();qi();SA();iC();kg=class extends k{#e;#t;#r=[];#o;constructor(e,r,n=c){super(),this.#e=e,this.#o=r,this.#t=n,this.addKey("height","tiles","width")}entries(){return this.#r}filter(e){return this.entries().filter(e)}forEach(e){return this.#r.forEach(e)}get(e,r){let[n]=this.entries().filter(a=>a.x()===e&&a.y()===r);return n||new kA(e,r,this.#o)}getByTile(e){let[r]=this.filter(n=>n.tile()===e);return r??null}height(){return this.#o.height()}includes(e){return e instanceof xe?!!this.getByTile(e):this.#r.includes(e)}map(e){return this.#r.map(e)}player(){return this.#e}register(...e){e.forEach(r=>{this.includes(r)||(this.#r.push(new $m(r,this.#e)),this.#t.process(Eg,r,this.player()))})}tiles(){return this.entries()}width(){return this.#o.width()}};t(kg,"PlayerWorld");Ml=kg});var Wg,Bn,Ul=i(()=>{gd();A();Wg=class extends jm{#e;constructor(e,r,n=c){super(e,r.negotiation(),n),this.#e=r,this.addKey("proposal")}proposal(){return this.#e}};t(Wg,"Resolution");Bn=Wg});var ts,nC=i(()=>{Os();ts=class extends $r{};t(ts,"Revolution")});var WA=i(()=>{nC();nC()});var YA=i(()=>{WA()});var aC=i(()=>{YA()});var zg,ie,er=i(()=>{he();Wy();zg=class extends F{constructor(){super(Cl)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of CityGrowths returned.");return r[0]}};t(zg,"CityGrowthRegistry");ie=new zg});var De,Ae,Le=i(()=>{qe();De=class extends K{};t(De,"Wonder");Ae=De});var Kg,C,E=i(()=>{J();Kg=class extends ae{};t(Kg,"Advance");C=Kg});var qg,v,D=i(()=>{E();Pn();qg=class extends st{constructor(){super(C)}};t(qg,"AdvanceRegistry");v=new qg});var Vg,Z,mt=i(()=>{he();Ps();Vg=class extends F{constructor(){super(it)}getByPlayer(e,r=!1){return r?this.getBy("player",e):this.filter(n=>n.player()===e&&!n.destroyed())}getByTile(e){let[r]=this.filter(n=>n.tile()===e&&!n.destroyed());return r??null}};t(Vg,"CityRegistry");Z=new Vg});var Jg,Lt,rs=i(()=>{he();Qc();Jg=class extends F{constructor(){super(MI)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of Clients for Player.");return r[0]}};t(Jg,"ClientRegistry");Lt=new Jg});var _p,Xi,Zm=i(()=>{he();Do();_p=class extends F{constructor(){super(q)}};t(_p,"PlayerRegistry");Xi=new _p});var $g,os,Kp=i(()=>{Zm();$g=class extends _p{};t($g,"CurrentPlayerRegistry");os=new $g});var Zg,P,ee=i(()=>{xb();Zg=class extends Zy{#e={};#t=!1;debug(e){if(!!this.option("debug"))return e()}emit(e,...r){return this.debug(()=>console.log(`Engine#emit: ${String(e)}: ${r}`)),super.emit(e,...r)}loadPlugins(){return this.emit("plugins:load:start"),new Promise((e,r)=>{this.once("plugins:load:end",()=>e())})}option(e,r=null){return this.#e[e]||r}setOption(e,r){this.#e[e]!==r&&(this.#e[e]=r,this.emit("option:changed",e,r))}start(){this.#t||(this.#t=!0,this.emit("engine:initialise"),this.loadPlugins().then(()=>{this.emit("engine:start")}))}};t(Zg,"Engine");P=new Zg});var Qg,Ur,vm=i(()=>{he();vp();Qg=class extends F{constructor(){super(On)}getByPlayer(e){return this.entries().filter(r=>r.players().includes(e))}getByPlayers(...e){return this.entries().filter(r=>r.isBetween(...e))}};t(Qg,"InteractionRegistry");Ur=new Qg});var Xg,Qm,eh=i(()=>{M();Xg=class extends x{};t(Xg,"Complete");Qm=Xg});var th,rh,pC=i(()=>{M();th=class extends x{};t(th,"Cost");rh=th});var oh,ih,fC=i(()=>{M();oh=class extends x{};t(oh,"Requirements");ih=oh});var Dl,KA=i(()=>{We();Dl=class extends Y{};t(Dl,"Research")});var qA=i(()=>{KA()});var nh,qp,ah=i(()=>{M();nh=class extends x{};t(nh,"Started");qp=nh});var sh,Vp,mh=i(()=>{D();J();A();eh();pC();fC();qA();ah();sh=class extends k{#e;#t=[];#r=null;#o;#i=new Dl(1/0);#n=new Dl(0);#a;constructor(e,r=v,n=c){super(),this.#e=r,this.#o=e,this.#a=n,this.addKey("available","complete","cost","progress","researching")}add(e){this.#n.add(e),this.check()}addAdvance(e){if(this.#t.some(n=>n instanceof e))return;this.#r===e&&(this.#r=null);let r=new e;this.#t.push(r),this.#a.process(Qm,this,r)}available(){let e=this.#a.get(ih);return this.#e.filter(r=>e.filter(n=>n.validate(r,this.#t)).every(n=>n.process(r,this.#t)===!0)&&!this.#t.some(n=>n instanceof r))}check(){if(this.#r!==null&&this.#n.value()>=this.#i.value()){let e=new this.#r;this.#t.push(e),this.#r=null,this.#n.subtract(this.#i),this.#i.set(1/0),this.#a.process(Qm,this,e)}}complete(){return this.#t}completed(e){return this.#t.some(r=>r instanceof e)}cost(){return this.#i}player(){return this.#o}progress(){return this.#n}research(e){let[r]=this.#a.process(rh,e,this);this.#i.set(r),this.#r=e,this.#a.process(qp,this,e)}researching(){return this.#r}};t(sh,"PlayerResearch");Vp=sh});var lh,H,He=i(()=>{he();mh();lh=class extends F{constructor(){super(Vp)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of results for player.");return r[0]}};t(lh,"PlayerResearchRegistry");H=new lh});var ph,Gn,El=i(()=>{he();ph=class extends F{constructor(){super(Function)}accepts(e){return"build"in e}};t(ph,"AvailableCityBuildItemsRegistry");Gn=new ph});var Dt,VA,Jp=i(()=>{U();M();Dt=class extends x{process(e,r){let n=super.process(e,r);if(!(n instanceof sp))throw new TypeError("Invalid build rule.");return n}};t(Dt,"Build");VA=Dt});var fh,uh,uC=i(()=>{J();fh=class extends ae{#e;constructor(e){super(),this.addKey("value"),this.#e=e}value(){return this.#e}};t(fh,"BuildCost");uh=fh});var Eu,JA,Xm,gq,$p=i(()=>{uC();U();b();M();Eu=class extends x{};t(Eu,"BuildCost");JA=Eu,Xm=t((o,e)=>gq([[o,e]]),"buildCost"),gq=t(o=>o.map(([e,r])=>new Eu(new l(n=>n.item()===e),new p(()=>new uh(r)))),"buildCosts")});var ch,yh,cC=i(()=>{A();uC();$p();J();ch=class extends ae{#e;#t=new uh(1/0);#r;#o;constructor(e,r=null,n=c){super(),this.#r=e,this.#e=r,this.#o=n,this.addKey("cost","item")}cost(){if(!Number.isFinite(this.#t.value())){let[e]=this.#o.process(JA,this,this.#e);e&&(this.#t=e)}return this.#t}item(){return this.#r}};t(ch,"BuildItem");yh=ch});var kl,$A=i(()=>{We();kl=class extends Y{};t(kl,"BuildProgress")});var ZA=i(()=>{$A()});var dh,QA,XA=i(()=>{M();dh=class extends x{};t(dh,"BuildingCancelled");QA=dh});var gh,en,Zp=i(()=>{M();gh=class extends x{};t(gh,"BuildingComplete");en=gh});var hh,el,ku=i(()=>{El();J();A();Jp();cC();ZA();XA();Zp();hh=class extends k{#e;#t=null;#r;#o=new kl(1/0);#i=new kl;#n;constructor(e,r=Gn,n=c){super(),this.#e=r,this.#r=e,this.#n=n,this.addKey("available","building","city","cost","progress","remaining")}add(e){this.#i.add(e)}available(){let e=this.#n.get(VA);return this.#e.filter(r=>e.filter(n=>n.validate(this.city(),r)).every(n=>n.process(this.city(),r).validate())).map(r=>new yh(r,this.city(),this.#n))}build(e){let r=this.getAvailable(e);if(!r)throw new TypeError(`Cannot build ${e.name}, it's not available.`);this.#t=r,this.#o.set(this.#t.cost().value())}building(){return this.#t}check(){if(this.#i.value()>=this.#o.value()&&this.#t){let e=this.#t.item().build(this.#r,this.#n);return this.#i.set(0),this.#t=null,this.#o.set(1/0),this.#n.process(en,this,e),e}return null}city(){return this.#r}cost(){return this.#o}getAvailable(e){return this.available().filter(r=>r.item()===e)[0]}progress(){return this.#i}remaining(){return this.#o.value()-this.#i.value()}revalidate(){this.#t&&!this.getAvailable(this.#t.item())&&(this.#t=null,this.#o.set(1/0),this.#n.process(QA,this))}};t(hh,"CityBuild");el=hh});var xh,zt,is=i(()=>{he();ku();xh=class extends F{constructor(){super(el)}getByCity(e){let r=this.getBy("city",e);if(r.length!==1)throw new TypeError("Wrong number of entities returned.");return r[0]}};t(xh,"CityBuildRegistry");zt=new xh});var Rh,Mn,Su=i(()=>{M();Rh=class extends x{};t(Rh,"Spend");Mn=Rh});var Oh,eB,tB=i(()=>{M();Oh=class extends x{};t(Oh,"Rush");eB=Oh});var vh,bh,yC=i(()=>{is();A();J();Su();We();tB();vh=class extends ae{#e;#t;#r;#o=0;#i;constructor(e,r,n=zt,a=c){super(),this.addKey("value","yield"),this.#e=n,this.#t=e,this.#r=a,this.#i=r}add(e){if(e instanceof Y){this.add(e.value());return}this.#o+=e}buy(e){let r=this.#e.getByCity(e),[n]=this.cost(e).filter(s=>s.resource()===this.#i),a=n.value();e.player()!==this.#t||this.value()<a||(this.#r.process(eB,r,n),r.add(new Y(r.remaining())),this.subtract(a))}cost(e){let r=this.#e.getByCity(e);return this.#r.process(Mn,r)}player(){return this.#t}set(e){this.#o=0,this.add(e)}subtract(e){if(e instanceof Y){this.add(e.value());return}this.#o-=e}value(){return this.#o}yield(){return this.#i}};t(vh,"PlayerTreasury");bh=vh});var Ch,tn,Sl=i(()=>{he();yC();Ch=class extends F{constructor(){super(bh)}getByPlayer(e){return this.getBy("player",e)}getByPlayerAndType(e,r){let n=this.filter(a=>a.player()===e&&a.yield()===r);if(n.length!==1)throw new TypeError(`Wrong number of playerTreasuries: ${n.length}`);return n[0]}};t(Ch,"PlayerTreasuryRegistry");tn=new Ch});var Th,me,Ri=i(()=>{he();Sg();Th=class extends F{constructor(){super(Ml)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError(`Wrong number of player worlds exist for player: ${e.id()}`);return r[0]}};t(Th,"PlayerWorldRegistry");me=new Th});var Ph,tl,dC=i(()=>{M();Ph=class extends x{};t(Ph,"Year");tl=Ph});var Ih,Ns,Fu=i(()=>{J();A();Mt();dC();Ih=class extends k{#e=new Map;#t;#r;constructor(e=te,r=c){super(),this.#t=r,this.#r=e,this.addKey("value")}value(e=this.#r.value()){if(!this.#e.has(e)){let[n]=this.#t.process(tl,e);this.#e.set(e,n)}let r=this.#e.get(e);if(typeof r!="number")throw new TypeError("Invalid cache result.");return r}};t(Ih,"Year");Ns=new Ih});var Fl,tt,Un=i(()=>{Fl=t((o,...e)=>o.reduce((r,n)=>{let a=e.findIndex(s=>n instanceof s);return a===-1||(r[a]+=n.value()),r},e.map(()=>0)),"reduceYields"),tt=t((o,e)=>Fl(o,e).shift()??0,"reduceYield")});var rB,gC,hC,Nu,wh,xC,Wu,RC=i(()=>{er();pd();Ri();fi();Un();Ry();rB=t(o=>gC(o.tiles().entries(),o),"getHighestValueCityTiles"),gC=t((o,e,r=[[X,8],[$,3*(tt(e.tilesWorked().yields(e.player()),$)===0?3:1)],[oe,1*(tt(e.tilesWorked().yields(e.player()),oe)===0?2:1)]])=>o.sort((n,a)=>a.score(e.player(),r)-n.score(e.player(),r)),"sortTiles"),hC=t((o,e=me,r=Se)=>rB(o).filter(n=>r.tileCanBeWorkedBy(n,o)&&e.getByPlayer(o.player()).includes(n)),"getHighestValueAvailableCityTiles"),Nu=t((o,e=me,r=ie,n=Se)=>{n.getBy("city",o).forEach(a=>n.unregister(a)),n.register(new Fm(o.tile(),o)),wh(o,e,r,n)},"reassignWorkers"),wh=t((o,e=me,r=ie,n=Se)=>{let a=r.getByCity(o);hC(o,e,n).some(s=>o.tilesWorked().length>=a.size()+1?!0:(n.register(new Fm(s,o)),!1))},"assignWorkers"),xC=t((o,e=me,r=ie,n=Se)=>{let[a]=hC(o,e,n);!a||n.register(new Fm(a,o))},"assignWorker"),Wu=t((o,e)=>gC(o.tilesWorked().entries().filter(r=>r!==o.tile()),o).slice(e.size()),"reduceWorkers")});var Qp,rl=i(()=>{RC();RC();Qp=wh});var Et,aB,Mh=i(()=>{Xr();Et=class extends Q{};t(Et,"Arctic");aB=Et});var sB=i(()=>{Mh();Mh()});var Ie,mB,Uh=i(()=>{Xr();Ie=class extends Q{};t(Ie,"Desert");mB=Ie});var lB=i(()=>{Uh();Uh()});var pB=i(()=>{hu();hu()});var fB=i(()=>{Bl();Bl()});var Ee,uB,Dh=i(()=>{Xr();Ee=class extends Q{};t(Ee,"Hills");uB=Ee});var cB=i(()=>{Dh();Dh()});var rt,yB,Eh=i(()=>{Xr();rt=class extends Q{};t(rt,"Jungle");yB=rt});var dB=i(()=>{Eh();Eh()});var ze,gB,kh=i(()=>{Xr();ze=class extends Q{};t(ze,"Mountains");gB=ze});var hB=i(()=>{kh();kh()});var lt,xB,Sh=i(()=>{mb();lt=class extends Qr{};t(lt,"Ocean");xB=lt});var RB=i(()=>{Sh();Sh()});var OB=i(()=>{Up();Up()});var le,Fh,zu=i(()=>{Xr();le=class extends Q{};t(le,"River");Fh=le});var vB=i(()=>{zu();zu()});var ot,bB,Nh=i(()=>{Xr();ot=class extends Q{};t(ot,"Swamp");bB=ot});var CB=i(()=>{Nh();Nh()});var gt,TB,Wh=i(()=>{Xr();gt=class extends Q{};t(gt,"Tundra");TB=gt});var PB=i(()=>{Wh();Wh()});var IB=i(()=>{sB();lB();pB();fB();cB();dB();hB();RB();OB();vB();CB();PB()});var En=i(()=>{IB()});var wB=i(()=>{Ms();Ms()});var AB=i(()=>{mm();mm()});var BB=i(()=>{Gs();Gs()});var GB=i(()=>{wB();AB();BB()});var Xp=i(()=>{GB()});var ht,ef,tf=i(()=>{Es();ht=class extends Fe{};t(ht,"Air");ef=ht});var MB=i(()=>{tf();tf()});var _e,Yh,ju=i(()=>{Es();_e=class extends Fe{};t(_e,"Land");Yh=_e});var V,ur=i(()=>{ju();V=class extends Yh{};t(V,"Fortifiable")});var UB=i(()=>{ur();ur()});var DB=i(()=>{ju();ju()});var Ne,Ws,ol=i(()=>{Es();Ne=class extends Fe{};t(Ne,"Naval");Ws=Ne});var EB=i(()=>{ol();ol()});var Lh,zh,bC=i(()=>{Lh=class{#e;#t;#r;constructor(e,r,n){this.#t=e,this.#r=r,this.#e=n}sourceTile(){return this.#e}transport(){return this.#t}unit(){return this.#r}};t(Lh,"TransportManifest");zh=Lh});var jh,kn,Wl=i(()=>{he();bC();jh=class extends F{constructor(){super(zh)}getByTransport(e){return this.getBy("transport",e)}getByUnit(e){let r=this.getBy("unit",e);if(r.length!==1)throw new TypeError(`Wrong number of results. (${r.length})`);return r[0]}};t(jh,"TransportRegistry");kn=new jh});var il,kB=i(()=>{We();il=class extends Y{};t(il,"Capacity")});var nl,SB=i(()=>{We();nl=class extends Y{};t(nl,"CargoWeight")});var CC=i(()=>{kB();SB()});var Hh,_h,TC=i(()=>{M();Hh=class extends x{};t(Hh,"Stowed");_h=Hh});var Kh,FB,NB=i(()=>{M();Kh=class extends x{};t(Kh,"Unloaded");FB=Kh});var qh,WB,YB=i(()=>{M();qh=class extends x{};t(qh,"CanStow");WB=qh});var Vh,LB,Jh=i(()=>{CC();A();Wl();Es();TC();bC();NB();YB();Vh=t(o=>t(class extends o{#e=c;#t=kn;canStow(r){return this.#e.process(WB,this,r).every(n=>n)}capacity(){let[r]=this.yield(new il);return r}cargo(){return this.#t.getByTransport(this).map(r=>r.unit())}cargoWeight(){let[r]=this.yield(new nl);return r}hasCapacity(){return this.cargoWeight().value()<this.capacity().value()}hasCargo(){return this.#t.getByTransport(this).length>0}setRuleRegistry(r){this.#e=r}setTransportRegistry(r){this.#t=r}stow(r,n=r.tile()){return!this.hasCapacity()||!this.canStow(r)?!1:(this.#t.register(new zh(this,r,n)),this.#e.process(_h,r,this),!0)}unload(r){try{let n=this.#t.getByUnit(r);return this.#t.unregister(n),this.#e.process(FB,r,this),!0}catch{return!1}}},"Transport"),"Transport"),LB=Vh});var jt,Ys,al=i(()=>{A();Wl();ol();Jh();jt=class extends LB(Ws){constructor(e,r,n,a=c,s=kn){super(e,r,n,a),this.setRuleRegistry(a),this.setTransportRegistry(s)}};t(jt,"NavalTransport");Ys=jt});var zB=i(()=>{al();al()});var jB=i(()=>{Jh();Jh()});var cr,$h=i(()=>{ju();cr=class extends Yh{};t(cr,"Worker")});var HB=i(()=>{$h();$h()});var PC=i(()=>{MB();UB();DB();EB();zB();jB();HB()});var Ls=i(()=>{PC()});var Oi,IC=i(()=>{Qi();Oi=class extends at{};t(Oi,"Coal")});var _B=i(()=>{IC();IC()});var vi,wC=i(()=>{Qi();vi=class extends at{};t(vi,"Fish")});var KB=i(()=>{wC();wC()});var io,AC=i(()=>{Qi();io=class extends at{};t(io,"Game")});var qB=i(()=>{AC();AC()});var bi,BC=i(()=>{Qi();bi=class extends at{};t(bi,"Gems")});var VB=i(()=>{BC();BC()});var Ci,GC=i(()=>{Qi();Ci=class extends at{};t(Ci,"Gold")});var JB=i(()=>{GC();GC()});var $B=i(()=>{dg();dg()});var no,MC=i(()=>{Qi();no=class extends at{};t(no,"Oasis")});var ZB=i(()=>{MC();MC()});var Ti,UC=i(()=>{Qi();Ti=class extends at{};t(Ti,"Oil")});var QB=i(()=>{UC();UC()});var Pi,DC=i(()=>{Qi();Pi=class extends at{};t(Pi,"Seal")});var XB=i(()=>{DC();DC()});var eG=i(()=>{gu();gu()});var tG=i(()=>{_B();KB();qB();VB();JB();$B();ZB();QB();XB();eG()});var Hu=i(()=>{tG()});var Zh,Yl,EC=i(()=>{M();Zh=class extends x{};t(Zh,"Action");Yl=Zh});var Qh,Xh,kC=i(()=>{M();Qh=class extends x{};t(Qh,"ActionPerformed");Xh=Qh});var ex,rf,SC=i(()=>{M();ex=class extends x{};t(ex,"Discovered");rf=ex});var tx,rx,FC=i(()=>{J();A();EC();kC();SC();tx=class extends k{#e;#t;constructor(e,r=c){super(),this.#e=r,this.#t=e,this.addKey("tile")}action(e){this.#e.process(Xh,this,e),e.perform()}actions(e){return this.#e.process(Yl,this,e)}process(e){this.#e.process(rf,this,e)}tile(){return this.#t}};t(tx,"GoodyHut");rx=tx});var ox,Ii,sl=i(()=>{FC();he();ox=class extends F{constructor(){super(rx)}getByTile(e){let r=this.filter(n=>n.tile()===e);return r.length===0?null:r[0]}};t(ox,"GoodyHutRegistry");Ii=new ox});var rG=i(()=>{kd();kd()});var oG=i(()=>{Nd();Nd()});var NC=i(()=>{wl()});var iG=i(()=>{NC();NC()});var nG=i(()=>{zd();zd()});var aG=i(()=>{Yd();Yd()});var sG=i(()=>{rG();oG();iG();nG();aG()});var zs=i(()=>{sG()});var ix,wi,ml=i(()=>{J();ix=class extends ae{};t(ix,"Government");wi=ix});var nx,of,ax=i(()=>{Pn();ml();nx=class extends st{constructor(){super(wi)}};t(nx,"AvailableGovernmentRegistry");of=new nx});var sx,_u,YC=i(()=>{M();sx=class extends x{};t(sx,"Availability");_u=sx});var mx,Ku,LC=i(()=>{M();mx=class extends x{};t(mx,"Changed");Ku=mx});var lx,px,zC=i(()=>{ax();J();A();YC();LC();lx=class extends k{#e;#t=null;#r;#o;constructor(e,r=of,n=c){super(),this.#r=e,this.#e=r,this.#o=n,this.addKey("available","current")}available(){return this.#e.filter(e=>this.#o.get(_u).some(r=>r.validate(e,this.#r)))}current(){return this.#t}is(...e){return e.some(r=>this.#t instanceof r)}player(){return this.#r}set(e){this.#t=e,this.#o.process(Ku,this.#r,e)}};t(lx,"PlayerGovernment");px=lx});var fx,Ht,ns=i(()=>{he();zC();fx=class extends F{constructor(){super(px)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerGovernments for player.");return r[0]}};t(fx,"PlayerGovernmentRegistry");Ht=new fx});var ux,as,cx=i(()=>{Ul();ux=class extends Bn{};t(ux,"Accept");as=ux});var yx,js,dx=i(()=>{A();Pp();yx=class extends Hm{#e;constructor(e,r,n,a=c){super(r,n,a),this.#e=e,this.addKey("advances")}advances(){return this.#e}};t(yx,"ExchangeKnowledge");js=yx});var mG=i(()=>{tg();tg()});var ss,jC=i(()=>{Qd();ss=class extends Ep{};t(ss,"Veteran")});var lG=i(()=>{jC();jC()});var pG=i(()=>{mG();lG()});var qu=i(()=>{pG()});var rn,Vu,Ju=i(()=>{E();rn=class extends C{};t(rn,"AdvancedFlight");Vu=rn});var fG=i(()=>{Ju();Ju()});var So,uG,gx=i(()=>{E();So=class extends C{};t(So,"Alphabet");uG=So});var cG=i(()=>{gx();gx()});var ao,yG,hx=i(()=>{E();ao=class extends C{};t(ao,"Astronomy");yG=ao});var dG=i(()=>{hx();hx()});var on,gG,xx=i(()=>{E();on=class extends C{};t(on,"AtomicTheory");gG=on});var hG=i(()=>{xx();xx()});var _t,$u,Zu=i(()=>{E();_t=class extends C{};t(_t,"Automobile");$u=_t});var xG=i(()=>{Zu();Zu()});var so,RG,Rx=i(()=>{E();so=class extends C{};t(so,"Banking");RG=so});var OG=i(()=>{Rx();Rx()});var Fo,vG,Ox=i(()=>{E();Fo=class extends C{};t(Fo,"BridgeBuilding");vG=Fo});var bG=i(()=>{Ox();Ox()});var No,vx,Qu=i(()=>{E();No=class extends C{};t(No,"BronzeWorking");vx=No});var CG=i(()=>{Qu();Qu()});var mo,TG,bx=i(()=>{E();mo=class extends C{};t(mo,"CeremonialBurial");TG=mo});var PG=i(()=>{bx();bx()});var Ai,IG,Cx=i(()=>{E();Ai=class extends C{};t(Ai,"Chemistry");IG=Ai});var wG=i(()=>{Cx();Cx()});var Sn,Xu,ec=i(()=>{E();Sn=class extends C{};t(Sn,"Chivalry");Xu=Sn});var AG=i(()=>{ec();ec()});var yr,BG,Tx=i(()=>{E();yr=class extends C{};t(yr,"CodeOfLaws");BG=yr});var GG=i(()=>{Tx();Tx()});var Bi,tc,rc=i(()=>{E();Bi=class extends C{};t(Bi,"Combustion");tc=Bi});var MG=i(()=>{rc();rc()});var Tt,UG,Px=i(()=>{E();Tt=class extends C{};t(Tt,"Communism");UG=Tt});var DG=i(()=>{Px();Px()});var lo,EG,Ix=i(()=>{E();lo=class extends C{};t(lo,"Computers");EG=lo});var kG=i(()=>{Ix();Ix()});var Fn,Ll,oc=i(()=>{E();Fn=class extends C{};t(Fn,"Conscription");Ll=Fn});var SG=i(()=>{oc();oc()});var Dr,FG,wx=i(()=>{E();Dr=class extends C{};t(Dr,"Construction");FG=Dr});var NG=i(()=>{wx();wx()});var Wo,WG,Ax=i(()=>{E();Wo=class extends C{};t(Wo,"Corporation");WG=Wo});var YG=i(()=>{Ax();Ax()});var po,LG,Bx=i(()=>{E();po=class extends C{};t(po,"Currency");LG=po});var zG=i(()=>{Bx();Bx()});var Yo,jG,Gx=i(()=>{E();Yo=class extends C{};t(Yo,"Democracy");jG=Yo});var HG=i(()=>{Gx();Gx()});var dr,_G,Mx=i(()=>{E();dr=class extends C{};t(dr,"Electricity");_G=dr});var KG=i(()=>{Mx();Mx()});var xt,qG,Ux=i(()=>{E();xt=class extends C{};t(xt,"Electronics");qG=xt});var VG=i(()=>{Ux();Ux()});var Gi,JG,Dx=i(()=>{E();Gi=class extends C{};t(Gi,"Engineering");JG=Gi});var $G=i(()=>{Dx();Dx()});var Mi,ZG,Ex=i(()=>{E();Mi=class extends C{};t(Mi,"Explosives");ZG=Mi});var QG=i(()=>{Ex();Ex()});var nn,XG,kx=i(()=>{E();nn=class extends C{};t(nn,"Feudalism");XG=nn});var eM=i(()=>{kx();kx()});var an,Sx,ic=i(()=>{E();an=class extends C{};t(an,"Flight");Sx=an});var tM=i(()=>{ic();ic()});var Nn,rM,Fx=i(()=>{E();Nn=class extends C{};t(Nn,"FusionPower");rM=Nn});var oM=i(()=>{Fx();Fx()});var Ui,iM,Nx=i(()=>{E();Ui=class extends C{};t(Ui,"GeneticEngineering");iM=Ui});var nM=i(()=>{Nx();Nx()});var tr,nf,nc=i(()=>{E();tr=class extends C{};t(tr,"Gunpowder");nf=tr});var aM=i(()=>{nc();nc()});var Wn,Wx,ac=i(()=>{E();Wn=class extends C{};t(Wn,"HorsebackRiding");Wx=Wn});var sM=i(()=>{ac();ac()});var rr,sc,mc=i(()=>{E();rr=class extends C{};t(rr,"Industrialization");sc=rr});var mM=i(()=>{mc();mc()});var gr,lM,Yx=i(()=>{E();gr=class extends C{};t(gr,"Invention");lM=gr});var pM=i(()=>{Yx();Yx()});var Di,Lx,lc=i(()=>{E();Di=class extends C{};t(Di,"IronWorking");Lx=Di});var fM=i(()=>{lc();lc()});var Yn,zx,pc=i(()=>{E();Yn=class extends C{};t(Yn,"LaborUnion");zx=Yn});var uM=i(()=>{pc();pc()});var hr,cM,jx=i(()=>{E();hr=class extends C{};t(hr,"Literacy");cM=hr});var yM=i(()=>{jx();jx()});var Er,fc,uc=i(()=>{E();Er=class extends C{};t(Er,"Magnetism");fc=Er});var dM=i(()=>{uc();uc()});var Lo,Hx,cc=i(()=>{E();Lo=class extends C{};t(Lo,"MapMaking");Hx=Lo});var gM=i(()=>{cc();cc()});var Kt,hM,_x=i(()=>{E();Kt=class extends C{};t(Kt,"Masonry");hM=Kt});var xM=i(()=>{_x();_x()});var xr,Kx,yc=i(()=>{E();xr=class extends C{};t(xr,"MassProduction");Kx=xr});var RM=i(()=>{yc();yc()});var fo,qx,dc=i(()=>{E();fo=class extends C{};t(fo,"Mathematics");qx=fo});var OM=i(()=>{dc();dc()});var uo,vM,Vx=i(()=>{E();uo=class extends C{};t(uo,"Medicine");vM=uo});var bM=i(()=>{Vx();Vx()});var Ei,gc,hc=i(()=>{E();Ei=class extends C{};t(Ei,"Metallurgy");gc=Ei});var CM=i(()=>{hc();hc()});var kr,TM,Jx=i(()=>{E();kr=class extends C{};t(kr,"Monarchy");TM=kr});var PM=i(()=>{Jx();Jx()});var qt,IM,$x=i(()=>{E();qt=class extends C{};t(qt,"Mysticism");IM=qt});var wM=i(()=>{$x();$x()});var co,xc,Rc=i(()=>{E();co=class extends C{};t(co,"Navigation");xc=co});var AM=i(()=>{Rc();Rc()});var Sr,BM,Zx=i(()=>{E();Sr=class extends C{};t(Sr,"NuclearFission");BM=Sr});var GM=i(()=>{Zx();Zx()});var zo,MM,Qx=i(()=>{E();zo=class extends C{};t(zo,"NuclearPower");MM=zo});var UM=i(()=>{Qx();Qx()});var Fr,DM,Xx=i(()=>{E();Fr=class extends C{};t(Fr,"Philosophy");DM=Fr});var EM=i(()=>{Xx();Xx()});var yo,kM,eR=i(()=>{E();yo=class extends C{};t(yo,"Physics");kM=yo});var SM=i(()=>{eR();eR()});var ki,Oc,vc=i(()=>{E();ki=class extends C{};t(ki,"Plastics");Oc=ki});var FM=i(()=>{vc();vc()});var Si,NM,tR=i(()=>{E();Si=class extends C{};t(Si,"Pottery");NM=Si});var WM=i(()=>{tR();tR()});var Nr,YM,rR=i(()=>{E();Nr=class extends C{};t(Nr,"Railroad");YM=Nr});var LM=i(()=>{rR();rR()});var Fi,zM,oR=i(()=>{E();Fi=class extends C{};t(Fi,"Recycling");zM=Fi});var jM=i(()=>{oR();oR()});var go,HM,iR=i(()=>{E();go=class extends C{};t(go,"Refining");HM=go});var _M=i(()=>{iR();iR()});var Pt,KM,nR=i(()=>{E();Pt=class extends C{};t(Pt,"Religion");KM=Pt});var qM=i(()=>{nR();nR()});var Ni,bm,af=i(()=>{E();Ni=class extends C{};t(Ni,"Robotics");bm=Ni});var VM=i(()=>{af();af()});var sn,aR,bc=i(()=>{E();sn=class extends C{};t(sn,"Rocketry");aR=sn});var JM=i(()=>{bc();bc()});var jo,sR,Cc=i(()=>{E();jo=class extends C{};t(jo,"SpaceFlight");sR=jo});var $M=i(()=>{Cc();Cc()});var mn,mR,Tc=i(()=>{E();mn=class extends C{};t(mn,"SteamEngine");mR=mn});var ZM=i(()=>{Tc();Tc()});var ln,lR,Pc=i(()=>{E();ln=class extends C{};t(ln,"Steel");lR=ln});var QM=i(()=>{Pc();Pc()});var Ho,XM,pR=i(()=>{E();Ho=class extends C{};t(Ho,"Superconductor");XM=Ho});var eU=i(()=>{pR();pR()});var ho,tU,fR=i(()=>{E();ho=class extends C{};t(ho,"TheRepublic");tU=ho});var rU=i(()=>{fR();fR()});var Ln,uR,Ic=i(()=>{E();Ln=class extends C{};t(Ln,"TheWheel");uR=Ln});var oU=i(()=>{Ic();Ic()});var _o,iU,cR=i(()=>{E();_o=class extends C{};t(_o,"TheoryOfGravity");iU=_o});var nU=i(()=>{cR();cR()});var Wi,yR,wc=i(()=>{E();Wi=class extends C{};t(Wi,"Trade");yR=Wi});var aU=i(()=>{wc();wc()});var or,sU,dR=i(()=>{E();or=class extends C{};t(or,"University");sU=or});var mU=i(()=>{dR();dR()});var xo,gR,Ac=i(()=>{E();xo=class extends C{};t(xo,"Writing");gR=xo});var lU=i(()=>{Ac();Ac()});var hR=i(()=>{fG();cG();dG();hG();xG();OG();bG();CG();PG();wG();AG();GG();MG();DG();kG();SG();NG();YG();zG();HG();KG();VG();$G();QG();eM();tM();oM();nM();aM();sM();mM();pM();fM();uM();yM();dM();gM();xM();RM();OM();bM();CM();PM();wM();AM();GM();UM();EM();SM();FM();WM();LM();jM();_M();qM();VM();JM();$M();ZM();QM();eU();rU();oU();nU();aU();mU();lU()});var pn=i(()=>{hR()});var Ro,HC=i(()=>{ml();Ro=class extends wi{};t(Ro,"Anarchy")});var pU=i(()=>{HC();HC()});var It,_C=i(()=>{ml();It=class extends wi{};t(It,"Communism")});var fU=i(()=>{_C();_C()});var pt,KC=i(()=>{ml();pt=class extends wi{};t(pt,"Democracy")});var uU=i(()=>{KC();KC()});var Vt,qC=i(()=>{ml();Vt=class extends wi{};t(Vt,"Despotism")});var cU=i(()=>{qC();qC()});var ft,VC=i(()=>{ml();ft=class extends wi{};t(ft,"Monarchy")});var yU=i(()=>{VC();VC()});var Rt,JC=i(()=>{ml();Rt=class extends wi{};t(Rt,"Republic")});var dU=i(()=>{JC();JC()});var $C=i(()=>{pU();fU();uU();cU();yU();dU()});var Hs=i(()=>{$C()});var xR,_s,RR=i(()=>{Pp();xR=class extends Hm{};t(xR,"OfferPeace");_s=xR});var Wr,ZC=i(()=>{qe();Wr=class extends K{};t(Wr,"Aqueduct")});var gU=i(()=>{ZC();ZC()});var ir,QC=i(()=>{qe();ir=class extends K{};t(ir,"Bank")});var hU=i(()=>{QC();QC()});var Yr,XC=i(()=>{qe();Yr=class extends K{};t(Yr,"Barracks")});var xU=i(()=>{XC();XC()});var nr,eT=i(()=>{qe();nr=class extends K{};t(nr,"Cathedral")});var RU=i(()=>{eT();eT()});var Ko,tT=i(()=>{qe();Ko=class extends K{};t(Ko,"CityWalls")});var OU=i(()=>{tT();tT()});var Lr,rT=i(()=>{qe();Lr=class extends K{};t(Lr,"Colosseum")});var vU=i(()=>{rT();rT()});var Rr,oT=i(()=>{qe();Rr=class extends K{};t(Rr,"Courthouse")});var bU=i(()=>{oT();oT()});var Jt,iT=i(()=>{qe();Jt=class extends K{};t(Jt,"Factory")});var CU=i(()=>{iT();iT()});var zr,nT=i(()=>{qe();zr=class extends K{};t(zr,"Granary")});var TU=i(()=>{nT();nT()});var wt,aT=i(()=>{qe();wt=class extends K{};t(wt,"HydroPlant")});var PU=i(()=>{aT();aT()});var Or,sT=i(()=>{qe();Or=class extends K{};t(Or,"Library")});var IU=i(()=>{sT();sT()});var vr,mT=i(()=>{qe();vr=class extends K{};t(vr,"ManufacturingPlant")});var wU=i(()=>{mT();mT()});var ar,lT=i(()=>{qe();ar=class extends K{};t(ar,"Marketplace")});var AU=i(()=>{lT();lT()});var qo,pT=i(()=>{qe();qo=class extends K{};t(qo,"MassTransit")});var BU=i(()=>{pT();pT()});var At,fT=i(()=>{qe();At=class extends K{};t(At,"NuclearPlant")});var GU=i(()=>{fT();fT()});var ut,uT=i(()=>{qe();ut=class extends K{};t(ut,"Palace")});var MU=i(()=>{uT();uT()});var Bt,cT=i(()=>{qe();Bt=class extends K{};t(Bt,"PowerPlant")});var UU=i(()=>{cT();cT()});var Vo,yT=i(()=>{qe();Vo=class extends K{};t(Vo,"RecyclingCenter")});var DU=i(()=>{yT();yT()});var Jo,dT=i(()=>{qe();Jo=class extends K{};t(Jo,"SdiDefence")});var EU=i(()=>{dT();dT()});var kt,gT=i(()=>{qe();kt=class extends K{};t(kt,"Temple")});var kU=i(()=>{gT();gT()});var br,hT=i(()=>{qe();br=class extends K{};t(br,"University")});var SU=i(()=>{hT();hT()});var xT=i(()=>{gU();hU();xU();RU();OU();vU();bU();CU();TU();PU();IU();wU();AU();BU();GU();MU();UU();DU();EU();kU();SU()});var fn=i(()=>{xT()});var OR,ms,vR=i(()=>{Sp();nu();OR=class extends cp{#e=1/0;end(){return this.entries()[this.length-1]}static for(e,r,n,a=Fs){let[s]=a.entries().map(m=>new m(e,r,n)).map(m=>m.generate()).sort((m,f)=>m.movementCost()-f.movementCost());return s&&(s.shift(),s)}movementCost(){return this.#e}setMovementCost(e){this.#e=e}push(...e){e.forEach(r=>{let n=this.end();if(this.length>0&&!r.isNeighbourOf(n))throw new TypeError(`Tile#push: Invalid element passed, ${r.x()},${r.y()} is not a neighbour of ${n.x()},${n.y()}.`);super.push(r)})}start(){return this.entries()[0]}};t(OR,"Path");ms=OR});var $o,RT=i(()=>{ur();$o=class extends V{};t($o,"Artillery")});var FU=i(()=>{RT();RT()});var Zo,OT=i(()=>{ol();Zo=class extends Ws{};t(Zo,"Battleship")});var NU=i(()=>{OT();OT()});var jr,vT=i(()=>{tf();jr=class extends ef{};t(jr,"Bomber")});var WU=i(()=>{vT();vT()});var Oo,bT=i(()=>{ur();Oo=class extends V{};t(Oo,"Cannon")});var YU=i(()=>{bT();bT()});var Qo,CT=i(()=>{ur();Qo=class extends V{};t(Qo,"Caravan")});var LU=i(()=>{CT();CT()});var vo,TT=i(()=>{al();vo=class extends Ys{};t(vo,"Carrier")});var zU=i(()=>{TT();TT()});var bo,PT=i(()=>{ur();bo=class extends V{};t(bo,"Catapult")});var jU=i(()=>{PT();PT()});var Co,IT=i(()=>{ur();Co=class extends V{};t(Co,"Chariot")});var HU=i(()=>{IT();IT()});var Xo,wT=i(()=>{ol();Xo=class extends Ws{};t(Xo,"Cruiser")});var _U=i(()=>{wT();wT()});var ei,AT=i(()=>{ur();ei=class extends V{};t(ei,"Diplomat")});var KU=i(()=>{AT();AT()});var sr,BT=i(()=>{tf();sr=class extends ef{};t(sr,"Fighter")});var qU=i(()=>{BT();BT()});var Hr,GT=i(()=>{al();Hr=class extends Ys{};t(Hr,"Frigate")});var VU=i(()=>{GT();GT()});var Cr,MT=i(()=>{ur();Cr=class extends V{};t(Cr,"Horseman")});var JU=i(()=>{MT();MT()});var To,UT=i(()=>{ol();To=class extends Ws{};t(To,"Ironclad")});var $U=i(()=>{UT();UT()});var Po,DT=i(()=>{ur();Po=class extends V{};t(Po,"Knight")});var ZU=i(()=>{DT();DT()});var ti,ET=i(()=>{ur();ti=class extends V{};t(ti,"MechanizedInfantry")});var QU=i(()=>{ET();ET()});var Io,kT=i(()=>{ur();Io=class extends V{};t(Io,"Musketman")});var XU=i(()=>{kT();kT()});var mr,ST=i(()=>{tf();mr=class extends ef{};t(mr,"Nuclear")});var eD=i(()=>{ST();ST()});var ri,FT=i(()=>{ur();ri=class extends V{};t(ri,"Rifleman")});var tD=i(()=>{FT();FT()});var _r,NT=i(()=>{al();_r=class extends Ys{};t(_r,"Sail")});var rD=i(()=>{NT();NT()});var Ke,oD,bR=i(()=>{$h();Ke=class extends cr{};t(Ke,"Settlers");oD=Ke});var iD=i(()=>{bR();bR()});var wo,WT=i(()=>{ur();wo=class extends V{};t(wo,"Spearman")});var nD=i(()=>{WT();WT()});var Kr,YT=i(()=>{ol();Kr=class extends Ws{};t(Kr,"Submarine")});var aD=i(()=>{YT();YT()});var Tr,LT=i(()=>{ur();Tr=class extends V{};t(Tr,"Swordman")});var sD=i(()=>{LT();LT()});var oi,zT=i(()=>{ur();oi=class extends V{};t(oi,"Tank")});var mD=i(()=>{zT();zT()});var Ao,jT=i(()=>{al();Ao=class extends Ys{};t(Ao,"Transport")});var lD=i(()=>{jT();jT()});var lr,HT=i(()=>{al();lr=class extends Ys{};t(lr,"Trireme")});var pD=i(()=>{HT();HT()});var ii,_T=i(()=>{ur();ii=class extends V{};t(ii,"Warrior")});var fD=i(()=>{_T();_T()});var uD=i(()=>{FU();NU();WU();YU();LU();zU();jU();HU();_U();KU();qU();VU();JU();$U();ZU();QU();XU();eD();tD();rD();iD();nD();aD();sD();mD();lD();pD();fD()});var zn=i(()=>{uD()});var CR,jn,TR=i(()=>{Ul();CR=class extends Bn{};t(CR,"Decline");jn=CR});var cD,Rq,Oq,PR,Ks,sf=i(()=>{wp();Gl();ap();is();er();mt();rs();En();ee();Xp();Ls();Hu();sl();vm();zs();Sp();ns();He();Sl();Ri();A();_a();xi();Mt();gm();Ve();cx();ey();Gp();ku();Jy();dx();qu();Bs();lu();pn();Hs();tC();RR();fn();vR();mh();Ul();zn();qi();Es();Le();rl();TR();cD=t((o,e)=>new Promise((r,n)=>setTimeout(()=>e===void 0?r():n(e),o)),"awaitTimeout"),Rq=t((o,e,r=Z)=>{let n=r.getByTile(o);return n===null?!1:n.player()===e},"hasPlayerCity"),Oq=15,PR=class extends hl{#e=e=>this.#u.getByPlayer(this.player()).some(r=>r.tiles().includes(e));#t=e=>{let r=this.#D.option("earth",!1),n=this.#u.getByPlayer(this.player()).length===0;if(r&&n)return!0;let a=this.#M.getByTerrain(e.terrain());return(e.terrain()instanceof Re||e.terrain()instanceof le||e.terrain()instanceof fe||a.some(s=>s instanceof no)||a.some(s=>s instanceof io))&&e.getSurroundingArea().score(this.player(),[[X,4],[$,2],[oe,1]])>=160&&!e.getSurroundingArea(4).filter(s=>this.#u.getByTile(s)!==null).length};#r=e=>[Ie,fe,Re,le].some(r=>e.terrain()instanceof r)&&!this.#O.getByTile(e).some(r=>r instanceof Ue)&&this.#e(e)&&[...e.getAdjacent(),e].some(r=>r.terrain()instanceof le||r.isCoast()||this.#O.getByTile(r).some(n=>n instanceof Ue)&&this.#u.getByTile(r)===null);#o=e=>[Ee,ze].some(r=>e.terrain()instanceof r)&&!this.#O.getByTile(e).some(r=>r instanceof et)&&this.#e(e);#i=e=>!this.#O.getByTile(e).some(r=>r instanceof Ye)&&this.#e(e);#n=new Map;#a=new Map;#m=new Map;#s=[];#l=[];#c=[];#h=[];#y=[];#d=[];#f=[];#u;#P;#b;#I;#w;#T;#g;#A;#B;#G;#x;#R;#M;#O;#U;#C;#p;#D;#v;constructor(e,r=Z,n=zt,a=ie,s=Ii,m=Fs,f=Ht,u=H,y=tn,R=me,B=c,N=Yt,W=Je,_=oo,d=z,g=P,h=Lt,G=Ur,L=te,Qe=()=>Math.random()){super(e),this.#u=r,this.#P=n,this.#b=a,this.#I=h,this.#w=s,this.#T=G,this.#g=m,this.#A=f,this.#B=u,this.#G=y,this.#x=R,this.#R=B,this.#M=N,this.#U=L,this.#C=_,this.#O=W,this.#p=d,this.#D=g,this.#v=Qe}scoreUnitMove(e,r){let n=e.actions(r),{attack:a,buildIrrigation:s,buildMine:m,buildRoad:f,captureCity:u,disembark:y,embark:R,fortify:B,foundCity:N,noOrders:W,sneakAttack:_}=n.reduce((Be,Jr)=>({...Be,[Jr.constructor.name.replace(/^./,sq=>sq.toLowerCase())]:Jr}),{});if(_&&!this.shouldAttack(_.enemy()))return-10;if(!n.length||n.length===1&&W||e instanceof V&&n.length===2&&B&&W)return-1;let d=0;this.#w.getByTile(r)!==null&&(d+=60),(N&&this.#t(r)||m&&this.#o(r)||s&&this.#r(r)||f&&this.#i(r))&&(d+=24);let h=this.#p.getByTile(r).sort((Be,Jr)=>Jr.defence().value()-Be.defence().value()),[G]=h,L=h.some(Be=>Be.player()===this.player());e instanceof jt&&e.hasCapacity()&&h.length&&L&&(d+=10),e instanceof jt&&e.hasCargo()&&r.isCoast()&&r.isWater()&&(d+=16),R&&(d+=16),y&&(d+=16),u&&(d+=100),a&&e.attack()>G.defence()&&(d+=24*(e.attack().value()-G.defence().value())),a&&e.attack().value()>=G.defence().value()&&(d+=16),a&&e.attack().value()>=G.defence().value()*(2/3)&&(d+=8);let Qe=this.#x.getByPlayer(this.player()),Ft=r.getNeighbours().filter(Be=>!Qe.includes(Be)).length;Ft>0&&(d+=Ft*3);let be=this.#m.get(e);return be instanceof xe&&r.distanceFrom(be)<e.tile().distanceFrom(be)&&(d+=14),(this.#n.get(e)||[]).includes(r)||(d*=4),d}async moveUnit(e){let r=0;for(;e.active()&&e.moves().value()>=.1;){if(r++>1e3){console.log("SimpleAIClient#moveUnit: loopCheck: aborting"),console.log(`${e.player().civilization().name()} ${e.constructor.name}`),console.log(e.actions()),console.log(e.actionsForNeighbours()),this.noOrders(e);return}let n=this.#a.get(e);if(n){let y=n.shift(),[R]=e.actions(y).filter(B=>B instanceof nt);if(R instanceof An&&!this.shouldAttack(R.enemy())){this.#a.delete(e);continue}if(R){e.action(R),n.length===0&&this.#a.delete(e),await this.canNegotiate(e);continue}if(n.length>0)continue;this.#a.delete(e)}let[a]=e.tile().getNeighbours().map(y=>[y,this.scoreUnitMove(e,y)]).filter(([,y])=>y>-1).sort(([,y],[,R])=>R-y||Math.floor(this.#v()*3)-1).map(([y])=>y);if(!a){this.noOrders(e);return}let s=e.actions(a),[m]=s,f=this.#n.get(e)||[],u=this.#m.get(e);if(!m||(m instanceof Xa||m instanceof An)&&!this.shouldAttack(m.enemy())){this.noOrders(e);return}u===a&&this.#m.delete(e),f.push(a),this.#n.set(e,f.slice(-50)),e.action(m)}await this.canNegotiate(e),e.moves().value()>0&&this.noOrders(e)}preProcessTurn(){this.#s.splice(0),this.#l.splice(0),this.#c.splice(0),this.#h.splice(0),this.#y.splice(0),this.#d.splice(0),this.#f.splice(0);let e=this.#x.getByPlayer(this.player());e.entries().forEach(r=>{let n=r.tile(),a=this.#u.getByTile(n),s=this.#p.getBy("tile",n),m=this.#f.includes(n)&&![...this.#m.values(),...[...this.#a.values()].map(f=>f.end())].includes(n);a&&a.player()===this.player()&&!s.length&&!this.#f.includes(n)&&!m?this.#f.push(n):a&&a.player()!==this.player()&&a.originalPlayer()===this.player()?this.#s.push(n):a&&a.player()!==this.player()&&!this.#l.includes(n)?this.#l.push(n):s.length&&s.some(f=>f.player()!==this.player())&&this.#c.includes(n)?this.#c.push(n):n.isLand()&&n.getNeighbours().some(f=>!e.includes(f))&&!this.#y.includes(n)&&!m?this.#y.push(n):n.isWater()&&n.getNeighbours().some(f=>!e.includes(f))&&this.#d.includes(n)&&!m&&this.#d.push(n),this.#t(n)&&this.#h.includes(n)&&!m&&this.#h.push(n)}),this.#u.getByPlayer(this.player()).forEach(r=>{let n=this.#p.getByTile(r.tile());Qp(r,this.#x,this.#b),!n.length&&!this.#f.includes(r.tile())&&this.#f.push(r.tile())})}async chooseFromList(e){if(e.key()!=="negotiation.next-step")return super.chooseFromList(e);let r=t(a=>this.shouldAttack(a.players().filter(m=>m!==this.player())[0])?a instanceof jn?10:-1:a instanceof js?30:a instanceof _s?20:a instanceof as?10:0,"score"),[n]=e.choices().sort((a,s)=>r(s.value())-r(a.value()));return n.value()}takeTurn(){return new Promise(async(e,r)=>{try{let n=0;this.preProcessTurn();let[a]=this.#A.filter(m=>m.player()===this.player()),[s]=this.#B.filter(m=>m.player()===this.player());for(s.completed(kr)&&!a.is(ft)&&a.set(new ft);this.player().hasMandatoryActions();){let m=this.player().mandatoryAction(),f=m.value();if(n++>1e3){console.log(""),console.log(""),console.log(f),f instanceof Fe&&(console.log(f.actions()),f.tile().getNeighbours().forEach(u=>console.log(f.actions(u))),console.log(f.active()),console.log(f.busy()),console.log(f.moves().value()),console.log(this.#C.getByUnit(f))),this.noOrders(f),console.error("SimpleAIClient: Couldn't pick an action to do.");break}if(f instanceof Fe){let u=f,y=u.tile(),R=this.#m.get(u),B=u.actions(),{buildIrrigation:N,buildMine:W,buildRoad:_,fortify:d,foundCity:g,unload:h}=B.reduce((be,Ce)=>({...be,[Ce.constructor.name.replace(/^./,Be=>Be.toLowerCase())]:Ce}),{}),G=this.#p.getByTile(y);if(this.#n.get(u)||this.#n.set(u,[u.tile()]),u instanceof jt&&h&&y.isCoast()&&u.cargo().some(be=>!y.getNeighbours().some(Ce=>(this.#n.get(be)||[]).includes(Ce)))){u.action(h),u.setWaiting();continue}if(u instanceof cr){g&&this.#t(y)?u.action(g):N&&this.#r(y)?u.action(N):W&&this.#o(y)?u.action(W):_&&this.#i(y)?u.action(_):!R&&this.#h.length&&this.#m.set(u,this.#h.shift()),await this.moveUnit(u);continue}let[Qe]=G.filter(be=>this.#C.getByUnit(be).some(Ce=>Ce instanceof Eo)&&u.defence()>be.defence()),Ft=this.#u.getByTile(y);if(d&&Ft&&(Qe||G.length<=Math.ceil(this.#b.getByCity(Ft).size()/5))){u.action(d),Qe&&Qe.activate();continue}if(!R){if(u instanceof V&&u.defence().value()>0&&this.#f.length>0){let[be]=this.#f.sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#f.splice(this.#f.indexOf(be),1),this.#a.set(u,Ce))}else if(u.attack().value()>0&&this.#s.length>0){let[be]=this.#s.filter(Be=>u instanceof _e&&Be.isLand()).sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#s.splice(this.#s.indexOf(be),1),this.#a.set(u,Ce))}else if(u.attack().value()>0&&this.#c.length>0){let[be]=this.#c.filter(Be=>u instanceof _e&&Be.isLand()||u instanceof Ne&&Be.isWater()).sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#c.splice(this.#c.indexOf(be),1),this.#a.set(u,Ce))}else if(u instanceof _e&&u.attack().value()>0&&this.#l.length>0){let[be]=this.#l.sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#l.splice(this.#l.indexOf(be),1),this.#a.set(u,Ce))}else if(u instanceof _e&&this.#y.length>0){let[be]=this.#y.sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#y.splice(this.#y.indexOf(be),1),this.#a.set(u,Ce))}else if(u instanceof Ne&&this.#d.length>0){let[be]=this.#d.sort((Be,Jr)=>Be.distanceFrom(u.tile())-Jr.distanceFrom(u.tile())),Ce=ms.for(u,u.tile(),be,this.#g);Ce&&(this.#d.splice(this.#d.indexOf(be),1),this.#a.set(u,Ce))}}await this.moveUnit(u);continue}if(f instanceof el){this.buildItemInCity(f.city());continue}if(f instanceof Vp){let u=f.available();u.length&&f.research(u[Math.floor(u.length*this.#v())]);continue}if(m instanceof Vy)break;console.log(`Can't process: '${f.constructor.name}'`);break}e()}catch(n){if(typeof n=="string"){r(new Error(n));return}if(n instanceof Error){r(n);return}r(new Error(`An unknown error occurred: ${n}`))}})}buildItemInCity(e){let r=e.tile(),n=this.#P.getByCity(e),a=this.#p.getByTile(r),s=n.available(),m=[ut,Ke],f=s.filter(d=>!m.includes(d.item())&&!Object.prototype.isPrototypeOf.call(Ae,d.item())),u=s.filter(d=>Object.prototype.isPrototypeOf.call(Ae,d.item())),y=f.filter(d=>Object.prototype.isPrototypeOf.call(Fe,d.item())),R=f[Math.floor(f.length*this.#v())].item(),B=t(d=>{let[[g]]=y.map(h=>{let G=h.item(),L=new d;return this.#R.process(Km,G,L),[G,L]}).sort(([,h],[,G])=>G.value()-h.value());return g},"getUnitByYield"),N=(d=>()=>d||(d=B($i)))(),W=(d=>()=>d||(d=B(bn)))();if(this.#p.getByTile(r).length<2&&N()){n.build(N());return}let _=this.#b.getByCity(n.city());if(s.some(d=>d.item()===Ke)&&!this.#p.getByCity(n.city()).some(d=>d instanceof Ke)&&this.#p.getByPlayer(this.player()).filter(d=>d instanceof Ke).length<3&&_.size()>1){n.build(Ke);return}if(this.#s.length>0||this.#l.length>0||this.#c.length>4){n.build(W());return}if(a.filter(d=>this.#C.getByUnit(d).filter(g=>g instanceof Eo)).length<2||this.#f.length){n.build(N());return}if(n.city().yields().filter(d=>d instanceof $).some(d=>d.value()>4)){let d=u.map(g=>g.item());n.build(d[Math.floor(this.#v()*d.length)])}R&&n.build(R)}cityLost(e,r,n){if(!r)return;let a=this.#x.getByPlayer(this.player());if(n){this.#l.push(...a.entries().filter(s=>Rq(s.tile(),this.player(),this.#u)).map(s=>s.tile())),this.#c.push(...a.entries().filter(s=>this.#p.getByTile(s.tile()).some(m=>m.player()===r)).map(s=>s.tile()));return}this.#s.push(e.tile())}unitDestroyed(e,r){let n=this.#u.getByTile(e.tile()),a=this.#p.getByTile(e.tile());n&&n.player()===this.player()&&a.length<2&&(this.buildItemInCity(n),this.#G.getByPlayerAndType(this.player(),ci).buy(n))}async canNegotiate(e){let r=Array.from(new Set(e.tile().getNeighbours().flatMap(n=>this.#p.getByTile(n).map(a=>a.player()).filter(a=>a!==this.player()))));r.length!==0&&await r.filter(n=>this.#T.getByPlayer(n).filter(a=>a instanceof Wp&&a.isBetween(n,this.player())).every(a=>this.#U.value()-a.when()>Oq)).reduce((n,a)=>n.then(()=>this.handleNegotiation(a)),Promise.resolve())}async handleNegotiation(e){let r=new Wp(this.player(),e,this.#R);for(r.proceed(new vn(this.player(),r,this.#R));!r.terminated();){let n=r.lastInteraction();if(await(n!==null?n.for():r.players().slice(1)).reduce(async(s,m)=>s.then(async()=>{let f=this.#I.getByPlayer(m),u=r.nextSteps(),R=await Promise.race([f.chooseFromList(new Mm(u,"negotiation.next-step",r)),f instanceof hl?cD(500,new Error(`Timeout waiting for ${f.player().id()} (${f.player().civilization().sourceClass().name}) - sent ${u.length} options`)):new Promise(()=>{})]);!R||(r.proceed(R),R instanceof Bn&&await R.proposal().resolve(R),await cD(20))}).catch(f=>console.error(f)),Promise.resolve()),r.terminated())break}return this.#T.register(r),r}noOrders(e){e.action(new In(e.tile(),e.tile(),e,this.#R))}shouldAttack(e){let r=this.#p.getByPlayer(this.player()).reduce((s,m)=>s+m.attack().value()+m.defence().value(),0),n=this.#p.getByPlayer(e).reduce((s,m)=>s+m.attack().value()+m.defence().value(),0);return r*1>=n}};t(PR,"SimpleAIClient");Ks=PR});var Hn,zl,jl=i(()=>{Mr();Hn=class extends ve{};t(Hn,"American");zl=Hn});var vq={};var yD=i(()=>{jl();to();Br();Object.entries({people:"American",nation:"America",colors:["#0055A4","#FFF"]}).forEach(([o,e])=>Te.register(new Me(zl,o,e)))});var bq={};var dD=i(()=>{jl();Gr();Wt();["Washington","New York","Los Angeles","Chicago","Houston","Phoenix","Philadelphia","San Antonio","San Diego","Dallas","San Jose","Austin","Jacksonville","Fort Worth","Columbus","San Francisco","Charlotte","Indianapolis","Seattle","Denver","Boston","El Paso","Detroit","Nashville","Portland","Memphis","Oklahoma City","Las Vegas","Louisville","Baltimore","Milwaukee","Albuquerque","Tucson","Fresno","Mesa","Sacramento","Atlanta","Kansas City","Colorado Springs","Miami","Raleigh","Omaha","Long Beach","Virginia Beach","Oakland","Minneapolis","Tulsa","Arlington","Tampa","New Orleans","Wichita","Cleveland","Bakersfield","Aurora","Anaheim","Honolulu","Santa Ana","Riverside","Corpus Christi","Lexington","Stockton","Henderson","Saint Paul","St. Louis","Cincinnati","Pittsburgh","Greensboro","Anchorage","Plano","Lincoln","Orlando","Irvine","Newark","Toledo","Durham","Chula Vista","Fort Wayne","Jersey City","St. Petersburg","Laredo","Madison","Chandler","Buffalo","Lubbock","Scottsdale","Reno","Glendale","Gilbert","Winston\u2013Salem","North Las Vegas","Norfolk","Chesapeake","Garland","Irving","Hialeah","Fremont","Boise","Richmond","Baton Rouge","Spokane","Des Moines","Tacoma","San Bernardino","Modesto","Fontana","Santa Clarita","Birmingham","Oxnard","Fayetteville","Moreno Valley","Rochester","Huntington Beach","Salt Lake City","Grand Rapids","Amarillo","Yonkers","Montgomery","Akron","Little Rock","Huntsville","Augusta","Port St. Lucie","Grand Prairie","Tallahassee","Overland Park","Tempe","McKinney","Mobile","Cape Coral","Shreveport","Frisco","Knoxville","Worcester","Brownsville","Vancouver","Fort Lauderdale","Sioux Falls","Ontario","Chattanooga","Providence","Newport News","Rancho Cucamonga","Santa Rosa","Oceanside","Salem","Elk Grove","Garden Grove","Pembroke Pines","Peoria","Eugene","Corona","Cary","Springfield","Fort Collins","Jackson","Alexandria","Hayward","Lancaster","Lakewood","Clarksville","Palmdale","Salinas","Hollywood","Pasadena","Sunnyvale","Macon","Pomona","Escondido","Killeen","Naperville","Joliet","Bellevue","Rockford","Savannah","Paterson","Torrance","Bridgeport","McAllen","Mesquite","Syracuse","Midland","Murfreesboro","Miramar","Dayton","Fullerton","Olathe","Orange","Thornton","Roseville","Denton","Waco","Surprise","Carrollton","West Valley City","Charleston","Warren","Hampton","Gainesville","Visalia","Coral Springs","Columbia","Cedar Rapids","Sterling Heights","New Haven","Stamford","Concord","Kent","Santa Clara","Elizabeth","Round Rock","Thousand Oaks","Lafayette","Athens","Topeka","Simi Valley","Fargo","Norman","Abilene","Wilmington","Hartford","Victorville","Pearland","Vallejo","Ann Arbor","Berkeley","Allentown","Richardson","Odessa","Arvada","Cambridge","Sugar Land","Beaumont","Lansing","Evansville","Independence","Fairfield","Provo","Clearwater","College Station","West Jordan","Carlsbad","El Monte","Murrieta","Temecula","Palm Bay","Costa Mesa","Westminster","North Charleston","Miami Gardens","Manchester","High Point","Downey","Clovis","Pompano Beach","Pueblo","Elgin","Lowell","Antioch","West Palm Beach","Everett","Ventura","Centennial","Lakeland","Gresham","Billings","Inglewood","Broken Arrow","Sandy Springs","Jurupa Valley","Hillsboro","Waterbury","Santa Maria","Boulder","Greeley","Daly City","Meridian","Lewisville","Davie","West Covina","League City","Tyler","Norwalk","San Mateo","Green Bay","Wichita Falls","Sparks","Burbank","Rialto","Allen","El Cajon","Las Cruces","Renton","Davenport","South Bend","Vista","Tuscaloosa","Clinton","Edison","Woodbridge","San Angelo","Kenosha","Vacaville"].forEach((o,e)=>se.register(new ye(o,zl,e===0)))});var hD=I(gD=>{"use strict";Object.defineProperty(gD,"__esModule",{value:!0});yD();dD()});var _n,mf,lf=i(()=>{Mr();_n=class extends ve{};t(_n,"Aztec");mf=_n});var Cq={};var xD=i(()=>{lf();to();Br();Object.entries({people:"Aztec",nation:"Aztec",colors:["#A1DAB5","#EA6B76"]}).forEach(([o,e])=>Te.register(new Me(mf,o,e)))});var Tq={};var RD=i(()=>{lf();Gr();Wt();["Tenochtitlan","Teotihuacan","Tlatelolco","Texcoco","Tlaxcala","Calixtlahuaca","Xochicalco","Tlacopan","Atzcapotzalco","Tzintzuntzan","Malinalco","Tula","Tamuin","Teayo","Cempoala","Chalco","Tlalmanalco","Ixtapaluca","Huexotla","Tepexpan","Tepetlaoxtoc","Chiconautla","Zitlaltepec","Coyotepec","Tequixquiac","Jilotzingo","Tlapanaloya","Tultitan","Ecatepec","Coatepec","Chalchiuites","Chiauhita","Chapultepec","Itzapalapa","Ayotzinco","Iztapam"].forEach((o,e)=>se.register(new ye(o,mf,e===0)))});var vD=I(OD=>{"use strict";Object.defineProperty(OD,"__esModule",{value:!0});xD();RD()});var Kn,pf,ff=i(()=>{Mr();Kn=class extends ve{};t(Kn,"Babylonian");pf=Kn});var Pq={};var bD=i(()=>{ff();to();Br();Object.entries({people:"Babylonian",nation:"Babylon",colors:["#D0B8A6","#2f7b00"]}).forEach(([o,e])=>Te.register(new Me(pf,o,e)))});var Iq={};var CD=i(()=>{ff();Gr();Wt();["Babilim","Eshnunna","Diniktum","Tutub","Der","Sippar","Kutha","Jemdet Nasr","Kish","Borsippa","Mashkan-shapir","Dilbat","Nippur","Marad","Adab","Isin","Kisurra","Shuruppak","Bad-tibira","Zabalam","Umma","Girsu","Lagash","Urum","Uruk","Larsa","Ur","Kuara","Eridu","Akshak","Akkad"].forEach((o,e)=>se.register(new ye(o,pf,e===0)))});var PD=I(TD=>{"use strict";Object.defineProperty(TD,"__esModule",{value:!0});bD();CD()});var qn,uf,cf=i(()=>{Mr();qn=class extends ve{};t(qn,"Chinese");uf=qn});var wq={};var ID=i(()=>{cf();to();Br();Object.entries({people:"Chinese",nation:"China",colors:["#ee1c25","#ff0"]}).forEach(([o,e])=>Te.register(new Me(uf,o,e)))});var Aq={};var wD=i(()=>{cf();Gr();Wt();["Beijing","Shanghai","Chongqing","Tianjin","Guangzhou","Shenzhen","Chengdu","Nanjing","Wuhan","Xi'an","Hangzhou","Dongguan","Foshan","Shenyang","Harbin","Qingdao","Dalian","Jinan","Zhengzhou","Changsha","Kunming","Changchun","\xDCr\xFCmqi","Shantou","Hefei","Shijiazhuang","Ningbo","Taiyuan","Nanning","Xiamen","Fuzhou","Changzhou","Wenzhou","Nanchang","Tangshan","Guiyang","Wuxi","Lanzhou","Zhongshan","Handan","Huai'an","Weifang","Zibo","Shaoxing","Yantai","Huizhou","Luoyang","Nantong","Baotou","Liuzhou"].forEach((o,e)=>se.register(new ye(o,uf,e===0)))});var BD=I(AD=>{"use strict";Object.defineProperty(AD,"__esModule",{value:!0});ID();wD()});var Vn,yf,df=i(()=>{Mr();Vn=class extends ve{};t(Vn,"Egyptian");yf=Vn});var Bq={};var GD=i(()=>{df();to();Br();Object.entries({people:"Egyptian",nation:"Egypt",colors:["#CE1126","#FFF"]}).forEach(([o,e])=>Te.register(new Me(yf,o,e)))});var Gq={};var MD=i(()=>{df();Gr();Wt();["Cairo","Alexandria","Gizeh","Shubra El-Kheima","Port Said","Suez","Luxor","al-Mansura","El-Mahalla El-Kubra","Tanta","Asyut","Ismailia","Fayyum","Zagazig","Aswan","Damietta","Damanhur","al-Minya","Beni Suef","Qena","Sohag","Hurghada","6th of October City","Shibin El Kom","Banha","Kafr el-Sheikh","Arish","Mallawi","10th of Ramadan City","Bilbais","Marsa Matruh","Idfu","Mit Ghamr","Al-Hamidiyya","Desouk","Qalyub","Abu Kabir","Kafr el-Dawwar","Girga","Akhmim","Matarey"].forEach((o,e)=>se.register(new ye(o,yf,e===0)))});var DD=I(UD=>{"use strict";Object.defineProperty(UD,"__esModule",{value:!0});GD();MD()});var Jn,Hl,_l=i(()=>{Mr();Jn=class extends ve{};t(Jn,"English");Hl=Jn});var Mq={};var ED=i(()=>{_l();to();Br();Object.entries({people:"English",nation:"England",colors:["#FFF","#C8102E"]}).forEach(([o,e])=>Te.register(new Me(Hl,o,e)))});var Uq={};var kD=i(()=>{_l();Gr();Wt();["London","Birmingham","Liverpool","Leeds","Sheffield","Bristol","Manchester","Leicester","Coventry","Kingston upon Hull","Stoke-on-Trent","Wolverhampton","Nottingham","Plymouth","Southampton","Reading","Derby","Dudley","Newcastle upon Tyne","Northampton","Portsmouth","Luton","Preston","Sunderland","Norwich","Walsall","Bournemouth","Southend-on-Sea","Swindon","Huddersfield","Poole","Oxford","Middlesbrough","Blackpool","Oldbury","Boldon","Ipswich","York","West Bromwich","Peterborough","Stockport","Brighton","Slough","Gloucester","Rotherham","Cambridge","Exeter","Eastbourne","Sutton Coldfield","Blackburn","Colchester","Oldham","St Helens","Woking","Chesterfield","Crawley"].forEach((o,e)=>se.register(new ye(o,Hl,e===0)))});var FD=I(SD=>{"use strict";Object.defineProperty(SD,"__esModule",{value:!0});ED();kD()});var $n,gf,hf=i(()=>{Mr();$n=class extends ve{};t($n,"French");gf=$n});var Dq={};var ND=i(()=>{hf();to();Br();Object.entries({people:"French",nation:"France",colors:["#FFF","#0055A4"]}).forEach(([o,e])=>Te.register(new Me(gf,o,e)))});var Eq={};var WD=i(()=>{hf();Gr();Wt();["Paris","Marseille","Lyon","Toulouse","Nice","Nantes","Strasbourg","Montpellier","Bordeaux","Lille","Rennes","Reims","Le Havre","Saint-\xC9tienne","Toulon","Grenoble","Dijon","N\xEEmes","Angers","Villeurbanne","Le Mans","Saint-Denis","Aix-en-Provence","Clermont-Ferrand","Brest","Limoges","Tours","Amiens","Perpignan","Metz","Besan\xE7on","Boulogne-Billancourt","Orl\xE9ans","Mulhouse","Rouen","Caen","Argenteuil","Saint-Paul","Montreuil","Nancy","Roubaix","Tourcoing","Nanterre","Avignon","Vitry-sur-Seine","Cr\xE9teil","Dunkirk","Poitiers","Asni\xE8res-sur-Seine","Courbevoie","Versailles","Colombes","Fort-de-France","Aulnay-sous-Bois","Saint-Pierre","Rueil-Malmaison","Pau","Aubervilliers","Le Tampon","Champigny-sur-Marne","Antibes","B\xE9ziers","La Rochelle","Saint-Maur-des-Foss\xE9s","Cannes","Calais","Saint-Nazaire","M\xE9rignac","Drancy","Colmar","Ajaccio","Bourges","Issy-les-Moulineaux","Levallois-Perret","La Seyne-sur-Mer","Quimper","Noisy-le-Grand","Villeneuve-d'Ascq","Neuilly-sur-Seine","Valence","Antony","Cergy","V\xE9nissieux","Pessac","Troyes","Clichy","Ivry-sur-Seine","Chamb\xE9ry","Lorient","Les Abymes","Montauban","Sarcelles","Niort","Villejuif","Saint-Andr\xE9","Hy\xE8res","Saint-Quentin","Beauvais","\xC9pinay-sur-Seine","Cayenne","Maisons-Alfort","Cholet","Meaux","Chelles","Pantin","\xC9vry","Fontenay-sous-Bois","Fr\xE9jus","Vannes","Bondy","Le Blanc-Mesnil","La Roche-sur-Yon","Saint-Louis","Arles","Clamart","Narbonne","Annecy","Sartrouville","Grasse","Laval","Belfort","Bobigny","\xC9vreux","Vincennes","Montrouge","Sevran","Albi","Charleville-M\xE9zi\xE8res","Suresnes","Martigues","Corbeil-Essonnes","Saint-Ouen","Bayonne","Cagnes-sur-Mer","Brive-la-Gaillarde","Carcassonne","Massy","Blois","Aubagne","Saint-Brieuc","Ch\xE2teauroux","Chalon-sur-Sa\xF4ne","Mantes-la-Jolie","Meudon","Saint-Malo","Ch\xE2lons-en-Champagne","Alfortville","S\xE8te","Salon-de-Provence","Vaulx-en-Velin","Puteaux","Rosny-sous-Bois","Saint-Herblain","Gennevilliers","Le Cannet","Livry-Gargan","Saint-Priest","Istres","Valenciennes","Choisy-le-Roi","Caluire-et-Cuire","Boulogne-sur-Mer","Bastia","Angoul\xEAme","Garges-l\xE8s-Gonesse","Castres","Thionville","Wattrelos","Talence","Saint-Laurent-du-Maroni","Douai","Noisy-le-Sec","Tarbes","Arras","Al\xE8s","La Courneuve","Bourg-en-Bresse","Compi\xE8gne","Gap","Melun","Le Lamentin","Rez\xE9","Saint-Germain-en-Laye","Marcq-en-Bar\u0153ul","Gagny","Anglet","Draguignan","Chartres","Bron","Bagneux","Colomiers","Saint-Martin-d'H\xE8res","Pontault-Combault","Montlu\xE7on","Jou\xE9-l\xE8s-Tours","Saint-Joseph","Poissy","Savigny-sur-Orge","Cherbourg-Octeville","Mont\xE9limar","Villefranche-sur-Sa\xF4ne","Stains","Saint-Beno\xEEt","Bagnolet","Ch\xE2tillon","Le Port","Sainte-Genevi\xE8ve-des-Bois","\xC9chirolles","Roanne","Villepinte","Saint-Chamond","Conflans-Sainte-Honorine","Auxerre","Nevers","Neuilly-sur-Marne","La Ciotat","Tremblay-en-France","Thonon-les-Bains","Vitrolles","Haguenau","Six-Fours-les-Plages","Agen","Creil","Annemasse","Saint-Rapha\xEBl","Marignane","Romans-sur-Is\xE8re","Montigny-le-Bretonneux","Le Perreux-sur-Marne","Franconville","M\xE2con","Saint-Leu","Cambrai","Ch\xE2tenay-Malabry","Sainte-Marie","Villeneuve-Saint-Georges","Houilles","\xC9pinal","Lens","Li\xE9vin","Les Mureaux","Schiltigheim","La Possession","Meyzieu","Dreux","Nogent-sur-Marne","Plaisir","Mont-de-Marsan","Palaiseau","Ch\xE2tellerault","Goussainville","L'Ha\xFF-les-Roses","Viry-Ch\xE2tillon","Vigneux-sur-Seine","Chatou","Trappes","Clichy-sous-Bois","Rillieux-la-Pape","Villenave-'Ornon","Maubeuge","Charenton-le-Pont","Malakoff","Matoury","Dieppe","Athis-Mons","Savigny-le-Temple","P\xE9rigueux","Baie-Mahault","Vandoeuvre-l\xE8s-Nancy","Pontoise","Aix-les-Bains","Cachan","Vienne","Thiais","Orange","Saint-M\xE9dard-en-Jalles","Villemomble","Saint-Cloud","Saint-Laurent-du-Var","Yerres","Saint-\xC9tienne-du-Rouvray","Sotteville-l\xE8s-Rouen","Draveil","Le Chesnay","Bois-Colombes","Le Plessis-Robinson","La Garenne-Colombes","Lambersart","Soissons","Pierrefitte-sur-Seine","Carpentras","Villiers-sur-Marne","Vanves","Menton","Bergerac","Ermont","Bezons","Grigny","Guyancourt","Saumur","Herblay","Ris-Orangis","Villiers-le-Bel","Bourgoin-Jallieu","Vierzon","Le Gosier","D\xE9cines-Charpieu","H\xE9nin-Beaumont","Fresnes","Aurillac","Sannois","Vallauris","Illkirch-Graffenstaden","Alen\xE7on","\xC9lancourt","Tournefeuille","B\xE8gles","Gonesse","Oullins","Brunoy","Taverny","Armenti\xE8res","Montfermeil","Rambouillet","Villeparisis","Le Kremlin-Bic\xEAtre","Sucy-en-Brie","Kourou","Montb\xE9liard","Romainville","Cavaillon","Saint-Dizier","Br\xE9tigny-sur-Orge","Saint-S\xE9bastien-sur-Loire","Saintes","La Teste-de-Buch","Villeneuve-la-Garenne","B\xE9thune","Bussy-Saint-Georges","Vichy","La Garde","Agde","Laon","Sens","Lunel","Miramas","Biarritz","Le Grand-Quevilly","Orvault","Les Ulis","Champs-sur-Marne","Rochefort","Muret","Sainte-Anne","Eaubonne","\xC9tampes","Gradignan","Vernon","Petit-Bourg","Libourne","Abbeville","Rodez","Saint-Ouen-l'Aum\xF4ne","Torcy","Maisons-Laffitte","Montgeron","Villeneuve-sur-Lot","Cormeilles-en-Parisis","\xC9pernay","S\xE8vres","Dole","Le Robert","Le Bouscat","Blagnac","Frontignan","Cenon","Mandelieu-la-Napoule","Vertou","Les Lilas","Bruay-la-Buissi\xE8re","Les Pavillons-sous-Bois","Chaumont","Roissy-en-Brie","Le Moule","Le Petit-Quevilly","Manosque","Saint-Mand\xE9","Fontenay-aux-Roses","Orly","Le Creusot","Oyonnax","La Madeleine","Sainte-Suzanne","Millau","Combs-la-Ville","Fontaine","Deuil-la-Barre","Coudekerque-Branche","Auch","Lanester","Beaune","Montigny-l\xE8s-Metz","Hazebrouck","Longjumeau","Sainte-Foy-l\xE8s-Lyon","Forbach","Sarreguemines","Mons-en-Bar\u0153ul","La Valette-du-Var","H\xE9rouville-Saint-Clair","Morsang-sur-Orge","Grande-Synthe","La Celle-Saint-Cloud","Lisieux","Croix","Dammarie-les-Lys","V\xE9lizy-Villacoublay","Wasquehal","Saint-Gratien","Halluin","Neuilly-Plaisance","Montmorency","Dax","Lagny-sur-Marne","Le M\xE9e-sur-Seine","Saint-Genis-Laval","Fleury-les-Aubrais","Loos","Gif-sur-Yvette","Denain","Saint-Di\xE9-des-Vosges","Sainte-Rose","Saint-Michel-sur-Orge"].forEach((o,e)=>se.register(new ye(o,gf,e===0)))});var LD=I(YD=>{"use strict";Object.defineProperty(YD,"__esModule",{value:!0});ND();WD()});var Zn,Kl,ql=i(()=>{Mr();Zn=class extends ve{};t(Zn,"German");Kl=Zn});var kq={};var zD=i(()=>{ql();to();Br();Object.entries({people:"German",nation:"Germany",colors:["#000","#FC0"]}).forEach(([o,e])=>Te.register(new Me(Kl,o,e)))});var Sq={};var jD=i(()=>{ql();Gr();Wt();["Berlin","Hamburg","Munich","Cologne","Frankfurt","Stuttgart","D\xFCsseldorf","Dortmund","Essen","Leipzig","Bremen","Dresden","Hanover","Nuremberg","Duisburg","Bochum","Wuppertal","Bielefeld","Bonn","M\xFCnster","Karlsruhe","Mannheim","Augsburg","Wiesbaden","Gelsenkirchen","M\xF6nchengladbach","Braunschweig","Chemnitz","Kiel","Aachen","Halle","Magdeburg","Freiburg","Krefeld","L\xFCbeck","Oberhausen","Erfurt","Mainz","Rostock","Kassel","Hagen","Hamm","Saarbr\xFCcken","M\xFClheim an der Ruhr","Potsdam","Ludwigshafen am Rhein","Oldenburg","Leverkusen","Osnabr\xFCck","Solingen"].forEach((o,e)=>se.register(new ye(o,Kl,e===0)))});var _D=I(HD=>{"use strict";Object.defineProperty(HD,"__esModule",{value:!0});zD();jD()});var Qn,xf,Rf=i(()=>{Mr();Qn=class extends ve{};t(Qn,"Greek");xf=Qn});var Fq={};var KD=i(()=>{Rf();to();Br();Object.entries({people:"Greek",nation:"Greece",colors:["#2175D8","#FFF"]}).forEach(([o,e])=>Te.register(new Me(xf,o,e)))});var Nq={};var qD=i(()=>{Rf();Gr();Wt();["Athens","Thessaloniki","Patras","Piraeus","Larissa","Heraklion","Peristeri","Kallithea","Acharnes","Kalamaria","Nikaia","Glyfada","Volos","Ilio","Ilioupoli","Keratsini","Evosmos","Chalandri","Nea Smyrni","Marousi","Agios Dimitrios","Zografou","Egaleo","Nea Ionia","Ioannina","Palaio Faliro","Korydallos","Trikala","Vyronas","Agia Paraskevi","Galatsi","Agrinio","Chalcis","Petroupoli","Serres","Alexandroupoli","Xanthi","Katerini","Kalamata","Kavala","Chania","Lamia","Komotini","Irakleio","Rhodes","Kifissia","Stavroupoli","Chaidari","Drama","Veria","Alimos","Kozani","Polichni","Karditsa","Sykies","Ampelokipoi","Pylaia","Agioi Anargyroi","Argyroupoli","Ano Liosia","Rethymno","Ptolemaida","Tripoli","Cholargos","Vrilissia","Aspropyrgos","Corinth","Gerakas","Metamorfosi","Giannitsa","Voula","Kamatero","Mytilene","Neapoli","Eleftherio-Kordelio","Chios","Agia Varvara","Kaisariani","Nea Filadelfeia","Moschato","Perama","Salamina","Eleusis","Corfu","Pyrgos","Megara","Kilkis","Dafni","Thebes","Melissia","Argos","Arta","Artemida","Livadeia","Pefki","Oraiokastro","Aigio","Kos","Koropi","Preveza","Naousa","Orestiada","Peraia","Edessa","Florina","Panorama","Nea Erythraia1","Elliniko1","Amaliada","Pallini","Sparta","Agios Ioannis Rentis","Thermi","Vari","Nea Makri","Tavros","Alexandreia","Menemeni","Paiania","Kalyvia Thorikou","Nafplio","Drapetsona","Efkarpia","Papagou","Nafpaktos","Kastoria","Grevena","Pefka","Nea Alikarnassos","Missolonghi","Gazi","Ierapetra","Kalymnos","Rafina","Loutraki","Agios Nikolaos","Ermoupoli","Ialysos","Mandra","Tyrnavos","Glyka Nera","Ymittos","Neo Psychiko"].forEach((o,e)=>se.register(new ye(o,xf,e===0)))});var JD=I(VD=>{"use strict";Object.defineProperty(VD,"__esModule",{value:!0});KD();qD()});var Xn,Of,vf=i(()=>{Mr();Xn=class extends ve{};t(Xn,"Indian");Of=Xn});var Wq={};var $D=i(()=>{vf();to();Br();Object.entries({people:"Indian",nation:"India",colors:["#138808","#FF9933"]}).forEach(([o,e])=>Te.register(new Me(Of,o,e)))});var Yq={};var ZD=i(()=>{vf();Gr();Wt();["Delhi","Mumbai","Bangalore","Hyderabad","Ahmedabad","Chennai","Kolkata","Surat","Pune","Jaipur","Lucknow","Kanpur","Nagpur","Indore","Thane","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara","Ghaziabad","Ludhiana","Agra","Nashik","Faridabad","Meerut","Rajkot","Kalyan-Dombivli","Vasai-Virar","Varanasi","Srinagar","Aurangabad","Dhanbad","Amritsar","Navi Mumbai","Allahabad","Howrah","Ranchi","Gwalior","Jabalpur","Coimbatore","Vijayawada","Jodhpur","Madurai","Raipur","Kota","Chandigarh","Guwahati","Solapur","Hubli\u2013Dharwad","Tiruchirappalli","Bareilly","Moradabad","Mysore","Tiruppur","Gurgaon","Aligarh","Jalandhar","Bhubaneswar","Salem","Mira-Bhayandar","Warangal","Jalgaon","Guntur","Bhiwandi","Saharanpur","Gorakhpur","Bikaner","Amravati","Noida","Jamshedpur","Bhilai","Cuttack","Firozabad","Kochi","Nellore","Bhavnagar","Dehradun","Durgapur","Asansol","Rourkela","Nanded","Kolhapur","Ajmer","Akola","Gulbarga","Jamnagar","Ujjain","Loni","Siliguri","Jhansi","Ulhasnagar","Jammu","Sangli-Miraj & Kupwad","Mangalore","Erode","Belgaum","Ambattur","Tirunelveli","Malegaon","Gaya","Thiruvananthapuram","Udaipur","Maheshtala","Davanagere","Kozhikode","Kurnool","Rajpur Sonarpur","Rajahmundry","Bokaro","South Dumdum","Bellary","Patiala","Gopalpur","Agartala","Bhagalpur","Muzaffarnagar","Bhatpara","Panihati","Latur","Dhule","Tirupati","Rohtak","Korba","Bhilwara","Berhampur","Muzaffarpur","Ahmednagar","Mathura","Kollam","Avadi","Kadapa","Kamarhati","Sambalpur","Bilaspur","Shahjahanpur","Satara","Bijapur","Kakinada","Rampur","Shimoga","Chandrapur","Junagadh","Thrissur","Alwar","Bardhaman","Kulti","Nizamabad","Parbhani","Tumkur","Khammam","Ozhukarai","Bihar Sharif","Panipat","Darbhanga","Bally","Aizawl","Dewas","Ichalkaranji","Karnal","Bathinda","Jalna","Eluru","Barasat","Kirari Suleman Nagar","Purnia","Satna","Mau","Sonipat","Farrukhabad","Sagar","Durg","Imphal","Ratlam","Hapur","Arrah","Anantapur","Karimnagar","Etawah","Ambarnath","North Dumdum","Bharatpur","Begusarai","New Delhi","Gandhidham","Baranagar","Tiruvottiyur","Pondicherry","Sikar","Thoothukudi","Rewa","Mirzapur","Raichur","Pali","Ramagundam","Haridwar","Vijayanagaram","Katihar","Nagercoil","Sri Ganganagar","Karawal Nagar","Mango","Thanjavur","Bulandshahr","Uluberia","Katni","Sambhal","Singrauli","Nadiad","Secunderabad","Naihati","Yamunanagar","Bidhannagar","Pallavaram","Bidar","Munger","Panchkula","Burhanpur","Raurkela Industrial Township","Kharagpur","Dindigul","Gandhinagar","Hospet","Nangloi Jat","Malda","Ongole","Deoghar","Chapra","Haldia","Khandwa","Nandyal","Morena","Amroha","Anand","Bhind","Bhalswa Jahangir Pur","Madhyamgram","Bhiwani","Berhampore","Ambala","Morbi","Fatehpur","Raebareli","Mahaboobnagar","Chittoor","Bhusawal","Orai","Bahraich","Vellore","Mehsana","Raiganj","Sirsa","Danapur","Serampore","Sultan Pur Majra","Guna","Jaunpur","Panvel","Shivpuri","Surendranagar Dudhrej","Unnao","Chinsurah","Alappuzha","Kottayam","Machilipatnam","Shimla","Adoni","Udupi","Tenali","Proddatur","Saharsa","Hindupur","Sasaram","Hajipur","Bhimavaram","Kumbakonam","Dehri","Madanapalle","Siwan","Bettiah","Guntakal","Srikakulam","Motihari","Dharmavaram","Gudivada","Phagwara","Narasaraopet","Suryapet","Miryalaguda","Tadipatri","Karaikudi","Kishanganj","Jamalpur","Ballia","Kavali","Tadepalligudem","Amaravati","Buxar","Jehanabad","Gangtok"].forEach((o,e)=>se.register(new ye(o,Of,e===0)))});var XD=I(QD=>{"use strict";Object.defineProperty(QD,"__esModule",{value:!0});$D();ZD()});var ea,bf,Cf=i(()=>{Mr();ea=class extends ve{};t(ea,"Mongol");bf=ea});var Lq={};var eE=i(()=>{Cf();to();Br();Object.entries({people:"Mongol",nation:"Mongolia",colors:["#DA2032","#0066B3"]}).forEach(([o,e])=>Te.register(new Me(bf,o,e)))});var zq={};var tE=i(()=>{Cf();Gr();Wt();["Ulaanbaatar","Erdenet","Darkhan","Choibalsan","M\xF6r\xF6n","Nalaikh","Bayankhongor","\xD6lgii","Khovd","Arvaikheer","Ulaangom","Baganuur","Sainshand","Tsetserleg","S\xFCkhbaatar","\xD6nd\xF6rkhaan","Dalanzadgad","Z\xFC\xFCnkharaa","Uliastai","Altai","Baruun-Urt","Mandalgovi","Zuunmod","Zamyn-\xDC\xFCd","Bulgan","Kharkhorin","Choir","Bor-\xD6nd\xF6r","Sharyngo"].forEach((o,e)=>se.register(new ye(o,bf,e===0)))});var oE=I(rE=>{"use strict";Object.defineProperty(rE,"__esModule",{value:!0});eE();tE()});var ta,Tf,Pf=i(()=>{Mr();ta=class extends ve{};t(ta,"Roman");Tf=ta});var jq={};var iE=i(()=>{Pf();to();Br();Object.entries({people:"Roman",nation:"Rome",colors:["#A20101","#D1B24F"]}).forEach(([o,e])=>Te.register(new Me(Tf,o,e)))});var Hq={};var nE=i(()=>{Pf();Gr();Wt();["Roma","Ariminum","Belum","Placentia","Tarraco","Italica","Mod","Salernum","Bononia","Forum Livii","Regium Lepidi","Aquileia","Ascrivium","Valentia Edetanorum","Scalabis","Villa Euracini","Palma","Colonia Narbo Martius","Massa","Pistoria","Segovia","Gerunda","Pompaelo","Naissus","Brigantium","Florentia","Vesontio","Lutetia Parisiorum","Atuatuca Tungrorum","Iulia Romula Hispalis","Augusta Raurica","Noviodunum","Lugdunum","Siscia","Marsonia","Augusta Treverorum","Castra Legionis","Augusta Taurinorum","Augusta Praetoria Salassorum","Emerita Augusta","Norba Caesarina","Lucus Augusta","Caesarea","Bracara Augusta","Novaesium","Castra Vetera","Pons Drusi","Ovilava","Iuvavum","Augusta Vindelicorum","Turicum","Asturica Augusta","Borbetomagus","Caesaraugusta","Sirmium","Sorviodurum","Mogontiacum","Argentoratum","Bonna","Noviomagus","Castellum apud Confluentes","Divodurum","Caesaromagus","Ambianum","Faventia Paterna Barcino","Abila","Lousonna","Ulpia Noviomagus Batavorum","Rigomagus","Aquae Mattiacorum","Mursa","Emona","Vindonissa","Aventicum","Praetorium Agrippinae","Lugdunum Batavorum","Aequum","Londinium","Albanianis","Lauri","Durovernum Cantiacorum","Regulbium","Rutupiae","Viminacium","Camulodunum","Traiectum","Matilo","Forum Hadriani","Nigrum Pullum","Lindum Colonia","Ratae Corieltauvorum","Durocobrivis","Colonia Agrippina","Durocornovium","Verulamium","Letocetum","Dubris","Danum","Mediolanum","Isca Dumnoniorum","Blestium","Viroconium Cornoviorum","Aquae Sulis","Durnovaria","Lindinis","Ad Flexum","Clausentum","Venta Belgarum","Calleva Atrebatum","Duroliponte","Concangis","Condate","Corinium Dobunnorum","Eboracum","Luguvalium","Arae Flaviae","Isca Augusta","Lagentium","Lopodunum","Moridunum","Venta Silurum","Deva Victrix","Mamucium","Olicana","Vinovia","Bonames","Coria","Gerulata","Vindobona","Biriciana","Cannstatt Castrum","Colonia Nervia Glevensium","Sumelocenna","Traiectum ad Nicrem","Castra Batavar","Nida","Lactodurum","Bovium","Burgodunum","Lentia","Aquae Granni","Complutum","Aeminium","Traiectum ad Mosam","Coriovallum","Portus Lemanis","Andautonia","Salona","Cibalae","Aquae Helveticae","Aquincum","Apulum","Pons Aelius","Durovigutum","Aelia Capitolina","Ala","Castra Regina","Theranda","Pomaria","Partiscum","Gesoriacum","Aurelia Aquensis","Urbs Aurelianorum","Venetiae","Ragusium"].forEach((o,e)=>se.register(new ye(o,Tf,e===0)))});var sE=I(aE=>{"use strict";Object.defineProperty(aE,"__esModule",{value:!0});iE();nE()});var ra,Vl,Jl=i(()=>{Mr();ra=class extends ve{};t(ra,"Russian");Vl=ra});var _q={};var mE=i(()=>{Jl();to();Br();Object.entries({people:"Russian",nation:"Russia",colors:["#0032A0","#DA291C"]}).forEach(([o,e])=>Te.register(new Me(Vl,o,e)))});var Kq={};var lE=i(()=>{Jl();Gr();Wt();["Moscow","Saint Petersburg","Novosibirsk","Yekaterinburg","Nizhny Novgorod","Kazan","Chelyabinsk","Omsk","Samara","Ufa","Rostov-on-Don","Krasnoyarsk","Voronezh","Perm","Volgograd","Krasnodar","Saratov","Tyumen","Makhachkala","Tolyatti","Barnaul","Ulyanovsk","Izhevsk","Vladivostok","Irkutsk","Khabarovsk","Yaroslavl","Tomsk","Orenburg","Kemerovo","Novokuznetsk","Tula","Ryazan","Kirov","Astrakhan","Naberezhnye Chelny","Sochi","Penza","Lipetsk","Cheboksary","Balashikha","Kaliningrad","Kursk","Stavropol","Ulan-Ude","Bryansk","Tver","Magnitogorsk","Ivanovo","Belgorod","Surgut","Vladimir","Arkhangelsk","Nizhny Tagil","Kaluga","Chita","Saransk","Yakutsk","Smolensk","Podolsk","Volzhsky","Vladikavkaz","Vologda","Cherepovets","Kurgan","Oryol","Grozny","Murmansk","Tambov","Petrozavodsk","Sterlitamak","Kostroma","Nizhnevartovsk","Novorossiysk","Yoshkar-Ola","Taganrog","Komsomolsk-on-Amur","Khimki","Syktyvkar","Nalchik","Nizhnekamsk","Shakhty","Dzerzhinsk","Bratsk","Orsk","Angarsk","Engels","Blagoveshchensk","Stary Oskol","Veliky Novgorod","Korolyov","Pskov","Mytishchi","Biysk","Lyubertsy","Prokopyevsk","Yuzhno-Sakhalinsk","Balakovo","Armavir","Rybinsk","Severodvinsk","Abakan","Petropavlovsk-Kamchatsky","Norilsk","Syzran","Volgodonsk","Ussuriysk","Kamensk-Uralsky","Novocherkassk","Zlatoust","Elektrostal","Almetyevsk","Krasnogorsk","Salavat","Miass","Nakhodka","Kopeysk","Pyatigorsk","Rubtsovsk","Berezniki","Kolomna","Maykop","Odintsovo","Khasavyurt","Kovrov","Kislovodsk","Neftekamsk","Nefteyugansk","Novocheboksarsk","Serpukhov","Shchyolkovo","Novomoskovsk","Bataysk","Pervouralsk","Domodedovo","Derbent","Cherkessk","Orekhovo-Zuyevo","Nevinnomyssk","Dimitrovgrad","Nazran","Kyzyl","Oktyabrsky","Obninsk","Kaspiysk","Novy Urengoy","Ramenskoye","Kamyshin","Murom","Zhukovsky"].forEach((o,e)=>se.register(new ye(o,Vl,e===0)))});var fE=I(pE=>{"use strict";Object.defineProperty(pE,"__esModule",{value:!0});mE();lE()});var oa,If,wf=i(()=>{Mr();oa=class extends ve{};t(oa,"Zulu");If=oa});var qq={};var uE=i(()=>{wf();to();Br();Object.entries({people:"Zulu",nation:"Zulus",colors:["#FFFD1E","#000"]}).forEach(([o,e])=>Te.register(new Me(If,o,e)))});var Vq={};var cE=i(()=>{wf();Gr();Wt();["uMgungundlovu","Nobamba","Bulawayo","KwaDukuza","Nongoma","oNdini","Nodwengu","Ndondakusuka","Babanango","Khangela","Kwahlomendlini","Hlobane","eThekwini","Mlambongwenya","Eziqwaqweni","Isiphezi","Masotsheni","Mtunzini","Nyakamubi","Hlatikulu","Mthonjaneni","Empangeni","Pongola","Tungela","Kwamashu","Ingwavuma","Hluhluwe","Mtubatuba","Mhlahlandlela","Mthatha","Maseru","Lobamba","Qunu"].forEach((o,e)=>se.register(new ye(o,If,e===0)))});var dE=I(yE=>{"use strict";Object.defineProperty(yE,"__esModule",{value:!0});uE();cE()});var Jq={};var gE=i(()=>{D();Ju();v.register(Vu)});var xE=I(hE=>{"use strict";Object.defineProperty(hE,"__esModule",{value:!0});gE()});var $q={};var RE=i(()=>{D();gx();v.register(uG)});var vE=I(OE=>{"use strict";Object.defineProperty(OE,"__esModule",{value:!0});RE()});var Zq={};var bE=i(()=>{D();hx();v.register(yG)});var TE=I(CE=>{"use strict";Object.defineProperty(CE,"__esModule",{value:!0});bE()});var Qq={};var PE=i(()=>{D();xx();v.register(gG)});var wE=I(IE=>{"use strict";Object.defineProperty(IE,"__esModule",{value:!0});PE()});var Xq={};var AE=i(()=>{D();Zu();v.register($u)});var GE=I(BE=>{"use strict";Object.defineProperty(BE,"__esModule",{value:!0});AE()});var e2={};var ME=i(()=>{D();Rx();v.register(RG)});var DE=I(UE=>{"use strict";Object.defineProperty(UE,"__esModule",{value:!0});ME()});var t2={};var EE=i(()=>{D();Ox();v.register(vG)});var SE=I(kE=>{"use strict";Object.defineProperty(kE,"__esModule",{value:!0});EE()});var r2={};var FE=i(()=>{D();Qu();v.register(vx)});var WE=I(NE=>{"use strict";Object.defineProperty(NE,"__esModule",{value:!0});FE()});var o2={};var YE=i(()=>{D();bx();v.register(TG)});var zE=I(LE=>{"use strict";Object.defineProperty(LE,"__esModule",{value:!0});YE()});var i2={};var jE=i(()=>{D();Cx();v.register(IG)});var _E=I(HE=>{"use strict";Object.defineProperty(HE,"__esModule",{value:!0});jE()});var n2={};var KE=i(()=>{D();ec();v.register(Xu)});var VE=I(qE=>{"use strict";Object.defineProperty(qE,"__esModule",{value:!0});KE()});var a2={};var JE=i(()=>{D();Tx();v.register(BG)});var ZE=I($E=>{"use strict";Object.defineProperty($E,"__esModule",{value:!0});JE()});var s2={};var QE=i(()=>{D();rc();v.register(tc)});var ek=I(XE=>{"use strict";Object.defineProperty(XE,"__esModule",{value:!0});QE()});var m2={};var tk=i(()=>{D();Px();v.register(UG)});var ok=I(rk=>{"use strict";Object.defineProperty(rk,"__esModule",{value:!0});tk()});var l2={};var ik=i(()=>{D();Ix();v.register(EG)});var ak=I(nk=>{"use strict";Object.defineProperty(nk,"__esModule",{value:!0});ik()});var p2={};var sk=i(()=>{D();oc();v.register(Ll)});var lk=I(mk=>{"use strict";Object.defineProperty(mk,"__esModule",{value:!0});sk()});var f2={};var pk=i(()=>{D();wx();v.register(FG)});var uk=I(fk=>{"use strict";Object.defineProperty(fk,"__esModule",{value:!0});pk()});var u2={};var ck=i(()=>{D();Ax();v.register(WG)});var dk=I(yk=>{"use strict";Object.defineProperty(yk,"__esModule",{value:!0});ck()});var c2={};var gk=i(()=>{D();Bx();v.register(LG)});var xk=I(hk=>{"use strict";Object.defineProperty(hk,"__esModule",{value:!0});gk()});var y2={};var Rk=i(()=>{D();Gx();v.register(jG)});var vk=I(Ok=>{"use strict";Object.defineProperty(Ok,"__esModule",{value:!0});Rk()});var d2={};var bk=i(()=>{D();Mx();v.register(_G)});var Tk=I(Ck=>{"use strict";Object.defineProperty(Ck,"__esModule",{value:!0});bk()});var g2={};var Pk=i(()=>{D();Ux();v.register(qG)});var wk=I(Ik=>{"use strict";Object.defineProperty(Ik,"__esModule",{value:!0});Pk()});var h2={};var Ak=i(()=>{D();Dx();v.register(JG)});var Gk=I(Bk=>{"use strict";Object.defineProperty(Bk,"__esModule",{value:!0});Ak()});var x2={};var Mk=i(()=>{D();Ex();v.register(ZG)});var Dk=I(Uk=>{"use strict";Object.defineProperty(Uk,"__esModule",{value:!0});Mk()});var R2={};var Ek=i(()=>{D();kx();v.register(XG)});var Sk=I(kk=>{"use strict";Object.defineProperty(kk,"__esModule",{value:!0});Ek()});var O2={};var Fk=i(()=>{D();ic();v.register(Sx)});var Wk=I(Nk=>{"use strict";Object.defineProperty(Nk,"__esModule",{value:!0});Fk()});var v2={};var Yk=i(()=>{D();Fx();v.register(rM)});var zk=I(Lk=>{"use strict";Object.defineProperty(Lk,"__esModule",{value:!0});Yk()});var b2={};var jk=i(()=>{D();Nx();v.register(iM)});var _k=I(Hk=>{"use strict";Object.defineProperty(Hk,"__esModule",{value:!0});jk()});var C2={};var Kk=i(()=>{D();nc();v.register(nf)});var Vk=I(qk=>{"use strict";Object.defineProperty(qk,"__esModule",{value:!0});Kk()});var T2={};var Jk=i(()=>{D();ac();v.register(Wx)});var Zk=I($k=>{"use strict";Object.defineProperty($k,"__esModule",{value:!0});Jk()});var P2={};var Qk=i(()=>{D();mc();v.register(sc)});var eS=I(Xk=>{"use strict";Object.defineProperty(Xk,"__esModule",{value:!0});Qk()});var I2={};var tS=i(()=>{D();Yx();v.register(lM)});var oS=I(rS=>{"use strict";Object.defineProperty(rS,"__esModule",{value:!0});tS()});var w2={};var iS=i(()=>{D();lc();v.register(Lx)});var aS=I(nS=>{"use strict";Object.defineProperty(nS,"__esModule",{value:!0});iS()});var A2={};var sS=i(()=>{D();pc();v.register(zx)});var lS=I(mS=>{"use strict";Object.defineProperty(mS,"__esModule",{value:!0});sS()});var B2={};var pS=i(()=>{D();jx();v.register(cM)});var uS=I(fS=>{"use strict";Object.defineProperty(fS,"__esModule",{value:!0});pS()});var G2={};var cS=i(()=>{D();uc();v.register(fc)});var dS=I(yS=>{"use strict";Object.defineProperty(yS,"__esModule",{value:!0});cS()});var M2={};var gS=i(()=>{D();cc();v.register(Hx)});var xS=I(hS=>{"use strict";Object.defineProperty(hS,"__esModule",{value:!0});gS()});var U2={};var RS=i(()=>{D();_x();v.register(hM)});var vS=I(OS=>{"use strict";Object.defineProperty(OS,"__esModule",{value:!0});RS()});var D2={};var bS=i(()=>{D();yc();v.register(Kx)});var TS=I(CS=>{"use strict";Object.defineProperty(CS,"__esModule",{value:!0});bS()});var E2={};var PS=i(()=>{D();dc();v.register(qx)});var wS=I(IS=>{"use strict";Object.defineProperty(IS,"__esModule",{value:!0});PS()});var k2={};var AS=i(()=>{D();Vx();v.register(vM)});var GS=I(BS=>{"use strict";Object.defineProperty(BS,"__esModule",{value:!0});AS()});var S2={};var MS=i(()=>{D();hc();v.register(gc)});var DS=I(US=>{"use strict";Object.defineProperty(US,"__esModule",{value:!0});MS()});var F2={};var ES=i(()=>{D();Jx();v.register(TM)});var SS=I(kS=>{"use strict";Object.defineProperty(kS,"__esModule",{value:!0});ES()});var N2={};var FS=i(()=>{D();$x();v.register(IM)});var WS=I(NS=>{"use strict";Object.defineProperty(NS,"__esModule",{value:!0});FS()});var W2={};var YS=i(()=>{D();Rc();v.register(xc)});var zS=I(LS=>{"use strict";Object.defineProperty(LS,"__esModule",{value:!0});YS()});var Y2={};var jS=i(()=>{D();Zx();v.register(BM)});var _S=I(HS=>{"use strict";Object.defineProperty(HS,"__esModule",{value:!0});jS()});var L2={};var KS=i(()=>{D();Qx();v.register(MM)});var VS=I(qS=>{"use strict";Object.defineProperty(qS,"__esModule",{value:!0});KS()});var z2={};var JS=i(()=>{D();Xx();v.register(DM)});var ZS=I($S=>{"use strict";Object.defineProperty($S,"__esModule",{value:!0});JS()});var j2={};var QS=i(()=>{D();eR();v.register(kM)});var eF=I(XS=>{"use strict";Object.defineProperty(XS,"__esModule",{value:!0});QS()});var H2={};var tF=i(()=>{D();vc();v.register(Oc)});var oF=I(rF=>{"use strict";Object.defineProperty(rF,"__esModule",{value:!0});tF()});var _2={};var iF=i(()=>{D();tR();v.register(NM)});var aF=I(nF=>{"use strict";Object.defineProperty(nF,"__esModule",{value:!0});iF()});var K2={};var sF=i(()=>{D();rR();v.register(YM)});var lF=I(mF=>{"use strict";Object.defineProperty(mF,"__esModule",{value:!0});sF()});var q2={};var pF=i(()=>{D();oR();v.register(zM)});var uF=I(fF=>{"use strict";Object.defineProperty(fF,"__esModule",{value:!0});pF()});var V2={};var cF=i(()=>{D();iR();v.register(HM)});var dF=I(yF=>{"use strict";Object.defineProperty(yF,"__esModule",{value:!0});cF()});var J2={};var gF=i(()=>{D();nR();v.register(KM)});var xF=I(hF=>{"use strict";Object.defineProperty(hF,"__esModule",{value:!0});gF()});var $2={};var RF=i(()=>{D();af();v.register(bm)});var vF=I(OF=>{"use strict";Object.defineProperty(OF,"__esModule",{value:!0});RF()});var Z2={};var bF=i(()=>{D();bc();v.register(aR)});var TF=I(CF=>{"use strict";Object.defineProperty(CF,"__esModule",{value:!0});bF()});var Q2={};var PF=i(()=>{D();Cc();v.register(sR)});var wF=I(IF=>{"use strict";Object.defineProperty(IF,"__esModule",{value:!0});PF()});var X2={};var AF=i(()=>{D();Tc();v.register(mR)});var GF=I(BF=>{"use strict";Object.defineProperty(BF,"__esModule",{value:!0});AF()});var eV={};var MF=i(()=>{D();Pc();v.register(lR)});var DF=I(UF=>{"use strict";Object.defineProperty(UF,"__esModule",{value:!0});MF()});var tV={};var EF=i(()=>{D();pR();v.register(XM)});var SF=I(kF=>{"use strict";Object.defineProperty(kF,"__esModule",{value:!0});EF()});var rV={};var FF=i(()=>{D();cR();v.register(iU)});var WF=I(NF=>{"use strict";Object.defineProperty(NF,"__esModule",{value:!0});FF()});var oV={};var YF=i(()=>{D();fR();v.register(tU)});var zF=I(LF=>{"use strict";Object.defineProperty(LF,"__esModule",{value:!0});YF()});var iV={};var jF=i(()=>{D();Ic();v.register(uR)});var _F=I(HF=>{"use strict";Object.defineProperty(HF,"__esModule",{value:!0});jF()});var nV={};var KF=i(()=>{D();wc();v.register(yR)});var VF=I(qF=>{"use strict";Object.defineProperty(qF,"__esModule",{value:!0});KF()});var aV={};var JF=i(()=>{D();dR();v.register(sU)});var ZF=I($F=>{"use strict";Object.defineProperty($F,"__esModule",{value:!0});JF()});var sV={};var QF=i(()=>{D();Ac();v.register(gR)});var e0=I(XF=>{"use strict";Object.defineProperty(XF,"__esModule",{value:!0});QF()});var IR,ia,Af=i(()=>{M();IR=class extends x{};t(IR,"TurnStart");ia=IR});var mV,t0,r0=i(()=>{ng();Ve();b();qb();my();Af();ug();Vb();mV=t((o=Np,e=z)=>[new ia(new sy,new p(r=>e.getByPlayer(r).forEach(n=>{if(!(n.busy()instanceof sg))return;let a=o.getByKey(Jb(n));if(!a){n.setBusy(),n.setActive();return}let s=a.value();fg(n,s)})))],"getRules"),t0=mV});var lV={};var o0=i(()=>{A();r0();c.register(...t0())});var n0=I(i0=>{"use strict";Object.defineProperty(i0,"__esModule",{value:!0});o0()});var pV,a0,s0=i(()=>{Zp();b();ee();pV=t((o=P)=>[new en(new p((e,r)=>{o.emit("city:building-complete",e,r)}))],"getRules"),a0=pV});var fV,m0,l0=i(()=>{mt();Ve();fi();ab();b();fV=t((o=Z,e=z,r=Se)=>[new lp(new p(n=>!r.tileIsWorked(n))),new lp(new p((n,a)=>!e.getByTile(n).some(s=>s.player()!==a.player()))),new lp(new p((n,a)=>{let s=o.getByTile(n);return s===null?!0:s===a}))],"getRules"),m0=fV});var uV,p0,f0=i(()=>{mt();er();is();Ve();ee();Ol();b();rl();Ri();fi();uV=t((o=Z,e=z,r=ie,n=zt,a=P,s=me,m=Se)=>[new eo(new p(f=>n.getByCity(f).progress().set(0))),new eo(new p(f=>r.getByCity(f).shrink())),new eo(new p((f,u,y)=>{a.emit("city:captured",f,u,y)})),new eo(new p(f=>e.getByCity(f).forEach(u=>u.destroy()))),new eo(new p(f=>Nu(f,s,r,m)))],"getRules"),p0=uV});var cV,u0,c0=i(()=>{Ls();Hs();er();ns();Ve();yp();U();b();ad();zn();md();ld();cV=t((o=ie,e=Ht,r=z)=>[new Gt(new p(n=>new QI(o.getByCity(n).size()*2))),...[[Ke,1,Ro,Vt],[Ke,2,It,pt,ft,Rt]].map(([n,a,...s])=>new Gt(new l(m=>r.getByCity(m).some(f=>f instanceof n)),new l(m=>e.getByPlayer(m.player()).is(...s)),new p(m=>r.getByCity(m).filter(f=>f instanceof n).map(f=>new nw(a,f))))),new Gt(new l(n=>e.getByPlayer(n.player()).is(Ro,Vt)),new l(n=>{let a=o.getByCity(n);return r.getByCity(n).filter(s=>[ht,V,Ne,cr].some(m=>s instanceof m)).length>a.size()}),new p(n=>{let a=o.getByCity(n);return r.getByCity(n).filter(s=>[ht,V,Ne,cr].some(m=>s instanceof m)).slice(a.size()).map(s=>new Ob(1,s))})),new Gt(new l(n=>e.getByPlayer(n.player()).is(It,pt,ft,Rt)),new p(n=>r.getByCity(n).filter(a=>[ht,V,Ne,cr].some(s=>a instanceof s)).map(a=>new Ob(1,a))))],"getRules"),u0=cV});var wR,Bf,AR=i(()=>{M();wR=class extends x{};t(wR,"TileReassigned");Bf=wR});var yV,y0,d0=i(()=>{El();is();er();mt();ee();zs();Ri();A();xi();fi();ku();Wy();Iy();U();b();AR();Ry();rl();yV=t((o=Je,e=zt,r=ie,n=Z,a=me,s=c,m=Gn,f=P,u=Se)=>[...[Ue,Ye].map(y=>new Ga(new l(R=>o.getByTile(R.tile()).every(B=>!(B instanceof y))),new p(R=>o.register(new y(R.tile()))))),new Ga(new p(y=>e.register(new el(y,m,s)))),new Ga(new p(y=>r.register(new Cl(y,s)))),new Ga(new p(y=>n.register(y))),new Ga(new p(y=>{f.emit("city:created",y)})),new Ga(new p(y=>{let R=u.getByTile(y.tile());R!==null&&u.unregister(R),u.register(new Fm(y.tile(),y)),R!==null&&s.process(Bf,R.city(),R.tile()),Qp(y,a,r,u)}))],"getRules"),y0=yV});var dV,g0,h0=i(()=>{mt();ee();xi();Ve();vl();b();zs();fi();dV=t((o=Je,e=Z,r=P,n=z,a=Se)=>[new Uo(new p(s=>o.getByTile(s.tile()).filter(m=>m instanceof Ue).forEach(m=>o.unregister(m)))),new Uo(new p((s,m)=>{r.emit("city:destroyed",s,m)})),new Uo(new p(s=>n.getByCity(s).forEach(m=>m.destroy()))),new Uo(new p(s=>a.getByCity(s).forEach(m=>a.unregister(m))))],"getRules"),g0=dV});var BR,GR,KT=i(()=>{M();BR=class extends x{};t(BR,"FoodExhausted");GR=BR});var gV,x0,R0=i(()=>{b();KT();gV=t(()=>[new GR(new p(o=>o.shrink()))],"getRules"),x0=gV});var hV,O0,v0=i(()=>{A();U();b();yb();KT();hV=t((o=c)=>[new au(new l(e=>e.progress().value()>=e.cost().value()),new p(e=>e.grow())),new au(new l(e=>e.progress().value()<0),new p(e=>{o.process(GR,e)}))],"getRules"),O0=hV});var xV,b0,C0=i(()=>{er();Ri();U();b();Sy();rl();fi();xV=t((o=ie,e=me,r=Se)=>[new Is(new p(n=>n.empty())),new Is(new p(n=>n.cost().set((n.size()+1)*10,"city-grow"))),new Is(new l(n=>n.city().tilesWorked().length<n.size()+1),new p(n=>xC(n.city(),e,o,r))),new Is(new l(n=>n.city().tilesWorked().length>n.size()+1),new p(n=>Wu(n.city(),n).forEach(a=>r.unregisterByTile(a))))],"getRules"),b0=xV});var RV,T0,P0=i(()=>{ub();b();RV=t(()=>[new Uy(new p(o=>10*(o.size()+1)))],"getRules"),T0=RV});var MR,qs,Gf=i(()=>{M();MR=class extends x{};t(MR,"CivilDisorder");qs=MR});var UR,ls,Mf=i(()=>{M();UR=class extends x{};t(UR,"ProcessYield");ls=UR});var DR,$l,ER=i(()=>{M();DR=class extends x{};t(DR,"Unsupported");$l=DR});var OV,I0,w0=i(()=>{is();er();lm();lm();A();Ve();Gf();U();b();Mf();ER();OV=t((o=zt,e=ie,r=z,n=c)=>[new ls(new l(a=>a instanceof X),new p((a,s,m)=>{let f=e.getByCity(s),u=new Vi(a);m.forEach(y=>{if(!(y instanceof Ea)||u.value()>=0)return;let R=y.unit();R!==null&&(n.process($l,s,R,y),u.subtract(y))}),f.add(u),f.check()})),new ls(new l(a=>a instanceof $),new p((a,s,m)=>{let f=o.getByCity(s),u=a.clone();m.filter(R=>R instanceof ka).sort((R,B)=>(B.unit()?.tile().distanceFrom(s.tile())??0)-(R.unit()?.tile().distanceFrom(s.tile())??0)).forEach(R=>{if(u.value()>=0)return;let B=R.unit();B!==null&&(n.process($l,s,B,R),u.subtract(R))});let y=s.yields();n.process(qs,s,y).some(R=>R)||f.add(u),f.check()}))],"getRules"),I0=OV});var vV,A0,B0=i(()=>{er();Ri();U();b();db();rl();fi();vV=t((o=ie,e=me,r=Se)=>[new hp(new l(n=>n.size()>0),new p(n=>n.cost().set((n.size()+1)*10,"city-shrink"))),new hp(new l(n=>n.size()>0),new l(n=>n.city().tilesWorked().length>n.size()+1),new p(n=>Wu(n.city(),n).forEach(a=>r.unregisterByTile(a)))),new hp(new l(n=>n.size()<=0),new p(n=>n.city().destroy()))],"getRules"),A0=vV});var bV,G0,M0=i(()=>{er();Ri();fi();b();AR();rl();bV=t((o=me,e=ie,r=Se)=>[new Bf(new p(n=>Qp(n,o,e,r)))],"getRules"),G0=bV});var CV,U0,D0=i(()=>{b();fb();nu();CV=t(()=>[new Cy(new p(o=>up.from(...o.tile().getSurroundingArea(2).filter((e,r)=>![0,4,20,24].includes(r)))))],"getRules"),U0=CV});var kR,ke,Bo=i(()=>{qe();he();kR=class extends F{constructor(){super(K)}getByCity(e,r=!1){return this.filter(n=>n.city()===e&&!n.destroyed())}};t(kR,"CityImprovementRegistry");ke=new kR});var TV,E0,k0=i(()=>{Hs();Bo();lm();ns();b();em();xT();km();gp();Un();TV=t((o=ke,e=Ht)=>[new Ma(new Xs,new p((r,n)=>{let a=e.getByPlayer(r.player()),[s]=o.filter(y=>y instanceof ut&&r.player()===y.city().player()).map(y=>y.city()),m=tt(n,oe),f=a.is(It)?10:a.is(pt)?0:s?s.tile().distanceFrom(r.tile()):32,[u]=[[Ro,8],[It,20],[pt,0],[Vt,12],[ft,16],[Rt,24]].filter(([y])=>a.is(y)).map(([,y])=>y);return new yi(u?Math.min(Math.floor(m*f*3/(10*u)),m):0,f.toFixed(2))})),new Ma(new pi(0),new p(r=>r.tilesWorked().entries().flatMap(n=>n.yields(r.player()).flatMap(a=>new a.constructor(a.value(),n.id()+": "+a.values().map(([,s])=>s).join("-"))))))],"getRules"),E0=TV});var PV,S0,F0=i(()=>{tb();is();mt();Sa();U();b();PV=t((o=zt,e=Z)=>[new yt(new l(r=>e.getByPlayer(r).map(n=>o.getByCity(n)).some(n=>!n.building())),new p(r=>e.getByPlayer(r).map(n=>o.getByCity(n)).filter(n=>!n.building()).map(n=>new vs(r,n)))),new yt(new l(r=>e.getByPlayer(r).map(n=>o.getByCity(n)).some(n=>!!n.building())),new p(r=>e.getByPlayer(r).map(n=>o.getByCity(n)).filter(n=>!!n.building()).map(n=>new Gm(r,n))))],"getRules"),S0=PV});var IV,N0,W0=i(()=>{er();mt();ee();Gl();U();cu();b();IV=t((o=Z,e=ie,r=P)=>[new Na(new l((n,a,s)=>s instanceof Zi&&s.to()===n.tile()&&o.getByTile(s.to())!==null),new p(n=>{let a=o.getByTile(n.tile());e.getByCity(a).shrink()})),new Na(new p((n,a,s)=>r.emit("unit:defeated",n,a,s)))],"getRules"),N0=IV});var wV,Y0,L0=i(()=>{A();fi();U();b();dt();AR();wV=t((o=c,e=Se)=>[new j(new l(r=>r.moves().value()===0),new l((r,n)=>e.tileIsWorked(n.to())),new l((r,n)=>{let a=e.getByTile(n.to());return a.city().player()===r.player()?!1:!e.tileCanBeWorkedBy(a.tile(),a.city())}),new p((r,n)=>{let a=e.getByTile(n.to());e.unregister(a),o.process(Bf,a.city(),n.to())}))],"getRules"),Y0=wV});var AV,z0,j0=i(()=>{b();ER();AV=t(()=>[new $l(new p((o,e)=>e.destroy()))],"getRules"),z0=AV});var BV={};var H0=i(()=>{s0();l0();f0();c0();d0();h0();R0();v0();C0();P0();w0();B0();M0();D0();k0();A();F0();W0();L0();j0();c.register(...a0(),...m0(),...p0(),...u0(),...y0(),...g0(),...x0(),...O0(),...b0(),...T0(),...I0(),...A0(),...U0(),...G0(),...E0(),...S0(),...N0(),...Y0(),...z0())});var K0=I(_0=>{"use strict";Object.defineProperty(_0,"__esModule",{value:!0});H0()});var SR,FR,qT=i(()=>{Rp();rm();Un();SR=t((o,e=o.city().yields())=>{let r=o.city(),n=new Array(o.size()).fill(1),[a,s]=Fl(e,rd,ws),m=n.length-1;for(;s>0&&m>-1;)n[m--]=0,s--;for(m=0;a>0&&m<n.length;)n[m]===0&&(n[m]=1,a--),n[m]===1&&(n[m++]=2,a--),n[m]===2&&m++;return n},"calculateCitizenState"),FR=t(o=>o.reduce(([e,r,n],a)=>[e+(a===0?1:0),r+(a===1?1:0),n+(a===2?1:0)],[0,0,0]),"citizenSummary")});var NR,Uf,WR=i(()=>{M();NR=class extends x{};t(NR,"CelebrateLeader");Uf=NR});var GV,q0,V0=i(()=>{er();qT();WR();U();b();GV=t((o=ie)=>[new Uf(new l(e=>o.getByCity(e).size()>2),new p((e,r=e.yields())=>{let n=o.getByCity(e),a=SR(n,r),[s,,m]=FR(a);return s===0&&Math.floor(m)>=n.size()/2}))],"getRules"),q0=GV});var MV,J0,$0=i(()=>{er();qT();Gf();b();MV=t((o=ie)=>[new qs(new p((e,r=e.yields())=>{let n=o.getByCity(e),a=SR(n,r),[s,,m]=FR(a);return s>m}))],"getRules"),J0=MV});var Z0=i(()=>{Op();Op()});var Q0=i(()=>{Z0()});var VT=i(()=>{Q0()});var YR=i(()=>{Xy();lm();Rp();mu();od();id();nd();sd();Xp();VT();rm()});var LR,ni,zR=i(()=>{ob();LR=class extends ry{validate(...e){return!this.criteria().length||this.criteria().some(r=>r.validate(...e))}};t(LR,"Or");ni=LR});var UV,X0,eN=i(()=>{Hs();fn();er();YR();Bo();ns();He();A();Ve();yp();U();b();Ls();xl();em();pn();zR();Un();UV=t((o=c,e=ie,r=ke,n=Ht,a=H,s=z)=>[new Gt(new l(m=>n.getByPlayer(m.player()).is(Ro,It,Vt,ft)),new p((m,f)=>s.getByTile(m.tile()).filter(u=>u instanceof V).slice(0,Math.min(4,tt(f,Xe))).map(u=>new Us(1,u)))),...[[kt,1],[kt,1,qt],[Lr,3],[nr,4]].map(([m,f,...u])=>new Gt(new Ot,new l(y=>r.getByCity(y).some(R=>R instanceof m)),new ni(new l(y=>u.length===0),new l(y=>u.every(R=>a.getByPlayer(y.player()).completed(R)))),new l((y,R)=>tt(R,Xe)>0),new p((y,R)=>new As(Math.min(f,tt(R,Xe)),r.getByCity(y).filter(B=>B instanceof m)[0])))),new Gt(new Cs,new p((m,f)=>new im(Math.floor(tt(f,ro)/2),ro.name)))],"getRules"),X0=UV});var DV,tN,rN=i(()=>{Ls();er();Hs();YR();ns();Ve();gp();U();b();DV=t((o=ie,e=Ht,r=z)=>[new Ma(new l(n=>o.getByCity(n).size()-5>0),new p(n=>new am(Math.max(o.getByCity(n).size()-5,0)))),...[[Rt,1],[pt,2]].map(([n,a])=>new Ma(new l(s=>{try{return e.getByPlayer(s.player()).is(n)}catch{return!1}}),new l(s=>r.getByCity(s).filter(m=>[ht,V,Ne].some(f=>m instanceof f)&&m.tile()!==s.tile()).length>0),new p(s=>r.getByCity(s).filter(m=>[ht,V,Ne].some(f=>m instanceof f)&&m.tile()!==s.tile()).map(m=>new Rn(a,m)))))],"getRules"),tN=DV});var jR,oN,iN=i(()=>{Os();jR=class extends $r{};t(jR,"CivilDisorder");oN=jR});var Df,Bc,EV,nN,JT=i(()=>{er();mt();ee();A();WR();Gf();b();em();Af();Df=new Set,Bc=new Set,EV=t((o=Z,e=c,r=P,n=ie)=>[new ia(new Ot,new p(a=>o.getByPlayer(a).forEach(s=>{let m=e.process(qs,s,s.yields()).some(u=>u),f=e.process(Uf,s,s.yields()).some(u=>u);m&&r.emit("city:civil-disorder",s),m&&!Df.has(s)&&Df.add(s),!m&&Df.has(s)&&(r.emit("city:order-restored",s),Df.delete(s)),f&&!Bc.has(s)&&(r.emit("city:leader-celebration",s),Bc.add(s)),!f&&Bc.has(s)&&(r.emit("city:leader-celebration-ended",s),Bc.delete(s))}))),new ia(new Ot,new p(a=>o.getByPlayer(a).forEach(s=>{if(!Bc.has(s))return;n.getByCity(s).grow()})))],"getRules"),nN=EV});var kV,aN,sN=i(()=>{mt();Sa();iN();b();JT();kV=t((o=Z)=>[new yt(new p(e=>o.getByPlayer(e).filter(r=>Df.has(r)).map(r=>new oN(e,r))))],"getRules"),aN=kV});var SV={};var mN=i(()=>{V0();$0();eN();rN();A();sN();JT();c.register(...q0(),...tN(),...J0(),...X0(),...aN(),...nN())});var pN=I(lN=>{"use strict";Object.defineProperty(lN,"__esModule",{value:!0});mN()});var FV={};var fN=i(()=>{fn();El();Gn.register(Wr,ir,Yr,nr,Ko,Lr,Rr,Jt,zr,wt,Or,vr,ar,qo,At,ut,Bt,Vo,Jo,kt,br)});var NV,uN,cN=i(()=>{fn();pn();Jp();Bo();He();U();b();NV=t((o=ke,e=H)=>[new Dt(new p((r,n)=>new l(()=>!o.getByCity(r).some(a=>a instanceof n)))),...[[Wr,Dr],[Ko,Kt],[Lr,Dr],[Rr,yr],[zr,Si],[Or,xo],[ar,po],[ut,Kt],[kt,mo],[ir,so],[nr,Pt],[Jt,rr],[wt,xt],[qo,xr],[vr,Ni],[At,zo],[Bt,go],[Vo,Fi],[Jo,Ho],[br,or]].map(([r,n])=>new Dt(new l((a,s)=>s===r),new p(a=>new l(()=>e.getByPlayer(a.player()).completed(n))))),...[[ir,ar],[br,Or],[wt,Jt],[At,Jt],[Bt,Jt],[vr,wt,At,Bt]].map(([r,...n])=>new Dt(new l((a,s)=>s===r),new p(a=>new l(()=>o.getByCity(a).some(s=>n.some(m=>s instanceof m)))))),...[[Rr,ut],[wt,At,Bt],[At,Bt,wt],[Bt,wt,At]].map(([r,...n])=>new Dt(new l((a,s)=>s===r),new p(a=>new l(()=>o.getByCity(a).every(s=>!n.some(m=>s instanceof m))))))],"getRules"),uN=NV});var WV,yN,dN=i(()=>{fn();$p();WV=t(()=>[...[[Wr,120],[Yr,40],[Ko,120],[Lr,100],[Rr,80],[zr,60],[Or,80],[ar,80],[ut,200],[kt,40],[ir,120],[nr,160],[Jt,200],[wt,240],[qo,160],[vr,320],[At,160],[Bt,160],[Vo,200],[Jo,200],[br,160]].flatMap(([o,e])=>Xm(o,e))],"getRules"),yN=WV});var YV,gN,hN=i(()=>{Bo();Ol();b();fn();Le();YV=t((o=ke,e=()=>Math.random())=>[new eo(new p(r=>{let n=o.getByCity(r).filter(s=>!(s instanceof Ae)),[a]=n.filter(s=>s instanceof ut);for(a&&(a.destroy(),n.splice(n.indexOf(a),1));n.length>0&&e()>.7;){let s=n[Math.floor(e()*n.length)];if(!s)break;s.destroy(),n.splice(n.indexOf(s),1)}}))],"getRules"),gN=YV});var HR=i(()=>{pd()});var LV,xN,RN=i(()=>{fn();pn();Bo();He();HR();yp();U();b();LV=t((o=ke,e=H)=>[...[[Wr,de,2],[ir,de,3],[nr,de,3],[Ko,de,2],[Lr,de,2],[Rr,de,1],[Jt,de,4],[zr,de,1],[wt,de,4],[Or,de,1],[vr,de,6],[ar,de,1],[qo,de,4],[At,de,2],[ut,de,0],[Bt,de,4],[Vo,de,2],[Jo,de,4],[kt,de,1],[br,de,3]].map(([r,n,a])=>new Gt(new l(s=>o.getByCity(s).some(m=>m instanceof r)),new p(s=>{let[m]=o.getByCity(s).filter(f=>f instanceof r);return new n(a,m)}))),...[[Yr,de,0,null,tr],[Yr,de,1,tr,_t],[Yr,de,2,_t,null]].map(([r,n,a,s,m])=>new Gt(new l(f=>o.getByCity(f).some(u=>u instanceof r)),new l(f=>s===null||e.getByPlayer(f.player()).completed(s)),new l(f=>m===null||!e.getByPlayer(f.player()).completed(m)),new p(f=>{let[u]=o.getByCity(f).filter(y=>y instanceof r);return new n(a,u)})))],"getRules"),xN=LV});var zV,ON,vN=i(()=>{Bo();mt();A();Iy();U();b();fn();zV=t((o=Z,e=ke,r=c)=>[new Ga(new l(n=>o.getByPlayer(n.player()).length===0),new p(n=>e.register(new ut(n,r))))],"getRules"),ON=zV});var jV,bN,CN=i(()=>{Bo();U();vl();b();jV=t((o=ke)=>[new Uo(new l(e=>o.getByCity(e).length>0),new p(e=>o.getByCity(e).forEach(r=>r.destroy())))],"getRules"),bN=jV});var HV,TN,PN=i(()=>{fn();Bo();U();b();HR();Sy();HV=t((o=ke)=>[new Is(new l(e=>!o.getByCity(e.city()).some(r=>r instanceof Wr)),new l(e=>e.size()>10),new p(e=>e.shrink())),new Is(new l(e=>o.getByCity(e.city()).some(r=>r instanceof zr)),new p(e=>e.add(new Vi(e.cost().value()/2))))],"getRules"),TN=HV});var _V,IN,wN=i(()=>{Bo();ee();gb();b();_V=t((o=ke,e=P)=>[new su(new p(r=>o.register(r))),new su(new p((r,n)=>{e.emit("city-improvement:created",r,n)}))],"getRules"),IN=_V});var KV,AN,BN=i(()=>{fn();Bo();HR();U();b();my();By();Un();KV=t((o=ke)=>[...[[ar,je,.5],[ar,ro,.5],[ir,je,.5],[ir,ro,.5],[Or,ct,.5],[br,ct,.5],[Jt,$,.5],[Bt,$,.5],[wt,$,.5],[At,$,.5],[vr,$,.5],[Rr,yi,.5]].map(([e,r,n])=>new bl(new sy,new l(a=>o.getByCity(a).some(s=>s instanceof e)),new p((a,s)=>new r(Math.floor(tt(s,r)*n),e.name))))],"getRules"),AN=KV});var qV,GN,MN=i(()=>{Bo();gm();fn();Cd();U();b();qu();qV=t((o=ke,e=oo)=>[new pm(new l(r=>r.city()!==null),new l(r=>o.getByCity(r.city()).some(n=>n instanceof Yr)),new p(r=>e.register(new ss(r))))],"getRules"),GN=qV});var VV={};var UN=i(()=>{A();cN();dN();hN();RN();vN();CN();PN();wN();BN();MN();c.register(...uN(),...yN(),...gN(),...xN(),...ON(),...bN(),...TN(),...IN(),...AN(),...GN())});var EN=I(DN=>{"use strict";Object.defineProperty(DN,"__esModule",{value:!0});fN();UN()});var SN={};Kc(SN,{default:()=>JV,registerCityNames:()=>kN});var kN,JV,FN=i(()=>{Gr();Wt();kN=t((o=se)=>{["Bergen","Cannae","Capua","Cordoba","Cremona","Crete","Cunaxa","Damascus","Dublin","Genoa","Ghent","Issus","Lisbon","Mecca","Melbourne","Milan","Naples","Pisa","Prague","Salamis","Salzburg","Seville","Sidon","Sydney","Tarsus","Toronto","Turin","Tyre","Utica","Venice","Verona"].forEach(e=>o.register(new ye(e,null)))},"registerCityNames"),JV=kN});var NN=i(()=>{jl();jl()});var WN=i(()=>{lf();lf()});var YN=i(()=>{ff();ff()});var LN=i(()=>{cf();cf()});var zN=i(()=>{df();df()});var jN=i(()=>{_l();_l()});var HN=i(()=>{hf();hf()});var _N=i(()=>{ql();ql()});var KN=i(()=>{Rf();Rf()});var qN=i(()=>{vf();vf()});var VN=i(()=>{Cf();Cf()});var JN=i(()=>{Pf();Pf()});var $N=i(()=>{Jl();Jl()});var ZN=i(()=>{wf();wf()});var QN=i(()=>{NN();WN();YN();LN();zN();jN();HN();_N();KN();qN();VN();JN();$N();ZN()});var $T=i(()=>{QN()});var _R,KR,ZT=i(()=>{Pn();Mr();_R=class extends st{constructor(){super(ve)}};t(_R,"CivilizationRegistry");KR=new _R});var e1={};Kc(e1,{default:()=>$V,registerCivilizations:()=>XN});var XN,$V,t1=i(()=>{$T();ZT();XN=t((o=KR)=>{o.register(Hn,_n,Kn,qn,Vn,Jn,$n,Zn,Qn,Xn,ea,ta,ra,oa)},"registerCivilizations"),$V=XN});var qR,ll,Gc=i(()=>{We();qR=class extends Y{#e;constructor(e,r){super(r),this.#e=e}leader(){return this.#e}};t(qR,"Trait");ll=qR});var VR,Ef,JR=i(()=>{he();Gc();VR=class extends F{constructor(){super(ll)}getByLeader(e){return this.getBy("leader",e)}getBySubclass(e){return this.filter(r=>r instanceof e)}};t(VR,"TraitRegistry");Ef=new VR});var $R,Oe,$t=i(()=>{JR();J();$R=class extends k{#e=[];constructor(e=Ef){super();let r=e.getByLeader(this.sourceClass());this.#e.push(...r),this.addKey("name")}static civilization(){throw new TypeError("Must be implemented in extending class")}name(){throw new TypeError("Must be implemented in extending class")}traits(){return[...this.#e]}};t($R,"Leader");Oe=$R});var na,r1=i(()=>{$t();jl();na=class extends Oe{static civilization(){return zl}name(){return"Abraham Lincoln"}};t(na,"AbrahamLincoln")});var ZR=i(()=>{$t();jl()});var XT=i(()=>{r1();ZR()});var o1=i(()=>{XT();XT()});var aa,i1=i(()=>{$t();Rf();aa=class extends Oe{static civilization(){return xf}name(){return"Alexander the Great"}};t(aa,"AlexanderTheGreat")});var eP=i(()=>{i1()});var n1=i(()=>{eP();eP()});var QR=i(()=>{$t();Jl()});var a1=i(()=>{QR();QR()});var sa,s1=i(()=>{$t();_l();sa=class extends Oe{static civilization(){return Hl}name(){return"Elizabeth I"}};t(sa,"ElizabethI")});var XR=i(()=>{$t();_l()});var oP=i(()=>{s1();XR()});var m1=i(()=>{oP();oP()});var ma,l1=i(()=>{$t();ql();ma=class extends Oe{static civilization(){return Kl}name(){return"Frederick the Great"}};t(ma,"FrederickTheGreat")});var eO=i(()=>{$t();ql()});var nP=i(()=>{l1();eO()});var p1=i(()=>{nP();nP()});var la,f1=i(()=>{$t();Cf();la=class extends Oe{static civilization(){return bf}name(){return"Genghis Khan"}};t(la,"GenghisKhan")});var aP=i(()=>{f1()});var u1=i(()=>{aP();aP()});var c1=i(()=>{ZR();ZR()});var pa,y1=i(()=>{$t();ff();pa=class extends Oe{static civilization(){return pf}name(){return"Hammurabi"}};t(pa,"Hammurabi")});var sP=i(()=>{y1()});var d1=i(()=>{sP();sP()});var fa,g1=i(()=>{$t();Jl();fa=class extends Oe{static civilization(){return Vl}name(){return"Joseph Stalin"}};t(fa,"JosephStalin")});var mP=i(()=>{QR();g1()});var h1=i(()=>{mP();mP()});var ua,x1=i(()=>{$t();Pf();ua=class extends Oe{static civilization(){return Tf}name(){return"Julius Caesar"}};t(ua,"JuliusCaesar")});var lP=i(()=>{x1()});var R1=i(()=>{lP();lP()});var ca,O1=i(()=>{$t();vf();ca=class extends Oe{static civilization(){return Of}name(){return"Mahatma Gandhi"}};t(ca,"MahatmaGandhi")});var pP=i(()=>{O1()});var v1=i(()=>{pP();pP()});var ya,b1=i(()=>{$t();cf();ya=class extends Oe{static civilization(){return uf}name(){return"Mao Zedong"}};t(ya,"MaoZedong")});var fP=i(()=>{b1()});var C1=i(()=>{fP();fP()});var da,T1=i(()=>{$t();lf();da=class extends Oe{static civilization(){return mf}name(){return"Moctezuma II"}};t(da,"MoctezumaII")});var uP=i(()=>{T1()});var P1=i(()=>{uP();uP()});var ga,I1=i(()=>{$t();hf();ga=class extends Oe{static civilization(){return gf}name(){return"Napoleon I"}};t(ga,"NapoleonI")});var cP=i(()=>{I1()});var w1=i(()=>{cP();cP()});var A1=i(()=>{eO();eO()});var ha,B1=i(()=>{$t();df();ha=class extends Oe{static civilization(){return yf}name(){return"Ramesses II"}};t(ha,"RamessesII")});var yP=i(()=>{B1()});var G1=i(()=>{yP();yP()});var xa,M1=i(()=>{$t();wf();xa=class extends Oe{static civilization(){return If}name(){return"Shaka"}};t(xa,"Shaka")});var dP=i(()=>{M1()});var U1=i(()=>{dP();dP()});var D1=i(()=>{XR();XR()});var E1=i(()=>{o1();n1();a1();m1();p1();u1();c1();d1();h1();R1();v1();C1();P1();w1();A1();G1();U1();D1()});var gP=i(()=>{E1()});var tO,rO,hP=i(()=>{Pn();$t();tO=class extends st{constructor(){super(Oe)}getByCivilization(e){return this.getBy("civilization",e)}};t(tO,"LeaderRegistry");rO=new tO});var S1={};Kc(S1,{default:()=>ZV,registerLeaders:()=>k1});var k1,ZV,F1=i(()=>{gP();hP();k1=t((o=rO)=>{o.register(na,da,pa,ya,ha,sa,ga,ma,aa,ca,la,ua,fa,xa)},"registerLeaders"),ZV=k1});var Zl,kf,Sf=i(()=>{Gc();Zl=class extends ll{};t(Zl,"Aggression");kf=Zl});var N1=i(()=>{Sf();Sf()});var un,xP=i(()=>{Sf();un=class extends kf{constructor(e){super(e,1)}};t(un,"Aggressive")});var W1=i(()=>{xP();xP()});var Ql,Ff,Nf=i(()=>{Gc();Ql=class extends ll{};t(Ql,"Militarism");Ff=Ql});var Go,RP=i(()=>{Nf();Go=class extends Ff{constructor(e){super(e,0)}};t(Go,"Civilized")});var Y1=i(()=>{RP();RP()});var Xl,Wf,Yf=i(()=>{Gc();Xl=class extends ll{};t(Xl,"Development");Wf=Xl});var L1=i(()=>{Yf();Yf()});var cn,OP=i(()=>{Yf();cn=class extends Wf{constructor(e){super(e,1)}};t(cn,"Expansionist")});var z1=i(()=>{OP();OP()});var ps,vP=i(()=>{Sf();ps=class extends kf{constructor(e){super(e,0)}};t(ps,"Friendly")});var j1=i(()=>{vP();vP()});var H1=i(()=>{Nf();Nf()});var fs,bP=i(()=>{Nf();fs=class extends Ff{constructor(e){super(e,1)}};t(fs,"Militaristic")});var _1=i(()=>{bP();bP()});var Yi,CP=i(()=>{Sf();Yi=class extends kf{constructor(e){super(e,.5)}};t(Yi,"Normal")});var K1=i(()=>{CP();CP()});var yn,TP=i(()=>{Yf();yn=class extends Wf{constructor(e){super(e,.5)}};t(yn,"Normal")});var q1=i(()=>{TP();TP()});var us,PP=i(()=>{Nf();us=class extends Ff{constructor(e){super(e,.5)}};t(us,"Normal")});var V1=i(()=>{PP();PP()});var Ra,IP=i(()=>{Yf();Ra=class extends Wf{constructor(e){super(e,0)}};t(Ra,"Perfectionist")});var J1=i(()=>{IP();IP()});var $1=i(()=>{N1();W1();Y1();L1();z1();j1();H1();_1();K1();q1();V1();J1()});var Z1=i(()=>{$1()});var X1={};Kc(X1,{default:()=>QV,registerTraits:()=>Q1});var Q1,QV,eW=i(()=>{gP();Z1();JR();Q1=t((o=Ef)=>{[[na,ps,yn,Go],[da,Yi,Ra,Go],[pa,ps,Ra,Go],[ya,Yi,yn,Go],[ha,Yi,yn,Go],[sa,Yi,cn,us],[ga,un,cn,Go],[ma,un,Ra,Go],[aa,Yi,cn,fs],[ca,ps,Ra,us],[la,un,cn,fs],[ua,Yi,cn,Go],[fa,un,yn,fs],[xa,un,yn,us]].forEach(([e,...r])=>r.forEach(n=>o.register(new n(e))))},"registerTraits"),QV=Q1});var rW=I(tW=>{"use strict";Object.defineProperty(tW,"__esModule",{value:!0});var XV=(FN(),O(SN)),e5=(t1(),O(e1)),t5=(F1(),O(S1)),r5=(eW(),O(X1));(0,XV.default)();(0,e5.default)();(0,t5.default)();(0,r5.default)()});var Pr,Cm,wP=i(()=>{es();Pr=class extends Ct{};t(Pr,"Fuel");Cm=Pr});var Ir,Mc,AP=i(()=>{es();Ir=class extends Ct{};t(Ir,"Habitation");Mc=Ir});var oO,ep,iO=i(()=>{M();oO=class extends x{};t(oO,"ChooseSlot");ep=oO});var nO,tp,BP=i(()=>{M();nO=class extends x{};t(nO,"Active");tp=nO});var oW,aO,sO,GP=i(()=>{J();A();iO();BP();oW=t((o,e,r)=>e<=o&&o<r,"isBetween"),aO=class extends k{#e=new Map;#t;#r;#o=[];#i;constructor(e,r,n,a=c){super(),this.addKey("activeSlots","height","inactiveSlots","slots","width"),this.#t=e,this.#r=a,this.#i=r,this.#o.push(...n)}activeSlots(){return this.#o.filter(e=>this.#r.process(tp,e,this).every(r=>r))}get(e,r){if(e<0||e>=this.#i||r<0||r>=this.#t)return null;let n=[e,r].toString();if(!this.#e.has(n)){let[a]=this.#o.filter(s=>oW(e,s.x(),s.x()+s.width())&&oW(r,s.y(),s.y()+s.height()));this.#e.set(n,a??null)}return this.#e.get(n)}getAdjacent(e){let r=new Set;for(let n=e.x(),a=e.x()+e.width()-1;n<=a;n++){let s=this.get(n,e.y()-1),m=this.get(n,e.y()+e.height());s&&r.add(s),m&&r.add(m)}for(let n=e.y(),a=e.y()+e.height()-1;n<=a;n++){let s=this.get(e.x()-1,n),m=this.get(e.x()+e.width(),n);s&&r.add(s),m&&r.add(m)}return[...r.values()].filter(n=>n!==e)}getFreeSlot(e){let[r]=this.#r.process(ep,e,this);return r??null}height(){return this.#t}inactiveSlots(){return this.#o.filter(e=>this.#r.process(tp,e,this).some(r=>!r))}slots(){return this.#o}width(){return this.#i}};t(aO,"Layout");sO=aO});var qr,Uc,MP=i(()=>{es();qr=class extends Ct{};t(qr,"LifeSupport");Uc=qr});var Mo,Dc,UP=i(()=>{es();Mo=class extends Ct{};t(Mo,"Power");Dc=Mo});var pr,Tm,DP=i(()=>{es();pr=class extends Ct{};t(pr,"Propulsion");Tm=pr});var mO,S,iW=i(()=>{J();mO=class extends k{#e=[];#t;#r=null;#o;#i;#n;constructor(e,r,n,a,s){super(),this.addKey("height","part","width","x","y"),this.#t=n,this.#o=a,this.#i=e,this.#n=r,this.#e.push(...s)}accepts(e){return this.#e.some(r=>e instanceof r)}empty(){return this.#r===null}fill(e){!this.accepts(e)||(this.#r=e)}height(){return this.#t}part(){return this.#r}width(){return this.#o}x(){return this.#i}y(){return this.#n}};t(mO,"Slot");S=mO});var Zt,ge,EP=i(()=>{es();Zt=class extends Ct{};t(Zt,"Structural");ge=Zt});var lO,nW,aW=i(()=>{A();wP();AP();GP();MP();UP();DP();iW();EP();lO=class extends sO{constructor(e=c){super(12,12,[new S(9,0,1,1,[Cm]),new S(10,0,1,2,[Tm]),new S(1,1,2,2,[Dc]),new S(5,1,2,2,[Dc]),new S(8,1,1,1,[ge]),new S(9,1,1,1,[ge]),new S(10,1,1,1,[ge]),new S(8,2,1,1,[ge]),new S(9,2,1,1,[Cm]),new S(10,2,1,2,[Tm]),new S(0,3,1,1,[ge]),new S(1,3,1,1,[ge]),new S(2,3,1,1,[ge]),new S(3,3,1,1,[ge]),new S(4,3,1,1,[ge]),new S(5,3,1,1,[ge]),new S(6,3,1,1,[ge]),new S(7,3,1,1,[ge]),new S(8,3,1,1,[ge]),new S(9,3,1,1,[Cm]),new S(10,3,1,2,[Tm]),new S(0,4,2,2,[Uc]),new S(2,4,2,2,[Mc]),new S(4,4,2,2,[Uc]),new S(6,4,2,2,[Mc]),new S(8,4,1,1,[ge]),new S(9,4,1,1,[ge]),new S(10,4,1,1,[ge]),new S(8,5,1,1,[ge]),new S(9,5,1,1,[Cm]),new S(10,5,1,2,[Tm]),new S(0,6,2,2,[Mc]),new S(2,6,2,2,[Uc]),new S(4,6,2,2,[Mc]),new S(6,6,2,2,[Uc]),new S(8,6,1,1,[ge]),new S(9,6,1,1,[Cm]),new S(10,6,1,2,[Tm]),new S(8,7,1,1,[ge]),new S(9,7,1,1,[ge]),new S(10,7,1,1,[ge]),new S(0,8,1,1,[ge]),new S(1,8,1,1,[ge]),new S(2,8,1,1,[ge]),new S(3,8,1,1,[ge]),new S(4,8,1,1,[ge]),new S(5,8,1,1,[ge]),new S(6,8,1,1,[ge]),new S(7,8,1,1,[ge]),new S(8,8,1,1,[ge]),new S(9,8,1,1,[Cm]),new S(10,8,1,2,[Tm]),new S(1,9,2,2,[Dc]),new S(5,9,2,2,[Dc]),new S(8,9,1,1,[ge]),new S(9,9,1,1,[Cm]),new S(10,9,1,2,[Tm]),new S(8,10,1,1,[ge]),new S(9,10,1,1,[ge]),new S(10,10,1,1,[ge]),new S(9,11,1,1,[Cm]),new S(10,11,1,2,[Tm])],e)}};t(lO,"Default");nW=lO});var pO,Lf,fO=i(()=>{Pn();GP();pO=class extends aA{constructor(){super(sO)}};t(pO,"LayoutRegistry");Lf=new pO});var o5={};var sW=i(()=>{aW();fO();Lf.register(nW)});var lW=I(mW=>{"use strict";Object.defineProperty(mW,"__esModule",{value:!0});sW()});var uO,cO,kP=i(()=>{M();uO=class extends x{};t(uO,"Expired");cO=uO});var i5,pW,fW=i(()=>{ee();b();kP();i5=t((o=P)=>[new cO(new p(e=>{o.emit("diplomacy:declaration-expired",e),e.players().forEach(r=>o.emit("player:declaration-expired",r,e))}))],"getRules"),pW=i5});var n5,uW,cW=i(()=>{vm();b();Xb();n5=t((o=Ur)=>[new Og(new p(e=>o.register(e)))],"getRules"),uW=n5});var yO,cs,yW=i(()=>{Ul();yO=class extends Bn{};t(yO,"Acknowledge");cs=yO});var dO,gO,dW=i(()=>{A();Pp();dO=class extends Hm{#e;constructor(e,r,n,a=c){super(r,n,a),this.#e=e,this.addKey("tribute")}tribute(){return this.#e}};t(dO,"DemandTribute");gO=dO});var hO,wr,gW=i(()=>{Pp();A();hO=class extends Tp{#e;constructor(e,r,n,a=c){super(e,n,a),this.#e=r,this.addKey("key")}key(){return this.#e}};t(hO,"Dialogue");wr=hO});var xO,Ec,SP=i(()=>{J();Mt();xO=class extends k{#e;#t;constructor(e,r=te){super(),this.#e=e,this.#t=r,this.addKey("expired","expiry")}expired(){return this.#e<=this.#t.value()}expiry(){return this.#e}};t(xO,"Expiry");Ec=xO});var RO,OO,FP=i(()=>{SP();RO=class extends Ec{constructor(){super(1/0)}expired(){return!1}};t(RO,"Never");OO=RO});var vO,NP,WP=i(()=>{vp();Mt();kP();SP();FP();Do();A();vO=class extends On{#e=new OO;#t=te;constructor(...e){super(...e.filter(r=>r instanceof q||r instanceof kI)),this.addKey("expired","expiry"),e.forEach(r=>{r instanceof Ec&&(this.#e=r),r instanceof zm&&(this.#t=r)})}active(){return!this.expiry().expired()}expire(){this.#e=new Ec(this.#t.value()),this.ruleRegistry().process(cO,this)}expired(){return this.#e.expired()}expiry(){return this.#e}};t(vO,"Declaration");NP=vO});var Li,kc,Sc=i(()=>{WP();Li=class extends NP{};t(Li,"Peace");kc=Li});var a5,hW,xW=i(()=>{vm();He();A();cx();yW();U();TR();dW();gW();b();dx();Bs();lu();RR();Sc();Ul();xd();bg();a5=t((o=c,e=Ur,r=H)=>{let n=t((g,...h)=>h.includes(g.key().split(".")[0]),"dialogueNamespaceMatches"),a=t(g=>new l(h=>!e.getByPlayers(...h.players()).some(G=>G instanceof g&&G.negotiation()===h)),"onlyOncePerNegotiation"),s=t(g=>new l(h=>h.lastInteraction()instanceof Bn&&h.lastInteraction().proposal()instanceof g),"lastInteractionWasResolutionForAction"),m=t((...g)=>new l(h=>h.lastInteraction()instanceof cs&&h.lastInteraction().proposal()instanceof wr&&n(h.lastInteraction().proposal(),...g)),"lastInteractionWasAcknowledgeForDialogueWithNamespace"),f=t(g=>g.lastInteraction()===null?g.players()[0]:g.lastInteraction().for()[0],"getNextBy"),u=t(g=>new p(h=>new g(f(h),h,o)),"proposalAction"),y=t(g=>new p(h=>new g(f(h),h.lastInteraction(),o)),"resolutionAction"),R=t((g,h)=>new p(G=>new g(f(G),h,G,o)),"dialogueAction"),B=t(g=>new l(h=>{let G=h.lastInteraction();return G instanceof wr&&n(G,g)}),"lastInteractionWasDialogueWithNamespace"),N=t((...g)=>e.getByPlayers(...g).some(h=>h instanceof kc&&h.active()),"hasPeaceTreaty"),W={standardTopics:[[new l(g=>!g.interactions().some(h=>h instanceof jn&&h.proposal()instanceof js)),new l(g=>{let[h,G]=g.players().map(Ft=>r.getByPlayer(Ft)),L=h.complete().filter(Ft=>!G.completed(Ft.sourceClass())),Qe=G.complete().filter(Ft=>!h.completed(Ft.sourceClass()));return L.length>0&&Qe.length>0}),new p(g=>{let h=g.lastInteraction(),[G,L]=h!==null?[h.by(),...h.for()]:g.players(),[Qe,Ft]=[G,L].map(Ce=>r.getByPlayer(Ce)),be=Ft.complete().filter(Ce=>!Qe.completed(Ce.sourceClass()));return new js(be,f(g),g,o)})],[a(_s),new l(g=>!N(...g.players())),u(_s)],[R(wr,"handover")]]},_=[[y(as)],[y(jn)]];return[...[[[null],[[u(vn)]]],[[vn],_],[[jn,s(vn)],[[u(Om)]]],[[as,s(vn),new l(g=>!N(...g.players()))],[[R(wr,"welcome.no-peace")]]],[[as,s(vn),new l(g=>N(...g.players()))],[[R(wr,"welcome.peace")]]],[[wr,B("welcome")],[[y(cs)]]],[[_s],_],[[jn,s(_s)],[[R(wr,"decline-peace.neutral")]]],[[as,s(_s)],[[R(wr,"accept-peace.neutral")]]],[[wr,B("decline-peace")],[[y(cs)]]],[[cs,m("decline-peace")],[[new p(g=>new Om(f(g),g,o))]]],[[cs,m("decline-demand")],[[new p(g=>new Om(f(g),g,o))]]],[[cs,new l(g=>g.lastInteraction()instanceof cs&&g.lastInteraction().proposal()instanceof wr&&!["decline-demand","decline-peace"].includes(g.lastInteraction().proposal().key()))],W.standardTopics],[[wr,B("accept-peace")],[[y(cs)]]],[[gO],[[y(jn)]]],[[jn,s(gO)],[[R(wr,"decline-demand.neutral")]]],[[wr,B("decline-demand")],[[y(cs)]]],[[wr,B("accept-demand")],[[y(cs)]]],[[js],_],[[jn,s(js)],W.standardTopics],[[as,s(js)],W.standardTopics],[[wr,B("handover")],[[new l(g=>N(...g.players())),R(wr,"welcome-peace")],[new l(g=>!N(...g.players())),R(wr,"grateful-discussion")],[new p(g=>new gO(new ci(50),f(g),g,o))]]]].flatMap(([[g,...h],G])=>G.map(([...L])=>new bp(new l(Qe=>g===null?Qe.lastInteraction()===null:Qe.lastInteraction()instanceof g),...h,...L)))]},"getRules"),hW=a5});var s5,RW,OW=i(()=>{rs();A();vm();He();cx();ap();U();TR();b();dx();lu();FP();RR();Sc();bb();bg();s5=t((o=c,e=Ur,r=H,n=Lt)=>[new Cp(new l((a,s)=>a instanceof jn&&s instanceof vn),new p(async(a,s)=>s.negotiation().proceed(new Om(a.by(),s.negotiation(),o)))),new Cp(new l((a,s)=>a instanceof as&&s instanceof _s),new p(async(a,s)=>e.register(new kc(...s.players(),new OO,o)))),new Cp(new l((a,s)=>a instanceof as&&s instanceof js),new p(async(a,s)=>{let m=r.getByPlayer(a.by()),f=r.getByPlayer(a.for()[0]),u=m.complete().filter(_=>!f.completed(_.sourceClass())),y=f.complete().filter(_=>!m.completed(_.sourceClass())),R=n.getByPlayer(a.by()),B=await R.chooseFromList(new Um(y.map(_=>_.sourceClass()),"diplomacy.exchange-knowledge",a)),N=n.getByPlayer(a.for()[0]),W=await N.chooseFromList(new Um(u.map(_=>_.sourceClass()),"diplomacy.exchange-knowledge",a));m.addAdvance(B),f.addAdvance(W)}))],"getRules"),RW=s5});var zf,vW=i(()=>{vp();zf=class extends fw{constructor(...e){let r=e.map(n=>n.player());super(...r)}};t(zf,"Contact")});var bW=i(()=>{vW()});var m5,CW,TW=i(()=>{vm();Ve();bW();U();b();dt();m5=t((o=Ur,e=z)=>[new j(new l(r=>r.tile().getNeighbours().some(n=>e.getByTile(n).some(a=>a.player()!==r.player()))),new p(r=>r.tile().getNeighbours().forEach(n=>e.getByTile(n).filter(a=>a.player()!==r.player()).forEach(a=>o.register(new zf(r,a))))))],"getRules"),CW=m5});var l5={};var PW=i(()=>{A();fW();cW();xW();OW();TW();c.register(...pW(),...uW(),...hW(),...RW(),...CW())});var wW=I(IW=>{"use strict";Object.defineProperty(IW,"__esModule",{value:!0});PW()});var bO,CO,YP=i(()=>{bO=class{#e;#t;#r;constructor(e,r,n){this.#e=e,this.#t=r,this.#r=n}civilizationType(){return this.#e}mapGenerator(){return this.#t}startTile(){return this.#r}startTileForMap(e){let{x:r,y:n}=this.#r;return e.get(r,n)}};t(bO,"CivilizationStartTile");CO=bO});var p5,ys,LP=i(()=>{p5=t((o,e,r,n)=>{for(;r<0;)r+=e;for(;n<0;)n+=o;return r=r%e,n=n%o,n*e+r},"coordsToIndex"),ys=p5});var f5,rp,TO=i(()=>{f5=t((o,e,r)=>{let n=o*e;for(;r<0;)r+=n;return r=r%n,[r%e,Math.floor(r/e)]},"indexToCoords"),rp=f5});var u5,AW,BW=i(()=>{TO();u5=t((o,e,r,n)=>{let[a,s]=rp(o,e,r),[m,f]=rp(o,e,n),u=[[-1,1],[-1,0],[-1,-1],[0,1],[0,0],[0,-1],[1,1],[1,0],[1,-1]],[y]=u.map(([R,B])=>[R*e,B*o]).map(([R,B])=>[a-m+R,s-f+B]).map(R=>Math.hypot(...R)).sort((R,B)=>R-B);return y},"distanceFrom"),AW=u5});var c5,op,zP=i(()=>{LP();TO();c5=t((o,e,r,n=!0)=>{let[a,s]=rp(o,e,r),m=ys(o,e,a,s-1),f=ys(o,e,a+1,s-1),u=ys(o,e,a+1,s),y=ys(o,e,a+1,s),R=ys(o,e,a,s+1),B=ys(o,e,a-1,s+1),N=ys(o,e,a-1,s),W=ys(o,e,a-1,s-1);return n?[m,u,R,N]:[m,f,u,y,R,B,N,W]},"getNeighbours"),op=c5});var jf,PO,IO=i(()=>{LP();BW();zP();TO();jf=class{#e;#t;#r;constructor(e,r,n={}){this.#e=e,this.#t=n,this.#r=r}coordsToIndex(e,r){return ys(this.#e,this.#r,e,r)}distanceFrom(e,r){return AW(this.#e,this.#r,e,r)}generate(){throw new Error(`Generator#generate(): Must be overridden in '${this.constructor.name}'.`)}getNeighbours(e,r=!0){return op(this.#e,this.#r,e,r)}height(){return this.#e}indexToCoords(e){return rp(this.#e,this.#r,e)}options(){return this.#t}width(){return this.#r}};t(jf,"Generator");PO=jf});var y5,wO,Hf,AO=i(()=>{Mh();Uh();hu();IO();Bl();Dh();Eh();kh();Sh();Up();zu();Nh();Wh();y5={A:aB,D:mB,F:yg,G:Jm,H:uB,J:yB,M:gB,O:xB,P:Mp,R:Fh,S:bB,T:TB},wO=class extends PO{async generate(){return Array.from(`OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOAAAAAAAOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOAAOAOAAAOAAAAAAAAOOOOOOAOOOOOGGOOOOOTAGOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOTTTTAOOOOAAAAAAAAOOOOAAAAAATOOOOOAAOOOOOOOOOOOOOOOAAOOOOOTOOOOOOOOOOOOOOOOOO
OOOTTTTTTTTTAAOAOAAAAAOOOAAAAATOOOOOOOOOOOOOOOAOOOOOFFAAFFFFFOOFFFOOOOFFFOOOOOOO
OTPTGPPPPTTTTTOTAAAOOAOOOAAAATOOOOOOOOOOOOOOOAOOAAOFFGAFFFFFFFAFFFFFFFFFFOTOOOOO
OOOOOPGTPTOOTTAAAAAAAAOOAAGGOOOOOOOOOOGAAOOOOOOGOGFFFGFFFFFFFFAFFAFFFFFGFGGOOOOO
OOOOOGGFGPPTTAAOOOAOTOOOAGOOOOAOOOOOOAFGFPGFOAAFGTGFFFFFFFFFFFFFFFGFFGOGFFOOOOOO
OOOOPMGFPPPPTTOOOATAAOOOOOOOOOOOOOOOGFPGGFOFFFFFFGFFFFFFFFFFFFFFGFFFFGOOFOOOOOOO
OOOOPMGFGPPOTTTAATTTTOOOOOOOOOOHOOOPFGOGGGFFFGFGGGFFFFFFFFFFFFFFFFFFOOOOFGOOOOOO
OOOOPHFFGPGOPPPOPTTTTOOOOOOOOOGROOOOOPOGFGFFGFFFGFGFGGFGGFFFGFFFFFFFGOOOOPOOOOOO
OOOOGGHFGPPPPPPPPPTPPOOOOOOOOOOFOOOFOOOFFFRFFFFRGFPFFPFGPFGFFOFFFFFGPPGOOOOOOOOO
OOOGGGMGGGPPPOPPPPPOPOOOOOOOOOGGOOOGPPFFFGRRFRRRGGFGGGGGPGGFFFFDPPPPPPOOOOOOOOOO
OOOGGFMGRGRPGORRGOPOOOOOOOOOOOOOOGRGGGGFFGFRFRPGPGGGGGPPPPPPPPPPPPPPGPGOOOOOOOOO
OOGGGMMGRGRGGGGOOOOOOOOOOOOOOOOOGGRMMGGGGPGRPRRPPPPPPPPPPPPPPPPPPPPPGPGOPGOOOOOO
OOGGPPHGRRRGGGOOOOOOOOOOOOOOOOOOPGGGGFGRRGPRPDOOPPOPPPDPDDDPPPPPPDPPPGOOGOOOOOOO
OOGFPPFGGRGGGPOOOOOOOOOOOOOOOOPPPPOGHOOGRFOOOHPOGPPDPDPDDPPPPPPDDPPOPGOOMGOOOOOO
OOGPPDDGGRGGOOOOOOOOOOOOOOOOOOPPPOOOGHOOOGPPPPPOPPPPDPPHPDDDDDDPPPGOOOOOOPOOOOOO
OOPOGDDPOOOPOOOOOOOOOOOOOOOOOOOOOOOOOGOOOOOPPPPGPPPPPPHHMHHHHHHHHMHPGOOGOOOOOOOO
OOPOGDDOOOOPOOOOOOOOOOOOOOOOOOGPPDDOOOOOOOOPPRRHPPPDPPHPGHMMMMMHHHPPPGOOOOOOOOOO
OOOOGDGOOOOOOOOOOOOOOOOOOOOOOODPHHPPPGODPOPPPGRRPPPPPHHRDPGMHHMHHPPRRROOOOOOOOOO
OOOOGGPOPOOOGPOOOOOOOOOOOOOOOPPHDDDPPPPDDRGDPPDOPPPPHPRRDGGGHHHHHPGPPPOOOOOOOOOO
OOOOOGGPGOOOOGPOOOOOOOOOOOOOPPDDDDDPDDDDDRDOPDDOOOOHHRRDPGGRGGGHGPGGPOOOOOOOOOOO
OOOOOOOOGGOOOOOOOOOOOOOOOOOOPDDDDDDDDDDDSRSODDDDDDOOOOPPGGGRRPPGFGGGOOOGOOOOOOOO
OOOOOOOOOGOOOOOOOOOOOOOOOOOPDDDDDDPPPDDDDRDOOPDDDDPOOOOGGGGGOOGGGGGOOOOPGOOOOOOO
OOOOOOOOOPPOGPPGOOOOOOOOOOODDDDDDDPDDDDDDRDDOODDDDOOOOOOGGGOOOPPGGOOOOOGGOOOOOOO
OOOOOOOOOOPGFPPPGOOOOOOOOOODDDDDDDDPDPDPPDHHDOOPDOOOOOOOGGOOOOOGGGGOOOOOFGOOOOOO
OOOOOOOOOOOGHGGGGGGOOOOOOOOPPDPPPPDDDPPPPPPMDPOOGOOOOOOOPGOOOOOOOGGOOOOOOGOOOOOO
OOOOOOOOOOOHJJJGGGGROOOOOOOOPPDPPPPPPPPPPPPHMDPOOOOOOOOOOGOOOOOOOOOOOPOOOOOOOOOO
OOOOOOOOOOGHJRRJJRRRGOOOOOOOOPPPGOPPGPGGGGGGMDDPOOOOOOOOOOOOOOOOOOOGPPOOGPOOOOOO
OOOOOOOOOOPGJJRRRRJGFGGOOOOOOOOOOOOGGGGJJJGGODPPOOOOOOOOOOOOOOOGFGOOPGFGGGOGOOOO
OOOOOOOOOOOFGGJJGJJFGGGPOOOOOOOOOOOGGJJRRRGGHPPOOOOOOOOOOOOOOOOOGFOOGOPGOOOPGGOO
OOOOOOOOOOOGHGGGGGGGGGGOOOOOOOOOOOOGGRRRJJHOGGOOOOOOOOOOOOOOOOOOOGOOOOOOOOOOOGGO
OOOOOOOOOOOOGMFGGGGGGPOOOOOOOOOOOOOOGRJJJGHMGOOOOOOOOOOOOOOOOOOOOPPOOOOOGOOOOOOO
OOOOOOOOOOOOGFMGGFGPPPOOOOOOOOOOOOOORRGGGGGMPOOOOOOOOOOOOOOOOOOOOOGOOOOOOOPGOOOO
OOOOOOOOOOOOOOHMGGRPGGOOOOOOOOOOOOOOOGGGGGGHGOOOOOOOOOOOOOOOOOOOOOOOOOOGGPGPGGOO
OOOOOOOOOOOOOOGHGGRGGOOOOOOOOOOOOOOOODPPGGGGGGOOOOOOOOOOOOOOOOOOOOOOOOOGGPPPPGOO
OOOOOOOOOOOOOOGMGPRROOOOOOOOOOOOOOOOPPPPPPPGGGOPOOOOOOOOOOOOOOOOOOOOGGPPPDDDPPPO
OOOOOOOOOOOOOOGMGGGPOOOOOOOOOOOOOOOOHPDDPPGGOOOPOOOOOOOOOOOOOOOOOOOGGGPDDDDDDPFO
OOOOOOOOOOOOOOPMGGGOOOOOOOOOOOOOOOOOOPPDPPGGOOOGOOOOOOOOOOOOOOOOOOOGPDDDDDDDDPPO
OOOOOOOOOOOOOOOMGPOOOOOOOOOOOOOOOOOOOHPPPGGGOOGPOOOOOOOOOOOOOOOOOOOGDDDDDPDDDPGO
OOOOOOOOOOOOOOOGGOOOOOOOOOOOOOOOOOOOOHPPGHGOOOPOOOOOOOOOOOOOOOOOOOODDDDDDDPDDHFO
OOOOOOOOOOOOOOOPGOOOOOOOOOOOOOOOOOOOOODPGHGOOOOOOOOOOOOOOOOOOOOOOOODDDOOGDDDHGOO
OOOOOOOOOOOOOOOOGOOOOOOOOOOOOOOOOOOOOOPGGGOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOGHHHGOOO
OOOOOOOOOOOOOOOOFOOOOOOOOOOOOOOOOOOOOOGOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOPGOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
`.replace(/\n/g,"")).map(e=>new y5[e])}height(){return 50}width(){return 80}};t(wO,"Earth");Hf=wO});var BO,GW,MW=i(()=>{YP();AO();BO=class extends CO{constructor(e,r){super(e,Hf,r)}};t(BO,"EarthStartTile");GW=BO});var Fc,T8e,UW,DW=i(()=>{YP();he();Fc=class extends Bm{constructor(){super(CO)}getByCivilization(e){let[r]=this.getBy("civilizationType",e);if(!r)throw new TypeError(`${e.name} does not have a registered start tile.`);return r}getStartTileByCivilizationAndWorld(e,r){return this.getByCivilization(e).startTileForMap(r)}};t(Fc,"CivilizationStartTileRegistry");T8e=new Fc,UW=Fc});var GO,MO,jP=i(()=>{DW();AO();GO=class extends UW{entries(){return super.entries().filter(e=>e.mapGenerator()===Hf)}};t(GO,"EarthStartTileRegistry");MO=new GO});var d5={};var EW=i(()=>{$T();MW();jP();MO.register(...[[Hn,{x:12,y:18}],[_n,{x:5,y:23}],[Kn,{x:45,y:22}],[qn,{x:66,y:19}],[Vn,{x:41,y:24}],[Jn,{x:31,y:14}],[$n,{x:33,y:16}],[Zn,{x:38,y:15}],[Qn,{x:39,y:18}],[Xn,{x:57,y:26}],[ea,{x:49,y:19}],[ta,{x:36,y:19}],[ra,{x:44,y:12}],[oa,{x:42,y:42}]].map(([o,e])=>new GW(o,e)))});var SW=I(kW=>{"use strict";Object.defineProperty(kW,"__esModule",{value:!0});EW()});var g5,FW,NW=i(()=>{U();b();dC();g5=t(()=>[new tl(new l(o=>o<252),new p(o=>o*20-4020)),new tl(new l(o=>o>251),new l(o=>o<302),new p(o=>(o-151)*10+1e3)),new tl(new l(o=>o>301),new l(o=>o<352),new p(o=>(o-201)*5+1500)),new tl(new l(o=>o>351),new l(o=>o<402),new p(o=>(o-251)*2+1750)),new tl(new l(o=>o>401),new p(o=>o-301+1850))],"getRules"),FW=g5});var h5={};var WW=i(()=>{A();NW();c.register(...FW())});var LW=I(YW=>{"use strict";Object.defineProperty(YW,"__esModule",{value:!0});WW()});var _f,Kf,Nc=i(()=>{_f=class{#e;#t;constructor(e,r){this.#e=e,this.#t=r}goodyHut(){return this.#e}perform(){}unit(){return this.#t}};t(_f,"Action");Kf=_f});var qf,zW=i(()=>{He();Nc();qf=class extends Kf{#e;#t;constructor(e,r,n=H,a=()=>Math.random()){super(e,r),this.#e=n,this.#t=a}perform(){let e=this.#e.getByPlayer(this.unit().player()),r=e.available(),n=r[Math.floor(r.length*this.#t())];e.addAdvance(n)}};t(qf,"Advance")});var Vf,jW=i(()=>{mt();A();Nc();Ps();Vf=class extends Kf{#e;constructor(e,r,n=Z){super(e,r),this.#e=n}perform(e=c){let r=this.unit().player(),n=new it(r,this.goodyHut().tile(),r.civilization().getCityName(!0),e);this.#e.register(n)}};t(Vf,"City")});var Jf,HW=i(()=>{Sl();Nc();Bs();Jf=class extends Kf{#e;constructor(e,r,n=tn){super(e,r),this.#e=n}perform(){this.#e.getByPlayerAndType(this.unit().player(),ci).add(new ci(50))}};t(Jf,"Gold")});var UO,DO,HP=i(()=>{M();UO=class extends x{};t(UO,"Unit");DO=UO});var $f,_W=i(()=>{Nc();A();HP();$f=class extends _f{#e;#t;constructor(e,r,n=()=>Math.random(),a=c){super(e,r),this.#e=n,this.#t=a}perform(){this.#t.process(DO,this.goodyHut(),this.unit())}};t($f,"Unit")});var KW=i(()=>{zW();jW();HW();_W()});var x5,qW,VW=i(()=>{KW();mt();En();He();EC();U();b();Ms();mm();Gs();x5=t((o=H,e=Z)=>[new Yl(new l((r,n)=>o.getByPlayer(n.player()).available().length>0),new p((r,n)=>new qf(r,n))),new Yl(new l(r=>[Re,fe,le].some(n=>r.tile().terrain()instanceof n)),new l((r,n)=>r.tile().getSurroundingArea().score(null,[[Ua,8],[sm,3],[om,1]])>=150),new l(r=>r.tile().getSurroundingArea(4).every(n=>e.getByTile(n)===null)),new p((r,n)=>new Vf(r,n))),new Yl(new p((r,n)=>new Jf(r,n))),new Yl(new p((r,n)=>new $f(r,n)))],"getRules"),qW=x5});var R5,JW,$W=i(()=>{ee();kC();b();R5=t((o=P)=>[new Xh(new p((e,r)=>{o.emit("goody-hut:action-performed",e,r)}))],"getRules"),JW=R5});var O5,ZW,QW=i(()=>{ee();sl();SC();b();O5=t((o=Ii,e=P,r=()=>Math.random())=>[new rf(new p(n=>o.unregister(n))),new rf(new p((n,a)=>{let s=n.actions(a),m=s[Math.floor(s.length*r())];n.action(m)})),new rf(new p((n,a)=>{e.emit("goody-hut:discovered",n,a)}))],"getRules"),ZW=O5});var EO,Zf,_P=i(()=>{M();EO=class extends x{};t(EO,"Distribution");Zf=EO});var v5,XW,eY=i(()=>{sl();U();_P();v5=t((o=Ii,e=()=>Math.random())=>[new Zf(new l(r=>r.isLand())),new Zf(new l(r=>r.getSurroundingArea(3).every(n=>o.getByTile(n)===null))),new Zf(new l(()=>e()<.05))],"getRules"),XW=v5});var b5,tY,rY=i(()=>{sl();zn();A();b();HP();b5=t((o=Ii,e=()=>Math.random(),r=c)=>[new DO(new p((n,a)=>{let s=[Cr,Tr],m=s[Math.floor(s.length*e())];return new m(null,a.player(),a.tile(),r)}))],"getRules"),tY=b5});var C5,oY,iY=i(()=>{sl();U();b();dt();C5=t((o=Ii)=>[new j(new l(e=>o.getByTile(e.tile())!==null),new p(e=>{o.getByTile(e.tile()).process(e)}))],"getRules"),oY=C5});var kO,pl,SO=i(()=>{M();kO=class extends x{};t(kO,"Built");pl=kO});var T5,nY,aY=i(()=>{sl();A();SO();b();FC();_P();T5=t((o=Ii,e=c)=>[new pl(new p(r=>{let n=e.get(Zf);r.forEach(a=>{n.every(s=>s.validate(a))&&o.register(new rx(a))})}))],"getRules"),nY=T5});var P5={};var sY=i(()=>{VW();$W();QW();eY();rY();A();iY();aY();c.register(...qW(),...JW(),...ZW(),...XW(),...tY(),...oY(),...nY())});var lY=I(mY=>{"use strict";Object.defineProperty(mY,"__esModule",{value:!0});sY()});var I5={};var pY=i(()=>{Hs();ax();of.register(It,pt,Vt,ft,Rt)});var w5,fY,uY=i(()=>{ns();Hs();U();b();aC();Sa();w5=t((o=Ht)=>[new yt(new l(e=>!o.getByPlayer(e).is(Ro)),new p(e=>[new ts(e,o.getByPlayer(e))]))],"getRules"),fY=w5});var A5,cY,yY=i(()=>{ax();ns();A();Pl();Hs();b();xl();zC();A5=t((o=of,e=Ht,r=c)=>[new Ji(new Cs,new p(n=>{let a=new px(n,o,r);a.set(new Vt),e.register(a)}))],"getRules"),cY=A5});var B5,dY,gY=i(()=>{hR();Hs();He();YC();U();B5=t((o=H)=>[new _u(new l(e=>e===Vt)),...[[It,Tt],[pt,Yo],[ft,kr],[Rt,ho]].map(([e,r])=>new _u(new l(n=>n===e),new l((n,a)=>o.getByPlayer(a).completed(r))))],"getRules"),dY=B5});var G5,hY,xY=i(()=>{ee();Ri();LC();U();b();G5=t((o=P,e=me)=>[new Ku(new p((r,n)=>{o.emit("player:government:changed",r,n)})),new Ku(new l(r=>{try{return e.getByPlayer(r),!0}catch(n){if(n instanceof TypeError&&n.message.match(/Wrong number of player worlds exist/))return!1;throw n}}),new p(r=>{e.getByPlayer(r).entries().forEach(a=>a.tile().clearYieldCache(r))}))],"getRules"),hY=G5});var M5={};var RY=i(()=>{A();uY();yY();gY();xY();c.register(...fY(),...cY(),...dY(),...hY())});var vY=I(OY=>{"use strict";Object.defineProperty(OY,"__esModule",{value:!0});pY();RY()});var FO,bY,CY=i(()=>{M();FO=class extends x{};t(FO,"TurnEnd");bY=FO});var U5,TY,PY=i(()=>{Kp();ee();A();CY();U5=t((o=os,e=c,r=P)=>[["player:turn-end",n=>{o.unregister(n),e.process(bY,n);let[a]=o.entries();if(!a){r.emit("turn:end");return}r.emit("player:turn-start",a)}]],"getEvents"),TY=U5});var D5,IY,wY=i(()=>{rs();ee();A();Af();D5=t((o=Lt,e=P,r=c)=>[["player:turn-start",n=>{try{r.process(ia,n)}catch(s){console.error(s)}o.getByPlayer(n).takeTurn().catch(s=>console.error(s)).finally(()=>{e.emit("player:turn-end",n)})}]],"getEvents"),IY=D5});var E5,AY,BY=i(()=>{Kp();ee();Zm();E5=t((o=Xi,e=os,r=P)=>[["turn:start",()=>{e.register(...o.entries());let[n]=e.entries();r.emit("player:turn-start",n)}]],"getEvents"),AY=E5});var k5={};var GY=i(()=>{ee();PY();wY();BY();[...TY(),...IY(),...AY()].forEach(([o,e])=>P.on(o,e))});var NO,Vs,Wc=i(()=>{M();NO=class extends x{};t(NO,"Defeated");Vs=NO});var S5,MY,UY=i(()=>{mt();A();Ol();U();Wc();b();S5=t((o=Z,e=c)=>[new eo(new l((r,n,a)=>o.getByPlayer(a).filter(s=>s!==r).length===0),new p((r,n,a)=>{e.process(Vs,a,n)}))],"getRules"),MY=S5});var F5,DY,EY=i(()=>{mt();A();U();Wc();vl();b();F5=t((o=Z,e=c)=>[new Uo(new l((r,n)=>o.getByPlayer(r.player()).filter(a=>a!==r).length===0),new p((r,n)=>e.process(Vs,r.player(),n)))],"getRules"),DY=F5});var KP,N5,kY,SY=i(()=>{Sa();U();b();Jy();km();KP=new yt(new pi(9001),new l(o=>{KP.disable();let e=o.mandatoryActions();return KP.enable(),e.length===0}),new p(o=>[new Vy(o,null)])),N5=t(()=>[KP],"getRules"),kY=N5});var W5,FY,NY=i(()=>{ee();Pl();b();W5=t((o=P)=>[new Ji(new p(e=>{o.emit("player:added",e)}))],"getRules"),FY=W5});var Y5,WY,YY=i(()=>{Kp();ee();Zm();U();Wc();b();Y5=t((o=os,e=Xi,r=P)=>[new Vs(new l(n=>o.includes(n)),new p(n=>o.unregister(n))),new Vs(new l(n=>e.includes(n)),new p(n=>e.unregister(n))),new Vs(new p((n,a)=>{r.emit("player:defeated",n,a)}))],"getRules"),WY=Y5});var WO,YO,qP=i(()=>{M();WO=class extends x{};t(WO,"Spawn");YO=WO});var L5,LY,zY=i(()=>{A();b();bR();qP();L5=t((o=c)=>[new YO(new p((e,r)=>{new oD(null,e,r,o)}))],"getRules"),LY=L5});var z5,jY,HY=i(()=>{mt();A();Ve();b();Ms();xl();Mf();mm();Gs();Af();Un();z5=t((o=c,e=Z,r=z)=>[new ia(new Cs,new p(n=>{e.getByPlayer(n).forEach(a=>{let s=a.yields();Fl(s,Ua,sm,om).reduce((m,f,u)=>(m[u].set(f,"Consolidated"),m),[new Ua(0,"Consolidated"),new sm(0,"Consolidated"),new om(0,"Consolidated")]).forEach(m=>o.process(ls,m,a,s))})})),new ia(new p(n=>r.getByPlayer(n).forEach(a=>{if(a.destroyed())return;a.moves().set(a.movement());let s=a.busy();if(!s){a.setActive(),a.setWaiting(!1);return}!s.validate()||s.process()})))],"getRules"),jY=z5});var j5,_Y,KY=i(()=>{ee();b();iC();j5=t((o=P)=>[new Eg(new p((e,r)=>{o.emit("player:visibility-changed",e,r)}))],"getRules"),_Y=j5});var H5,qY,VY=i(()=>{Zm();Ri();Dd();b();H5=t((o=Xi,e=me)=>[new cm(new p(r=>{r.clearYieldCache(null),o.forEach(n=>{e.getByPlayer(n).getByTile(r)!==null&&r.clearYieldCache(n)})}))],"getRules"),qY=H5});var _5,JY,$Y=i(()=>{mt();A();U();Wc();pu();b();_5=t((o=Z,e=c)=>[new Fa(new l((r,n)=>o.getByPlayer(r.player()).length===0),new p((r,n)=>e.process(Vs,r.player(),n)))],"getRules"),JY=_5});var K5,ZY,QY=i(()=>{Ri();b();Ab();K5=t((o=me)=>[new Id(new p((e,r)=>{e.clearYieldCache(r);let n=o.getByPlayer(r);n.register(e),n.getByTile(e).update()}))],"getRules"),ZY=K5});var LO,zO,VP=i(()=>{M();LO=class extends x{};t(LO,"PickStartTile");zO=LO});var q5,XY,eL=i(()=>{Br();Wt();ZT();rs();ee();hP();Zm();Ri();A();JR();SO();ap();b();Ms();Bl();VP();Up();Sg();mm();zu();qP();Gs();q5=t((o=KR,e=Lt,r=P,n=Xi,a=me,s=c,m=rO,f=Te,u=se,y=Ef)=>[new pl(new p(R=>n.entries().forEach(B=>a.register(new Ml(B,R))))),new pl(new p(R=>{let B=new Map,N=new Map,W=t((h,G=null)=>(B.has(h)||B.set(h,h.score(G,[[Ua,8],[sm,3],[om,1]])),B.get(h)),"tileScore"),_=t((h,G=null)=>(N.has(h)||N.set(h,h.getSurroundingArea().entries().reduce((L,Qe)=>L+W(Qe,G),0)),N.get(h)),"areaScore");r.emit("world:generate-start-tiles");let d=[],g=R.entries().filter(h=>[Jm,Mp,Fh].some(G=>h.terrain()instanceof G)).map(h=>({tile:h,score:_(h)})).sort(({score:h},{score:G})=>G-h).map(({tile:h})=>h);r.emit("world:start-tiles",g),e.entries().reduce((h,G)=>h.then(async()=>{let L=G.player(),Qe=await G.chooseFromList(new Um(o.entries(),"choose-civilization")),Ft=new Qe(f,u);L.setCivilization(Ft);let be=await G.chooseFromList(new Um(m.getByCivilization(Ft.sourceClass()),"choose-leader")),Ce=new be(y);Ft.setLeader(Ce),o.unregister(Ft.sourceClass()),m.unregister(Ce.sourceClass());let[Be]=s.process(zO,R,L,d);if(!Be)throw new TypeError("Not enough `startingSquare`s.");d.push(Be),s.process(YO,L,Be)}),Promise.resolve()).then(()=>r.emit("game:start"))})),new pl(new p(R=>{r.emit("world:built",R)}))],"getRules"),XY=q5});var V5={};var tL=i(()=>{UY();EY();A();SY();NY();YY();zY();HY();KY();VY();$Y();QY();eL();c.register(...MY(),...DY(),...kY(),...FY(),...WY(),...LY(),...jY(),..._Y(),...qY(),...JY(),...ZY(),...XY())});var oL=I(rL=>{"use strict";Object.defineProperty(rL,"__esModule",{value:!0});GY();tL()});var J5={};var iL=i(()=>{pn();D();v.register(rn,So,ao,on,_t,so,Fo,No,mo,Ai,Sn,yr,Bi,Tt,lo,Fn,Dr,Wo,po,Yo,dr,xt,Gi,Mi,nn,an,Nn,Ui,tr,Wn,rr,gr,Di,Yn,hr,Er,Lo,Kt,xr,fo,uo,Ei,kr,qt,co,Sr,zo,Fr,yo,ki,Si,Nr,Fi,go,Pt,Ni,sn,jo,mn,ln,Ho,ho,Ln,_o,Wi,or,xo)});var nL=i(()=>{nb()});var $5,aL,sL=i(()=>{He();Sa();nL();U();b();$5=t((o=H)=>[new yt(new l(e=>o.getByPlayer(e).researching()===null),new l(e=>o.getByPlayer(e).available().length>0),new p(e=>[new tm(e,o.getByPlayer(e))]))],"getRules"),aL=$5});var Z5,mL,lL=i(()=>{D();He();A();Pl();b();mh();Z5=t((o=v,e=H,r=c,n=()=>Math.random())=>[new Ji(new p(a=>e.register(new Vp(a,o,r)))),new Ji(new p(a=>{let s=e.getByPlayer(a);for(let m=0,f=Math.min(s.available().length,Math.floor(4*n()));m<f;m++){let u=s.available();s.addAdvance(u[Math.floor(n()*u.length)])}}))],"getRules"),mL=Z5});var Q5,pL,fL=i(()=>{rs();He();Ol();ap();U();b();Q5=t((o=H,e=()=>Math.random(),r=Lt)=>[new eo(new l((n,a,s)=>o.getByPlayer(s).complete().some(m=>!o.getByPlayer(a).completed(m.constructor))),new p(async(n,a,s)=>{let m=o.getByPlayer(a),f=o.getByPlayer(s).complete().map(R=>R.sourceClass()).filter(R=>!m.completed(R)),u=r.getByPlayer(a),y=await u.chooseFromList(new Um(f,"capture-city.steal-advance",n));m.addAdvance(y)}))],"getRules"),pL=Q5});var X5,uL,cL=i(()=>{ee();eh();b();X5=t((o=P)=>[new Qm(new p((e,r)=>{o.emit("player:research-complete",e,r)}))],"getRules"),uL=X5});var e3,yL,dL=i(()=>{pC();b();e3=t(()=>[new rh(new p((o,e)=>(e.complete().length+1)*(6+2*0)))],"getRules"),yL=e3});var t3,gL,hL=i(()=>{He();A();Gf();U();b();Mf();VT();t3=t((o=H,e=c)=>[new ls(new l(r=>r instanceof ct),new l((r,n,a)=>!e.process(qs,n,a).some(s=>s)),new p((r,n)=>o.getByPlayer(n.player()).add(r)))],"getRules"),gL=t3});var r3,xL,RL=i(()=>{pn();U();b();fC();r3=t(()=>[...[[rn,an,dr],[ao,fo,qt],[on,_o,yo],[_t,Bi,ln],[so,ho,Wi],[Fo,Dr,Di],[Ai,or,uo],[Sn,nn,Wn],[yr,So],[Bi,go,Mi],[Tt,Fr,rr],[lo,xt,fo],[Fn,Mi,ho],[Dr,po,Kt],[Wo,so,rr],[po,No],[Yo,Fr,hr],[dr,Ei,Er],[xt,Gi,dr],[Gi,Dr,Ln],[Mi,tr,Ai],[nn,Kt,kr],[an,Bi,yo],[Nn,zo,Ho],[Ui,Wo,uo],[tr,gr,Di],[rr,Nr,so],[gr,Gi,hr],[Di,No],[Yn,xr,Tt],[hr,yr,xo],[Er,co,yo],[Lo,So],[xr,Wo,_t],[fo,So,Kt],[uo,Fr,Wi],[Ei,tr,or],[kr,yr,qt],[qt,mo],[co,ao,Lo],[Sr,xr,on],[zo,Sr,xt],[Fr,qt,hr],[yo,co,fo],[ki,go,jo],[Nr,Fo,mn],[Fi,Yo,xr],[go,Wo,Ai],[Pt,Fr,xo],[Ni,lo,ki],[sn,xt,rn],[jo,lo,sn],[mn,gr,yo],[ln,Ei,rr],[Ho,xr,ki],[ho,yr,hr],[_o,ao,or],[Wi,yr,po],[or,Fr,fo],[xo,So]].map(([o,...e])=>new ih(new l(r=>r===o),new p((r,n)=>e.every(a=>n.some(s=>s instanceof a)))))],"getRules"),xL=r3});var o3,OL,vL=i(()=>{ee();b();ah();o3=t((o=P)=>[new qp(new p((e,r)=>{o.emit("player:research",e,r)}))],"getRules"),OL=o3});var i3={};var bL=i(()=>{sL();lL();fL();cL();dL();A();hL();RL();vL();c.register(...aL(),...mL(),...pL(),...uL(),...yL(),...gL(),...xL(),...OL())});var TL=I(CL=>{"use strict";Object.defineProperty(CL,"__esModule",{value:!0});iL();bL()});var Pm=i(()=>{wP();AP();MP();UP();DP();EP()});var n3={};var PL=i(()=>{Pm();El();Gn.register(Pr,Ir,qr,Mo,pr,Zt)});var jO,HO,JP=i(()=>{M();jO=class extends x{};t(jO,"Built");HO=jO});var _O,KO,$P=i(()=>{M();_O=class extends x{};t(_O,"ChanceOfSuccess");KO=_O});var qO,VO,ZP=i(()=>{M();qO=class extends x{};t(qO,"FlightTime");VO=qO});var JO,$O,QP=i(()=>{M();JO=class extends x{};t(JO,"Landed");$O=JO});var ZO,IL,wL=i(()=>{M();ZO=class extends x{};t(ZO,"Launch");IL=ZO});var QO,Yc,XP=i(()=>{M();QO=class extends x{};t(QO,"Lost");Yc=QO});var XO,Qf,ev=i(()=>{J();A();Mt();Fu();JP();$P();iO();ZP();QP();wL();XP();XO=class extends k{#e=1/0;#t=!1;#r;#o;#i;#n;#a=null;#m;#s;constructor(e,r,n=c,a=te,s=Ns,m=()=>Math.random()){super(),this.#o=e,this.#r=r,this.#n=n,this.#m=a,this.#s=s,this.#i=m,this.addKey("activeParts","chanceOfSuccess","flightTime","inactiveParts","launched","layout","player","successful","yields")}activeParts(){return this.#r.activeSlots().filter(e=>!e.empty()).map(e=>e.part())}add(e){let[r]=this.#n.process(ep,e,this.#r);!r||(r.fill(e),this.#n.process(HO,e,this))}chanceOfSuccess(){return Math.max(...this.#n.process(KO,this),0)}check(){if(!(this.#a!==null||this.#t===!1||this.#m.value()<this.#e)){if(this.#a=this.chanceOfSuccess()>this.#i(),this.#a){this.#n.process($O,this);return}this.#n.process(Yc,this)}}flightTime(){return Math.min(...this.#n.process(VO,this),1/0)}inactiveParts(){return this.#r.inactiveSlots().filter(e=>!e.empty()).map(e=>e.part())}launch(){this.#n.process(IL,this),this.#e=this.#t=this.#m.value();let e=this.flightTime(),r=this.#s.value()+e;for(;this.#s.value(this.#e)<r;)this.#e++}launched(){return this.#t}layout(){return this.#r}player(){return this.#o}successful(){return this.#a}yields(){return this.activeParts().flatMap(e=>e.yields())}};t(XO,"Spaceship");Qf=XO});var tv,Oa,ip=i(()=>{he();ev();tv=class extends F{constructor(){super(Qf)}getActiveByPlayer(e){let[r]=this.getBy("player",e).filter(n=>n.launched()===!1||n.successful()===null);return r||null}};t(tv,"SpaceshipRegistry");Oa=new tv});var rv,St,ds=i(()=>{he();Le();rv=class extends F{constructor(){super(Ae)}getByCity(e){return this.getBy("city",e)}getByPlayer(e){return this.filter(r=>r.city().player()===e)}};t(rv,"WonderRegistry");St=new rv});var gs,ov,iv=i(()=>{Le();gs=class extends De{};t(gs,"ApolloProgram");ov=gs});var a3,AL,BL=i(()=>{Jp();Pm();He();ip();ds();iv();U();b();es();vc();af();Cc();a3=t((o=St,e=H,r=Oa)=>[new Dt(new l((n,a)=>Object.prototype.isPrototypeOf.call(Ct,a)),new p(()=>new l(()=>o.some(n=>n instanceof ov)))),new Dt(new l((n,a)=>Object.prototype.isPrototypeOf.call(Ct,a)),new p(n=>new l(()=>{let a=r.getActiveByPlayer(n.player());return a===null?!1:a.launched()===!1}))),...[[Zt,sR],[Pr,Oc],[pr,Oc],[Ir,bm],[qr,bm],[Mo,bm]].map(([n,a])=>new Dt(new l((s,m)=>m===n),new p(s=>new l(()=>e.getByPlayer(s.player()).completed(a)))))],"getRules"),AL=a3});var s3,GL,ML=i(()=>{$p();Pm();s3=t(()=>[...[[Pr,160],[Ir,320],[qr,320],[Mo,320],[pr,160],[Zt,80]].flatMap(([o,e])=>Xm(o,e))],"getRules"),GL=s3});var m3,UL,DL=i(()=>{Kp();fO();A();ip();Mt();Fu();iv();Zp();U();b();es();ev();m3=t((o=os,e=Oa,r=Lf,n=c,a=te,s=Ns,m=()=>Math.random())=>[new en(new l((f,u)=>u instanceof ov),new p(()=>{let[f]=r.entries(),u=new f(n);o.entries().forEach(y=>e.register(new Qf(y,u,n,a,s,m)))})),new en(new l((f,u)=>u instanceof Ct),new l((f,u)=>e.getActiveByPlayer(u.city().player())!==null),new p((f,u)=>{let y=u;e.getActiveByPlayer(y.city().player()).add(y)}))],"getRules"),UL=m3});var nv,fl,eI=i(()=>{J();nv=class extends ae{#e;#t;constructor(e,r){super(),this.addKey("resource","value"),this.#e=e,this.#t=r}resource(){return this.#e}value(){return this.#t}};t(nv,"SpendCost");fl=nv});var l3,EL,kL=i(()=>{U();b();Bs();es();Su();eI();l3=t(()=>[new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(Ct,o.building().item())),new l(o=>o.progress().value()===0),new p(o=>new fl(ci,o.remaining()*8))),new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(Ct,o.building().item())),new l(o=>o.progress().value()>0),new p(o=>new fl(ci,o.remaining()*4)))],"getRules"),EL=l3});var p3,SL,FL=i(()=>{ip();Sa();U();b();Cb();p3=t((o=Oa)=>[new yt(new l(e=>o.getActiveByPlayer(e)!==null),new p(e=>[new cw(e,o.getActiveByPlayer(e))]))],"getRules"),SL=p3});var tI,f3,NL,WL=i(()=>{Pm();BP();U();b();tI=new tp(new l(o=>o.part()instanceof pr),new p((o,e)=>{tI.disable();let r=e.activeSlots();return tI.enable(),e.getAdjacent(o).some(n=>n.part()instanceof Pr&&r.includes(n))})),f3=t(()=>[new tp(new p(o=>o.part()!==null)),new tp(new l(o=>[Pr,Ir,qr,Mo].some(e=>o.part()instanceof e)),new p((o,e)=>e.getAdjacent(o).some(r=>r.part()instanceof Zt))),tI],"getRules"),NL=f3});var u3,YL,LL=i(()=>{ee();JP();b();u3=t((o=P)=>[new HO(new p(e=>{o.emit("player:spaceship:part-built",e.city().player())}))],"getRules"),YL=u3});var hs,zL=i(()=>{We();hs=class extends Y{};t(hs,"Energy")});var Js,jL=i(()=>{We();Js=class extends Y{};t(Js,"LifeSupport")});var dn,HL=i(()=>{We();dn=class extends Y{};t(dn,"Mass")});var ul,_L=i(()=>{We();ul=class extends Y{};t(ul,"Population")});var av=i(()=>{zL();jL();HL();_L()});var c3,KL,qL=i(()=>{av();Pm();$P();b();c3=t(()=>[new KO(new p(o=>{let[e,r,n,a,s]=o.yields().reduce(([B,N,W,_,d],g)=>(g instanceof hs&&g.value()>0&&(B+=g.value()),g instanceof hs&&g.value()<0&&(N+=Math.abs(g.value())),g instanceof Js&&g.value()>0&&(W+=g.value()),g instanceof Js&&g.value()<0&&(_+=Math.abs(g.value())),g instanceof ul&&(d+=g.value()),[B,N,W,_,d]),[0,0,0,0,0]),[m,f]=o.activeParts().reduce(([B,N],W)=>(W instanceof Pr&&B++,W instanceof pr&&N++,[B,N]),[0,0]);if([e,n,s,m,f].some(B=>B===0))return 0;let u=Math.min(m/f,1),y=Math.min(a/n,1),R=Math.min(r/e,1);return u*y*R}))],"getRules"),KL=c3});var y3,VL,JL=i(()=>{iO();U();b();Pm();y3=t(()=>[new ep(new l(o=>o instanceof Zt),new l((o,e)=>e.slots().filter(r=>r.accepts(o)&&r.empty()).length>0),new p((o,e)=>{let r=e.slots().filter(a=>a.accepts(o)&&a.empty()),[n]=r.sort((a,s)=>e.getAdjacent(s).filter(m=>m.part()instanceof Zt).length-e.getAdjacent(a).filter(m=>m.part()instanceof Zt).length||e.getAdjacent(s).filter(m=>!m.empty()).length-e.getAdjacent(a).filter(m=>!m.empty()).length||Math.abs(a.x()-8)-Math.abs(s.x()-8)||Math.abs(a.y()-6)-Math.abs(s.y()-6));return n})),new ep(new l(o=>!(o instanceof Zt)),new l((o,e)=>e.slots().filter(r=>r.accepts(o)&&r.empty()).length>0),new p((o,e)=>{let r=e.slots().filter(a=>a.accepts(o)&&a.empty()),[n]=r.sort((a,s)=>e.getAdjacent(s).filter(m=>!m.empty()).length-e.getAdjacent(a).filter(m=>!m.empty()).length||Math.abs(a.x()-8)-Math.abs(s.x()-8)||Math.abs(a.y()-6)-Math.abs(s.y()-6));return n}))],"getRules"),VL=y3});var d3,$L,ZL=i(()=>{b();ZP();av();Pm();Un();d3=t(()=>[new VO(new p(o=>{let e=tt(o.yields(),dn),r=o.activeParts().reduce((n,a)=>n+(a instanceof pr?1:0),0);return Math.trunc(e/20/(1+r*10)*10)/10}))],"getRules"),$L=d3});var g3,QL,XL=i(()=>{ee();b();QP();g3=t((o=P)=>[new $O(new p(e=>{o.emit("player:spaceship:landed",e.player())}))],"getRules"),QL=g3});var h3,ez,tz=i(()=>{ee();fO();A();ip();Mt();Fu();b();XP();ev();h3=t((o=Oa,e=Lf,r=c,n=te,a=Ns,s=P,m=()=>Math.random())=>[new Yc(new p(f=>{s.emit("player:spaceship:lost",f.player())})),new Yc(new p(f=>{let[u]=e.entries(),y=new u(r);o.register(new Qf(f.player(),y,r,n,a,m))}))],"getRules"),ez=h3});var x3,rz,oz=i(()=>{av();Pm();U();b();rC();x3=t(()=>[...[[Pr,dn,400],[Ir,hs,-50],[Ir,Js,-100],[Ir,dn,1600],[Ir,ul,1e4],[qr,hs,-50],[qr,Js,100],[qr,dn,1600],[Mo,hs,100],[Mo,dn,400],[pr,dn,400],[Zt,dn,100]].map(([o,e,r])=>new Ag(new l(n=>n instanceof o),new p(n=>new e(r,n.id()))))],"getRules"),rz=x3});var sv,mv,rI=i(()=>{M();sv=class extends x{};t(sv,"Start");mv=sv});var R3,iz,nz=i(()=>{ip();b();rI();R3=t((o=Oa)=>[new mv(new p(()=>{o.entries().forEach(e=>e.check())}))],"getRules"),iz=R3});var O3={};var az=i(()=>{BL();ML();DL();kL();A();FL();WL();LL();qL();JL();ZL();XL();tz();oz();nz();c.register(...AL(),...GL(),...UL(),...EL(),...SL(),...NL(),...YL(),...KL(),...VL(),...$L(),...QL(),...ez(),...rz(),...iz())});var mz=I(sz=>{"use strict";Object.defineProperty(sz,"__esModule",{value:!0});PL();az()});var lv,cl,Lc=i(()=>{We();lv=class extends Y{};t(lv,"TradeRate");cl=lv});var Im,lz=i(()=>{mu();Lc();Im=class extends cl{};t(Im,"Luxuries"),Im.tradeYield=qI});var wm,pz=i(()=>{Op();Lc();wm=class extends cl{};t(wm,"Research"),wm.tradeYield=ct});var Am,fz=i(()=>{Bs();Lc();Am=class extends cl{};t(Am,"Tax"),Am.tradeYield=ci});var oI=i(()=>{lz();pz();fz()});var pv,yl,zc=i(()=>{Pn();Lc();pv=class extends st{constructor(){super(cl)}};t(pv,"AvailableTradeRateRegistry");yl=new pv});var v3={};var uz=i(()=>{oI();zc();yl.register(Im,wm,Am)});var cz=i(()=>{td();Gs()});var fv,uv,iI=i(()=>{J();fv=class extends k{#e;#t=[];constructor(e,...r){super(),this.#e=e,this.#t=r,this.addKey("all")}all(){return[...this.#t]}balance(e){if(this.total()===100)return;let r=100-e.value(),n=this.#t.filter(s=>s!==e),a=n.reduce((s,m)=>s+m.value(),0);n.forEach(s=>s.set(s.value()/a*r)),this.total()<100&&n[Math.floor(n.length*Math.random())].add(100-this.total()),this.total()>100&&n[Math.floor(n.length*Math.random())].subtract(100-this.total())}get(e){let[r]=this.#t.filter(n=>n instanceof e);return r}player(){return this.#e}set(e,r){let n=this.get(e);n.set(r),this.balance(n)}setAll(e){if(e.reduce((r,[,n])=>r+n,0)!==100)throw new TypeError("Invalid rates provided, must sum to 100.");e.forEach(([r,n])=>this.get(r).set(n))}total(){return this.#t.reduce((e,r)=>e+r.value(),0)}};t(fv,"PlayerTradeRates");uv=fv});var cv,dl,jc=i(()=>{he();iI();cv=class extends F{constructor(){super(uv)}getByPlayer(e){let r=this.getBy("player",e);if(r.length!==1)throw new TypeError("Wrong number of PlayerTradeRates for player");return r[0]}};t(cv,"PlayerTradeRatesRegistry");dl=new cv});var b3,yz,dz=i(()=>{zc();cz();jc();b();gp();Un();b3=t((o=yl,e=dl)=>[new dp(new p((r,n)=>{let a=e.getByPlayer(r.player()),s=Math.max(0,tt(n,oe)),m=s;return o.entries().map(f=>{let u=f.tradeYield,y=Math.min(Math.ceil(s*(a.get(f).value()/100)),m);return m-=y,new u(y,f.name)})}))],"getRules"),yz=b3});var C3,gz,hz=i(()=>{jc();Sa();rb();b();C3=t((o=dl)=>[new yt(new p(e=>[new Em(e,o.getByPlayer(e))]))],"getRules"),gz=C3});var T3,xz,Rz=i(()=>{zc();jc();oI();Pl();b();iI();T3=t((o=yl,e=dl)=>[new Ji(new p(r=>{let n=[new Am(50),new wm(50),new Im(0)],a=o.entries(),s=new uv(r,...a.map(m=>{let[f]=n.filter(u=>u instanceof m);return new m(f||0)}));e.register(s)}))],"getRules"),xz=T3});var yv,P3,Oz,vz=i(()=>{zc();mt();A();b();xl();Mf();Af();Un();yv=[],P3=t((o=c,e=Z,r=yl)=>[new ia(new Cs,new p(n=>{yv.length===0&&r.entries().forEach(a=>yv.push(a.tradeYield)),e.getByPlayer(n).forEach(a=>{let s=a.yields();Fl(s,...yv).reduce((m,f,u)=>(m[u].set(f,"Consolidated"),m),yv.map(m=>new m)).forEach(m=>o.process(ls,m,a,s))})}))],"getRules"),Oz=P3});var I3={};var bz=i(()=>{A();dz();hz();Rz();vz();c.register(...yz(),...gz(),...xz(),...Oz())});var Tz=I(Cz=>{"use strict";Object.defineProperty(Cz,"__esModule",{value:!0});uz();bz()});var dv=i(()=>{ed();Bs()});var w3,Pz,Iz=i(()=>{qe();U();b();dv();Su();eI();Es();w3=t(()=>[new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(Fe,o.building().item())),new l(o=>o.progress().value()===0),new p(o=>{let e=o.remaining()/10;return new fl(je,Math.floor((e+4)*10*e))})),new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(Fe,o.building().item())),new l(o=>o.progress().value()>0),new p(o=>{let e=o.remaining()/10;return new fl(je,Math.floor(5*e**2+20*e))})),new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(K,o.building().item())),new l(o=>o.progress().value()===0),new p(o=>new fl(je,o.remaining()*4))),new Mn(new l(o=>o.building()!==null&&Object.isPrototypeOf.call(K,o.building().item())),new l(o=>o.progress().value()>0),new p(o=>new fl(je,o.remaining()*2)))],"getRules"),Pz=w3});var A3,wz,Az=i(()=>{is();mt();Sa();hb();b();A3=t((o=Z,e=zt)=>[new yt(new p(r=>o.getByPlayer(r).map(n=>new Wm(r,e.getByCity(n)))))],"getRules"),wz=A3});var B3,Bz,Gz=i(()=>{is();Sl();A();Pl();b();dv();yC();B3=t((o=tn,e=zt,r=c)=>[new Ji(new p(n=>o.register(new bh(n,je,e,r))))],"getRules"),Bz=B3});var G3,Mz,Uz=i(()=>{dv();Bo();ee();Sl();A();cC();U();b();Mf();G3=t((o=tn,e=c,r=ke,n=P)=>[new ls(new l(a=>a instanceof je),new p((a,s,m)=>{let f=o.getByPlayerAndType(s.player(),je);m.forEach(u=>{if(u instanceof je&&(f.add(u),u instanceof de&&f.value()<0)){let y=u.cityImprovement(),R=new yh(y.constructor,s,e);r.unregister(y),f.add(R.cost().value()),n.emit("city:unsupported-improvement",s,y);return}})}))],"getRules"),Mz=G3});var gv,Dz,Ez=i(()=>{M();gv=class extends x{};t(gv,"Updated");Dz=gv});var M3,kz,Sz=i(()=>{ee();U();b();Ez();M3=t((o=P)=>[new Dz(new l(e=>e.value()<0),new p((e,r)=>{o.emit("player:treasury-exhausted",e.player(),e,r)}))],"getRules"),kz=M3});var U3={};var Fz=i(()=>{A();Iz();Az();Gz();Uz();Sz();c.register(...Pz(),...wz(),...Bz(),...Mz(),...kz())});var Wz=I(Nz=>{"use strict";Object.defineProperty(Nz,"__esModule",{value:!0});Fz()});var D3={};var Yz=i(()=>{zn();El();Gn.register($o,Zo,jr,Oo,Qo,vo,bo,Co,Xo,ei,sr,Hr,Cr,To,Po,ti,Io,mr,ri,_r,Ke,wo,Kr,Tr,oi,Ao,lr,ii)});var hv,Xf,nI=i(()=>{M();hv=class extends x{};t(hv,"Available");Xf=hv});var Lz=i(()=>{Sc();Sc()});var aI=i(()=>{WP()});var zz=i(()=>{aI();aI()});var sI=i(()=>{Lz();zz()});var xv,jz,Rv,k3,Hz,_z=i(()=>{Ib();Ls();Gl();Wt();mt();zn();En();vm();zs();Xr();Sp();A();ng();_a();xi();Wl();Mt();Ve();gm();fi();iy();nI();U();b();zR();vR();sI();xv=new l((o,e,r=o.tile())=>o instanceof _e),jz=new l((o,e,r=o.tile())=>o instanceof Ne),Rv=t((o,e)=>e.getByTile(o)!==null,"tileHasCity"),k3=t((o=se,e=Z,r=c,n=Je,a=oo,s=z,m=Yt,f=kn,u=te,y=Ur,R=Se,B=Fs,N=Np)=>{let W=[Ap,di,new l((d,g)=>s.getByTile(g).some(h=>h.player()!==d.player())),new ni(new bs(new l(d=>d instanceof ht),new ni(new l((d,g)=>!s.getByTile(g).every(h=>h instanceof ht)),new l((d,g)=>d instanceof sr))),new bs(xv,new ni(new l((d,g)=>Rv(g,e)),new l((d,g)=>s.getByTile(g).some(h=>h instanceof _e)))),new bs(jz,new ni(new l((d,g)=>!(d instanceof Kr)),new l((d,g)=>g.isWater()))))],_=[Ap,di,xv,new l((d,g)=>Rv(g,e)),new l((d,g)=>s.getByTile(g).length===0),new l((d,g)=>e.getByTile(g).player()!==d.player())];return[new vt(Ap,di,new ni(new bs(xv,new l((d,g,h=d.tile())=>h.isLand()),new l((d,g)=>g.isLand()),new l((d,g)=>s.getByTile(g).every(h=>h.player()===d.player()))),new bs(jz,new ni(new l((d,g,h=d.tile())=>h.isWater()),new l((d,g,h=d.tile())=>e.getByTile(h)?.player()===d.player())),new ni(new l((d,g)=>g.isWater()),new l((d,g)=>e.getByTile(g)?.player()===d.player()))),new l(d=>d instanceof ht)),new ni(new l((d,g)=>!(d instanceof _e)),new l((d,g,h=d.tile())=>!(h.getNeighbours().some(G=>s.getByTile(G).some(L=>L instanceof _e&&L.tile().terrain()instanceof Q&&L.player()!==d.player()))&&g.getNeighbours().some(G=>s.getByTile(G).some(L=>L instanceof _e&&L.tile().terrain()instanceof Q&&L.player()!==d.player())))),new l((d,g)=>s.getByTile(g).filter(h=>h.player()===d.player()).length>0),new l((d,g)=>{let h=e.getByTile(g);return h===null?!1:h.player()===d.player()})),new l((d,g)=>{let h=e.getByTile(g);return h===null?!0:h.player()===d.player()}),new l((d,g)=>!s.getByTile(g).some(h=>h.player()!==d.player())),new p((d,g,h=d.tile())=>new nt(h,g,d,r))),new vt(...W,new l((d,g)=>s.getByTile(g).every(h=>y.getByPlayers(d.player(),h.player()).filter(G=>G instanceof Li).every(G=>G.expired()))),new p((d,g,h=d.tile())=>new Zi(h,g,d,r,s))),new vt(...W,new l((d,g)=>s.getByTile(g).every(h=>y.getByPlayers(d.player(),h.player()).some(G=>G instanceof Li&&G.active()))),new p((d,g,h=d.tile())=>{let G=Array.from(new Set(s.getByTile(g).filter(L=>y.getByPlayers(d.player(),L.player()).some(Qe=>Qe instanceof Li&&Qe.active())).map(L=>L.player())));return G.length>1&&(console.warn("Multiple targets for declaring war:"),console.warn(G),console.warn("core-unit/Rules/Unit/action.ts")),new Xa(h,g,d,G[0],r,s)})),new vt(..._,new l((d,g)=>{let h=e.getByTile(g);return y.getByPlayers(d.player(),h.player()).filter(G=>G instanceof Li).every(G=>G.expired())}),new p((d,g,h=d.tile())=>{let G=e.getByTile(g);return new Ha(h,g,d,G,r)})),new vt(..._,new l((d,g)=>{let h=e.getByTile(g);return y.getByPlayers(d.player(),h.player()).filter(G=>G instanceof Li).some(G=>G.active())}),new p((d,g,h=d.tile())=>{let G=e.getByTile(g);return new An(h,g,d,G,G.player(),r)})),new vt(di,Ds,new l(d=>d instanceof V),new l((d,g)=>n.getByTile(g).filter(h=>[Ue,et,Xt,Ye].some(G=>h instanceof G)).length>0),new p((d,g,h=d.tile())=>new Za(h,g,d,r,n,u))),new vt(di,Ds,new l(d=>d instanceof V),new l((d,g,h=d.tile())=>h.isLand()),new p((d,g,h=d.tile())=>new $a(h,g,d,r,u,a))),new vt(di,Ds,new p((d,g,h=d.tile())=>new wn(h,g,d,r,u))),new vt(di,Ds,new p((d,g,h=d.tile())=>new ym(h,g,d,r))),new vt(Ds,new p((d,g,h=d.tile())=>new In(h,g,d,r))),new vt(di,Ds,new l(d=>d instanceof Ke),new l((d,g,h=d.tile())=>h.isLand()),new l((d,g,h=d.tile())=>!Rv(h,e)),new p((d,g,h=d.tile())=>new hm(h,g,d,o,r,R))),...[[Ue,Ya,new ni(new l((d,g,h=d.tile())=>h.terrain()instanceof le),new l((d,g,h=d.tile())=>h.getAdjacent().some(G=>G.terrain()instanceof le||G.terrain()instanceof Qr||n.getByTile(G).some(L=>L instanceof Ue)&&!Rv(G,e))))],[et,La],[Ye,ja],[Xt,za,new l((d,g)=>n.getByTile(g).some(h=>h instanceof Ye))]].map(([d,g,...h])=>new vt(new l(G=>G instanceof cr),di,new l((G,L,Qe=G.tile())=>r.get(Xf).some(Ft=>Ft.validate(Qe,d,G.player()))),Ds,...h,new p((G,L,Qe=G.tile())=>new g(Qe,L,G,r,u)))),...[[rt,qa],[$e,Ka],[fe,Qa],[ot,Va]].map(([d,g])=>new vt(di,Ds,new l(h=>h instanceof cr),new l((h,G,L=h.tile())=>L.terrain()instanceof d),new p((h,G,L=h.tile())=>new g(L,G,h,r,m,u)))),new vt(Ap,di,xv,new l((d,g)=>g.terrain()instanceof Qr),new l((d,g)=>s.getByTile(g).every(h=>h.player()===d.player())),new l((d,g)=>s.getByTile(g).filter(h=>h instanceof jt).some(h=>h.hasCapacity()&&h.canStow(d))),new p((d,g,h=d.tile())=>{let[G]=s.getByTile(g).filter(L=>L instanceof jt).filter(L=>L.hasCapacity()&&L.canStow(d));return new dm(h,g,d,G,r)})),new vt(Ap,new l(d=>{try{return f.getByUnit(d),!0}catch{return!1}}),new ni(new l((d,g)=>!(d instanceof _e)),new l((d,g)=>g.isLand())),new l((d,g,h=d.tile())=>f.getByUnit(d).transport().tile()===h),new p((d,g,h=d.tile())=>{let G=f.getByUnit(d).transport();return new Ja(h,g,d,G,r)})),new vt(di,Ds,new l(d=>d instanceof jt),new l(d=>d.hasCargo()),new l((d,g)=>g.getNeighbours().some(h=>h.isLand())),new p((d,g,h=d.tile())=>new Rm(h,g,d,r))),new vt(di,new l((d,g,h)=>g!==h&&!g.isNeighbourOf(h)),new l((d,g,h)=>{let[G]=B.entries();return G?new G(d,h,g).generate()instanceof ms:!1}),new p((d,g,h)=>new xm(h,g,d,r,B,N)))]},"getRules"),Hz=k3});var S3,Kz,qz=i(()=>{gm();wb();U();b();qu();S3=t((o=oo)=>[new Bp(new l(e=>e.moves().value()>0),new p(e=>e.setActive())),new Bp(new l(e=>e.busy()!==null),new p(e=>e.setBusy())),...[Eo].map(e=>new Bp(new l(r=>o.getByUnit(r).some(n=>n instanceof e)),new p(r=>o.unregister(...o.getByUnit(r).filter(n=>n instanceof e)))))],"getRules"),Kz=S3});var F3,Vz,Jz=i(()=>{Jp();zn();He();Ju();Zu();Qu();ec();rc();oc();U();b();ic();nc();ac();mc();lc();pc();uc();cc();yc();dc();hc();Ls();Rc();af();bc();Tc();Pc();Ic();wc();Ac();F3=t((o=H)=>[new Dt(new l((e,r)=>Object.prototype.isPrototypeOf.call(Ne,r)),new p(e=>new l(()=>e.tile().isCoast()))),...[[$o,bm],[Zo,lR],[jr,Vu],[Oo,gc],[vo,Vu],[Qo,yR],[bo,qx],[Co,uR],[Xo,tc],[ei,gR],[sr,Sx],[Hr,fc],[Cr,Wx],[To,mR],[Po,Xu],[ti,zx],[Io,nf],[mr,aR],[ri,Ll],[_r,xc],[wo,vx],[Kr,Kx],[Tr,Lx],[oi,$u],[Ao,sc],[lr,Hx]].map(([e,r])=>new Dt(new l((n,a)=>a===e),new p(n=>new l(()=>o.getByPlayer(n.player()).completed(r))))),...[[Oo,bm],[bo,gc],[Co,Xu],[Hr,sc],[Cr,Ll],[To,tc],[Po,$u],[Io,Ll],[_r,fc],[wo,nf],[Tr,Ll],[lr,xc],[ii,nf]].map(([e,r])=>new Dt(new l((n,a)=>a===e),new p(n=>new l(()=>!o.getByPlayer(n.player()).completed(r)))))],"getRules"),Vz=F3});var N3,$z,Zz=i(()=>{$p();zn();N3=t(()=>[...[[$o,80],[Zo,160],[jr,120],[Oo,40],[Qo,50],[vo,160],[bo,40],[Co,40],[Xo,80],[ei,30],[sr,60],[Hr,40],[Cr,20],[To,50],[Po,40],[ti,50],[Io,30],[mr,160],[ri,30],[_r,40],[Ke,40],[wo,20],[Kr,50],[Tr,20],[oi,80],[Ao,50],[lr,40],[ii,10]].flatMap(([o,e])=>Xm(o,e))],"getRules"),$z=N3});var W3,Qz,Xz=i(()=>{er();Zp();U();b();zn();W3=t((o=ie)=>[new en(new l((e,r)=>r instanceof Ke),new p(e=>o.getByCity(e.city()).shrink()))],"getRules"),Qz=W3});var Y3,ej,tj=i(()=>{ee();Ve();Cd();b();Y3=t((o=z,e=P)=>[new pm(new p(r=>o.register(r))),new pm(new p(r=>r.applyVisibility())),new pm(new p(r=>r.moves().set(r.movement()))),new pm(new p(r=>{e.emit("unit:created",r)}))],"getRules"),ej=Y3});var L3,rj,oj=i(()=>{mt();ee();A();xi();Ve();U();cu();pu();b();L3=t((o=Z,e=c,r=Je,n=z,a=P)=>[new Na(new p((s,m)=>{a.emit("unit:defeated",s,m),e.process(Fa,s,m.player())})),new Na(new l(s=>o.getByTile(s.tile())===null),new l(s=>n.getByTile(s.tile()).filter(m=>m!==s&&m.player()===s.player()).length>0),new p((s,m)=>n.getByTile(s.tile()).forEach(f=>{f!==s&&f.player()===s.player()&&e.process(Fa,s,m.player())})))],"getRules"),rj=L3});var z3,ij,nj=i(()=>{ee();gm();Ve();pu();b();z3=t((o=z,e=oo,r=P)=>[new Fa(new p((n,a)=>{r.emit("unit:destroyed",n,a)})),new Fa(new p(n=>{n.setActive(!1),n.setDestroyed()})),new Fa(new p(n=>e.getByUnit(n).forEach(a=>e.unregister(a))))],"getRules"),ij=z3});var Ov,eu,mI=i(()=>{M();Ov=class extends x{};t(Ov,"LostAtSea");eu=Ov});var j3,aj,sj=i(()=>{ee();b();mI();j3=t((o=P)=>[new eu(new p(e=>{o.emit("unit:lost-at-sea",e)})),new eu(new p(e=>e.destroy(null)))],"getRules"),aj=j3});var vv,H3,mj,lj=i(()=>{zn();mt();Gl();ee();vm();A();Wl();Mt();iy();U();b();xl();mI();dt();zR();Ls();sI();vv=new Map,H3=t((o=kn,e=c,r=()=>Math.random(),n=P,a=Z,s=te,m=Ur)=>[new j(new p((f,u)=>{n.emit("unit:moved",f,u)})),new j(new p(f=>f.applyVisibility())),new j(new l(f=>f.moves().value()<.3),new p(f=>{f.moves().set(0),f.setActive(!1)})),new j(new l(f=>f instanceof jt),new l((f,u)=>u instanceof nt),new l(f=>f.hasCargo()),new p((f,u)=>f.cargo().forEach(y=>y.action(u.forUnit(y))))),new j(new l((f,u)=>u instanceof Ja),new p(f=>{let u=o.getByUnit(f);u.transport().unload(f),o.unregister(u)})),new j(new l(f=>f instanceof lr),new l(f=>f.moves().value()===0),new l(f=>!f.tile().isCoast()),new l(()=>r()<=.5),new p(f=>{e.process(eu,f)})),...[[jr,1],[sr,0],[mr,0]].flatMap(([f,u])=>[new j(new Cs,new l(y=>y instanceof f),new l(y=>y.moves().value()===0),new l(y=>!vv.has(y)),new p(y=>{vv.set(y,s.value())})),new j(new l(y=>y instanceof f),new l(y=>y.moves().value()===0),new ni(new l(y=>a.getByTile(y.tile())!==null),new l(y=>!!o.getByUnit(y))),new p(y=>{vv.delete(y)})),new j(new l(y=>y instanceof f),new l(y=>y.moves().value()===0),new bs(new l(y=>a.getByTile(y.tile())===null),new l(y=>!o.getByUnit(y))),new l(y=>(vv.get(y)??s.value())+u<=s.value()),new p(y=>{e.process(eu,y)}))]),new j(new l((f,u)=>u instanceof Xa||u instanceof An),new p((f,u)=>{m.getByPlayers(f.player(),u.enemy()).filter(R=>R instanceof Li&&R.active()).forEach(R=>R.expire())}))],"getRules"),mj=H3});var pj,_3,fj,uj=i(()=>{En();Ls();Gl();zs();xi();Wl();U();b();gi();pj=[[Et,2],[Ie,1],[$e,2],[Re,1],[Ee,2],[rt,2],[ze,3],[lt,1],[fe,1],[le,1],[ot,2],[gt,1]],_3=t((o=Je,e=kn)=>[...pj.map(([r,n])=>new we(new l((a,s)=>s instanceof nt),new l(a=>a instanceof _e),new l((a,s)=>s.to().terrain()instanceof r),new p(()=>n))),new we(new l((r,n)=>n instanceof nt),new l(r=>r instanceof ht||r instanceof Ne),new p(()=>1)),new we(new l((r,n)=>n instanceof nt),new l(r=>r instanceof _e),new l((r,n)=>o.getByTile(n.from()).some(a=>a instanceof Ye)),new l((r,n)=>o.getByTile(n.to()).some(a=>a instanceof Ye)),new p(()=>1/3)),new we(new l((r,n)=>n instanceof nt),new l(r=>r instanceof _e),new l((r,n)=>o.getByTile(n.from()).some(a=>a instanceof Xt)),new l((r,n)=>o.getByTile(n.to()).some(a=>a instanceof Xt)),new p(()=>0)),new we(new l((r,n)=>n instanceof nt),new l(r=>r instanceof _e),new l(r=>{try{return e.getByUnit(r),!0}catch{return!1}}),new l(r=>e.getByUnit(r).transport()instanceof jt),new p(()=>0)),...[[Ya,2],[La,3],[ja,1],[za,2],[Ka,2],[qa,3],[Va,3],[$a,1],[Za,1],[Qa,3],[wn,0]].flatMap(([r,n])=>pj.map(([a,s])=>new we(new l((m,f)=>f instanceof r),new l(m=>m.tile().terrain()instanceof a),new p(()=>n*s))))],"getRules"),fj=_3});var K3,cj,yj=i(()=>{eb();Ve();Sa();U();b();K3=t((o=z)=>[new yt(new l(e=>o.getByPlayer(e).some(r=>r.active()&&r.moves().value())),new p(e=>o.getByPlayer(e).filter(r=>r.active()&&r.moves().value()>0).sort((r,n)=>(r.waiting()?1:0)-(n.waiting()?1:0)).map(r=>new Aa(e,r)))),new yt(new l(e=>o.getByPlayer(e).some(r=>!r.active()||!r.moves().value())),new p(e=>o.getByPlayer(e).filter(r=>!r.active()||r.moves().value()===0).sort((r,n)=>(r.waiting()?1:0)-(n.waiting()?1:0)).map(r=>new Ba(e,r))))],"getRules"),cj=K3});var q3,dj,gj=i(()=>{b();xg();TC();q3=t(()=>[new _h(new p(o=>o.action(new PA(o.tile(),o.tile(),o))))],"getRules"),dj=q3});var V3,hj,xj=i(()=>{wp();zn();CC();qu();A();Wl();gm();Gp();Gp();U();b();V3=t((o=oo,e=c,r=kn)=>[...[[$o,12,2,2],[Zo,18,12,4,2],[jr,12,1,8,2],[Oo,8],[Qo,0],[vo,1,12,5,2],[bo,6],[Co,4,1,2],[Xo,6,6,6,2],[ei,0,0,2],[sr,4,2,10,2],[Hr,2,2,3],[Cr,2,1,2],[To,4,4,4],[Po,4,2,2],[ti,6,6,3],[Io,3,2],[mr,99,0,16],[ri,3,5],[_r,1,1,3],[Ke,0],[wo,1,2],[Kr,8,2,3,2],[Tr,3],[oi,10,5,3],[Ao,0,3,4],[lr,1,0,3],[ii]].flatMap(([n,a=1,s=1,m=1,f=1])=>Rw(n,a,s,m,f)),...[[Eo,1,$i],[ss,.5,bn,$i]].flatMap(([n,a,...s])=>s.map(m=>new fm(new l((f,u)=>u instanceof m),new l(f=>o.getByUnit(f).some(u=>u instanceof n)),new p((f,u)=>{let y=new m;e.process(Km,f.constructor,y),u.add(y.value()*a,n.name)})))),...[[lr,2],[_r,3],[Hr,4],[Ao,8],[vo,8]].flatMap(([n,a])=>[new fm(new l((s,m)=>m instanceof il),new l(s=>s instanceof n),new p((s,m)=>m.set(a))),new fm(new l((s,m)=>m instanceof nl),new p((s,m)=>m.set(r.getByTransport(s).length)))])],"getRules"),hj=V3});var J3,Rj,Oj=i(()=>{ee();b();ER();J3=t((o=P)=>[new $l(new p((e,r)=>{o.emit("unit:unsupported",e,r)}))],"getRules"),Rj=J3});var $3,vj,bj=i(()=>{U();b();Eb();$3=t((o=()=>Math.random())=>[new yu(new l((e,r)=>e.moves().value()>=r),new p((e,r)=>(e.moves().subtract(r),!0))),new yu(new l((e,r)=>e.moves().value()<r),new p((e,r)=>{let n=e.moves().value();return e.moves().set(0),n>=r*.5*o()}))],"getRules"),vj=$3});var Z3={};var Cj=i(()=>{_z();qz();Jz();Zz();Xz();tj();oj();nj();A();sj();lj();uj();yj();gj();xj();Oj();bj();c.register(...Hz(),...Kz(),...Vz(),...$z(),...Qz(),...ej(),...rj(),...ij(),...aj(),...mj(),...fj(),...cj(),...dj(),...hj(),...Rj(),...vj())});var Pj=I(Tj=>{"use strict";Object.defineProperty(Tj,"__esModule",{value:!0});Yz();Cj()});var ai,Ij=i(()=>{Le();ai=class extends Ae{};t(ai,"Colossus")});var zi,wj=i(()=>{Le();zi=class extends Ae{};t(zi,"CopernicusObservatory")});var va,Aj=i(()=>{Le();va=class extends De{};t(va,"CureForCancer")});var ba,Bj=i(()=>{Le();ba=class extends De{};t(ba,"DarwinsVoyage")});var si,Gj=i(()=>{Le();si=class extends Ae{};t(si,"GreatLibrary")});var Ca,Mj=i(()=>{Le();Ca=class extends Ae{};t(Ca,"GreatWall")});var ji,Uj=i(()=>{Le();ji=class extends Ae{};t(ji,"HangingGardens")});var $s,Dj=i(()=>{Le();$s=class extends De{};t($s,"HooverDam")});var Ta,Ej=i(()=>{Le();Ta=class extends De{};t(Ta,"IsaacNewtonsCollege")});var gn,kj=i(()=>{Le();gn=class extends De{};t(gn,"JsBachsCathedral")});var Hi,Sj=i(()=>{Le();Hi=class extends De{};t(Hi,"Lighthouse")});var Pa,Fj=i(()=>{Le();Pa=class extends Ae{};t(Pa,"MagellansExpedition")});var xs,Nj=i(()=>{Le();xs=class extends De{};t(xs,"ManhattanProject")});var mi,Wj=i(()=>{Le();mi=class extends De{};t(mi,"MichelangelosChapel")});var Vr,Yj=i(()=>{Le();Vr=class extends Ae{};t(Vr,"Oracle")});var Ia,Lj=i(()=>{Le();Ia=class extends Ae{};t(Ia,"Pyramids")});var wa,zj=i(()=>{Le();wa=class extends De{};t(wa,"SetiProgram")});var li,jj=i(()=>{Le();li=class extends De{};t(li,"ShakespearesTheatre")});var Zs,Hj=i(()=>{Le();Zs=class extends De{};t(Zs,"UnitedNations")});var hn,_j=i(()=>{Le();hn=class extends De{};t(hn,"WomensSuffrage")});var Qs=i(()=>{iv();Ij();wj();Aj();Bj();Gj();Mj();Uj();Dj();Ej();kj();Sj();Fj();Nj();Wj();Yj();Lj();zj();jj();Hj();_j()});var Q3={};var Kj=i(()=>{Qs();El();Gn.register(gs,ai,zi,va,ba,si,Ca,ji,$s,Ta,gn,Hi,Pa,xs,mi,Vr,Ia,wa,li,Zs,hn)});var X3,qj,Vj=i(()=>{Qs();pn();Jp();He();ds();U();b();Le();zn();X3=t((o=H,e=St)=>[new Dt(new l((r,n)=>Object.isPrototypeOf.call(Ae,n)),new p((r,n)=>new l(()=>e.filter(a=>a instanceof n).length===0))),...[[ai,No],[zi,ao],[si,hr],[Ca,Kt],[ji,Si],[Hi,Lo],[Pa,co],[Vr,mo],[Ia,Kt],[gs,jo],[va,Ui],[ba,Nr],[$s,xt],[Ta,_o],[gn,Pt],[xs,Sr],[mi,Pt],[wa,lo],[li,uo],[Zs,Tt],[hn,rr]].map(([r,n])=>new Dt(new l((a,s)=>s===r),new p(a=>new l(()=>o.getByPlayer(a.player()).completed(n))))),...[[mr,xs]].map(([r,n])=>new Dt(new l((a,s)=>s===r),new p(()=>new l(()=>e.some(a=>a instanceof n)))))],"getRules"),qj=X3});var e4,Jj,$j=i(()=>{Qs();$p();e4=t(()=>[...[[gs,600],[ai,200],[zi,300],[va,600],[ba,300],[si,300],[Ca,300],[ji,300],[$s,600],[Ta,400],[gn,400],[Hi,200],[Pa,400],[xs,600],[mi,300],[Vr,300],[Ia,300],[wa,600],[li,400],[Zs,600],[hn,600]].flatMap(([o,e])=>Xm(o,e))],"getRules"),Jj=e4});var t4,Zj,Qj=i(()=>{is();ee();He();A();ds();Zp();U();Qs();b();ah();Le();t4=t((o=zt,e=H,r=c,n=St,a=P)=>[new en(new l((s,m)=>m instanceof Ae),new p((s,m)=>{let f=m.constructor;n.register(m),o.filter(u=>u.building()?.item()===f).forEach(u=>u.revalidate())})),new en(new l((s,m)=>m instanceof Ae),new p((s,m)=>{a.emit("wonder:built",m,s.city())})),new en(new l((s,m)=>m instanceof ba),new p(s=>{let m=e.getByPlayer(s.city().player()),f=t(y=>{let R=new qp(new l(B=>B===m),new p(()=>{r.unregister(R),y()}));r.register(R)},"createOnStarted"),u=t(()=>{m.add(m.cost()),f(()=>m.add(m.cost()))},"completeResearch");if(m.researching()===null){f(()=>u());return}u()}))],"getRules"),Zj=t4});var tu,xn,Hc=i(()=>{ds();U();tu=t((o,e=St)=>new l(r=>e.getByCity(r).some(n=>n instanceof o)),"cityHasWonder"),xn=t((o,e=St)=>new l(r=>e.getByPlayer(r.player()).some(n=>n instanceof o)),"playerHasWonder")});var Xj,Rs,bv,_c=i(()=>{He();U();Xj=t((o,e=H)=>new l(r=>e.getByPlayer(r.player()).completed(o)),"discoveredByPlayer"),Rs=t((o,e=H)=>new l(()=>o===null||!e.some(r=>r.completed(o))),"notDiscoveredByAnyPlayer"),bv=t((o,e=H)=>new l(r=>o===null||!e.getByPlayer(r.player()).completed(o)),"notDiscoveredByPlayer")});var Cv,eH=i(()=>{Bo();U();Cv=t((o,e=ke)=>new l(r=>e.getByCity(r).some(n=>n instanceof o)),"hasCityImprovement")});var r4,tH,rH=i(()=>{fn();Bo();pn();Qs();ns();He();Ve();ds();Hc();_c();yp();U();b();em();YR();km();lm();eH();Un();r4=t((o=ke,e=Ht,r=H,n=z,a=St)=>[new Gt(new Ot,xn(Vr,a),Cv(kt,o),bv(qt,r),Rs(Pt,r),new p((s,m)=>new Xe(-Math.min(1,tt(m,Xe)),Vr.name))),new Gt(new Ot,xn(Vr,a),Cv(kt,o),Xj(qt,r),Rs(Pt,r),new p((s,m)=>new Xe(-Math.min(2,tt(m,Xe)),Vr.name))),new Gt(new pi(4e3),tu(li,a),Rs(xt,r),new p((s,m)=>new Xe(-tt(m,Xe),li.name))),new Gt(new Ot,xn(gn,a),new p((s,m)=>new Xe(-Math.min(2,tt(m,Xe)),gn.name))),new Gt(new Ot,xn(mi,a),Cv(nr,o),Rs(Tt,r),new p((s,m)=>new Xe(-Math.min(4,tt(m,Xe)),mi.name))),new Gt(new Ot,xn(hn,a),new l((s,m)=>m.some(f=>f instanceof Rn)),new p((s,m)=>m.flatMap(f=>f instanceof Rn?new Xe(-1,hn.name):[])))],"getRules"),tH=r4});var o4,oH,iH=i(()=>{ds();vl();U();b();o4=t((o=St)=>[new Uo(new l(e=>o.getByCity(e).length>0),new p(e=>o.getByCity(e).forEach(r=>o.unregister(r))))],"getRules"),oH=o4});var i4,nH,aH=i(()=>{Qs();pn();lm();He();ds();Hc();gp();b();km();_c();i4=t((o=H,e=St)=>[new Ma(new pi(500),tu(ai,e),Rs(dr,o),new p(r=>new oe(r.tilesWorked().filter(n=>n.yields().some(a=>a instanceof oe)).length,ai.name))),...[[ji,1,gr],[va,1,null]].map(([r,n,a])=>new Ma(xn(r,e),Rs(a,o),new p(()=>new Da(n,r.name))))],"getRules"),nH=i4});var n4,sH,mH=i(()=>{Qs();He();ds();Hc();pn();b();em();lm();By();_c();Un();n4=t((o=H,e=St)=>[...[[zi,ct,1,_t]].map(([r,n,a,s])=>new bl(new Ot,tu(r,e),Rs(s,o),new p((m,f)=>new n(tt(f,n)*a,r.name)))),...[[wa,ct,.5,null]].map(([r,n,a,s])=>new bl(new Ot,xn(r,e),Rs(s,o),new p((m,f)=>new n(tt(f,n)*a,r.name))))],"getRules"),sH=n4});var Tv,Pv,lI=i(()=>{M();Tv=class extends x{};t(Tv,"Obsolete");Pv=Tv});var a4,lH,pH=i(()=>{pn();Qs();He();A();ds();eh();U();b();lI();a4=t((o=H,e=c,r=St)=>[new Qm(new l(()=>r.some(n=>n instanceof si)),new l((n,a)=>{let[s]=r.filter(f=>f instanceof si).map(f=>f.city().player());return!o.getByPlayer(s).completed(a.sourceClass())}),new l((n,a)=>o.filter(s=>s.completed(a.sourceClass())).length>=3),new p((n,a)=>{let[s]=r.filter(f=>f instanceof si).map(f=>f.city().player());return o.getByPlayer(s).addAdvance(a.sourceClass())})),...[[ai,dr],[zi,_t],[si,or],[Ca,tr],[ji,gr],[Ta,Sr],[Hi,Er],[mi,Tt],[Vr,Pt],[Ia,Tt],[li,xt]].map(([n,a])=>new Qm(new l(()=>r.entries().some(s=>s instanceof n)),new l((s,m)=>m instanceof a),new p(()=>{let[s]=r.filter(m=>m instanceof n);e.process(Pv,s,s.city())})))],"getRules"),lH=a4});var s4,fH,uH=i(()=>{Qs();He();ds();U();b();em();pn();wp();Ls();Gp();_c();Hc();s4=t((o=St,e=H)=>[new fu(new Ot,new l((r,n)=>n instanceof Cn),new l(r=>r instanceof Ne),xn(Hi,o),bv(Er,e),new p((r,n)=>n.add(1))),new fu(new Ot,new l((r,n)=>n instanceof Cn),new l(r=>r instanceof Ne),xn(Pa,o),new p((r,n)=>n.add(1)))],"getRules"),fH=s4});var m4,cH,yH=i(()=>{ee();b();lI();m4=t((o=P)=>[new Pv(new p((e,r)=>{o.emit("wonder:obsolete",e,r)}))],"getRules"),cH=m4});var l4={};var dH=i(()=>{Vj();$j();Qj();rH();iH();aH();mH();A();pH();uH();yH();c.register(...qj(),...Jj(),...Zj(),...tH(),...oH(),...nH(),...sH(),...lH(),...fH(),...cH())});var hH=I(gH=>{"use strict";Object.defineProperty(gH,"__esModule",{value:!0});Kj();dH()});var p4,xH,RH=i(()=>{En();zs();He();hR();xi();nI();U();p4=t((o=H,e=Je)=>[...[[Ue,Ie,Re,Ee,fe,le],[et,Ie,Ee,ze],[Ye,Et,Ie,$e,Re,Ee,rt,ze,fe,ot,gt]].map(([r,...n])=>new Xf(new l((a,s)=>s===r),new l(a=>n.some(s=>a.terrain()instanceof s)),new l((a,s)=>!e.getByTile(a).some(m=>m instanceof s)))),...[[Ye,Fo,le]].map(([r,n,...a])=>new Xf(new l((s,m)=>m===r),new l(s=>a.some(m=>s.terrain()instanceof m)),new l((s,m)=>!e.getByTile(s).some(f=>f instanceof m)),new l((s,m,f)=>o.getByPlayer(f).completed(n)))),...[[Xt,Nr,Ye,Et,Ie,$e,Re,Ee,rt,ze,fe,le,ot,gt]].map(([r,n,a,...s])=>new Xf(new l((m,f)=>f===r),new l(m=>s.some(f=>m.terrain()instanceof f)),new l((m,f)=>!e.getByTile(m).some(u=>u instanceof f)),new l(m=>e.getByTile(m).some(f=>f instanceof a)),new l((m,f,u)=>o.getByPlayer(u).completed(n))))],"getRules"),xH=p4});var f4,OH,vH=i(()=>{ee();zs();xi();Dd();U();b();f4=t((o=Je,e=P)=>[new cm(new l((r,n)=>o.getByTile(r).every(a=>n.constructor!==a.constructor)),new p((r,n)=>o.register(n))),new cm(new p(r=>r.clearYieldCache(null))),new cm(new p((r,n)=>{e.emit("tile-improvement:built",r,n)})),...[[et,Ue],[Ue,et]].map(([r,n])=>new cm(new l((a,s)=>s instanceof r),new l(a=>o.getByTile(a).some(s=>s instanceof n)),new p(a=>o.unregister(...o.getByTile(a).filter(s=>s instanceof n)))))],"getRules"),OH=f4});var Iv,wv,pI=i(()=>{Pn();Qi();Iv=class extends st{constructor(){super(at)}};t(Iv,"AvailableTerrainFeatureRegistry");wv=new Iv});var u4,bH,CH=i(()=>{pI();A();sb();b();Dp();u4=t((o=c,e=wv)=>[new cy(new p(r=>{let n=o.get(Vm);e.entries().forEach(a=>n.filter(s=>s.validate(a,r)).forEach(s=>s.process(a,r)))}))],"getRules"),bH=u4});var Ar,fI=i(()=>{M();Ar=class extends x{};t(Ar,"Distribution")});var c4,TH,PH=i(()=>{En();fI();Xr();U();b();c4=t(()=>[new Ar(new l(o=>o===Et),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:0,to:.01,fill:!0},{from:.01,to:.02},{from:.98,to:.99},{from:.99,to:1,fill:!0}])),new Ar(new l(o=>o===Ie),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.4,to:.45},{from:.45,to:.55,coverage:.025,cluster:!0,clusterChance:.1},{from:.55,to:.6}])),new Ar(new l(o=>o===$e),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.05,to:.2},{from:.2,to:.4,cluster:!0,clusterChance:.1,coverage:.1},{from:.4,to:.6},{from:.6,to:.8,cluster:!0,clusterChance:.1,coverage:.1},{from:.8,to:.95}])),new Ar(new l(o=>o===Re),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{fill:!0}])),new Ar(new l(o=>o===Ee),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.1,to:.9,path:!0,pathChance:.1,coverage:.06}])),new Ar(new l(o=>o===rt),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.3,to:.45,cluster:!0,clusterChance:.2,coverage:.08},{from:.55,to:.7,cluster:!0,clusterChance:.2,coverage:.08}])),new Ar(new l(o=>o===ze),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.01,to:.1,coverage:.3,path:!0},{from:.1,to:.9,path:!0},{from:.9,to:.99,coverage:.3,path:!0}])),new Ar(new l(o=>o===lt),new l((o,e)=>e.some(r=>r.constructor===Qr)),new p(()=>[{fill:!0}])),new Ar(new l(o=>o===fe),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.01,to:.2,coverage:.3},{from:.2,to:.4},{from:.1,to:.4,cluster:!0},{from:.4,to:.6},{from:.6,to:.8},{from:.6,to:.9,cluster:!0},{from:.8,to:.99,coverage:.3}])),new Ar(new l(o=>o===le),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.1,to:.9,coverage:.1,path:!0,pathChance:.5}])),new Ar(new l(o=>o===ot),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.2,to:.4,cluster:!0},{from:.6,to:.8,cluster:!0}])),new Ar(new l(o=>o===gt),new l((o,e)=>e.some(r=>r instanceof Q)),new p(()=>[{from:.01,to:.15,cluster:!0,coverage:.15},{from:.85,to:.99,cluster:!0,coverage:.15}]))],"getRules"),TH=c4});var Av,Bv,uI=i(()=>{M();Av=class extends x{};t(Av,"DistributionGroups");Bv=Av});var y4,IH,wH=i(()=>{En();b();uI();y4=t(()=>[new Bv(new p(()=>[lt,Re,ot,ze,rt,Ee,$e,Ie,fe,gt,Et,le]))],"getRules"),IH=y4});var d4,AH,BH=i(()=>{En();Hu();_a();Dp();d4=t((o=Yt)=>[...[[Oi,.2,Ee],[vi,.2,lt],[io,.2,$e,gt],[bi,.2,rt],[Ci,.2,ze],[ko,.2,fe],[no,.2,Ie],[Ti,.2,ot],[Pi,.2,Et],[hi,.5,Re,le]].flatMap(([r,n,...a])=>a.flatMap(s=>jw(s,r,n,o)))],"getRules"),AH=d4});var Gv,Mv,GH=i(()=>{M();Gv=class extends x{};t(Gv,"Pillaged");Mv=Gv});var g4,MH,UH=i(()=>{ee();xi();GH();U();b();g4=t((o=Je,e=P)=>[new Mv(new l((r,n)=>o.getByTile(r).includes(n)),new p((r,n)=>o.unregister(n))),new Mv(new p(r=>r.clearYieldCache(null))),new Mv(new p((r,n)=>{e.emit("tile-improvement:pillaged",r,n)}))],"getRules"),MH=g4});var cI,yI,dI,h4,x4,R4,O4,DH,EH=i(()=>{jP();ee();Xp();En();b();VP();cI=new Map,yI=new Map,dI=new Map,h4=t((o,e=null)=>(yI.has(o)||yI.set(o,o.score(e,[[X,8],[$,3],[oe,1]])),yI.get(o)),"tileScore"),x4=t((o,e=null)=>(dI.has(o)||dI.set(o,o.getSurroundingArea().entries().reduce((r,n)=>r+h4(n,e),0)),dI.get(o)),"areaScore"),R4=t((o,e=P)=>{if(!cI.has(o)){e.emit("world:generate-start-tiles");let r=o.entries().filter(n=>[Re,fe,le].some(a=>n.terrain()instanceof a)).map(n=>({tile:n,score:x4(n)})).sort(({score:n},{score:a})=>a-n).map(({tile:n})=>n);cI.set(o,r),e.emit("world:start-tiles",r)}return cI.get(o)},"pickStartTiles"),O4=t((o=MO,e=P,r=()=>Math.random())=>[new zO(new p((n,a,s)=>{if(e.option("earth",!1))try{return o.getStartTileByCivilizationAndWorld(a.civilization().sourceClass(),n)}catch{s.push(...o.entries().map(u=>u.startTileForMap(n)))}let m=R4(n,e);return m.forEach(f=>{s.some(u=>u.distanceFrom(f)<=4)&&m.splice(m.indexOf(f),1)}),m[Math.floor(m.length*r())]}))],"getRules"),DH=O4});var Uv,ru,Dv=i(()=>{IO();Pn();Uv=class extends st{constructor(){super(PO)}};t(Uv,"GeneratorRegistry");ru=new Uv});var Ev,kv,gI=i(()=>{M();Ev=class extends x{};t(Ev,"PickGenerator");kv=Ev});var Sv,Fv,hI=i(()=>{M();Sv=class extends x{};t(Sv,"Start");Fv=Sv});var Nv,Wv,xI=i(()=>{J();Nv=class extends ae{#e=[];constructor(e){super(),e.forEach(r=>this.#e.push(r))}hasTile(e){return this.#e.includes(e)}tiles(){return this.#e}};t(Nv,"LandMass");Wv=Nv});var Yv,kH,SH=i(()=>{he();xI();Yv=class extends F{constructor(){super(Wv)}getByTile(e){let[r]=this.entries().filter(n=>n.hasTile(e));return r??null}};t(Yv,"LandMassRegistry");kH=new Yv});var Lv,FH,NH=i(()=>{J();SH();A();SO();he();qi();xI();Lv=class extends k{#e;#t;#r;#o;#i=new Bm(xe);#n;constructor(e,r=c,n=kH){super(),this.#e=e,this.#t=e.height(),this.#r=n,this.#n=e.width(),this.#o=r,this.addKey("height","tiles","width")}async build(){let e=await this.#e.generate(),r=[];for(e.forEach((n,a)=>{let s=new xe(a%this.#n,Math.floor(a/this.#n),n,this,this.#o);this.#i.register(s),s.isLand()&&r.push(s)});r.length;){let n=r.slice(0,1),a=[];for(;n.length;){let s=n.shift();!r.includes(s)||(r.splice(r.indexOf(s),1),a.push(s),s.getNeighbours().forEach(m=>{!r.includes(m)||!m.isLand()||n.push(m)}))}this.#r.register(new Wv(a))}return this.#o.process(pl,this),this}entries(){return this.#i.entries()}filter(e){return this.entries().filter(e)}forEach(e){return this.#i.forEach(e)}get(e,r){return this.entries()[this.#e.coordsToIndex(e,r)]}height(){return this.#t}includes(e){return this.#i.includes(e)}landMasses(){return this.#r.entries()}map(e){return this.#i.map(e)}register(...e){this.#i.register(...e)}tiles(){return this.entries()}width(){return this.#n}};t(Lv,"World");FH=Lv});var v4,WH,YH=i(()=>{Dv();A();ee();b();gI();hI();NH();v4=t((o=c,e=ru,r=P)=>[new Fv(new p(()=>{let[n]=o.process(kv),a=new n(parseInt(r.option("height",100),10),parseInt(r.option("width",160),10),{landCoverage:parseFloat(r.option("landCoverage",.4)),landSize:parseFloat(r.option("landSize",.2)),maxIterations:parseInt(r.option("maxIterations",20),10)});new FH(a,o).build()}))],"getRules"),WH=v4});var b4,LH,zH=i(()=>{Hu();En();Xp();zs();$C();ns();_a();xi();U();b();pb();b4=t((o=Je,e=Yt,r=Ht)=>[...[[X,$e,1],[X,Re,2],[X,Ee,1],[X,rt,1],[X,lt,1],[X,fe,1],[X,le,2],[X,ot,1],[X,gt,1],[$,Ie,1],[$,$e,2],[$,ze,1],[$,fe,1]].map(([n,a,s])=>new Ki(new l(m=>m.terrain()instanceof a),new p(()=>new n(s,a.name)))),...[[$,Oi,2],[X,vi,1],[X,io,1],[oe,bi,2],[oe,Ci,3],[$,ko,1],[X,no,2],[$,Ti,3],[X,Pi,2],[$,hi,1]].map(([n,a,s])=>new Ki(new l(m=>e.getByTerrain(m.terrain()).some(f=>f instanceof a)),new p(()=>new n(s,a.name)))),...[[$,Oi,1],[X,vi,1],[X,io,1],[oe,bi,2],[oe,Ci,2],[$,ko,1],[X,no,1],[$,Ti,1],[X,Pi,1]].map(([n,a,s])=>new Ki(new l((m,f)=>{if(!f)return!1;try{return r.getByPlayer(f).is(It,pt,ft,Rt)}catch{return!1}}),new l(m=>e.getByTerrain(m.terrain()).some(f=>f instanceof a)),new p(()=>new n(s,a.name)))),new Ki(new l(n=>n.terrain()instanceof lt),new p(()=>new oe(2,lt.name))),new Ki(new l(n=>n.terrain()instanceof le),new p(()=>new oe(1))),new Ki(new l((n,a)=>{if(!a)return!1;try{return r.getByPlayer(a).is(pt,Rt)}catch{return!1}}),new l(n=>n.terrain()instanceof le||n.terrain()instanceof lt),new p(()=>new oe(1,lt.name))),...[[Ie,X,Ue,1],[Ie,$,et,1],[Ee,X,Ue,1],[Ee,$,et,2],[ze,$,et,1],[fe,X,Ue,1]].map(([n,a,s,m])=>new Ki(new l(f=>f.terrain()instanceof n),new l(f=>o.getByTile(f).some(u=>u instanceof s)),new p(()=>new a(m,s.name)))),...[[Ie,$,et,1],[Re,X,Ue,1],[Ee,$,et,1],[ze,$,et,1],[le,X,Ue,1]].map(([n,a,s,m])=>new Ki(new l((f,u)=>{if(!u)return!1;try{return r.getByPlayer(u).is(It,pt,ft,Rt)}catch{return!1}}),new l(f=>f.terrain()instanceof n),new l(f=>o.getByTile(f).some(u=>u instanceof s)),new p(()=>new a(m,s.name)))),...[Ie,Re,fe].map(n=>new Ki(new l(a=>a.terrain()instanceof n),new l(a=>o.getByTile(a).some(s=>s instanceof Ye)),new p(()=>new oe(1,Ye.name)))),...[Ie,Re,fe].map(n=>new Ki(new l((a,s)=>{if(!s)return!1;try{return r.getByPlayer(s).is(pt,Rt)}catch{return!1}}),new l(a=>a.terrain()instanceof n),new l(a=>o.getByTile(a).some(s=>s instanceof Ye)),new p(()=>new oe(1,Ye.name))))],"getRules"),LH=b4});var C4,jH,HH=i(()=>{Xp();xi();U();b();em();zs();lb();C4=t((o=Je)=>[...[[X,.5],[$,.5],[oe,.5]].map(([e,r])=>new gy(new Xs,new l((n,a,s)=>s.some(m=>m instanceof e)),new l(n=>o.getByTile(n).some(a=>a instanceof Xt)),new p((n,a,s)=>{let m=s.filter(f=>f instanceof e).reduce((f,u)=>f+u.value(),0);s.push(new e(Math.floor(m*r),Xt.name))})))],"getRules"),jH=C4});var T4,_H,KH=i(()=>{ee();Dv();AO();b();gI();T4=t((o=ru,e=P,r=()=>Math.random())=>[new kv(new p(()=>{if(e.option("earth",!1))return Hf;let n=o.entries();if(n.length===0)throw new TypeError("No available `World` generators.");return n[Math.floor(n.length*r())]}))],"getRules"),_H=T4});var P4={};var qH=i(()=>{RH();vH();CH();PH();wH();BH();A();UH();EH();YH();zH();HH();KH();c.register(...xH(),...OH(),...bH(),...TH(),...IH(),...AH(),...MH(),...DH(),...WH(),...LH(),...jH(),..._H())});var zv,jv,RI=i(()=>{Pn();pp();zv=class extends st{constructor(){super(Ts)}};t(zv,"TerrainRegistry");jv=new zv});var I4={};var VH=i(()=>{En();RI();jv.register(Et,Ie,$e,Re,Ee,rt,ze,lt,fe,le,ot,gt)});var w4={};var JH=i(()=>{Hu();pI();wv.register(Oi,vi,io,bi,Ci,ko,no,Ti,Pi,hi)});var ZH=I($H=>{"use strict";Object.defineProperty($H,"__esModule",{value:!0});qH();VH();JH()});var A4,QH,XH=i(()=>{mt();Nt();Do();qi();A4=t((o=Z)=>[new re(q,"cities",e=>o.getByPlayer(e)),new re(xe,"city",e=>o.getByTile(e))],"getAdditionalData"),QH=A4});var B4,e_,t_=i(()=>{fi();Nt();qi();B4=t((o=Se)=>[new re(xe,"workedBy",e=>o.getByTile(e)?.city()??null)],"getAdditionalData"),e_=B4});var G4={};var r_=i(()=>{XH();Qt();t_();pe.register(...QH(),...e_())});var i_=I(o_=>{"use strict";Object.defineProperty(o_,"__esModule",{value:!0});r_()});var M4,n_,a_=i(()=>{is();Nt();Ps();M4=t((o=zt)=>[new re(it,"build",e=>o.getByCity(e))],"getAdditionalData"),n_=M4});var U4={};var s_=i(()=>{a_();Qt();pe.register(...n_())});var l_=I(m_=>{"use strict";Object.defineProperty(m_,"__esModule",{value:!0});s_()});var D4,p_,f_=i(()=>{er();Nt();Ps();D4=t((o=ie)=>[new re(it,"growth",e=>o.getByCity(e))],"getAdditionalData"),p_=D4});var E4={};var u_=i(()=>{Qt();f_();pe.register(...p_())});var y_=I(c_=>{"use strict";Object.defineProperty(c_,"__esModule",{value:!0});u_()});var k4,d_,g_=i(()=>{A();Nt();WR();Ps();Gf();k4=t((o=c)=>[new re(it,"civilDisorder",e=>o.process(qs,e,e.yields()).some(r=>r)),new re(it,"celebrateLeader",e=>o.process(Uf,e,e.yields()).some(r=>r))],"getAdditionalData"),d_=k4});var S4={};var h_=i(()=>{g_();Qt();pe.register(...d_())});var R_=I(x_=>{"use strict";Object.defineProperty(x_,"__esModule",{value:!0});h_()});var F4,O_,v_=i(()=>{Bo();Nt();Ps();F4=t((o=ke)=>[new re(it,"improvements",e=>o.getByCity(e))],"getAdditionalData"),O_=F4});var N4={};var b_=i(()=>{Qt();v_();pe.register(...O_())});var T_=I(C_=>{"use strict";Object.defineProperty(C_,"__esModule",{value:!0});b_()});var W4,P_,I_=i(()=>{sl();Nt();qi();W4=t((o=Ii)=>[new re(xe,"goodyHut",e=>o.getByTile(e))],"getAdditionalData"),P_=W4});var Y4={};var w_=i(()=>{Qt();I_();pe.register(...P_())});var B_=I(A_=>{"use strict";Object.defineProperty(A_,"__esModule",{value:!0});w_()});var L4,G_,M_=i(()=>{ns();Nt();Do();L4=t((o=Ht)=>[new re(q,"government",e=>o.getByPlayer(e))],"getAdditionalData"),G_=L4});var z4={};var U_=i(()=>{M_();Qt();pe.register(...G_())});var E_=I(D_=>{"use strict";Object.defineProperty(D_,"__esModule",{value:!0});U_()});var j4,k_,S_=i(()=>{Ri();Nt();Do();j4=t((o=me)=>[new re(q,"world",e=>o.getByPlayer(e))],"getAdditionalData"),k_=j4});var H4={};var F_=i(()=>{Qt();S_();pe.register(...k_())});var W_=I(N_=>{"use strict";Object.defineProperty(N_,"__esModule",{value:!0});F_()});var _4,Y_,L_=i(()=>{He();Nt();Do();_4=t((o=H)=>[new re(q,"research",e=>o.getByPlayer(e))],"getAdditionalData"),Y_=_4});var K4={};var z_=i(()=>{Qt();L_();pe.register(...Y_())});var H_=I(j_=>{"use strict";Object.defineProperty(j_,"__esModule",{value:!0});z_()});var q4,__,K_=i(()=>{ip();Nt();Do();q4=t((o=Oa)=>[new re(q,"spaceship",e=>o.getActiveByPlayer(e))],"getAdditionalData"),__=q4});var V4={};var q_=i(()=>{Qt();K_();pe.register(...__())});var J_=I(V_=>{"use strict";Object.defineProperty(V_,"__esModule",{value:!0});q_()});var J4,$_,Z_=i(()=>{_a();Nt();pp();J4=t((o=Yt)=>[new re(Ts,"features",e=>o.getByTerrain(e))],"getAdditionalData"),$_=J4});var $4={};var Q_=i(()=>{Qt();Z_();pe.register(...$_())});var eK=I(X_=>{"use strict";Object.defineProperty(X_,"__esModule",{value:!0});Q_()});var Z4,tK,rK=i(()=>{xi();Nt();qi();Z4=t((o=Je)=>[new re(xe,"improvements",e=>o.getByTile(e))],"getAdditionalData"),tK=Z4});var Q4={};var oK=i(()=>{Qt();rK();pe.register(...tK())});var nK=I(iK=>{"use strict";Object.defineProperty(iK,"__esModule",{value:!0});oK()});var X4,aK,sK=i(()=>{jc();Nt();Do();X4=t((o=dl)=>[new re(q,"rates",e=>o.getByPlayer(e))],"getAdditionalData"),aK=X4});var eJ={};var mK=i(()=>{Qt();sK();pe.register(...aK())});var pK=I(lK=>{"use strict";Object.defineProperty(lK,"__esModule",{value:!0});mK()});var tJ,fK,uK=i(()=>{A();Nt();ku();Su();tJ=t((o=c)=>[new re(el,"spendCost",e=>o.process(Mn,e))],"getAdditionalData"),fK=tJ});var rJ,cK,yK=i(()=>{Sl();Nt();Do();rJ=t((o=tn)=>[new re(q,"treasuries",e=>o.getByPlayer(e))],"getAdditionalData"),cK=rJ});var oJ={};var dK=i(()=>{Qt();uK();yK();pe.register(...fK(),...cK())});var hK=I(gK=>{"use strict";Object.defineProperty(gK,"__esModule",{value:!0});dK()});var Hv,xK,RK=i(()=>{M();Hv=class extends x{};t(Hv,"End");xK=Hv});var iJ,OK,vK=i(()=>{ee();A();Mt();RK();hI();rI();iJ=t((o=c,e=P,r=te)=>[["engine:start",()=>{o.process(Fv)}],...["game:start","turn:end"].map(n=>[n,()=>{e.emit("turn:start",r.increment())}]),["turn:end",()=>{o.process(xK,r)}],["turn:start",()=>{o.process(mv,r)}]],"getEvents"),OK=iJ});var nJ={};var bK=i(()=>{ee();vK();[...OK()].forEach(([o,e])=>{P.on(o,e)})});var TK=I(CK=>{"use strict";Object.defineProperty(CK,"__esModule",{value:!0});bK()});var aJ,PK,IK=i(()=>{Ve();Nt();Ps();Do();qi();aJ=t((o=z)=>[new re(it,"units",e=>o.getByCity(e)),new re(q,"units",e=>o.getByPlayer(e,!0)),new re(xe,"units",e=>o.getByTile(e))],"getAdditionalData"),PK=aJ});var sJ={};var wK=i(()=>{Qt();IK();pe.register(...PK())});var BK=I(AK=>{"use strict";Object.defineProperty(AK,"__esModule",{value:!0});wK()});var mJ,GK,MK=i(()=>{gm();Nt();Es();mJ=t((o=oo)=>[new re(Fe,"improvements",e=>o.getByUnit(e))],"getAdditionalData"),GK=mJ});var lJ={};var UK=i(()=>{Qt();MK();pe.register(...GK())});var EK=I(DK=>{"use strict";Object.defineProperty(DK,"__esModule",{value:!0});UK()});var _v,kK,SK=i(()=>{Pn();ey();_v=class extends st{constructor(){super(hl)}};t(_v,"AIClientRegistry");kK=new _v});var pJ={};var FK=i(()=>{SK();sf();kK.register(Ks)});var fJ,NK,WK=i(()=>{rs();Ve();Ol();U();b();sf();fJ=t((o=z,e=Lt)=>[new eo(new l((r,n)=>e.getByPlayer(n)instanceof Ks),new p((r,n,a)=>e.getByPlayer(n).cityLost(r,a,!1)))],"getRules"),NK=fJ});var uJ,YK,LK=i(()=>{rs();Ve();U();vl();b();sf();uJ=t((o=z,e=Lt)=>[new Uo(new l(r=>e.getByPlayer(r.player())instanceof Ks),new p((r,n)=>e.getByPlayer(r.player()).cityLost(r,n,!0)))],"getRules"),YK=uJ});var cJ,zK,jK=i(()=>{rs();Ve();U();cu();b();sf();cJ=t((o=z,e=Lt)=>[new Na(new l(r=>e.getByPlayer(r.player())instanceof Ks),new p((r,n)=>e.getByPlayer(r.player()).unitDestroyed(r,n&&n.player())))],"getRules"),zK=cJ});var yJ={};var HK=i(()=>{A();WK();LK();jK();c.register(...NK(),...zK(),...YK())});var KK=I(_K=>{"use strict";Object.defineProperty(_K,"__esModule",{value:!0});FK();HK()});var Kv,qK,VK=i(()=>{fI();IO();Xr();A();RI();uI();zP();Kv=class extends jf{#e;#t;#r;#o;#i;#n;#a;#m;#s;#l;constructor(e=100,r=160,n={},a=c,s=jv,m=()=>Math.random()){super(e,r);let{landCoverage:f=.4,landSize:u=.2,maxIterations:y=10,clusterChance:R=.05,coverage:B=.25,pathChance:N=.05}=n;this.#e=f,this.#t=u,this.#r=y,this.#o=R,this.#i=B,this.#n=N,this.#s=a,this.#l=s,this.#m=m,this.#a=new Array(this.height()*this.width()).fill(0).map(()=>new Qr)}async generateIslands(){let e=this.height(),r=this.width(),n=this.#t+this.#m()*.2,a=this.#e,s=this.#r,m=Math.ceil(e*r/100*n),f=new Array(e*r).fill(0);for(;f.length===0||f.filter(u=>u===1).length/f.length<a;){let u={},y=[],R=[],B=Math.floor(e*r*Math.random()),N=t(W=>{W in u||(u[W]=0),u[W]++},"flagAsSeen");for(f[B]=1,y.push(B),N(B),R.push(...op(e,r,B));R.length;){let W=R.shift();if((u[W]||0)<=s&&(Math.random()>.3?(f[W]=1,y.push(W),op(e,r,W).filter(_=>R.indexOf(_)===-1).forEach(_=>R.push(_))):op(e,r,W).forEach(_=>{let d=R.indexOf(_);d>-1&&R.splice(d,1)}),N(W)),y.length>m||f.filter(_=>_===1).length/f.length>=a)break}if(f.filter(W=>W===1).length/f.length>=a)break}this.#a=f.map(u=>u===1?new Q:new Qr)}generate(){return this.generateIslands().then(()=>this.populateTerrain().then(()=>this.#a))}getNeighbours(e,r=!0){return op(this.height(),this.width(),e,r)}populateTerrain(){return new Promise(e=>{let r=this.#s.get(Ar);this.#s.get(Bv).filter(n=>n.validate()).map(n=>{let a=n.process();if(!a)throw new TypeError("Unexpected data from DistributionGroups.");return a}).forEach(n=>n.forEach(a=>r.filter(s=>s.validate(a,this.#a)).map(s=>{let m=s.process(a,this.#a);if(!m)throw new TypeError("Unexpected data from Distribution.");return m}).forEach(s=>s.forEach(({cluster:m=!1,clusterChance:f=this.#o,coverage:u=this.#i,fill:y=!1,from:R=0,path:B=!1,pathChance:N=this.#n,to:W=1})=>{let _=Object.keys(this.#a).map(g=>parseInt(g,10)).filter(g=>this.#a[g]instanceof a.__proto__).filter(g=>g>=R*this.height()*this.width()&&g<=W*this.height()*this.width());if(y){_.forEach(g=>{this.#a[g]=new a});return}let d=_.length*u;for(;d>0;){let g=_[Math.floor(this.#m()*_.length)];if(this.#a[g]=new a,d--,m){let h=this.getNeighbours(g).filter(G=>!(this.#a[G]instanceof a));for(;h.length&&d>0;){let G=h.shift();f>=this.#m()/this.distanceFrom(g,G)&&(this.#a[G]=new a,d--,h.push(...this.getNeighbours(G).filter(L=>!(this.#a[L]instanceof a)).filter(L=>this.#a[L]instanceof a.__proto__).filter(L=>!h.includes(L))))}}if(B){let h=g;for(;N>=this.#m();){let G=this.getNeighbours(h).filter(L=>this.#a[L]instanceof a.__proto__&&!(this.#a[L]instanceof a));h=G[Math.floor(this.#m()*G.length)],this.#a[h]=new a,d--}}}})))),e()})}};t(Kv,"BaseGenerator");qK=Kv});var dJ={};var JK=i(()=>{VK();Dv();ru.register(qK)});var ZK=I($K=>{"use strict";Object.defineProperty($K,"__esModule",{value:!0});JK()});var qv,QK,XK=i(()=>{PC();_b();A();xu();gi();vR();qv=class extends kp{#e=[];#t=[this.createNode(this.start())];#r;#o=[this.start()];constructor(e,r,n,a=c){super(e,r,n),this.#r=a}canMoveTo(e){return this.unit()instanceof ht?!0:this.unit()instanceof _e?e.isLand():this.unit()instanceof Ne?e.isWater():!1}createNode(e,r=null,n=0){return{tile:e,parent:r,cost:n}}createPath(e){let r=[],n=0;for(;e.parent;)r.unshift(e.tile),n+=e.cost,e=e.parent;r.unshift(e.tile);let a=new ms(...r);return a.setMovementCost(n),a}generate(){for(;this.#t.length;){let r=this.#t.shift(),{tile:n}=r;n.getNeighbours().sort((a,s)=>a.distanceFrom(n)-s.distanceFrom(n)).forEach(a=>{if(this.canMoveTo(a)){let[s]=this.#r.process(we,this.unit(),new nt(n,a,this.unit(),this.#r)).sort((f,u)=>f-u),m=this.createNode(a,r,1);if(a===this.end()){this.#e.push(this.createPath(m)),this.#e[this.#e.length-1].length<this.start().distanceFrom(this.end())*1.1&&this.#t.splice(0,this.#t.length);return}!this.#t.some(f=>f.tile===a)&&!this.#o.includes(a)&&(this.#t.push(m),this.#o.push(a))}})}let[e]=this.#e.sort((r,n)=>r.movementCost()-n.movementCost());return e}};t(qv,"BasePathFinder");QK=qv});var gJ={};var eq=i(()=>{XK();Sp();Fs.register(QK)});var rq=I(tq=>{"use strict";Object.defineProperty(tq,"__esModule",{value:!0});eq()});var hJ={};var dbt,gbt,hbt,xbt,Rbt,Obt,vbt,bbt,Cbt,Tbt,Pbt,Ibt,wbt,Abt,Bbt,Gbt,Mbt,Ubt,Dbt,Ebt,kbt,Sbt,Fbt,Nbt,Wbt,Ybt,Lbt,zbt,jbt,Hbt,_bt,Kbt,qbt,Vbt,Jbt,$bt,Zbt,Qbt,Xbt,eCt,tCt,rCt,oCt,iCt,nCt,aCt,sCt,mCt,lCt,pCt,fCt,uCt,cCt,yCt,dCt,gCt,hCt,xCt,RCt,OCt,vCt,bCt,CCt,TCt,PCt,ICt,wCt,ACt,BCt,GCt,MCt,UCt,DCt,ECt,kCt,SCt,FCt,NCt,WCt,YCt,LCt,zCt,jCt,HCt,_Ct,KCt,qCt,VCt,JCt,$Ct,ZCt,QCt,XCt,eTt,tTt,rTt,oTt,iTt,nTt,aTt,sTt,mTt,lTt,pTt,fTt,uTt,cTt,yTt,dTt,gTt,hTt,xTt,RTt,OTt,vTt,bTt,CTt,TTt,PTt,ITt,oq=i(()=>{"use strict";dbt=w(hD()),gbt=w(vD()),hbt=w(PD()),xbt=w(BD()),Rbt=w(DD()),Obt=w(FD()),vbt=w(LD()),bbt=w(_D()),Cbt=w(JD()),Tbt=w(XD()),Pbt=w(oE()),Ibt=w(sE()),wbt=w(fE()),Abt=w(dE()),Bbt=w(xE()),Gbt=w(vE()),Mbt=w(TE()),Ubt=w(wE()),Dbt=w(GE()),Ebt=w(DE()),kbt=w(SE()),Sbt=w(WE()),Fbt=w(zE()),Nbt=w(_E()),Wbt=w(VE()),Ybt=w(ZE()),Lbt=w(ek()),zbt=w(ok()),jbt=w(ak()),Hbt=w(lk()),_bt=w(uk()),Kbt=w(dk()),qbt=w(xk()),Vbt=w(vk()),Jbt=w(Tk()),$bt=w(wk()),Zbt=w(Gk()),Qbt=w(Dk()),Xbt=w(Sk()),eCt=w(Wk()),tCt=w(zk()),rCt=w(_k()),oCt=w(Vk()),iCt=w(Zk()),nCt=w(eS()),aCt=w(oS()),sCt=w(aS()),mCt=w(lS()),lCt=w(uS()),pCt=w(dS()),fCt=w(xS()),uCt=w(vS()),cCt=w(TS()),yCt=w(wS()),dCt=w(GS()),gCt=w(DS()),hCt=w(SS()),xCt=w(WS()),RCt=w(zS()),OCt=w(_S()),vCt=w(VS()),bCt=w(ZS()),CCt=w(eF()),TCt=w(oF()),PCt=w(aF()),ICt=w(lF()),wCt=w(uF()),ACt=w(dF()),BCt=w(xF()),GCt=w(vF()),MCt=w(TF()),UCt=w(wF()),DCt=w(GF()),ECt=w(DF()),kCt=w(SF()),SCt=w(WF()),FCt=w(zF()),NCt=w(_F()),WCt=w(VF()),YCt=w(ZF()),LCt=w(e0()),zCt=w(n0()),jCt=w(K0()),HCt=w(pN()),_Ct=w(EN()),KCt=w(rW()),qCt=w(lW()),VCt=w(wW()),JCt=w(SW()),$Ct=w(LW()),ZCt=w(lY()),QCt=w(vY()),XCt=w(oL()),eTt=w(TL()),tTt=w(mz()),rTt=w(Tz()),oTt=w(Wz()),iTt=w(Pj()),nTt=w(hH()),aTt=w(ZH()),sTt=w(i_()),mTt=w(l_()),lTt=w(y_()),pTt=w(R_()),fTt=w(T_()),uTt=w(B_()),cTt=w(E_()),yTt=w(W_()),dTt=w(H_()),gTt=w(J_()),hTt=w(eK()),xTt=w(nK()),RTt=w(pK()),OTt=w(hK()),vTt=w(TK()),bTt=w(BK()),CTt=w(EK()),TTt=w(KK()),PTt=w(ZK()),ITt=w(rq())});eb();tb();ap();Qc();ey();rb();Zr();nb();Ps();Wy();qe();Mr();hb();J();var Ym,qy=class{constructor(){ne(this,Ym,[])}add(e,r,n=null){T(this,Ym).push({[e]:{type:"add",index:n,value:r}})}clear(){T(this,Ym).splice(0)}remove(e,r=null){T(this,Ym).push({[e]:{type:"remove",index:r}})}transferData(){return T(this,Ym).slice(0).map(e=>{let r={};return Object.entries(e).forEach(([n,{type:a,index:s,value:m}])=>{r[n]={type:a,index:s,value:typeof m=="function"?m():m}}),r})}update(e,r,n=null){T(this,Ym).push({[e]:{type:"update",index:n,value:r}})}};t(qy,"DataQueue"),Ym=new WeakMap;var WI=qy;Jy();xb();lm();lu();Cb();gl();Gl();tC();J();var Ru,Ou,Ig=class extends ae{constructor(r,n){super();ne(this,Ru,void 0);ne(this,Ou,void 0);ce(this,Ru,n),ce(this,Ou,r),this.addKey("data","key")}data(){return T(this,Ru)}key(){return T(this,Ou)}};t(Ig,"Notification"),Ru=new WeakMap,Ou=new WeakMap;var Ut=Ig;es();Do();oC();Sg();var Fg=class extends Error{constructor(e,r,n){super(e)}};t(Fg,"RetryFailed");var FA=Fg;var vu,bu,Yp,Cu,Lp,Tu,Pu,Ng=class{constructor(e,r=5,n=100){ne(this,vu,0);ne(this,bu,void 0);ne(this,Yp,void 0);ne(this,Cu,void 0);ne(this,Lp,void 0);ne(this,Tu,void 0);ne(this,Pu,void 0);ce(this,Yp,e),ce(this,Cu,r),ce(this,Lp,setInterval(()=>this.run(),n)),ce(this,bu,new Promise((a,s)=>{ce(this,Pu,a),ce(this,Tu,s)}))}run(){if(++bI(this,vu)._>T(this,Cu)){clearInterval(T(this,Lp)),T(this,Tu).call(this,new FA("Retry failed.",T(this,Yp),T(this,vu)));return}T(this,Yp).call(this)&&(clearInterval(T(this,Lp)),T(this,Pu).call(this))}then(){return T(this,bu)}};t(Ng,"Retryable"),vu=new WeakMap,bu=new WeakMap,Yp=new WeakMap,Cu=new WeakMap,Lp=new WeakMap,Tu=new WeakMap,Pu=new WeakMap;var NA=Ng;Ul();aC();J();var Iu,wu,Au,Yg=class extends ae{constructor(r,n,a){super();ne(this,Iu,void 0);ne(this,wu,void 0);ne(this,Au,void 0);ce(this,Iu,r),ce(this,wu,n),ce(this,Au,a),this.addKey("player","turn","year")}player(){return T(this,Iu)}turn(){return T(this,wu)}year(){return T(this,Au)}};t(Yg,"TransferObject"),Iu=new WeakMap,wu=new WeakMap,Au=new WeakMap;var LA=Yg;qi();var Lg=class extends Error{};t(Lg,"Timeout");var zA=Lg;Es();J();er();var zp,jp,Hp,Bu,sC=class extends ae{constructor(r,n,a,s){super();ne(this,zp,void 0);ne(this,jp,void 0);ne(this,Hp,{size:0});ne(this,Bu,void 0);ce(this,zp,r),ce(this,jp,a),T(this,Hp).size=s,ce(this,Bu,n),this.addKey("_","growth","name","player","tile")}static fromCity(r){let n=ie.getByCity(r);return new sC(r.name(),r.tile(),r.player(),n.size())}_(){return"City"}name(){return T(this,zp)}player(){return T(this,jp)}growth(){return T(this,Hp)}tile(){return T(this,Bu)}update(r){let n=ie.getByCity(r);ce(this,zp,r.name()),ce(this,jp,r.player()),T(this,Hp).size=n.size()}},jg=sC;t(jg,"City"),zp=new WeakMap,jp=new WeakMap,Hp=new WeakMap,Bu=new WeakMap;var jA=jg;J();var Gu,mC=class extends ae{constructor(r){super();ne(this,Gu,void 0);ce(this,Gu,r),this.addKey("_","civilization")}static fromPlayer(r){return new mC(r.civilization())}_(){return"Player"}civilization(){return T(this,Gu)}},Hg=mC;t(Hg,"Player"),Gu=new WeakMap;var HA=Hg;J();var Mu,Uu,Du,lC=class extends ae{constructor(r,n,a){super();ne(this,Mu,void 0);ne(this,Uu,void 0);ne(this,Du,void 0);ce(this,Mu,r),ce(this,Uu,n),ce(this,Du,a),this.addKey("_","tile","player")}static fromUnit(r){return new lC(r.constructor.name,r.tile(),r.player())}_(){return T(this,Mu)}player(){return T(this,Du)}tile(){return T(this,Uu)}},_g=lC;t(_g,"Unit"),Mu=new WeakMap,Uu=new WeakMap,Du=new WeakMap;var _A=_g;Le();D();mt();rs();Kp();ee();vm();Zm();He();Sl();Ri();A();Mt();Ve();Fu();rl();var hq=t((o,e)=>new Promise((r,n)=>setTimeout(()=>e===void 0?r():n(e),o)),"awaitTimeout"),iB=t(o=>o instanceof ae?{"#ref":o.id()}:o,"referenceObject"),Ze=t((...o)=>e=>o.some(r=>e instanceof r)?iB(e):e,"filterToReference"),oB=t((...o)=>e=>o.some(r=>e instanceof r)?e:iB(e),"filterToReferenceAllExcept"),xq=15,OC=new Map,vC=new Map,Yu=new Map,Pe,ue,Nl,Bh,Gh,Lu,Dn,Ah=class extends Dm{constructor(r,n,a,s){super(r);ne(this,Pe,t((r=n=>n)=>n=>n instanceof q&&n!==this.player()?(OC.has(n)||OC.set(n,HA.fromPlayer(n)),OC.get(n)):n instanceof Fe&&n.player()!==this.player()?(vC.has(n)||vC.set(n,_A.fromUnit(n)),vC.get(n)):n instanceof it&&n.player()!==this.player()?(Yu.has(n)||Yu.set(n,jA.fromCity(n)),Yu.get(n)):n instanceof xe?me.getByPlayer(this.player()).get(n.x(),n.y()):n instanceof Ge?{_:n.constructor.name}:r(n),"#dataFilter"));ne(this,ue,new WI);ne(this,Nl,void 0);ne(this,Bh,void 0);ne(this,Gh,void 0);ne(this,Lu,!1);ne(this,Dn,void 0);ce(this,Nl,new Zy),ce(this,Dn,n),ce(this,Gh,a),ce(this,Bh,s),T(this,Dn).receive("action",(...m)=>T(this,Nl).emit("action",...m)),T(this,Dn).receive("cheat",({name:m,value:f})=>{if(m==="RevealMap"){let u=me.getByPlayer(this.player()),[y]=u.entries();y.tile().map().entries().forEach(R=>{if(u.includes(R))return;u.register(R);let B=u.getByTile(R);T(this,ue).add(u.id(),()=>R.toPlainObject(T(this,Pe).call(this)),`entries[${u.entries().indexOf(B)}]`)})}if(m==="GrantAdvance"){let[u]=v.filter(R=>R.name===f),y=H.getByPlayer(this.player());if(!u||y.completed(u))return;y.addAdvance(u),T(this,ue).add(y.id(),y.toPlainObject(T(this,Pe).call(this,Ze(q))))}if(m==="GrantGold"){let u=tn.getByPlayerAndType(this.player(),je);u.add(f),T(this,ue).add(u.id(),u.toPlainObject(T(this,Pe).call(this,Ze(q))))}if(m==="ModifyUnit"){let{unitId:u,properties:y}=f,[R]=z.getBy("id",u);if(!R)return;["attack","defence","moves","movement","visibility"].forEach(B=>{B in y&&R[B]().set(y[B])}),T(this,ue).add(R.id(),R.toPlainObject(T(this,Pe).call(this,Ze(q))))}this.sendPatchData()}),P.on("engine:plugins:load:failed",(m,f)=>{console.log(m+" failed to load"),console.error(f)}),P.on("player:visibility-changed",(m,f)=>{if(f!==this.player())return;let u=me.getByPlayer(this.player()),y=u.getByTile(m);if(y===null){new NA(()=>{let R=u.getByTile(m);return R===null?!1:(T(this,ue).add(u.id(),()=>m.toPlainObject(T(this,Pe).call(this,Ze(q))),`tiles[${u.entries().indexOf(R)}]`),!0)},2,20);return}T(this,ue).add(u.id(),()=>y.toPlainObject(T(this,Pe).call(this,Ze(q))),`tiles[${u.entries().indexOf(y)}]`)}),["unit:created","unit:defeated"].forEach(m=>{P.on(m,f=>{let u=me.getByPlayer(this.player()),y=u.getByTile(f.tile());if(!!y&&(T(this,ue).update(y.id(),()=>y.toPlainObject(T(this,Pe).call(this,Ze(q)))),f.player()===this.player())){if(m==="unit:created"){let R=z.getByPlayer(this.player()),B=R.indexOf(f),N=z.getByCity(f.city()),W=N.indexOf(f),_=z.getByTile(f.tile()),d=_.indexOf(f);T(this,ue).add(r.id(),()=>f.toPlainObject(T(this,Pe).call(this,Ze(xe,q,$m,it))),`units[${B}]`),T(this,ue).add(y.id(),()=>f.toPlainObject(T(this,Pe).call(this,Ze(Fe))),`units[${d}]`),f.city()!==null&&T(this,ue).add(f.city().id(),()=>f.toPlainObject(T(this,Pe).call(this,Ze(Fe))),`units[${W}]`);return}T(this,ue).update(this.player().id(),()=>this.player().toPlainObject(T(this,Pe).call(this,oB(q,Fe,ve))))}})}),["unit:destroyed"].forEach(m=>{P.on(m,(f,u)=>{f.player()===this.player()&&f.city()!==null&&T(this,ue).update(f.city().id(),()=>f.city().toPlainObject(T(this,Pe).call(this,Ze(vs,Cl,K,q,$m,xe,Fe))))})}),["unit:moved"].forEach(m=>{P.on(m,(f,u)=>{let y=me.getByPlayer(this.player()),R=y.getByTile(u.from()),B=y.getByTile(u.to());!R&&!B||(R&&T(this,ue).update(R.id(),()=>R.toPlainObject(T(this,Pe).call(this,Ze(q,it)))),B&&T(this,ue).update(B.id(),()=>B.toPlainObject(T(this,Pe).call(this,Ze(q,it)))),f.player()===this.player()&&f.city()!==null&&T(this,ue).update(f.city().id(),()=>f.city().toPlainObject(T(this,Pe).call(this,Ze(vs,Cl,K,q,$m,xe,Fe)))),this.sendPatchData())})}),["tile-improvement:built","tile-improvement:pillaged"].forEach(m=>{P.on(m,f=>{let u=me.getByPlayer(this.player()),y=u.getByTile(f);y&&T(this,ue).update(y.id(),()=>y.toPlainObject(T(this,Pe).call(this,Ze(q,it))))})}),P.on("city:captured",(m,f,u)=>{if(u===this.player()){Z.getByPlayer(this.player()).indexOf(m)!==-1&&T(this,ue).update(this.player().id(),()=>this.player().toPlainObject(T(this,Pe).call(this,oB(q,ve)))),this.sendNotification(new Ut("City.captured-from-us",{city:m,capturingPlayer:f,originalPlayer:u}));return}if(f===this.player()){this.sendNotification(new Ut("City.captured-by-us",{city:m,capturingPlayer:f,originalPlayer:u}));return}}),["city:created","city:captured","city:destroyed","city:grow","city:shrink"].forEach(m=>{P.on(m,f=>{let u=me.getByPlayer(this.player()),y=u.getByTile(f.tile());if(!!y){if(Yu.has(f)){let R=Yu.get(f);R.update(f),T(this,ue).update(R.id(),()=>R.toPlainObject(T(this,Pe).call(this,Ze(xe,Fe,q))))}T(this,ue).update(y.id(),()=>y.toPlainObject(T(this,Pe).call(this,Ze(q))))}})}),P.on("city:shrink",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.shrink",{city:m}))}),P.on("unit:unsupported",(m,f)=>{m.player()===this.player()&&this.sendNotification(new Ut("City.unit-unsupported",{city:m,unit:f}))}),P.on("city:unsupported-improvement",(m,f)=>{m.player()===this.player()&&this.sendNotification(new Ut("City.improvement-unsupported",{city:m,cityImprovement:f}))}),P.on("city:food-storage-exhausted",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.food-storage-exhausted",{city:m}))}),P.on("city:building-complete",(m,f)=>{let u=me.getByPlayer(this.player());if(m.city().player()!==this.player()&&f instanceof Ae){this.sendNotification(new Ut(u.getByTile(m.city().tile())?"Wonder.building-complete.other-player.known":"Wonder.building-complete.other-player.unknown",{cityBuild:m,build:f}));return}if(m.city().player()!==this.player())return;T(this,ue).update(m.id(),()=>m.toPlainObject(T(this,Pe).call(this,Ze(xe,Fe,q))));let y=f instanceof Fe?"unit":f instanceof Ae?"wonder":f instanceof K?"city-improvement":f instanceof Ct?"spaceship-part":"other";this.sendNotification(new Ut("City.building-complete."+y,{cityBuild:m,build:f}))}),P.on("player:research-complete",(m,f)=>{m.player()===this.player()&&(T(this,ue).update(m.id(),()=>m.toPlainObject(T(this,Pe).call(this,Ze(q)))),this.sendNotification(new Ut("Player.research-complete",{playerResearch:m,advance:f})))}),P.on("goody-hut:action-performed",(m,f)=>{let u=m.tile();!z.getByTile(u).some(R=>R.player()===this.player())||this.sendNotification(new Ut(`GoodyHut.action-performed.${f.constructor.name}`,{goodyHut:m,action:f}))}),P.on("player:defeated",(m,f)=>{if(m===this.player()){this.sendNotification(new Ut("Player.defeated.local",{defeatedPlayer:m,player:f})),Xi.unregister(...Xi.entries()),os.unregister(...os.entries()),T(this,Dn).send("restart",null);return}this.sendNotification(new Ut(f===null?"Player.defeated.unknown":"Player.defeated.by",{defeatedPlayer:m,player:f}))}),P.on("city:civil-disorder",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.civil-disorder",{city:m}))}),P.on("city:order-restored",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.order-restored",{city:m}))}),P.on("city:leader-celebration",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.leader-celebration",{city:m}))}),P.on("city:leader-celebration-ended",m=>{m.player()===this.player()&&this.sendNotification(new Ut("City.leader-celebration-ended",{city:m}))}),P.on("player:spaceship:part-built",m=>{this.player()!==m&&this.sendNotification(new Ut("Spaceship.part-built",{player:m}))}),P.on("player:spaceship:lost",m=>{this.player()===m&&this.sendNotification(new Ut("Player.spaceship-lost",{player:m}))}),P.on("player:spaceship:landed",m=>{this.player()===m&&this.sendNotification(new Ut("Player.spaceship-landed",{player:m}))}),P.on("player:declaration-expired",(m,f)=>{!f.players().includes(this.player())||this.sendNotification(new Ut("Player.declaration-expired",{player:this.player(),declaration:f,enemy:f.players().filter(u=>u!==this.player())[0]}))})}async chooseFromList(r){return new Promise(n=>{if(r.choices().length===1&&r.key()!=="negotiation.next-step"){let[a]=r.choices();n(a.value());return}T(this,Dn).send("chooseFromList",r),T(this,Dn).receiveOnce("chooseFromList",async a=>{let[s]=r.choices().filter(m=>m.id()===a);if(!s){console.warn(`No choice found for '${a}' against '${r.id()}', using super.`),n(await super.chooseFromList(r));return}n(s.value())})})}async handleAction(...r){let[n]=r,a=this.player(),s=a.actions(),m=s.filter(R=>R instanceof _i),{name:f,id:u}=n;if(f==="ReassignWorkers"){let[R]=Z.getBy("id",n.city);return R&&(Nu(R),T(this,ue).update(R.id(),R.toPlainObject(T(this,Pe).call(this,Ze(q,xe))))),!1}if(f==="EndTurn")return m.length===1&&m.every(R=>R instanceof Tl);if(!f)return console.log("action not specified: ",n),!1;let[y]=s.filter(R=>R.constructor.name===f&&u===(R.value()?R.value().id():void 0));if(!y)return console.log("action not specified"),!1;if(y instanceof Aa){let{unitAction:R,target:B}=n,N=y.value(),[W]=me.getByPlayer(this.player()).filter(h=>h.id()===B);if(!W)return console.log(`tile not found: ${B}`),!1;let _=N.actions(W.tile()),d=_.filter(h=>h.sourceClass().name===R);if(d.length===0)return console.log(`action not found: ${R}`),!1;let[g]=d;return g.perform(),g instanceof nt&&await this.canNegotiate(N),!1}if(y instanceof Ba){let R=y.value();return R.moves().value()>0&&T(this,ue).update(R.id(),R.toPlainObject(T(this,Pe).call(this,Ze(q,xe)))),R.activate(),!1}if(y instanceof vs||y instanceof Gm){let R=y.value(),{chosen:B}=n;if(!B)return console.warn("no build item specified"),!1;let[N]=R.available().filter(W=>W.item().name===B);return N?(R.build(N.item()),!1):(console.log(`build item not available: ${B}`),!1)}if(y instanceof EI){let R=y.value(),{chosen:B}=n;if(!B)return console.warn("no advance specified"),!1;let[N]=R.available().filter(W=>W.name===B);return N?(R.research(N),!1):(console.log(`build item not available: ${B}`),!1)}if(y instanceof Wm){let R=y.value(),[B]=tn.getBy("id",n.treasury);return B?(B.buy(R.city()),T(this,ue).update(B.id(),B.toPlainObject(T(this,Pe).call(this,Ze(q)))),!1):(console.warn(`No playerTreasury found for id: ${n.treasury}.`),!1)}if(y instanceof ts){let R=y.value(),{chosen:B}=n,[N]=R.available().filter(_=>_.name===B);if(!N)return console.error(`Government type: '${B}' not found.`),!1;R.set(new N);let W=me.getByPlayer(this.player());return T(this,ue).update(W.id(),W.toPlainObject(T(this,Pe).call(this,Ze(q)))),Z.getByPlayer(this.player()).forEach(_=>T(this,ue).update(_.id(),_.toPlainObject(T(this,Pe).call(this,Ze(q,xe,Fe))))),!1}if(y instanceof Em){let R=y.value(),{value:B}=n;return R.setAll(B.map(([N,W])=>{let[_]=R.all().filter(d=>d.constructor.name===N);return[_.constructor,W]})),Z.getByPlayer(this.player()).forEach(N=>T(this,ue).update(N.id(),N.toPlainObject(T(this,Pe).call(this,Ze(q,xe,Fe))))),!1}return y instanceof Il?(y.value().launch(),!1):(console.log(`unhandled action: ${JSON.stringify(n)}`),!1)}sendInitialData(){T(this,Dn).send("gameData",new LA(this.player(),te,Ns)),ce(this,Lu,!0)}sendPatchData(){T(this,Dn).send("gameDataPatch",T(this,ue).transferData()),T(this,ue).clear()}sendNotification(r){T(this,Dn).send("gameNotification",r)}takeTurn(){return new Promise((r,n)=>{T(this,Lu)||this.sendInitialData(),setTimeout(()=>{T(this,ue).update(te.id(),()=>te.toPlainObject()),T(this,ue).update(Ns.id(),()=>Ns.toPlainObject()),T(this,ue).add(this.player().id(),()=>this.player().toPlainObject(T(this,Pe).call(this,Ze(Ml,$m,xe)))),this.sendPatchData()},1);let a=t(async(...s)=>{try{if(await this.handleAction(...s)){T(this,Nl).off("action",a),this.sendPatchData(),setTimeout(()=>r(),10);return}T(this,ue).update(this.player().id(),()=>this.player().toPlainObject(T(this,Pe).call(this,Ze(Ml,$m,xe,it)))),this.sendPatchData()}catch(m){n(m)}},"listener");T(this,Nl).on("action",a)})}async canNegotiate(r){let n=Array.from(new Set(r.tile().getNeighbours().flatMap(a=>z.getByTile(a).map(s=>s.player()).filter(s=>s!==this.player()))));n.length!==0&&await n.filter(a=>Ur.getByPlayer(a).filter(s=>s instanceof Wp&&s.isBetween(a,this.player())).every(s=>te.value()-s.when()>xq)).reduce((a,s)=>a.then(()=>this.handleNegotiation(s)),Promise.resolve())}async handleNegotiation(r){let n=new Wp(r,this.player(),c);for(n.proceed(new vn(r,n,c));!n.terminated();){let a=n.lastInteraction();if(await(a!==null?a.for():n.players().slice(1)).reduce((m,f)=>m.then(async()=>{let u=Lt.getByPlayer(f),y=n.nextSteps(),B=await Promise.race([u.chooseFromList(new Mm(y,"negotiation.next-step",n)),u instanceof hl?hq(500,new zA(`Timeout waiting for ${u.player().id()} (${u.player().civilization().sourceClass().name}) - sent ${y.length} options`)):new Promise(()=>{})]);!B||(n.proceed(B),B instanceof Bn&&await B.proposal().resolve(B))}).catch(u=>console.error(u)),Promise.resolve()),n.terminated())break}return Ur.register(n),n}};t(Ah,"DataTransferClient"),Pe=new WeakMap,ue=new WeakMap,Nl=new WeakMap,Bh=new WeakMap,Gh=new WeakMap,Lu=new WeakMap,Dn=new WeakMap;var nB=Ah;Do();sf();rs();ee();Zm();var fr,Vv=class{constructor(e){ne(this,fr,void 0);ce(this,fr,e),e.receive("start",()=>{this.bindEvents(),this.start()}),e.receive("setOption",({name:r,value:n})=>{T(this,fr).send("notification",`setting ${r} to ${n}`),P.setOption(r,n)}),e.receive("getOptions",r=>e.send("getOptions",r.reduce((n,a)=>(n[a]=P.option(a),n),{}))),e.receive("setOptions",r=>{Object.entries(r).forEach(([n,a])=>P.setOption(n,a)),e.send("setOptions",null)})}bindEvents(){T(this,fr).send("notification","binding events"),P.on("engine:initialise",()=>T(this,fr).send("notification","initialising...")),P.on("engine:plugins:load:success",e=>T(this,fr).send("notification",`loaded plugin: ${e}`)),P.on("engine:plugins-loaded",()=>T(this,fr).send("notification","plugins loaded")),P.on("engine:start",()=>T(this,fr).send("notification","starting...")),P.on("world:generate-start-tiles",()=>T(this,fr).send("notification","generating start tiles...")),P.on("world:built",()=>T(this,fr).send("notification","world built")),P.on("game:start",()=>T(this,fr).send("notification","game start")),P.on("turn:start",e=>T(this,fr).send("notification",`turn start ${e}`)),P.on("player:turn-start",e=>T(this,fr).send("notification",`player turn-start: ${e.civilization().constructor.name}`))}start(){P.on("engine:start",()=>{new Array(parseInt(P.option("players"),10)).fill(0).forEach((e,r)=>{let n=new q,a=r===0?new nB(n,T(this,fr),(s,m)=>T(this,fr).send(s,m),(s,m)=>T(this,fr).receive(s,m)):new Ks(n);Xi.register(n),Lt.register(a),T(this,fr).send("notification","generating world...")})}),P.start(),Promise.resolve().then(()=>(oq(),hJ)).then(()=>P.emit("plugins:load:end"))}};t(Vv,"Game"),fr=new WeakMap;var iq=Vv;var Jv=class{async request(e){return new Promise(r=>{this.send(e.channel(),e.args()[0]),this.receiveOnce(e.channel(),n=>r(n))})}};t(Jv,"AbstractTransport");var nq=Jv;J();var $v=class extends nq{receive(e,r){addEventListener("message",({data:{channel:n,data:a}})=>{e===n&&r(a)})}receiveOnce(e,r){let n=t(({data:{channel:a,data:s}})=>{e===a&&(r(s),removeEventListener("message",n))},"fullHandler");addEventListener("message",n)}send(e,r){r instanceof ae&&(r=r.toPlainObject()),postMessage({channel:e,data:r})}};t($v,"ParentTransport");var aq=$v;var YTt=new iq(new aq);})();
//# sourceMappingURL=backend.js.map
